<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üåå ALEKSIN GAMES v6.3 ‚úÖ –§–ò–ö–°–´!</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        @import url('https://fonts.cdnfonts.com/css/neon-glow');
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Orbitron', monospace; 
            background: linear-gradient(45deg, #0a0a23, #1a0033, #0a0a23); 
            background-size: 400% 400%; animation: gradientShift 15s ease infinite;
            color: #00ff88; overflow-x: hidden; 
        }
        @keyframes gradientShift { 0%,100%{background-position:0%50%} 50%{background-position:100%50%} }
        
        .container { max-width: 1400px; margin: 0 auto; padding: 20px; }
        .header {
            text-align: center; background: rgba(0,255,136,0.1); backdrop-filter: blur(20px);
            border: 2px solid #00ff88; border-radius: 25px; padding: 30px; margin-bottom: 30px;
            box-shadow: 0 0 50px #00ff88; animation: neonPulse 2s ease-in-out infinite alternate;
        }
        @keyframes neonPulse { from{box-shadow:0 0 20px #00ff88} to{box-shadow:0 0 50px #00ff88,0 0 100px #00ff88} }
        
        .section { 
            background: rgba(255,255,255,0.05); backdrop-filter: blur(15px); border-radius: 20px;
            padding: 25px; margin-bottom: 25px; border: 1px solid rgba(0,255,136,0.3);
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
        }
        button { 
            background: linear-gradient(45deg,#00ff88,#00cc6a); color: #0a0a23; 
            border: none; padding: 15px 25px; border-radius: 12px; font-family: 'Orbitron',monospace;
            font-weight: 700; cursor: pointer; margin: 5px; transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0,255,136,0.4);
        }
        button:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(0,255,136,0.6); }
        input, select { 
            width: 100%; padding: 15px; border: 2px solid rgba(0,255,136,0.3); 
            border-radius: 12px; background: rgba(0,255,136,0.1); color: #00ff88;
            font-family: 'Orbitron', monospace; margin-bottom: 15px;
        }
        .game-canvas { border: 3px solid #00ff88; border-radius: 15px; background: #000; 
            display: none; margin: 20px auto; box-shadow: 0 0 30px #00ff88; }
        #tournamentTimer { 
            font-size: 2.5rem; font-weight: 900; text-align: center; margin: 20px 0;
            text-shadow: 0 0 30px #ff4444; animation: pulseRed 1s infinite;
        }
        @keyframes pulseRed { 0%,100%{text-shadow:0 0 20px #ff4444} 50%{text-shadow:0 0 40px #ff4444,0 0 60px #ff4444} }
        .leaderboard-table { width: 100%; border-collapse: collapse; background: rgba(0,0,0,0.5); border-radius: 12px; overflow: hidden; }
        .leaderboard-table th, .leaderboard-table td { padding: 12px; text-align: center; border-bottom: 1px solid rgba(0,255,136,0.2); }
        .leaderboard-table th { background: rgba(0,255,136,0.2); }
        .rank-1 { background: linear-gradient(45deg,#ffd700,#ffed4e); color: #000; }
        .rank-2 { background: linear-gradient(45deg,#c0c0c0,#e5e5e5); color: #000; }
        .rank-3 { background: linear-gradient(45deg,#cd7f32,#deb887); color: #000; }
        .hidden { display: none !important; }
        #chatMessages { height: 250px; overflow-y: auto; background: rgba(0,0,0,0.7); 
            border-radius: 12px; padding: 15px; margin-bottom: 15px; border: 1px solid rgba(0,255,136,0.3); }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üåå ALEKSIN GAMES v6.3 ‚úÖ –§–ò–ö–°–´!</h1>
            <p>–¢—É–ª–∞-–≥–µ–π–º–∏–Ω–≥ —Ö–∞–± | test/123456</p>
            <div>–¢—É—Ä–Ω–∏—Ä –¥–æ: <span id="tournamentTimer">--:--:--</span></div>
        </div>
        
        <!-- –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø -->
        <div id="authSection" class="section">
            <h2>üîê –í—Ö–æ–¥</h2>
            <input type="text" id="username" placeholder="test" value="test">
            <input type="password" id="password" placeholder="123456" value="123456">
            <button onclick="login()">üöÄ –í–û–ô–¢–ò</button>
            <div id="authStatus">–ì–æ—Å—Ç—å</div>
        </div>
        
        <!-- –ò–ì–†–´ -->
        <div id="gamesSection" class="section hidden">
            <h2>üéÆ –ò–ì–†–´</h2>
            
            <h3>üêç –ó–ú–ï–ô–ö–ê Pro</h3>
            <select id="snakeDifficulty">
                <option value="easy">–õ—ë–≥–∫–∞—è (20x15)</option>
                <option value="medium">–°—Ä–µ–¥–Ω—è—è (25x20)</option>
                <option value="hard">–°–ª–æ–∂–Ω–∞—è (30x25)</option>
            </select>
            <button onclick="startSnake()">‚ñ∂Ô∏è –°–¢–ê–†–¢</button>
            <button onclick="stopSnake()" id="stopSnakeBtn" class="hidden">‚èπÔ∏è –°–¢–û–ü</button>
            <canvas id="snakeCanvas" class="game-canvas" width="600" height="450"></canvas>
            <div>–û—á–∫–∏: <span id="snakeScore">0</span></div>
            
            <h3>üéØ –£–ì–ê–î–ê–ô –ß–ò–°–õ–û</h3>
            <select id="guessDifficulty">
                <option value="1000">1-1,000</option>
                <option value="10000">1-10,000</option>
                <option value="100000">1-100,000</option>
            </select>
            <input type="number" id="guessInput" placeholder="–£–≥–∞–¥–∞–π —á–∏—Å–ª–æ">
            <button onclick="makeGuess()">üîç –£–ì–ê–î–ê–¢–¨</button>
            <div id="guessFeedback">–í—ã–±–µ—Ä–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç—å</div>
            <div id="guessStats">–ü–æ–ø—ã—Ç–æ–∫: 0</div>
        </div>
        
        <!-- –¢–£–†–ù–ò–† -->
        <div id="tournamentSection" class="section hidden">
            <h2>‚öîÔ∏è –¢–£–†–ù–ò–† –¢–û–ü-100</h2>
            <button onclick="toggleTournament()">‚ö° –£–ß–ê–°–¢–í–û–í–ê–¢–¨</button>
            <div id="tournamentTable"></div>
        </div>
        
        <!-- –¢–û–ü–´ -->
        <div id="leaderboardsSection" class="section hidden">
            <h2>üèÜ –¢–û–ü-10</h2>
            <div id="leaderboards"></div>
        </div>
        
        <!-- –ß–ê–¢ -->
        <div id="chatSection" class="section hidden">
            <h2>üí¨ –ß–ê–¢</h2>
            <div id="chatMessages"></div>
            <input type="text" id="chatInput" placeholder="–°–æ–æ–±—â–µ–Ω–∏–µ..." onkeypress="if(event.key==='Enter')sendChat()">
            <button onclick="sendChat()">üì§</button>
        </div>
    </div>

    <script>
        // –ì–õ–û–ë–ê–õ–¨–ù–´–ï
        let currentUser = null, isInTournament = false, snakeGame = null;
        let tournamentEndTime = 0;
        
        // ‚úÖ –¢–û–ß–ù–´–ô –¢–ê–ô–ú–ï–† 00:00 –ú–°–ö
        function getNextMidnightMSK() {
            const now = new Date();
            const mskOffset = 3 * 60 * 60 * 1000; // +3 UTC –¥–ª—è –ú–°–ö
            const mskNow = new Date(now.getTime() + mskOffset);
            const tomorrow = new Date(mskNow);
            tomorrow.setHours(24,0,0,0);
            return tomorrow.getTime() - mskOffset; // –ö–æ–Ω–≤–µ—Ä—Ç –æ–±—Ä–∞—Ç–Ω–æ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–µ
        }
        
        // –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø
        document.addEventListener('DOMContentLoaded', () => {
            tournamentEndTime = getNextMidnightMSK();
            loadUser();
            updateUI();
            setInterval(updateTournamentTimer, 1000);
            setInterval(updateAll, 5000);
        });
        
        // –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø
        function login() {
            const name = document.getElementById('username').value.trim();
            const pass = document.getElementById('password').value;
            if(name && pass) {
                currentUser = { name, joined: Date.now() };
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                updateUI();
                alert(`‚úÖ ${name}!`);
            }
        }
        
        function updateUI() {
            const loggedIn = !!currentUser;
            ['gamesSection','tournamentSection','leaderboardsSection','chatSection']
                .forEach(id => document.getElementById(id).classList.toggle('hidden', !loggedIn));
            document.getElementById('authStatus').textContent = loggedIn ? `üë§ ${currentUser.name}` : '–ì–æ—Å—Ç—å';
        }
        
        // ‚úÖ –ó–ú–ï–ô–ö–ê –§–ò–ö–° - –ù–ï –ê–í–¢–û–ò–ì–†–ê–ï–¢
        function startSnake() {
            if(snakeGame) return alert('‚èπÔ∏è –°–Ω–∞—á–∞–ª–∞ –°–¢–û–ü!');
            
            const canvas = document.getElementById('snakeCanvas');
            const ctx = canvas.getContext('2d');
            const diff = document.getElementById('snakeDifficulty').value;
            
            const config = {
                easy: {tilesX:20,tilesY:15,speed:200},
                medium: {tilesX:25,tilesY:20,speed:150},
                hard: {tilesX:30,tilesY:25,speed:100}
            }[diff];
            
            canvas.width = config.tilesX * 20;
            canvas.height = config.tilesY * 20;
            canvas.style.display = 'block';
            document.getElementById('stopSnakeBtn').classList.remove('hidden');
            
            snakeGame = new SnakeGame(ctx, config);
            snakeGame.start();
        }
        
        function stopSnake() {
            if(snakeGame) {
                snakeGame.stop();
                snakeGame = null;
                document.getElementById('snakeCanvas').style.display = 'none';
                document.getElementById('stopSnakeBtn').classList.add('hidden');
            }
        }
        
        class SnakeGame {
            constructor(ctx, config) {
                this.ctx = ctx; this.tilesX = config.tilesX; this.tilesY = config.tilesY;
                this.gridSize = 20; this.speed = config.speed; this.score = 0;
                this.direction = {x:0,y:-1}; this.snakeParts = [{x:10,y:10}];
                this.foodX = Math.floor(Math.random()*this.tilesX);
                this.foodY = Math.floor(Math.random()*this.tilesY);
                this.gameLoop = null; this.keys = {}; this.isPaused = false;
            }
            
            start() {
                this.bindEvents();
                document.getElementById('snakeScore').textContent = this.score;
                this.gameLoop = setInterval(() => this.update(), this.speed);
            }
            
            stop() {
                if(this.gameLoop) clearInterval(this.gameLoop);
            }
            
            bindEvents() {
                document.addEventListener('keydown', e => {
                    if(e.key === 'ArrowUp' && this.direction.y === 0) this.direction = {x:0,y:-1};
                    if(e.key === 'ArrowDown' && this.direction.y === 0) this.direction = {x:0,y:1};
                    if(e.key === 'ArrowLeft' && this.direction.x === 0) this.direction = {x:-1,y:0};
                    if(e.key === 'ArrowRight' && this.direction.x === 0) this.direction = {x:1,y:0};
                    if(e.key === ' ') this.isPaused = !this.isPaused;
                });
            }
            
            update() {
                if(this.isPaused) return this.draw();
                
                const head = { 
                    x: this.snakeParts[0].x + this.direction.x, 
                    y: this.snakeParts[0].y + this.direction.y 
                };
                
                // ‚úÖ –†–ï–ö–û–†–î–´ –¢–û–õ–¨–ö–û GAME OVER
                if(head.x < 0 || head.x >= this.tilesX || head.y < 0 || head.y >= this.tilesY || 
                   this.snakeParts.slice(1).some(p => p.x === head.x && p.y === head.y)) {
                    this.saveScore(); // ‚úÖ –¢–û–õ–¨–ö–û –ó–î–ï–°–¨!
                    alert(`üéâ ${this.score} –æ—á–∫–æ–≤!`);
                    stopSnake();
                    return;
                }
                
                this.snakeParts.unshift(head);
                
                if(head.x === this.foodX && head.y === this.foodY) {
                    this.score += 10;
                    this.foodX = Math.floor(Math.random()*this.tilesX);
                    this.foodY = Math.floor(Math.random()*this.tilesY);
                } else {
                    this.snakeParts.pop();
                }
                
                document.getElementById('snakeScore').textContent = this.score;
                this.draw();
            }
            
            draw() {
                this.ctx.fillStyle = '#000'; 
                this.ctx.fillRect(0,0,this.tilesX*this.gridSize,this.tilesY*this.gridSize);
                
                this.ctx.fillStyle = '#00ff88';
                this.snakeParts.forEach(p => {
                    this.ctx.fillRect(p.x*this.gridSize, p.y*this.gridSize, this.gridSize-2, this.gridSize-2);
                });
                
                this.ctx.fillStyle = '#ff4444';
                this.ctx.fillRect(this.foodX*this.gridSize, this.foodY*this.gridSize, this.gridSize-2, this.gridSize-2);
                
                this.ctx.fillStyle = '#fff'; this.ctx.font = 'bold 24px Orbitron';
                this.ctx.fillText(`–û—á–∫–∏: ${this.score}`, 10, 30);
            }
            
            // ‚úÖ –†–ï–ö–û–†–î –¢–û–õ–¨–ö–û –û–î–ò–ù –†–ê–ó
            saveScore() {
                const diff = document.getElementById('snakeDifficulty').value;
                saveScore('snake', diff, this.score, 'max');
                if(isInTournament) addTournamentScore(this.score * 2); // ‚úÖ –ù–ê–ö–û–ü–õ–ï–ù–ò–ï
            }
        }
        
        // ‚úÖ –£–ì–ê–î–ê–ô–ö–ê (–ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–ô)
        let guessGame = {number:0, attempts:0, min:1, max:1000};
        function makeGuess() {
            const guess = parseInt(document.getElementById('guessInput').value);
            const diff = document.getElementById('guessDifficulty').value;
            guessGame.max = parseInt(diff);
            
            if(!guessGame.number) {
                guessGame.number = Math.floor(Math.random() * guessGame.max) + 1;
            }
            
            if(guess === guessGame.number) {
                const score = Math.floor(10000 / guessGame.attempts);
                saveScore('guess', diff, score, 'max');
                if(isInTournament) addTournamentScore(score * 1.5);
                document.getElementById('guessFeedback').innerHTML = `üéâ ${score} –æ—á–∫–æ–≤!`;
                guessGame = {number:0, attempts:0, min:1, max:guessGame.max};
            } else {
                guessGame.attempts++;
                document.getElementById('guessFeedback').textContent = 
                    guess < guessGame.number ? 'üìà –ë–æ–ª—å—à–µ!' : 'üìâ –ú–µ–Ω—å—à–µ!';
            }
            document.getElementById('guessStats').textContent = `–ü–æ–ø—ã—Ç–æ–∫: ${guessGame.attempts}`;
            document.getElementById('guessInput').value = '';
        }
        
        // ‚úÖ –¢–£–†–ù–ò–† –ù–ê–ö–û–ü–õ–ï–ù–ò–ï –û–ß–ö–û–í
        function toggleTournament() {
            isInTournament = !isInTournament;
            document.querySelector('[onclick="toggleTournament()"]').textContent = 
                isInTournament ? '‚úÖ –í –¢–£–†–ù–ò–†–ï' : '‚ö° –£–ß–ê–°–¢–í–û–í–ê–¢–¨';
        }
        
        function addTournamentScore(points) {
            if(!isInTournament) return;
            const scores = JSON.parse(localStorage.getItem('tournament_total') || '{}');
            scores[currentUser.name] = (scores[currentUser.name] || 0) + points;
            localStorage.setItem('tournament_total', JSON.stringify(scores));
        }
        
        // ‚úÖ –õ–ò–î–ï–†–ë–û–†–î–´
        function saveScore(game, diff, score, type) {
            const key = `${game}_${diff}`;
            const scores = JSON.parse(localStorage.getItem(key) || '[]');
            scores.unshift({user: currentUser.name, score, date: Date.now()});
            localStorage.setItem(key, JSON.stringify(scores.slice(0,10)));
            updateLeaderboards();
        }
        
        function updateLeaderboards() {
            let html = '';
            ['snake_easy','snake_medium','snake_hard','guess_1000','guess_10000','guess_100000']
                .forEach(key => {
                    const scores = JSON.parse(localStorage.getItem(key) || '[]').slice(0,10);
                    html += `<h4>${key.replace('snake_','–ó–º–µ–π–∫–∞ ').replace('guess_','–£–≥–∞–¥–∞–π ').replace('_',' ')}</h4>`;
                    html += '<table class="leaderboard-table"><tr><th>–ú–µ—Å—Ç–æ</th><th>–ò–≥—Ä–æ–∫</th><th>–û—á–∫–∏</th></tr>';
                    scores.forEach((s,i) => {
                        const cls = i<3 ? `rank-${i+1}` : '';
                        html += `<tr class="${cls}"><td>${i+1}${i<3?' ü•áü•àü•â'[i]:''}</td><td>${s.user}</td><td>${s.score}</td></tr>`;
                    });
                    html += '</table>';
                });
            document.getElementById('leaderboards').innerHTML = html;
        }
        
        // ‚úÖ –¢–ê–ô–ú–ï–†
        function updateTournamentTimer() {
            const now = Date.now();
            let timeLeft = tournamentEndTime - now;
            if(timeLeft <= 0) {
                tournamentEndTime = getNextMidnightMSK();
                timeLeft = tournamentEndTime - now;
            }
            const h = Math.floor(timeLeft/3600000).toString().padStart(2,'0');
            const m = Math.floor((timeLeft%3600000)/60000).toString().padStart(2,'0');
            const s = Math.floor((timeLeft%60000)/1000).toString().padStart(2,'0');
            document.getElementById('tournamentTimer').textContent = `${h}:${m}:${s}`;
        }
        
        function updateAll() {
            updateLeaderboards();
            updateTournamentTable();
            updateChat();
        }
        
        function updateTournamentTable() {
            const scores = Object.entries(JSON.parse(localStorage.getItem('tournament_total') || '{}'))
                .sort((a,b)=>b[1]-a[1]).slice(0,10);
            let html = '<table class="leaderboard-table"><tr><th>–ú–µ—Å—Ç–æ</th><th>–ò–≥—Ä–æ–∫</th><th>–û—á–∫–∏</th></tr>';
            scores.forEach((s,i) => {
                const cls = i<3 ? `rank-${i+1}` : '';
                html += `<tr class="${cls}"><td>${i+1}${i<3?' ü•áü•àü•â'[i]:''}</td><td>${s[0]}</td><td>${s[1]}</td></tr>`;
            });
            html += '</table>';
            document.getElementById('tournamentTable').innerHTML = html;
        }
        
        // –ß–ê–¢
        function sendChat() {
            const msg = document.getElementById('chatInput').value.trim();
            if(msg && currentUser) {
                const chat = JSON.parse(localStorage.getItem('chat') || '[]');
                chat.unshift({user:currentUser.name, msg, time:new Date().toLocaleTimeString('ru')});
                localStorage.setItem('chat', JSON.stringify(chat.slice(0,50)));
                document.getElementById('chatInput').value = '';
                updateChat();
            }
        }
        function updateChat() {
            const chat = JSON.parse(localStorage.getItem('chat') || '[]');
            document.getElementById('chatMessages').innerHTML = 
                chat.map(c => `<div><strong>${c.user}</strong> (${c.time}): ${c.msg}</div>`).join('');
        }
    </script>
</body>
</html>
