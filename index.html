<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üåå ALEKSIN COSMIC GAMES HUB v6.2 üåå ‚úÖ 13/13 –†–ê–ë–û–¢–ê–ï–¢!</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Exo+2:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        @import url('https://fonts.cdnfonts.com/css/neon-glow');
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body { 
            font-family: 'Orbitron', monospace; 
            background: linear-gradient(45deg, #0a0a23, #1a0033, #0a0a23); 
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
            color: #00ff88;
            overflow-x: hidden;
            min-height: 100vh;
        }
        @keyframes gradientShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        
        .container { max-width: 1400px; margin: 0 auto; padding: 20px; }
        .header {
            text-align: center; 
            background: rgba(0,255,136,0.1);
            backdrop-filter: blur(20px);
            border: 2px solid #00ff88;
            border-radius: 25px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 0 50px #00ff88;
            animation: neonPulse 2s ease-in-out infinite alternate;
        }
        @keyframes neonPulse {
            from { box-shadow: 0 0 20px #00ff88; }
            to { box-shadow: 0 0 50px #00ff88, 0 0 100px #00ff88; }
        }
        h1 { font-size: clamp(2rem, 5vw, 4rem); margin-bottom: 10px; text-shadow: 0 0 20px #00ff88; }
        .subtitle { font-size: 1.2rem; opacity: 0.9; }
        
        .auth-section, .games-section, .leaderboards-section, .chat-section, .tournament-section {
            background: rgba(255,255,255,0.05);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            border: 1px solid rgba(0,255,136,0.3);
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
        }
        
        .form-group { margin-bottom: 20px; }
        input, select, button {
            width: 100%; padding: 15px; border: none; border-radius: 12px;
            font-family: 'Orbitron', monospace; font-size: 1rem;
            transition: all 0.3s ease;
        }
        input, select { 
            background: rgba(0,255,136,0.1); 
            border: 2px solid rgba(0,255,136,0.3); 
            color: #00ff88;
        }
        input:focus, select:focus { 
            outline: none; 
            border-color: #00ff88; 
            box-shadow: 0 0 20px rgba(0,255,136,0.5);
        }
        button {
            background: linear-gradient(45deg, #00ff88, #00cc6a);
            color: #0a0a23; font-weight: 700; cursor: pointer;
            box-shadow: 0 5px 15px rgba(0,255,136,0.4);
        }
        button:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(0,255,136,0.6); }
        button:active { transform: translateY(0); }
        
        .game-canvas { 
            border: 3px solid #00ff88; 
            border-radius: 15px; 
            background: #000; 
            box-shadow: 0 0 30px #00ff88;
            display: block; margin: 20px auto;
        }
        
        .leaderboard-table {
            width: 100%; border-collapse: collapse; margin-top: 15px;
            background: rgba(0,0,0,0.5); border-radius: 12px; overflow: hidden;
        }
        .leaderboard-table th, .leaderboard-table td {
            padding: 12px; text-align: center; border-bottom: 1px solid rgba(0,255,136,0.2);
        }
        .leaderboard-table th { background: rgba(0,255,136,0.2); font-weight: 700; }
        .rank-1 { background: linear-gradient(45deg, #ffd700, #ffed4e); color: #000; }
        .rank-2 { background: linear-gradient(45deg, #c0c0c0, #e5e5e5); color: #000; }
        .rank-3 { background: linear-gradient(45deg, #cd7f32, #deb887); color: #000; }
        
        #chatMessages { 
            height: 300px; overflow-y: auto; 
            background: rgba(0,0,0,0.7); 
            border-radius: 12px; 
            padding: 15px; 
            margin-bottom: 15px;
            border: 1px solid rgba(0,255,136,0.3);
        }
        .chat-message { 
            margin-bottom: 10px; 
            padding: 8px; 
            background: rgba(0,255,136,0.1); 
            border-radius: 8px;
            border-left: 4px solid #00ff88;
        }
        .chat-message strong { color: #00ff88; }
        
        #tournamentTimer {
            font-size: 2rem; font-weight: 900;
            text-align: center; margin: 20px 0;
            text-shadow: 0 0 20px #ff4444;
            animation: pulseRed 1s infinite;
        }
        @keyframes pulseRed {
            0%, 100% { text-shadow: 0 0 20px #ff4444; }
            50% { text-shadow: 0 0 40px #ff4444, 0 0 60px #ff4444; }
        }
        
        .hidden { display: none !important; }
        .mobile-controls {
            position: fixed; bottom: 20px; left: 20px; right: 20px;
            display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px;
            z-index: 1000;
        }
        .mobile-btn {
            height: 60px; font-size: 1.5rem; border-radius: 15px;
            background: rgba(0,255,136,0.3); color: #00ff88; border: 2px solid #00ff88;
        }
        
        @media (max-width: 768px) {
            .container { padding: 10px; }
            .header { padding: 20px; margin-bottom: 20px; }
            .game-canvas { width: 100%; max-width: 400px; height: 400px; }
        }
        
        .particles {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: -1;
        }
        .particle {
            position: absolute; width: 4px; height: 4px;
            background: #00ff88; border-radius: 50%;
            animation: float 6s linear infinite;
        }
        @keyframes float {
            0% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { transform: translateY(-100px) rotate(360deg); opacity: 0; }
        }
    </style>
</head>
<body>
    <div class="particles" id="particles"></div>
    
    <div class="container">
        <div class="header">
            <h1>üåå ALEKSIN COSMIC GAMES HUB v6.2 üåå</h1>
            <p class="subtitle">–¢—É–ª–∞-–≥–µ–π–º–∏–Ω–≥ —Å—Ç–æ–ª–∏—Ü–∞ –º–∏—Ä–∞! ü•á 13/13 ‚úÖ</p>
            <p>–¢—É—Ä–Ω–∏—Ä –¥–æ: <span id="tournamentTimer">--:--:--</span></p>
        </div>
        
        <!-- –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø -->
        <div id="authSection" class="auth-section">
            <h2>üîê –í—Ö–æ–¥ / –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
            <div class="form-group">
                <input type="text" id="username" placeholder="–ù–∏–∫ (test)" value="test">
            </div>
            <div class="form-group">
                <input type="password" id="password" placeholder="–ü–∞—Ä–æ–ª—å (123456)" value="123456">
            </div>
            <button onclick="login()">üöÄ –í–û–ô–¢–ò</button>
            <button onclick="logout()" class="hidden" id="logoutBtn">‚ùå –í–´–•–û–î</button>
            <p id="authStatus">–ì–æ—Å—Ç—å</p>
        </div>
        
        <!-- –ò–ì–†–´ (—Å–∫—Ä—ã—Ç—ã –¥–æ –≤—Ö–æ–¥–∞) -->
        <div id="gamesSection" class="games-section hidden">
            <h2>üéÆ –ò–ì–†–´</h2>
            
            <!-- –ó–ú–ï–ô–ö–ê -->
            <div style="margin-bottom: 30px;">
                <h3>üêç –ó–ú–ï–ô–ö–ê Pro</h3>
                <select id="snakeDifficulty">
                    <option value="easy">–õ—ë–≥–∫–∞—è (20x15, –º–µ–¥–ª–µ–Ω–Ω–æ)</option>
                    <option value="medium">–°—Ä–µ–¥–Ω—è—è (25x20, —Å—Ä–µ–¥–Ω–µ)</option>
                    <option value="hard">–°–ª–æ–∂–Ω–∞—è (30x25, –±—ã—Å—Ç—Ä–æ)</option>
                </select>
                <button onclick="startSnake()">‚ñ∂Ô∏è –ò–ì–†–ê–¢–¨</button>
                <canvas id="snakeCanvas" class="game-canvas hidden" width="600" height="450"></canvas>
            </div>
            
            <!-- –£–ì–ê–î–ê–ô –ß–ò–°–õ–û -->
            <div>
                <h3>üéØ –£–ì–ê–î–ê–ô –ß–ò–°–õ–û</h3>
                <select id="guessDifficulty">
                    <option value="1000">1-1000 (–ª—ë–≥–∫–∞—è)</option>
                    <option value="10000">1-10,000 (—Å—Ä–µ–¥–Ω—è—è)</option>
                    <option value="100000">1-100,000 (—Å–ª–æ–∂–Ω–∞—è)</option>
                </select>
                <div class="form-group">
                    <input type="number" id="guessInput" placeholder="–¢–≤–æ—ë —á–∏—Å–ª–æ...">
                </div>
                <button onclick="makeGuess()">üîç –£–ì–ê–î–ê–¢–¨</button>
                <p id="guessFeedback">–í—ã–±–µ—Ä–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç—å –∏ –Ω–∞—á–Ω–∏!</p>
                <p id="guessStats">–ü–æ–ø—ã—Ç–æ–∫: 0 | –û—Å—Ç–∞–ª–æ—Å—å —á–∏—Å–µ–ª: ?</p>
            </div>
        </div>
        
        <!-- –õ–ò–î–ï–†–ë–û–†–î–´ -->
        <div id="leaderboardsSection" class="leaderboards-section hidden">
            <h2>üèÜ –¢–û–ü-10 –ø–æ –∏–≥—Ä–∞–º</h2>
            <div id="snakeLeaderboards"></div>
            <div id="guessLeaderboards"></div>
        </div>
        
        <!-- –¢–£–†–ù–ò–† -->
        <div id="tournamentSection" class="tournament-section hidden">
            <h2>‚öîÔ∏è –ì–õ–ê–í–ù–´–ô –¢–£–†–ù–ò–† (24—á)</h2>
            <button onclick="joinTournament()" id="joinTournamentBtn">‚ö° –£–ß–ê–°–¢–í–û–í–ê–¢–¨</button>
            <div id="tournamentTable"></div>
            <p><strong>–ü—Ä–∏–∑—ã –¢–û–ü-5:</strong> ü•á1000‚ÇΩ Steam | ü•à500‚ÇΩ | ü•â300‚ÇΩ | 4-5–µ Discord Nitro</p>
        </div>
        
        <!-- –ß–ê–¢ -->
        <div id="chatSection" class="chat-section hidden">
            <h2>üí¨ –ì–õ–û–ë–ê–õ–¨–ù–´–ô –ß–ê–¢</h2>
            <div id="chatMessages"></div>
            <div class="form-group">
                <input type="text" id="chatInput" placeholder="–ü–∏—à–∏ –∑–¥–µ—Å—å..." onkeypress="if(event.key==='Enter') sendChat()">
            </div>
            <button onclick="sendChat()">üì§ –û–¢–ü–†–ê–í–ò–¢–¨</button>
        </div>
    </div>
    
    <!-- –ú–û–ë–ò–õ–¨–ù–´–ï –ö–û–ù–¢–†–û–õ–´ -->
    <div class="mobile-controls hidden" id="mobileControls">
        <button class="mobile-btn" onclick="mobileControl('up')">‚Üë</button>
        <button class="mobile-btn" onclick="mobileControl('left')">‚Üê</button>
        <button class="mobile-btn" onclick="mobileControl('right')">‚Üí</button>
        <div></div>
        <button class="mobile-btn" onclick="mobileControl('down')">‚Üì</button>
        <div></div>
        <button class="mobile-btn" onclick="mobileControl('pause')">‚è∏Ô∏è</button>
    </div>
    
    <script>
        // –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï
        let currentUser = null;
        let isInTournament = false;
        let tournamentEndTime = getNextTournamentEnd();
        
        // –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø
        document.addEventListener('DOMContentLoaded', function() {
            createParticles();
            loadUser();
            updateTournamentTimer();
            updateLeaderboards();
            updateChat();
            setInterval(updateAll, 3000);
            setInterval(updateTournamentTimer, 1000);
            
            // –ú–û–ë–ò–õ–¨–ù–´–ï –ö–û–ù–¢–†–û–õ–´
            if(/Android|iPhone/i.test(navigator.userAgent)) {
                document.getElementById('mobileControls').classList.remove('hidden');
            }
        });
        
        // –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø
        function login() {
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value;
            
            if(username && password) {
                currentUser = { name: username, joined: Date.now() };
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                saveUser();
                updateUI();
                playSound(800, 0.3);
                alert(`‚úÖ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ${username}!`);
            }
        }
        
        function logout() {
            currentUser = null;
            localStorage.removeItem('currentUser');
            isInTournament = false;
            updateUI();
        }
        
        function loadUser() {
            const saved = localStorage.getItem('currentUser');
            if(saved) {
                currentUser = JSON.parse(saved);
                updateUI();
            }
        }
        
        function saveUser() {
            if(currentUser) {
                const users = JSON.parse(localStorage.getItem('users') || '[]');
                const existing = users.find(u => u.name === currentUser.name);
                if(existing) {
                    existing.joined = currentUser.joined;
                } else {
                    users.push(currentUser);
                }
                localStorage.setItem('users', JSON.stringify(users));
            }
        }
        
        // UI –û–ë–ù–û–í–õ–ï–ù–ò–ï
        function updateUI() {
            const isLoggedIn = !!currentUser;
            document.getElementById('authSection').classList.toggle('hidden', isLoggedIn);
            document.getElementById('gamesSection').classList.toggle('hidden', !isLoggedIn);
            document.getElementById('leaderboardsSection').classList.toggle('hidden', !isLoggedIn);
            document.getElementById('chatSection').classList.toggle('hidden', !isLoggedIn);
            document.getElementById('tournamentSection').classList.toggle('hidden', !isLoggedIn);
            document.getElementById('logoutBtn').classList.toggle('hidden', !isLoggedIn);
            document.getElementById('authStatus').textContent = isLoggedIn ? 
                `üë§ ${currentUser.name}` : '–ì–æ—Å—Ç—å';
        }
        
        // –ó–ú–ï–ô–ö–ê
        let snakeGame = null;
        function startSnake() {
            if(snakeGame) snakeGame.stop();
            
            const canvas = document.getElementById('snakeCanvas');
            const ctx = canvas.getContext('2d');
            const diff = document.getElementById('snakeDifficulty').value;
            
            const config = {
                easy: { tilesX: 20, tilesY: 15, speed: 150 },
                medium: { tilesX: 25, tilesY: 20, speed: 120 },
                hard: { tilesX: 30, tilesY: 25, speed: 90 }
            }[diff];
            
            canvas.width = config.tilesX * 20;
            canvas.height = config.tilesY * 20;
            canvas.classList.remove('hidden');
            
            snakeGame = new SnakeGame(ctx, config);
            snakeGame.start();
        }
        
        class SnakeGame {
            constructor(ctx, config) {
                this.ctx = ctx;
                this.tilesX = config.tilesX;
                this.tilesY = config.tilesY;
                this.gridSize = 20;
                this.speed = config.speed;
                this.score = 0;
                this.gameLoop = null;
                this.direction = { x: 0, y: -1 };
                this.snakeParts = [{ x: Math.floor(this.tilesX/2), y: Math.floor(this.tilesY/2) }];
                this.foodX = Math.floor(Math.random() * this.tilesX);
                this.foodY = Math.floor(Math.random() * this.tilesY);
                this.keys = {};
                this.isPaused = false;
            }
            
            start() {
                this.bindEvents();
                this.gameLoop = requestAnimationFrame(() => this.gameLoopFn());
            }
            
            stop() {
                if(this.gameLoop) cancelAnimationFrame(this.gameLoop);
            }
            
            bindEvents() {
                document.addEventListener('keydown', (e) => {
                    this.keys[e.key] = true;
                    if(e.key === 'ArrowUp' && this.direction.y === 0) this.direction = {x:0,y:-1};
                    if(e.key === 'ArrowDown' && this.direction.y === 0) this.direction = {x:0,y:1};
                    if(e.key === 'ArrowLeft' && this.direction.x === 0) this.direction = {x:-1,y:0};
                    if(e.key === 'ArrowRight' && this.direction.x === 0) this.direction = {x:1,y:0};
                    if(e.key === ' ') this.isPaused = !this.isPaused;
                });
            }
            
            gameLoopFn() {
                if(this.isPaused) {
                    this.draw();
                    this.gameLoop = requestAnimationFrame(() => this.gameLoopFn());
                    return;
                }
                
                const head = { x: this.snakeParts[0].x + this.direction.x, 
                             y: this.snakeParts[0].y + this.direction.y };
                
                // –ö–û–õ–õ–ò–ó–ò–Ø ‚úÖ
                if(head.x < 0 || head.x >= this.tilesX || head.y < 0 || head.y >= this.tilesY || 
                   this.snakeParts.slice(1).some(part => part.x === head.x && part.y === head.y)) {
                    this.saveScore();
                    playSound(200, 0.3);
                    alert(`üéâ GAME OVER! ${this.score} –æ—á–∫–æ–≤ –≤ –ó–º–µ–π–∫–µ!`);
                    startSnake(); // –†–ï–°–¢–ê–†–¢
                    return;
                }
                
                this.snakeParts.unshift(head);
                
                // –ï–î–ê
                if(head.x === this.foodX && head.y === this.foodY) {
                    this.score += 10;
                    this.foodX = Math.floor(Math.random() * this.tilesX);
                    this.foodY = Math.floor(Math.random() * this.tilesY);
                    playSound(1000, 0.2);
                } else {
                    this.snakeParts.pop();
                }
                
                this.draw();
                setTimeout(() => {
                    this.gameLoop = requestAnimationFrame(() => this.gameLoopFn());
                }, this.speed);
            }
            
            draw() {
                this.ctx.fillStyle = '#000';
                this.ctx.fillRect(0, 0, this.tilesX * this.gridSize, this.tilesY * this.gridSize);
                
                // –ó–ú–ï–ô–ö–ê
                this.ctx.fillStyle = '#00ff88';
                this.snakeParts.forEach(part => {
                    this.ctx.fillRect(part.x * this.gridSize, part.y * this.gridSize, 
                                    this.gridSize - 2, this.gridSize - 2);
                });
                
                // –ï–î–ê
                this.ctx.fillStyle = '#ff4444';
                this.ctx.fillRect(this.foodX * this.gridSize, this.foodY * this.gridSize, 
                                this.gridSize - 2, this.gridSize - 2);
                
                // –°–ß–Å–¢
                this.ctx.fillStyle = '#fff';
                this.ctx.font = 'bold 24px Orbitron';
                this.ctx.fillText(`–û—á–∫–∏: ${this.score}`, 10, 30);
                if(this.isPaused) {
                    this.ctx.fillStyle = '#ff4444';
                    this.ctx.font = 'bold 48px Orbitron';
                    this.ctx.textAlign = 'center';
                    this.ctx.fillText('‚è∏Ô∏è –ü–ê–£–ó–ê', this.tilesX * this.gridSize / 2, 
                                    this.tilesY * this.gridSize / 2);
                    this.ctx.textAlign = 'left';
                }
            }
            
            saveScore() {
                const diff = document.getElementById('snakeDifficulty').value;
                saveScore('snake', diff, this.score, 'max');
                if(isInTournament) {
                    saveScore('tournament', 'total', this.score * 2, 'sum');
                }
            }
        }
        
        // –£–ì–ê–î–ê–ô–ö–ê
        let guessGame = { number: 0, attempts: 0, min: 1, max: 1000, low: 1, high: 1000 };
        function makeGuess() {
            const guess = parseInt(document.getElementById('guessInput').value);
            if(!guess || guess < guessGame.min || guess > guessGame.max) {
                document.getElementById('guessFeedback').textContent = '‚ùå –ß–∏—Å–ª–æ –≤–Ω–µ –¥–∏–∞–ø–∞–∑–æ–Ω–∞!';
                return;
            }
            
            guessGame.attempts++;
            if(guess === guessGame.number) {
                const diff = document.getElementById('guessDifficulty').value;
                const score = Math.floor(10000 / guessGame.attempts);
                saveScore('guess', diff, score, 'max');
                playSound(1200, 0.4);
                document.getElementById('guessFeedback').innerHTML = 
                    `üéâ –£–ì–î–ê–õ! (${guessGame.number}) –û—á–∫–∏: ${score}`;
                if(isInTournament) {
                    saveScore('tournament', 'total', score * 1.5, 'sum');
                }
                setTimeout(newGuess, 2000);
            } else if(guess < guessGame.number) {
                guessGame.low = guess + 1;
                document.getElementById('guessFeedback').textContent = 
                    `üìà –ë–æ–ª—å—à–µ! (${guessGame.low}-${guessGame.high})`;
                playSound(600, 0.2);
            } else {
                guessGame.high = guess - 1;
                document.getElementById('guessFeedback').textContent = 
                    `üìâ –ú–µ–Ω—å—à–µ! (${guessGame.low}-${guessGame.high})`;
                playSound(400, 0.2);
            }
            
            const remaining = guessGame.high - guessGame.low + 1;
            document.getElementById('guessStats').textContent = 
                `–ü–æ–ø—ã—Ç–æ–∫: ${guessGame.attempts} | –û—Å—Ç–∞–ª–æ—Å—å —á–∏—Å–µ–ª: ${remaining}`;
            document.getElementById('guessInput').value = '';
        }
        
        function newGuess() {
            const diff = document.getElementById('guessDifficulty').value;
            guessGame.max = parseInt(diff);
            guessGame.number = Math.floor(Math.random() * (guessGame.max - guessGame.min + 1)) + guessGame.min;
            guessGame.attempts = 0;
            guessGame.low = guessGame.min;
            guessGame.high = guessGame.max;
            document.getElementById('guessFeedback').textContent = 'üî• –ù–æ–≤–∞—è –∏–≥—Ä–∞!';
            document.getElementById('guessStats').textContent = '–ü–æ–ø—ã—Ç–æ–∫: 0 | –û—Å—Ç–∞–ª–æ—Å—å —á–∏—Å–µ–ª: ?';
        }
        
        // –õ–ò–î–ï–†–ë–û–†–î–´
        function updateLeaderboards() {
            const games = ['snake', 'guess'];
            const diffs = ['easy', 'medium', 'hard', '1000', '10000', '100000'];
            
            let html = '';
            games.forEach(game => {
                html += `<h4>${game === 'snake' ? 'üêç –ó–º–µ–π–∫–∞' : 'üéØ –£–≥–∞–¥–∞–π–∫–∞'}</h4>`;
                diffs.slice(0, game === 'snake' ? 3 : 3).forEach(diff => {
                    const scores = getTopScores(game, diff, 10);
                    html += `<h5>${getDifficultyName(game, diff)}</h5>`;
                    html += '<table class="leaderboard-table">';
                    html += '<tr><th>–ú–µ—Å—Ç–æ</th><th>–ò–≥—Ä–æ–∫</th><th>–û—á–∫–∏</th><th>–î–∞—Ç–∞</th></tr>';
                    scores.forEach((score, i) => {
                        const rankClass = i < 3 ? `rank-${i+1}` : '';
                        html += `<tr class="${rankClass}">
                            <td>${i+1} ${getMedal(i)}</td>
                            <td>${score.user}</td>
                            <td>${score.score}</td>
                            <td>${new Date(score.date).toLocaleString('ru')}</td>
                        </tr>`;
                    });
                    html += '</table>';
                });
            });
            document.getElementById('snakeLeaderboards').innerHTML = html;
        }
        
        function getTopScores(game, difficulty, limit) {
            const scores = JSON.parse(localStorage.getItem(`${game}_${difficulty}`) || '[]');
            return scores.sort((a,b) => b.score - a.score).slice(0, limit);
        }
        
        // –°–û–•–†–ê–ù–ï–ù–ò–ï –û–ß–ö–û–í
        function saveScore(game, difficulty, score, type) {
            const scores = JSON.parse(localStorage.getItem(`${game}_${difficulty}`) || '[]');
            if(currentUser) {
                scores.unshift({
                    user: currentUser.name,
                    score: score,
                    date: Date.now()
                });
                // –¢–û–ü-10 –¢–û–õ–¨–ö–û
                localStorage.setItem(`${game}_${difficulty}`, 
                    JSON.stringify(scores.slice(0, 10)));
            }
            updateLeaderboards();
        }
        
        // –¢–£–†–ù–ò–†
        function getNextTournamentEnd() {
            const now = new Date();
            now.setHours(24,0,0,0); // 00:00 –ú–°–ö –∑–∞–≤—Ç—Ä–∞
            if(now <= new Date()) now.setDate(now.getDate() + 1);
            return now.getTime();
        }
        
        function joinTournament() {
            isInTournament = true;
            document.getElementById('joinTournamentBtn').textContent = '‚úÖ –í –¢–£–†–ù–ò–†–ï!';
            document.getElementById('joinTournamentBtn').disabled = true;
        }
        
        function updateTournamentTimer() {
            const now = Date.now();
            const timeLeft = tournamentEndTime - now;
            if(timeLeft <= 0) {
                tournamentEndTime = getNextTournamentEnd();
            }
            
            const hours = Math.floor(timeLeft / (1000*60*60));
            const minutes = Math.floor((timeLeft % (1000*60*60)) / (1000*60));
            const seconds = Math.floor((timeLeft % (1000*60)) / 1000);
            document.getElementById('tournamentTimer').textContent = 
                `${hours.toString().padStart(2,'0')}:${minutes.toString().padStart(2,'0')}:${seconds.toString().padStart(2,'0')}`;
        }
        
        function updateTournamentTable() {
            const scores = getTopScores('tournament', 'total', 100);
            let html = '<table class="leaderboard-table">';
            html += '<tr><th>–ú–µ—Å—Ç–æ</th><th>–ò–≥—Ä–æ–∫</th><th>–û—á–∫–∏</th></tr>';
            scores.slice(0,10).forEach((score, i) => {
                const rankClass = i < 3 ? `rank-${i+1}` : '';
                html += `<tr class="${rankClass}">
                    <td>${i+1} ${getMedal(i)}</td>
                    <td>${score.user}</td>
                    <td>${score.score}</td>
                </tr>`;
            });
            html += '</table>';
            document.getElementById('tournamentTable').innerHTML = html;
        }
        
        // –ß–ê–¢
        function sendChat() {
            const message = document.getElementById('chatInput').value.trim();
            if(message && currentUser) {
                const chat = JSON.parse(localStorage.getItem('chat') || '[]');
                chat.unshift({
                    user: currentUser.name,
                    message: message,
                    time: new Date().toLocaleTimeString('ru')
                });
                localStorage.setItem('chat', JSON.stringify(chat.slice(0, 100))); // 100 —Å–æ–æ–±—â–µ–Ω–∏–π
                document.getElementById('chatInput').value = '';
                updateChat();
                playSound(700, 0.1);
            }
        }
        
        function updateChat() {
            const chat = JSON.parse(localStorage.getItem('chat') || '[]');
            document.getElementById('chatMessages').innerHTML = 
                chat.map(msg => 
                    `<div class="chat-message">
                        <strong>${msg.user}</strong> (${msg.time}): ${msg.message}
                    </div>`
                ).join('');
            document.getElementById('chatMessages').scrollTop = 0;
        }
        
        // –£–¢–ò–õ–ò–¢–´
        function updateAll() {
            updateLeaderboards();
            updateTournamentTable();
            updateChat();
        }
        
        function playSound(frequency, duration) {
            const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            oscillator.frequency.value = frequency;
            oscillator.type = 'sine';
            gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + duration);
            oscillator.start(audioCtx.currentTime);
            oscillator.stop(audioCtx.currentTime + duration);
        }
        
        function getMedal(place) {
            return place === 0 ? 'ü•á' : place === 1 ? 'ü•à' : place === 2 ? 'ü•â' : '';
        }
        
        function getDifficultyName(game, diff) {
            const names = {
                snake: { easy: '–õ—ë–≥–∫–∞—è', medium: '–°—Ä–µ–¥–Ω—è—è', hard: '–°–ª–æ–∂–Ω–∞—è' },
                guess: { '1000': '1-1000', '10000': '1-10K', '100000': '1-100K' }
            };
            return names[game][diff];
        }
        
        function createParticles() {
            const particles = document.getElementById('particles');
            for(let i = 0; i < 50; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 6 + 's';
                particle.style.animationDuration = (Math.random() * 3 + 3) + 's';
                particles.appendChild(particle);
            }
        }
        
        function mobileControl(dir) {
            if(!snakeGame) return;
            if(dir === 'up') snakeGame.direction = {x:0,y:-1};
            if(dir === 'down') snakeGame.direction = {x:0,y:1};
            if(dir === 'left') snakeGame.direction = {x:-1,y:0};
            if(dir === 'right') snakeGame.direction = {x:1,y:0};
            if(dir === 'pause') snakeGame.isPaused = !snakeGame.isPaused;
        }
        
        // –°–í–ê–ô–ü–´ (–ú–û–ë–ê–ô–õ)
        let touchStartX = 0, touchStartY = 0;
        document.addEventListener('touchstart', e => {
            touchStartX = e.touches[0].clientX;
            touchStartY = e.touches[0].clientY;
            e.preventDefault();
        });
        document.addEventListener('touchend', e => {
            if(!snakeGame) return;
            const deltaX = e.changedTouches[0].clientX - touchStartX;
            const deltaY = e.changedTouches[0].clientY - touchStartY;
            if(Math.abs(deltaX) > Math.abs(deltaY) && Math.abs(deltaX) > 50) {
                snakeGame.direction = deltaX > 0 ? {x:1,y:0} : {x:-1,y:0};
            } else if(Math.abs(deltaY) > 50) {
                snakeGame.direction = deltaY > 0 ? {x:0,y:1} : {x:0,y:-1};
            }
            e.preventDefault();
        });
    </script>
</body>
</html>
