<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üöÄ ALEKSIN GAMES v5.6.4 ‚úÖ –°–ö–†–û–õ–õ + ANTI-APPLE</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Courier New', monospace; 
            background: linear-gradient(45deg, #0a0a0a, #1a1a2e, #16213e);
            color: #00ff00; min-height: 100vh; overflow-x: hidden;
        }
        .header { 
            text-align: center; padding: 20px; background: rgba(0,0,0,0.8); 
            border-bottom: 3px solid #00ff00; position: sticky; top: 0; z-index: 100;
        }
        .user-info { color: #ffff00; font-size: 18px; }
        .games-grid { 
            display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); 
            gap: 20px; padding: 20px; max-width: 1200px; margin: 0 auto;
        }
        .game-card { 
            background: rgba(0,255,0,0.1); border: 2px solid #00ff00; 
            border-radius: 10px; padding: 20px; text-align: center; cursor: pointer;
            transition: all 0.3s; height: 200px; display: flex; flex-direction: column; justify-content: center;
        }
        .game-card:hover { background: rgba(0,255,0,0.2); transform: scale(1.05); }
        .game-canvas { border: 2px solid #00ff00; border-radius: 5px; background: #000; }
        .leaderboard { 
            background: rgba(0,0,255,0.1); border: 1px solid #0066ff; 
            padding: 10px; margin: 10px 0; max-height: 200px; overflow-y: auto; font-size: 12px;
        }
        .modal { 
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: rgba(0,0,0,0.9); z-index: 200; justify-content: center; align-items: center;
        }
        .modal-content { background: #111; padding: 30px; border: 2px solid #00ff00; border-radius: 10px; }
        button { 
            background: #00ff00; color: #000; border: none; padding: 10px 20px; 
            border-radius: 5px; cursor: pointer; font-weight: bold; margin: 5px;
        }
        button:hover { background: #00cc00; }
        .difficulty { display: flex; gap: 10px; justify-content: center; flex-wrap: wrap; }
        .diff-btn { padding: 5px 15px; font-size: 14px; }
        .score-display { font-size: 24px; font-weight: bold; color: #ffff00; margin: 10px 0; }
    </style>
</head>
<body>
    <div class="header">
        <h1>üöÄ ALEKSIN GAMES v5.6.4 ‚úÖ –°–ö–†–û–õ–õ + ANTI-APPLE</h1>
        <p>üèÜ –õ–ò–î–ï–†–ë–û–†–î–´ ‚öîÔ∏è –¢–£–†–ù–ò–† üí¨ –ß–ê–¢ üêç –ó–ú–ï–ô–ö–ê üéØ –£–ì–ê–î–ê–ô</p>
        <div class="user-info" id="user-info">üëã –ì–æ—Å—Ç—å</div>
        <div style="margin-top: 10px;">
            <button onclick="showAuthModal()">üîê –í—Ö–æ–¥/–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
            <button onclick="logout()" id="logout-btn" style="display:none;">üö™ –í—ã—Ö–æ–¥</button>
        </div>
    </div>

    <div class="games-grid">
        <!-- –ó–º–µ–π–∫–∞ –õ–µ–≥–∫–∞—è -->
        <div class="game-card" onclick="startSnake('easy')">
            <h3>üêç –ó–º–µ–π–∫–∞ –õ—ë–≥–∫–∞—è</h3>
            <div id="leaderboard-snake_easy" class="leaderboard">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
        </div>
        <!-- –ó–º–µ–π–∫–∞ –°—Ä–µ–¥–Ω—è—è -->
        <div class="game-card" onclick="startSnake('medium')">
            <h3>üêç –ó–º–µ–π–∫–∞ –°—Ä–µ–¥–Ω—è—è</h3>
            <div id="leaderboard-snake_medium" class="leaderboard">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
        </div>
        <!-- –ó–º–µ–π–∫–∞ –°–ª–æ–∂–Ω–∞—è -->
        <div class="game-card" onclick="startSnake('hard')">
            <h3>üêç –ó–º–µ–π–∫–∞ –°–ª–æ–∂–Ω–∞—è</h3>
            <div id="leaderboard-snake_hard" class="leaderboard">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
        </div>
        <!-- –£–≥–∞–¥–∞–π–∫–∞ –õ–µ–≥–∫–∞—è -->
        <div class="game-card" onclick="startGuess('easy')">
            <h3>üéØ –£–≥–∞–¥–∞–π–∫–∞ –õ—ë–≥–∫–∞—è</h3>
            <div id="leaderboard-guess_easy" class="leaderboard">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
        </div>
        <!-- –£–≥–∞–¥–∞–π–∫–∞ –°—Ä–µ–¥–Ω—è—è -->
        <div class="game-card" onclick="startGuess('medium')">
            <h3>üéØ –£–≥–∞–¥–∞–π–∫–∞ –°—Ä–µ–¥–Ω—è—è</h3>
            <div id="leaderboard-guess_medium" class="leaderboard">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
        </div>
        <!-- –£–≥–∞–¥–∞–π–∫–∞ –°–ª–æ–∂–Ω–∞—è -->
        <div class="game-card" onclick="startGuess('hard')">
            <h3>üéØ –£–≥–∞–¥–∞–π–∫–∞ –°–ª–æ–∂–Ω–∞—è</h3>
            <div id="leaderboard-guess_hard" class="leaderboard">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ê–í–¢–û–†–ò–ó–ê–¶–ò–ò -->
    <div id="auth-modal" class="modal">
        <div class="modal-content">
            <h2>üîê –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è</h2>
            <input type="text" id="auth-username" placeholder="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" style="width:100%;padding:10px;margin:10px 0;">
            <input type="password" id="auth-password" placeholder="–ü–∞—Ä–æ–ª—å" style="width:100%;padding:10px;margin:10px 0;">
            <button onclick="registerUser()">üìù –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
            <button onclick="loginUser()">üöÄ –í–æ–π—Ç–∏</button>
            <button onclick="closeAuthModal()">‚ùå –ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>

    <!-- –ò–ì–†–û–í–û–ô –ú–û–î–ê–õ–¨ -->
    <div id="game-modal" class="modal">
        <div class="modal-content" style="width:90%;max-width:600px;height:80%;">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;">
                <h2 id="game-title"></h2>
                <div>
                    <button class="diff-btn" onclick="changeDifficulty('easy')">–õ</button>
                    <button class="diff-btn" onclick="changeDifficulty('medium')">–°</button>
                    <button class="diff-btn" onclick="changeDifficulty('hard')">–°</button>
                    <span id="current-diff">–õ–µ–≥–∫–∞—è</span>
                </div>
            </div>
            <div class="score-display" id="score-display">–°—á—ë—Ç: 0</div>
            <canvas id="game-canvas" class="game-canvas" width="500" height="400"></canvas>
            <div style="margin-top:10px;text-align:center;">
                <button onclick="restartGame()">üîÑ –ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
                <button onclick="closeGameModal()">‚ùå –í—ã—Ö–æ–¥</button>
            </div>
            <div id="game-leaderboard" class="leaderboard">–¢–æ–ø-10 –∏–≥—Ä–æ–∫–æ–≤...</div>
        </div>
    </div>

    <script>
        // ‚úÖ –ì–õ–ê–í–ù–´–ô –§–ò–ö–° –ö–ò–†–ò–õ–õ–ò–¶–´ - —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ª—é–±—ã–º–∏ –∏–º–µ–Ω–∞–º–∏!
        function toLatin(str) {
            const map = {
                '–∞':'a','–±':'b','–≤':'v','–≥':'g','–¥':'d','–µ':'e','—ë':'e','–∂':'zh','–∑':'z','–∏':'i','–π':'y',
                '–∫':'k','–ª':'l','–º':'m','–Ω':'n','–æ':'o','–ø':'p','—Ä':'r','—Å':'s','—Ç':'t','—É':'u','—Ñ':'f',
                '—Ö':'h','—Ü':'c','—á':'ch','—à':'sh','—â':'sch','—ä':'','—ã':'y','—å':'','—ç':'e','—é':'yu','—è':'ya',
                '–ê':'A','–ë':'B','–í':'V','–ì':'G','–î':'D','–ï':'E','–Å':'E','–ñ':'Zh','–ó':'Z','–ò':'I','–ô':'Y',
                '–ö':'K','–õ':'L','–ú':'M','–ù':'N','–û':'O','–ü':'P','–†':'R','–°':'S','–¢':'T','–£':'U','–§':'F',
                '–•':'H','–¶':'C','–ß':'Ch','–®':'Sh','–©':'Sch','–™':'','–´':'Y','–¨':'','–≠':'E','–Æ':'Yu','–Ø':'Ya'
            };
            return str.split('').map(c => map[c] || c).join('').toLowerCase();
        }

        // ‚úÖ –£–ù–ò–í–ï–†–°–ê–õ–¨–ù–ê–Ø –û–¢–ü–†–ê–í–ö–ê –°–ö–û–†
        async function saveScore(game, diff, score) {
            const username = toLatin(document.getElementById('user-info').textContent.replace('üëã ', '') || 'guest');
            try {
                await fetch('/leaderboard', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'username': username },
                    body: JSON.stringify({game: game, diff: diff, score: score, timestamp: Date.now()})
                });
            } catch(e) { console.log('Save score:', e); }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –ª–∏–¥–µ—Ä–±–æ—Ä–¥–æ–≤
        async function loadLeaderboard(game, diff) {
            try {
                const res = await fetch(`/leaderboard/${game}/${diff}`);
                const scores = await res.json();
                const lb = document.getElementById(`leaderboard-${game}_${diff.replace('medium','medium').replace('hard','hard')}`);
                if (lb) {
                    lb.innerHTML = scores.map((s,i) => `${i+1}. ${s.name}: ${s.score}`).join('<br>') || '–ü–æ–∫–∞ –ø—É—Å—Ç–æ...';
                }
            } catch(e) {}
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        async function init() {
            // –ó–∞–≥—Ä—É–∑–∏—Ç—å –≤—Å–µ –ª–∏–¥–µ—Ä–±–æ—Ä–¥—ã
            const games = ['snake_easy','snake_medium','snake_hard','guess_easy','guess_medium','guess_hard'];
            games.forEach(g => {
                const [game,diff] = g.split('_');
                loadLeaderboard(game, diff);
            });
            setInterval(() => games.forEach(g => {
                const [game,diff] = g.split('_');
                loadLeaderboard(game, diff);
            }), 30000);

            // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–µ—Å—Å–∏—é
            const res = await fetch('/leaderboard/ping');
            const user = await res.json();
            if (user.username) {
                document.getElementById('user-info').textContent = `üëã ${user.username}`;
                document.getElementById('logout-btn').style.display = 'inline';
            }
        }

        // –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø
        function showAuthModal() { document.getElementById('auth-modal').style.display = 'flex'; }
        function closeAuthModal() { document.getElementById('auth-modal').style.display = 'none'; }
        
        async function registerUser() {
            const username = document.getElementById('auth-username').value;
            const password = document.getElementById('auth-password').value;
            await fetch('/register', { method: 'POST', body: new FormData({username, password}) });
            location.reload();
        }
        
        async function loginUser() {
            const username = document.getElementById('auth-username').value;
            const password = document.getElementById('auth-password').value;
            await fetch('/login', { method: 'POST', body: new FormData({username, password}) });
            location.reload();
        }
        
        function logout() { fetch('/logout'); location.reload(); }

        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–≥—Ä—ã
        let currentGame = '', currentDiff = 'easy', gameScore = 0, gameCanvas, gameCtx;

        function startSnake(diff) {
            currentGame = 'snake'; currentDiff = diff;
            document.getElementById('game-title').textContent = `üêç –ó–º–µ–π–∫–∞ ${diff==='easy'?'–õ—ë–≥–∫–∞—è':diff==='medium'?'–°—Ä–µ–¥–Ω—è—è':'–°–ª–æ–∂–Ω–∞—è'}`;
            document.getElementById('current-diff').textContent = diff==='easy'?'–õ–µ–≥–∫–∞—è':diff==='medium'?'–°—Ä–µ–¥–Ω—è—è':'–°–ª–æ–∂–Ω–∞—è';
            showGameModal();
            initSnake();
        }

        function startGuess(diff) {
            currentGame = 'guess'; currentDiff = diff;
            document.getElementById('game-title').textContent = `üéØ –£–≥–∞–¥–∞–π–∫–∞ ${diff==='easy'?'–õ—ë–≥–∫–∞—è':diff==='medium'?'–°—Ä–µ–¥–Ω—è—è':'–°–ª–æ–∂–Ω–∞—è'}`;
            document.getElementById('current-diff').textContent = diff==='easy'?'–õ–µ–≥–∫–∞—è':diff==='medium'?'–°—Ä–µ–¥–Ω—è—è':'–°–ª–æ–∂–Ω–∞—è';
            showGameModal();
            initGuess();
        }

        function showGameModal() { 
            document.getElementById('game-modal').style.display = 'flex'; 
            gameCanvas = document.getElementById('game-canvas');
            gameCtx = gameCanvas.getContext('2d');
        }
        function closeGameModal() { document.getElementById('game-modal').style.display = 'none'; }
        function restartGame() { if (currentGame==='snake') initSnake(); else initGuess(); }
        function changeDifficulty(diff) { currentDiff = diff; restartGame(); }

        // üêç –ó–ú–ï–ô–ö–ê
        let snake = [{x:10,y:10}], dx=1, dy=0, foodX, foodY, snakeSpeed = currentDiff==='easy'?8:currentDiff==='medium'?12:16;
        function initSnake() {
            snake = [{x:10,y:10}]; dx=1; dy=0; gameScore = 0;
            placeFood(); gameLoopSnake();
            loadLeaderboard('snake', currentDiff);
        }
        
        function placeFood() {
            foodX = Math.floor(Math.random()*47)+1;
            foodY = Math.floor(Math.random()*37)+1;
        }
        
        function gameLoopSnake() {
            setTimeout(() => {
                gameCtx.fillStyle = '#000'; gameCtx.fillRect(0,0,500,400);
                
                // –î–≤–∏–∂–µ–Ω–∏–µ –∑–º–µ–π–∫–∏
                const head = {x:snake[0].x+dx, y:snake[0].y+dy};
                if (head.x<1 || head.x>47 || head.y<1 || head.y>37 || snake.some(s=>s.x===head.x && s.y===head.y)) {
                    saveScore('snake_'+currentDiff, currentDiff, gameScore);
                    alert(`–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞! –°—á—ë—Ç: ${gameScore}`);
                    loadLeaderboard('snake', currentDiff);
                    return;
                }
                snake.unshift(head);
                
                // –ï–¥–∞
                if (head.x === foodX && head.y === foodY) {
                    gameScore += 10;
                    placeFood();
                } else snake.pop();
                
                // –û—Ç—Ä–∏—Å–æ–≤–∫–∞
                gameCtx.fillStyle = '#00ff00'; snake.forEach(s => gameCtx.fillRect(s.x*10, s.y*10, 10, 10));
                gameCtx.fillStyle = '#ff0000'; gameCtx.fillRect(foodX*10, foodY*10, 10, 10);
                
                document.getElementById('score-display').textContent = `–°—á—ë—Ç: ${gameScore}`;
                document.getElementById('user-info').textContent = `üëã ${document.getElementById('user-info').textContent.replace('üëã ', '')}`;
                
                if (document.getElementById('game-modal').style.display === 'flex') gameLoopSnake();
            }, 1000/snakeSpeed);
        }

        // üéØ –£–ì–ê–î–ê–ô–ö–ê
        let guessNumber, guessAttempts = 0, guessMax = currentDiff==='easy'?10:currentDiff==='medium'?100:1000;
        function initGuess() {
            guessNumber = Math.floor(Math.random()*(guessMax+1));
            guessAttempts = 0; gameScore = 0;
            document.getElementById('score-display').textContent = `–£–≥–∞–¥–∞–π—Ç–µ —á–∏—Å–ª–æ –æ—Ç 0 –¥–æ ${guessMax}`;
            loadLeaderboard('guess', currentDiff);
        }
        
        function gameLoopGuess() {
            const guess = prompt(`–ü–æ–ø—ã—Ç–∫–∞ ${guessAttempts+1}. –£–≥–∞–¥–∞–π—Ç–µ —á–∏—Å–ª–æ –æ—Ç 0 –¥–æ ${guessMax}:`);
            if (guess === null) {
                saveScore('guess_'+currentDiff, currentDiff, gameScore);
                alert(`–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞! –ë—ã–ª–æ –∑–∞–≥–∞–¥–∞–Ω–Ω–æ: ${guessNumber}`);
                return;
            }
            guessAttempts++;
            const num = parseInt(guess);
            if (num === guessNumber) {
                gameScore = Math.max(0, 1000 - guessAttempts*50);
                saveScore('guess_'+currentDiff, currentDiff, gameScore);
                alert(`‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û! –ü–æ–ø—ã—Ç–æ–∫: ${guessAttempts}. –°—á—ë—Ç: ${gameScore}`);
                loadLeaderboard('guess', currentDiff);
            } else {
                alert(num < guessNumber ? 'üìà –ë–æ–ª—å—à–µ!' : 'üìâ –ú–µ–Ω—å—à–µ!');
                gameLoopGuess();
            }
        }

        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–º–µ–π–∫–æ–π
        document.addEventListener('keydown', e => {
            if (!document.getElementById('game-modal').style.display === 'flex') return;
            if (currentGame !== 'snake') return;
            if (e.key==='ArrowUp' && dy!==1) {dx=0;dy=-1;}
            if (e.key==='ArrowDown' && dy!==-1) {dx=0;dy=1;}
            if (e.key==='ArrowLeft' && dx!==1) {dx=-1;dy=0;}
            if (e.key==='ArrowRight' && dx!==-1) {dx=1;dy=0;}
        });

        // –ó–∞–ø—É—Å–∫
        init();
    </script>
</body>
</html>
