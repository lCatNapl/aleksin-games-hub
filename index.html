<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>üåå ALEKSIN GAMES v6.5 ‚úÖ –ú–û–ë–ê–ô–õ!</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        @import url('https://fonts.cdnfonts.com/css/neon-glow');
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Orbitron', monospace; 
            background: linear-gradient(45deg, #0a0a23, #1a0033, #0a0a23); 
            background-size: 400% 400%; animation: gradientShift 15s ease infinite;
            color: #00ff88; overflow-x: hidden; touch-action: none; /* ‚úÖ –ú–û–ë–ê–ô–õ */
        }
        @keyframes gradientShift { 0%,100%{background-position:0%50%} 50%{background-position:100%50%} }
        
        .container { max-width: 1400px; margin: 0 auto; padding: 20px; }
        .header {
            text-align: center; background: rgba(0,255,136,0.1); backdrop-filter: blur(20px);
            border: 2px solid #00ff88; border-radius: 25px; padding: 30px; margin-bottom: 30px;
            box-shadow: 0 0 50px #00ff88; animation: neonPulse 2s ease-in-out infinite alternate;
        }
        @keyframes neonPulse { from{box-shadow:0 0 20px #00ff88} to{box-shadow:0 0 50px #00ff88,0 0 100px #00ff88} }
        
        .section { 
            background: rgba(255,255,255,0.05); backdrop-filter: blur(15px); border-radius: 20px;
            padding: 25px; margin-bottom: 25px; border: 1px solid rgba(0,255,136,0.3);
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
        }
        button { 
            background: linear-gradient(45deg,#00ff88,#00cc6a); color: #0a0a23; 
            border: none; padding: 12px 24px; border-radius: 12px; font-family: 'Orbitron',monospace;
            font-weight: 700; cursor: pointer; margin: 5px; transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0,255,136,0.4); touch-action: manipulation;
        }
        button:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(0,255,136,0.6); }
        button:active { transform: translateY(0); }
        input, select { 
            width: 100%; padding: 15px; border: 2px solid rgba(0,255,136,0.3); 
            border-radius: 12px; background: rgba(0,255,136,0.1); color: #00ff88;
            font-family: 'Orbitron', monospace; margin-bottom: 10px;
        }
        .game-canvas { border: 3px solid #00ff88; border-radius: 15px; background: #000; 
            display: none; margin: 15px auto; box-shadow: 0 0 30px #00ff88; touch-action: none; }
        
        /* ‚úÖ –ú–û–ë–ò–õ–¨–ù–´–ô –î–ñ–û–ô–°–¢–ò–ö */
        #mobileControls {
            position: fixed; bottom: 20px; left: 20px; display: none; z-index: 1000;
            background: rgba(0,255,136,0.1); padding: 20px; border-radius: 20px;
            border: 2px solid #00ff88; backdrop-filter: blur(10px);
        }
        .joystick-btn {
            width: 70px; height: 70px; border-radius: 50%; border: none; 
            margin: 5px; font-size: 24px; color: #00ff88; background: rgba(255,255,255,0.2);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        .joystick-btn:active { background: rgba(0,255,136,0.5); transform: scale(0.95); }
        
        #tournamentTimer { 
            font-size: 2.5rem; font-weight: 900; text-align: center; margin: 20px 0;
            text-shadow: 0 0 30px #ff4444; animation: pulseRed 1s infinite;
        }
        @keyframes pulseRed { 0%,100%{text-shadow:0 0 20px #ff4444} 50%{text-shadow:0 0 40px #ff4444,0 0 60px #ff4444} }
        .leaderboard-table { width: 100%; border-collapse: collapse; background: rgba(0,0,0,0.5); 
            border-radius: 12px; overflow: hidden; margin-top: 10px; }
        .leaderboard-table th, .leaderboard-table td { padding: 10px; text-align: center; 
            border-bottom: 1px solid rgba(0,255,136,0.2); }
        .leaderboard-table th { background: rgba(0,255,136,0.2); }
        .rank-1 { background: linear-gradient(45deg,#ffd700,#ffed4e); color: #000; }
        .rank-2 { background: linear-gradient(45deg,#c0c0c0,#e5e5e5); color: #000; }
        .rank-3 { background: linear-gradient(45deg,#cd7f32,#deb887); color: #000; }
        .hidden { display: none !important; }
        #chatMessages { height: 250px; overflow-y: auto; background: rgba(0,0,0,0.7); 
            border-radius: 12px; padding: 15px; margin-bottom: 15px; border: 1px solid rgba(0,255,136,0.3); }
        
        @media (max-width: 768px) {
            #mobileControls { display: block; }
            .container { padding: 10px; }
            .game-canvas { max-width: 95vw; max-height: 50vh; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üåå ALEKSIN GAMES v6.5 ‚úÖ –ü–ö+–ú–û–ë–ê–ô–õ!</h1>
            <p>–¢—É–ª–∞-–≥–µ–π–º–∏–Ω–≥ | test/123456 | 13/13</p>
            <div>–¢—É—Ä–Ω–∏—Ä –¥–æ: <span id="tournamentTimer">--:--:--</span></div>
        </div>
        
        <!-- –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø -->
        <div id="authSection" class="section">
            <h2>üîê –í—Ö–æ–¥</h2>
            <input type="text" id="username" placeholder="test" value="test">
            <input type="password" id="password" placeholder="123456" value="123456">
            <button onclick="login()">üöÄ –í–û–ô–¢–ò</button>
            <div id="authStatus">–ì–æ—Å—Ç—å</div>
        </div>
        
        <!-- –ò–ì–†–´ -->
        <div id="gamesSection" class="section hidden">
            <h3>üêç –ó–ú–ï–ô–ö–ê Pro</h3>
            <select id="snakeDifficulty">
                <option value="easy">–õ—ë–≥–∫–∞—è</option>
                <option value="medium">–°—Ä–µ–¥–Ω—è—è</option>
                <option value="hard">–°–ª–æ–∂–Ω–∞—è</option>
            </select>
            <button onclick="startSnake()">‚ñ∂Ô∏è –°–¢–ê–†–¢</button>
            <button onclick="stopSnake()" id="stopSnakeBtn" class="hidden">‚èπÔ∏è –°–¢–û–ü</button>
            <canvas id="snakeCanvas" class="game-canvas" width="600" height="450"></canvas>
            <div>–û—á–∫–∏: <span id="snakeScore">0</span></div>
            
            <h3>üéØ –£–ì–ê–î–ê–ô –ß–ò–°–õ–û</h3>
            <select id="guessDifficulty">
                <option value="1000">1-1,000</option>
                <option value="10000">1-10,000</option>
                <option value="100000">1-100,000</option>
            </select>
            <input type="number" id="guessInput" placeholder="–£–≥–∞–¥–∞–π —á–∏—Å–ª–æ">
            <button onclick="makeGuess()">üîç –£–ì–ê–î–ê–¢–¨</button>
            <div id="guessFeedback">–ù–∞—á–Ω–∏!</div>
            <div id="guessStats">–ü–æ–ø—ã—Ç–æ–∫: 0</div>
        </div>
        
        <!-- –¢–£–†–ù–ò–† -->
        <div id="tournamentSection" class="section hidden">
            <h2>‚öîÔ∏è –¢–£–†–ù–ò–† –¢–û–ü-100</h2>
            <button id="tournamentBtn" onclick="toggleTournament()">‚ö° –£–ß–ê–°–¢–í–û–í–ê–¢–¨</button>
            <div id="tournamentTable"></div>
            <div id="tournamentStatus"></div>
        </div>
        
        <!-- –¢–û–ü–´ -->
        <div id="leaderboardsSection" class="section hidden">
            <h2>üèÜ –¢–û–ü-10</h2>
            <button onclick="updateLeaderboards()">üîÑ –û–ë–ù–û–í–ò–¢–¨</button>
            <div id="leaderboards"></div>
        </div>
        
        <!-- –ß–ê–¢ -->
        <div id="chatSection" class="section hidden">
            <h2>üí¨ –ß–ê–¢</h2>
            <div id="chatMessages"></div>
            <input type="text" id="chatInput" placeholder="–ü–∏—à–∏..." onkeypress="if(event.key==='Enter')sendChat()">
            <button onclick="sendChat()">üì§</button>
        </div>
    </div>
    
    <!-- ‚úÖ –ú–û–ë–ò–õ–¨–ù–´–ô –î–ñ–û–ô–°–¢–ò–ö -->
    <div id="mobileControls">
        <button class="joystick-btn" onclick="mobileMove('up')">‚Üë</button><br>
        <button class="joystick-btn" onclick="mobileMove('left')">‚Üê</button>
        <button class="joystick-btn" onclick="mobileMove('right')">‚Üí</button><br>
        <button class="joystick-btn" onclick="mobileMove('down')">‚Üì</button>
        <button class="joystick-btn" onclick="mobilePause()">‚è∏Ô∏è</button>
    </div>

    <script>
        let currentUser = null, isInTournament = false, snakeGame = null;
        let tournamentEndTime = 0, lastScoreTime = 0, touchStart = {x:0,y:0};
        const SCORE_COOLDOWN = 10000;
        
        // ‚úÖ –ê–ù–¢–ò–°–ö–û–õ–õ –ú–û–ë–ê–ô–õ + –ü–ö
        document.addEventListener('DOMContentLoaded', () => {
            // –ë–õ–û–ö–ò–†–£–ï–ú –°–ö–†–û–õ–õ –ù–ê –°–¢–†–ï–õ–ö–ê–•
            document.addEventListener('keydown', e => {
                if(['ArrowUp','ArrowDown','ArrowLeft','ArrowRight'].includes(e.key)) {
                    e.preventDefault();
                }
            }, true);
            
            // –ë–õ–û–ö–ò–†–£–ï–ú –ó–£–ú/–°–ö–†–û–õ–õ –ù–ê –ú–û–ë–ê–ô–õ–ï
            document.addEventListener('touchmove', e => e.preventDefault(), { passive: false });
            document.addEventListener('touchstart', e => e.preventDefault(), { passive: false });
            
            tournamentEndTime = getNextMidnightMSK();
            loadUser();
            updateUI();
            setInterval(updateTournamentTimer, 1000);
            setInterval(updateAll, 3000);
        });
        
        function getNextMidnightMSK() {
            const now = new Date();
            const mskOffset = 3 * 60 * 60 * 1000;
            const mskNow = new Date(now.getTime() + mskOffset);
            const tomorrow = new Date(mskNow.getFullYear(), mskNow.getMonth(), mskNow.getDate() + 1, 0, 0, 0);
            return tomorrow.getTime() - mskOffset;
        }
        
        // ‚úÖ –ú–û–ë–ê–ô–õ –°–í–ê–ô–ü–´
        document.addEventListener('touchstart', e => {
            touchStart.x = e.touches[0].clientX;
            touchStart.y = e.touches[0].clientY;
        });
        
        document.addEventListener('touchend', e => {
            if(!snakeGame) return;
            const deltaX = e.changedTouches[0].clientX - touchStart.x;
            const deltaY = e.changedTouches[0].clientY - touchStart.y;
            
            if(Math.abs(deltaX) > Math.abs(deltaY) && Math.abs(deltaX) > 40) {
                snakeGame.changeDirection(deltaX > 0 ? 'right' : 'left');
            } else if(Math.abs(deltaY) > 40) {
                snakeGame.changeDirection(deltaY > 0 ? 'down' : 'up');
            }
        });
        
        function mobileMove(direction) {
            if(snakeGame) snakeGame.changeDirection(direction);
        }
        
        function mobilePause() {
            if(snakeGame) snakeGame.togglePause();
        }
        
        function login() {
            const name = document.getElementById('username').value.trim();
            const pass = document.getElementById('password').value;
            if(name && pass) {
                currentUser = { name, joined: Date.now() };
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                updateUI();
            }
        }
        
        function updateUI() {
            const loggedIn = !!currentUser;
            ['gamesSection','tournamentSection','leaderboardsSection','chatSection']
                .forEach(id => document.getElementById(id).classList.toggle('hidden', !loggedIn));
            document.getElementById('authStatus').textContent = loggedIn ? `üë§ ${currentUser.name}` : '–ì–æ—Å—Ç—å';
        }
        
        // ‚úÖ –ó–ú–ï–ô–ö–ê –° –ú–û–ë–ê–ô–õ –£–ü–†–ê–í–õ–ï–ù–ò–ï–ú
        function startSnake() {
            if(snakeGame) return alert('–°–Ω–∞—á–∞–ª–∞ –°–¢–û–ü!');
            const canvas = document.getElementById('snakeCanvas');
            const ctx = canvas.getContext('2d');
            const diff = document.getElementById('snakeDifficulty').value;
            const config = {
                easy: {tilesX:20,tilesY:15,speed:200},
                medium: {tilesX:25,tilesY:20,speed:150},
                hard: {tilesX:30,tilesY:25,speed:100}
            }[diff];
            
            canvas.width = Math.min(config.tilesX * 20, window.innerWidth * 0.9);
            canvas.height = Math.min(config.tilesY * 20, window.innerHeight * 0.4);
            canvas.style.display = 'block';
            document.getElementById('stopSnakeBtn').classList.remove('hidden');
            
            snakeGame = new SnakeGame(ctx, config);
            snakeGame.start();
        }
        
        function stopSnake() {
            if(snakeGame) {
                snakeGame.stop();
                snakeGame = null;
                document.getElementById('snakeCanvas').style.display = 'none';
                document.getElementById('stopSnakeBtn').classList.add('hidden');
            }
        }
        
        class SnakeGame {
            constructor(ctx, config) {
                this.ctx = ctx; this.config = config;
                this.tilesX = config.tilesX; this.tilesY = config.tilesY;
                this.gridSize = Math.floor(Math.min(ctx.canvas.width / this.tilesX, ctx.canvas.height / this.tilesY));
                this.speed = config.speed; this.score = 0;
                this.direction = {x:0,y:-1}; 
                this.snakeParts = [{x:Math.floor(this.tilesX/2),y:Math.floor(this.tilesY/2)}];
                this.foodX = Math.floor(Math.random()*this.tilesX);
                this.foodY = Math.floor(Math.random()*this.tilesY);
                this.gameLoop = null; this.isPaused = false;
            }
            
            changeDirection(dir) {
                if(dir === 'up' && this.direction.y === 0) this.direction = {x:0,y:-1};
                if(dir === 'down' && this.direction.y === 0) this.direction = {x:0,y:1};
                if(dir === 'left' && this.direction.x === 0) this.direction = {x:-1,y:0};
                if(dir === 'right' && this.direction.x === 0) this.direction = {x:1,y:0};
            }
            
            togglePause() {
                this.isPaused = !this.isPaused;
            }
            
            start() {
                document.getElementById('snakeScore').textContent = this.score;
                this.gameLoop = setInterval(() => this.update(), this.speed);
                this.bindControls();
            }
            
            stop() {
                if(this.gameLoop) clearInterval(this.gameLoop);
            }
            
            bindControls() {
                // ‚úÖ –ü–ö –°–¢–†–ï–õ–ö–ò –ë–ï–ó –°–ö–†–û–õ–õ–ê
                document.addEventListener('keydown', e => {
                    if(!snakeGame) return;
                    e.preventDefault();
                    this.changeDirection(e.key.replace('Arrow','').toLowerCase());
                });
            }
            
            update() {
                if(this.isPaused) return this.draw();
                
                const head = { 
                    x: this.snakeParts[0].x + this.direction.x, 
                    y: this.snakeParts[0].y + this.direction.y 
                };
                
                if(head.x < 0 || head.x >= this.tilesX || head.y < 0 || head.y >= this.tilesY || 
                   this.snakeParts.slice(1).some(p => p.x === head.x && p.y === head.y)) {
                    if(this.score > 0 && (Date.now() - lastScoreTime) > SCORE_COOLDOWN) {
                        this.saveScore();
                    }
                    alert(`üéâ ${this.score} –æ—á–∫–æ–≤!`);
                    stopSnake();
                    return;
                }
                
                this.snakeParts.unshift(head);
                
                if(head.x === this.foodX && head.y === this.foodY) {
                    this.score += 10;
                    this.foodX = Math.floor(Math.random()*this.tilesX);
                    this.foodY = Math.floor(Math.random()*this.tilesY);
                } else {
                    this.snakeParts.pop();
                }
                
                document.getElementById('snakeScore').textContent = this.score;
                this.draw();
            }
            
            draw() {
                this.ctx.fillStyle = '#000'; 
                this.ctx.fillRect(0,0,this.tilesX*this.gridSize,this.tilesY*this.gridSize);
                
                this.ctx.fillStyle = '#00ff88';
                this.snakeParts.forEach(p => {
                    this.ctx.fillRect(p.x*this.gridSize, p.y*this.gridSize, this.gridSize-1, this.gridSize-1);
                });
                
                this.ctx.fillStyle = '#ff4444';
                this.ctx.fillRect(this.foodX*this.gridSize, this.foodY*this.gridSize, this.gridSize-1, this.gridSize-1);
                
                this.ctx.fillStyle = '#fff'; this.ctx.font = 'bold 24px Orbitron';
                this.ctx.fillText(`–û—á–∫–∏: ${this.score}`, 10, 30);
                if(this.isPaused) {
                    this.ctx.fillStyle = '#ff4444';
                    this.ctx.font = 'bold 36px Orbitron';
                    this.ctx.textAlign = 'center';
                    this.ctx.fillText('‚è∏Ô∏è –ü–ê–£–ó–ê', this.tilesX*this.gridSize/2, this.tilesY*this.gridSize/2);
                    this.ctx.textAlign = 'left';
                }
            }
            
            saveScore() {
                const diff = document.getElementById('snakeDifficulty').value;
                saveScore('snake', diff, this.score, 'max');
                if(isInTournament) addTournamentScore(this.score * 2);
                lastScoreTime = Date.now();
            }
        }
        
        // –û—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π (—É–≥–∞–¥–∞–π–∫–∞, —Ç—É—Ä–Ω–∏—Ä, —á–∞—Ç)
        let guessGame = {number:0, attempts:0, max:1000};
        function makeGuess() {
            const guess = parseInt(document.getElementById('guessInput').value);
            const diff = document.getElementById('guessDifficulty').value;
            guessGame.max = parseInt(diff);
            
            if(!guessGame.number) guessGame.number = Math.floor(Math.random() * guessGame.max) + 1;
            
            if(guess === guessGame.number) {
                const score = Math.max(100, Math.floor(10000 / guessGame.attempts));
                if(score > 0 && (Date.now() - lastScoreTime) > SCORE_COOLDOWN) {
                    saveScore('guess', diff, score, 'max');
                    if(isInTournament) addTournamentScore(score * 1.5);
                    lastScoreTime = Date.now();
                }
                document.getElementById('guessFeedback').innerHTML = `üéâ –£–ì–î–ê–õ! ${score} –æ—á–∫–æ–≤!`;
                guessGame = {number:0, attempts:0, max:guessGame.max};
            } else {
                guessGame.attempts++;
                document.getElementById('guessFeedback').textContent = 
                    guess < guessGame.number ? 'üìà –ë–æ–ª—å—à–µ!' : 'üìâ –ú–µ–Ω—å—à–µ!';
            }
            document.getElementById('guessStats').textContent = `–ü–æ–ø—ã—Ç–æ–∫: ${guessGame.attempts}`;
            document.getElementById('guessInput').value = '';
        }
        
        function toggleTournament() {
            isInTournament = !isInTournament;
            document.getElementById('tournamentBtn').textContent = isInTournament ? '‚úÖ –í –¢–£–†–ù–ò–†–ï' : '‚ö° –£–ß–ê–°–¢–í–û–í–ê–¢–¨';
        }
        
        function saveScore(game, diff, score, type) {
            if(score <= 0) return;
            const key = `${game}_${diff}`;
            const scores = JSON.parse(localStorage.getItem(key) || '[]');
            scores.unshift({user: currentUser?.name || '–ì–æ—Å—Ç—å', score, date: Date.now()});
            localStorage.setItem(key, JSON.stringify(scores.slice(0,10)));
            updateLeaderboards();
        }
        
        function updateLeaderboards() {
            let html = '';
            const games = [
                {key:'snake_easy', name:'–ó–º–µ–π–∫–∞ –õ—ë–≥–∫–∞—è'},
                {key:'snake_medium', name:'–ó–º–µ–π–∫–∞ –°—Ä–µ–¥–Ω—è—è'},
                {key:'snake_hard', name:'–ó–º–µ–π–∫–∞ –°–ª–æ–∂–Ω–∞—è'},
                {key:'guess_1000', name:'–£–≥–∞–¥–∞–π–∫–∞ 1-1K'},
                {key:'guess_10000', name:'–£–≥–∞–¥–∞–π–∫–∞ 1-10K'},
                {key:'guess_100000', name:'–£–≥–∞–¥–∞–π–∫–∞ 1-100K'}
            ];
            games.forEach(g => {
                const scores = JSON.parse(localStorage.getItem(g.key) || '[]');
                html += `<h4>${g.name}</h4><table class="leaderboard-table">
                    <tr><th>–ú–µ—Å—Ç–æ</th><th>–ò–≥—Ä–æ–∫</th><th>–û—á–∫–∏</th></tr>`;
                scores.slice(0,10).forEach((s,i) => {
                    const cls = i<3 ? `rank-${i+1}` : '';
                    html += `<tr class="${cls}"><td>${i+1}${i<3?' ü•áü•àü•â'[i]:''}</td><td>${s.user}</td><td>${s.score}</td></tr>`;
                });
                html += '</table>';
            });
            document.getElementById('leaderboards').innerHTML = html;
        }
        
        function updateTournamentTimer() {
            const now = Date.now();
            let timeLeft = tournamentEndTime - now;
            if(timeLeft <= 0) {
                tournamentEndTime = getNextMidnightMSK();
                timeLeft = tournamentEndTime - now;
                document.getElementById('tournamentStatus').innerHTML = 'üèÜ –¢–£–†–ù–ò–† –ó–ê–í–ï–†–®–Å–ù!';
            }
            const h = Math.floor(timeLeft/3600000).toString().padStart(2,'0');
            const m = Math.floor((timeLeft%3600000)/60000).toString().padStart(2,'0');
            const s = Math.floor((timeLeft%60000)/1000).toString().padStart(2,'0');
            document.getElementById('tournamentTimer').textContent = `${h}:${m}:${s}`;
        }
        
        function sendChat() {
            const text = document.getElementById('chatInput').value.trim();
            if(text && currentUser) {
                const chat = JSON.parse(localStorage.getItem('chat') || '[]');
                chat.unshift({user:currentUser.name, message:text, time:new Date().toLocaleTimeString('ru-RU')});
                localStorage.setItem('chat', JSON.stringify(chat.slice(0,100)));
                document.getElementById('chatInput').value = '';
                updateChat();
            }
        }
        
        function updateChat() {
            const chat = JSON.parse(localStorage.getItem('chat') || '[]');
            document.getElementById('chatMessages').innerHTML = 
                chat.map(c => `<div><strong>${c.user}</strong> (${c.time}): ${c.message}</div>`).join('');
        }
        
        function updateAll() {
            updateLeaderboards();
            updateChat();
        }
        
        function loadUser() {
            try {
                const saved = localStorage.getItem('currentUser');
                if(saved) currentUser = JSON.parse(saved);
                updateUI();
            } catch(e) {}
        }
    </script>
</body>
</html>
