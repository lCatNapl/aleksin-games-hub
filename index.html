<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üöÄ ALEKSIN GAMES v8.0.0 - –ö–ò–ë–ï–† –ê–†–ï–ù–ê</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Roboto+Mono:wght@300;400;700&display=swap');
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Orbitron', 'Roboto Mono', monospace; 
            background: radial-gradient(circle at 30% 20%, #1a0d2e 0%, #0f0f23 30%, #000 70%);
            color: #00ff88; min-height: 100vh; overflow-x: hidden;
            position: relative;
        }
        
        /* –ú–ê–¢–†–ò–¶–ù–´–ô –≠–§–§–ï–ö–¢ */
        #matrix-bg {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1;
            opacity: 0.08;
        }
        
        /* –ì–õ–ê–í–ù–´–ô –•–ï–î–ï–† */
        .header { 
            background: linear-gradient(90deg, rgba(0,255,136,0.95), rgba(64,0,255,0.9), rgba(255,0,136,0.95)); 
            padding: 25px; border-bottom: 6px solid transparent;
            background-clip: padding-box;
            position: sticky; top: 0; z-index: 100; backdrop-filter: blur(25px);
            box-shadow: 0 10px 50px rgba(0,255,136,0.5);
            animation: headerGlow 3s ease-in-out infinite alternate;
        }
        @keyframes headerGlow {
            0% { box-shadow: 0 10px 50px rgba(0,255,136,0.5); }
            100% { box-shadow: 0 10px 80px rgba(255,0,136,0.7), 0 0 100px rgba(0,255,136,0.4); }
        }
        
        .header h1 {
            font-size: clamp(2.2em, 5vw, 3.5em); font-weight: 900; 
            text-shadow: 0 0 25px #00ff88, 0 0 50px #ff0088, 0 0 75px #00ff88;
            text-align: center; letter-spacing: 3px; margin-bottom: 15px;
        }
        
        .nav { 
            display: flex; gap: 20px; justify-content: center; flex-wrap: wrap; 
            perspective: 1000px;
        }
        .nav-btn { 
            background: linear-gradient(145deg, rgba(0,255,136,0.9), rgba(0,200,100,0.9)); 
            color: #000; border: 3px solid #00ff88; padding: 15px 30px; 
            border-radius: 50px; cursor: pointer; font-weight: 700; font-size: 1.2em;
            position: relative; overflow: hidden; transition: all 0.4s cubic-bezier(0.23, 1, 0.320, 1);
            transform-style: preserve-3d;
        }
        .nav-btn::before {
            content: ''; position: absolute; top: 0; left: -150%; width: 150%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.6), transparent);
            transition: left 0.7s;
        }
        .nav-btn:hover::before { left: 100%; }
        .nav-btn:hover { 
            transform: translateY(-8px) rotateX(10deg) scale(1.08); 
            box-shadow: 0 25px 50px rgba(0,255,136,0.6), 0 0 40px rgba(255,0,136,0.4);
            background: linear-gradient(145deg, rgba(0,200,100,1), rgba(0,255,136,1));
        }
        .nav-btn.active { 
            background: linear-gradient(145deg, #ff0088, #ff4499) !important; 
            box-shadow: 0 0 50px #ff0088; color: #fff !important;
            transform: scale(1.1);
        }
        .exit-btn { background: linear-gradient(145deg, #ff4444, #ff6666) !important; border-color: #ff4444; }
        .exit-btn:hover { box-shadow: 0 25px 50px rgba(255,68,68,0.6); }
        
        .content { display: none; padding: 50px; max-width: 1800px; margin: 0 auto; }
        .content.active { 
            display: block; animation: slideInUp 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        @keyframes slideInUp {
            from { opacity: 0; transform: translateY(100px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* –ö–ê–†–¢–û–ß–ö–ò –ò–ì–† */
        .games-grid { 
            display: grid; grid-template-columns: repeat(auto-fit, minmax(420px, 1fr)); gap: 40px; 
        }
        .game-card { 
            background: linear-gradient(135deg, rgba(0,255,136,0.25), rgba(64,0,255,0.2)); 
            backdrop-filter: blur(15px); border: 4px solid transparent;
            background-clip: padding-box; border-radius: 30px; padding: 45px; text-align: center;
            cursor: pointer; position: relative; overflow: hidden; height: 320px; 
            display: flex; flex-direction: column; justify-content: center;
            box-shadow: 0 25px 60px rgba(0,0,0,0.4), inset 0 1px 0 rgba(255,255,255,0.2);
            transition: all 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        .game-card::before {
            content: ''; position: absolute; inset: 0; background: linear-gradient(45deg, transparent, rgba(255,255,255,0.2), transparent);
            transform: translateX(-100%) translateY(-100%) rotate(45deg); transition: all 0.8s;
        }
        .game-card:hover::before { transform: translateX(100%) translateY(100%) rotate(45deg); }
        .game-card:hover { 
            transform: translateY(-25px) rotateX(5deg) scale(1.05); 
            border-color: #ff0088; box-shadow: 0 50px 100px rgba(0,255,136,0.5), 0 0 80px rgba(255,0,136,0.6);
        }
        .game-card h3 { 
            font-size: 2.8em; margin-bottom: 20px; font-weight: 900; 
            background: linear-gradient(45deg, #00ff88, #ff0088); -webkit-background-clip: text;
            -webkit-text-fill-color: transparent; background-clip: text;
        }
        
        /* –¢–û–ü-10 */
        .top10-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(450px, 1fr)); gap: 40px; }
        .top10-card { 
            background: linear-gradient(135deg, rgba(0,200,255,0.3), rgba(100,0,255,0.25)); 
            backdrop-filter: blur(20px); border: 3px solid #00ccff; border-radius: 25px; 
            padding: 40px; box-shadow: 0 30px 80px rgba(0,200,255,0.4);
        }
        
        /* –¢–£–†–ù–ò–†–´ */
        .tournament { 
            background: linear-gradient(45deg, rgba(255,50,100,0.45), rgba(255,150,50,0.4)); 
            backdrop-filter: blur(20px); border: 5px solid #ffaa44; border-radius: 35px; 
            padding: 60px; margin: 40px 0; box-shadow: 0 40px 100px rgba(255,100,50,0.5);
            position: relative; overflow: hidden;
        }
        .tournament::before {
            content: '‚öîÔ∏è'; position: absolute; font-size: 10em; top: -50px; right: -50px;
            opacity: 0.1; animation: rotate 20s linear infinite;
        }
        @keyframes rotate { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        
        .timer-text { font-size: 1.8em; color: #fff; margin-bottom: 15px; font-weight: 700; }
        .countdown { 
            font-size: 4.5em; font-weight: 900; color: #ffd700; 
            text-shadow: 0 0 30px #ffd700, 0 0 60px #ffaa44; margin: 25px 0;
            animation: pulseTournament 2s infinite;
        }
        @keyframes pulseTournament {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.08); }
        }
        
        /* –ú–û–î–ê–õ–ö–ò */
        .modal { 
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: rgba(0,0,0,0.92); z-index: 10000; backdrop-filter: blur(30px);
        }
        .modal-content { 
            background: linear-gradient(145deg, #1a1a3e, #2a1a4e, #1a3e4e); 
            padding: 60px; border: 5px solid #00ff88; border-radius: 40px; 
            max-width: 95%; max-height: 95%; position: relative;
            box-shadow: 0 0 150px #00ff88, inset 0 1px 0 rgba(255,255,255,0.2);
            animation: modalExplode 0.7s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        @keyframes modalExplode {
            0% { transform: scale(0) rotate(180deg); opacity: 0; }
            60% { transform: scale(1.1); }
            100% { transform: scale(1) rotate(0deg); opacity: 1; }
        }
        
        /* –ö–ê–ù–í–ê–° */
        canvas { 
            border: 5px solid #00ff88; background: #000; border-radius: 25px; 
            box-shadow: 0 0 80px #00ff88, inset 0 0 50px rgba(0,255,136,0.1);
            touch-action: none; image-rendering: pixelated;
        }
        
        /* –ò–ù–ü–£–¢–´ */
        input { 
            background: linear-gradient(145deg, rgba(0,0,0,0.9), rgba(20,20,50,0.8)); 
            color: #00ff88; border: 3px solid #00ff88; border-radius: 20px; 
            padding: 25px 30px; font-size: 1.6em; width: 100%; margin: 20px 0;
            font-family: 'Roboto Mono', monospace; box-shadow: 0 0 30px rgba(0,255,136,0.4);
            transition: all 0.3s ease;
        }
        input:focus { 
            outline: none; box-shadow: 0 0 50px #00ff88, 0 0 80px rgba(0,255,136,0.6);
            transform: scale(1.02);
        }
        
        /* –õ–ò–î–ï–†–ë–û–†–î–´ */
        .leaderboard { 
            background: rgba(0,0,0,0.85); backdrop-filter: blur(15px); 
            padding: 30px; border-radius: 20px; margin: 20px 0; max-height: 450px; 
            overflow-y: auto; border: 2px solid rgba(0,255,136,0.3);
        }
        .leaderboard::-webkit-scrollbar { width: 8px; }
        .leaderboard::-webkit-scrollbar-track { background: rgba(0,0,0,0.5); }
        .leaderboard::-webkit-scrollbar-thumb { background: linear-gradient(#00ff88, #ff0088); border-radius: 10px; }
        
        .rank-1 { color: #ffd700 !important; font-size: 2.2em !important; font-weight: 900 !important; text-shadow: 0 0 25px #ffd700; }
        .rank-2 { color: #c0c0c0 !important; font-size: 1.8em !important; }
        .rank-3 { color: #ffaa44 !important; font-size: 1.8em !important; }
        
        /* –ü–†–û–§–ò–õ–¨ */
        .profile-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 30px; }
        .stat-box { 
            background: linear-gradient(145deg, rgba(0,255,136,0.2), rgba(64,0,255,0.2)); 
            border: 3px solid #00ff88; border-radius: 25px; padding: 30px; text-align: center;
            font-size: 1.8em; font-weight: 700; box-shadow: 0 20px 50px rgba(0,0,0,0.4);
            transition: all 0.4s ease;
        }
        .stat-box:hover { transform: translateY(-10px) scale(1.05); box-shadow: 0 30px 70px rgba(0,255,136,0.6); }
        
        .achievement { 
            display: inline-block; background: linear-gradient(45deg, #ffd700, #ffaa00); 
            color: #000; padding: 15px 30px; border-radius: 30px; margin: 15px; 
            font-size: 1.2em; font-weight: 700; border: 3px solid #ffd700;
            box-shadow: 0 10px 30px rgba(255,215,0,0.5); animation: achievementFloat 3s ease-in-out infinite;
        }
        @keyframes achievementFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
    </style>
</head>
<body>
    <canvas id="matrix-bg"></canvas>
    
    <div class="header">
        <h1>üöÄ ALEKSIN GAMES v8.0.0 ‚ö° –ö–ò–ë–ï–†-–ê–†–ï–ù–ê ‚àû</h1>
        <p>üíæ –ì–õ–û–ë–ê–õ–¨–ù–ê–Ø –ú–ê–¢–†–ò–¶–ê –õ–ò–î–ï–†–û–í ‚Ä¢ ‚öîÔ∏è –ï–ñ–ï–î–ù–ï–í–ù–´–ï –¢–£–†–ù–ò–†–´ ‚Ä¢ üß¨ –ü–†–û–§–ò–õ–¨ –•–ê–ö–ï–†–ê ‚Ä¢ üêç NEURAL –ó–ú–ï–ô–ö–ê ‚Ä¢ üéØ AI –£–ì–ê–î–ê–ô–ö–ê</p>
                <div class="nav" id="nav">
            <button class="nav-btn active" data-page="games">üéÆ –ù–µ–π—Ä–æ-–ò–≥—Ä—ã</button>
            <button class="nav-btn" data-page="top10">üíæ –¢–û–ü –ú–ê–¢–†–ò–¶–ê</button>
            <button class="nav-btn" data-page="tournaments">‚öîÔ∏è –ö–ò–ë–ï–†-–¢–£–†–ù–ò–†</button>
            <button class="nav-btn" data-page="profile">üß¨ –•–ê–ö–ï–† –ü–†–û–§–ò–õ–¨</button>
            <button class="nav-btn" id="auth-btn">üîê <span id="user-status">–ì–æ—Å—Ç—å</span></button>
            <button class="nav-btn exit-btn" onclick="if(confirm('üö™ –í—ã–π—Ç–∏ –∏–∑ –∫–∏–±–µ—Ä-–∞—Ä–µ–Ω—ã?')) window.close()">‚ùå –í–´–•–û–î</button>
        </div>
    </div>

    <!-- üéÆ –ì–õ–ê–í–ù–ê–Ø –° 6 –ò–ì–†–ê–ú–ò -->
    <div id="games" class="content active">
        <h2 style="text-align: center; font-size: 4em; margin-bottom: 50px; text-shadow: 0 0 30px #00ff88;">üéÆ –í–´–ë–ï–†–ò –ö–ò–ë–ï–†-–ò–ì–†–£</h2>
        <div class="games-grid">
            <div class="game-card" onclick="startGame('snake', 'easy')">
                <h3>üêç –ó–ú–ï–ô–ö–ê v4K EASY</h3>
                <div style="font-size: 1.5em; color: #ffaa00; margin-bottom: 15px;">‚ö° –°–í–ê–ô–ü–´ + AI TRACK</div>
                <div id="lb-snake-easy-mini" class="leaderboard-mini" style="font-size: 1.2em;"></div>
            </div>
            <div class="game-card" onclick="startGame('snake', 'medium')">
                <h3>üêç –ó–ú–ï–ô–ö–ê v4K MEDIUM</h3>
                <div id="lb-snake-medium-mini" class="leaderboard-mini"></div>
            </div>
            <div class="game-card" onclick="startGame('snake', 'hard')">
                <h3>üêç –ó–ú–ï–ô–ö–ê v4K HARD</h3>
                <div id="lb-snake-hard-mini" class="leaderboard-mini"></div>
            </div>
            <div class="game-card" onclick="startGame('guess', '1000')">
                <h3>üéØ NEURAL 1-1000</h3>
                <div style="color: #00ffff; font-size: 1.4em;">AI –ø–æ–¥—Å–∫–∞–∑–∫–∏ + –î–∏–∞–ø–∞–∑–æ–Ω</div>
                <div id="lb-guess-1000-mini" class="leaderboard-mini"></div>
            </div>
            <div class="game-card" onclick="startGame('guess', '10000')">
                <h3>üéØ NEURAL 1-10000</h3>
                <div id="lb-guess-10000-mini" class="leaderboard-mini"></div>
            </div>
            <div class="game-card" onclick="startGame('guess', '100000')">
                <h3>üéØ NEURAL 1-100000</h3>
                <div id="lb-guess-100000-mini" class="leaderboard-mini"></div>
            </div>
        </div>
    </div>

    <!-- üèÜ –¢–û–ü-10 -->
    <div id="top10" class="content">
        <h2 style="text-align: center; font-size: 4em; margin-bottom: 50px;">üíæ –ì–õ–û–ë–ê–õ–¨–ù–ê–Ø –ú–ê–¢–†–ò–¶–ê –¢–û–ü-10</h2>
        <div class="top10-grid" id="top10-container">üîÑ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–∞—Ç—Ä–∏—Ü—ã –ª–∏–¥–µ—Ä–æ–≤...</div>
    </div>

    <!-- ‚öîÔ∏è –¢–£–†–ù–ò–†–´ -->
    <div id="tournaments" class="content">
        <h2 id="tournament-title" style="text-align: center; font-size: 4em; margin-bottom: 50px;">‚öîÔ∏è –ê–ö–¢–ò–í–ù–´–ô –ö–ò–ë–ï–†-–¢–£–†–ù–ò–†</h2>
        <div class="tournament">
            <div class="timer-text">‚è∞ –û—Å—Ç–∞–ª–æ—Å—å:</div>
            <div class="countdown" id="tournament-timer">–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è...</div>
            <div id="tournament-game-info" style="font-size: 2.2em; margin: 30px 0; font-weight: 700; text-align: center;"></div>
            <button class="nav-btn join-btn" id="join-btn" onclick="joinTournament()" style="display:none; padding: 25px 60px; font-size: 1.8em;">‚öîÔ∏è –í–°–¢–£–ü–ò–¢–¨ –í –ë–ò–¢–í–£</button>
        </div>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(550px, 1fr)); gap: 50px; margin-top: 50px;">
            <div>
                <h3 style="text-align: center; font-size: 2.8em; margin-bottom: 30px;">üèÜ –ú–ê–¢–†–ò–¶–ê –õ–ò–î–ï–†–û–í –¢–£–†–ù–ò–†–ê</h3>
                <div id="tournament-standings" class="leaderboard"></div>
            </div>
            <div>
                <h3 style="text-align: center; font-size: 2.8em; margin-bottom: 30px;">üìä –¢–í–û–ò –ë–ò–¢–í–´</h3>
                <div id="tournament-personal" class="leaderboard" style="background: linear-gradient(145deg, rgba(0,255,136,0.3), rgba(0,150,255,0.3));"></div>
            </div>
        </div>
    </div>

    <!-- üë§ –ü–†–û–§–ò–õ–¨ -->
    <div id="profile" class="content">
        <h2 style="text-align: center; font-size: 4em; margin-bottom: 50px;">üß¨ –ü–†–û–§–ò–õ–¨ –ö–ò–ë–ï–†-–°–ü–û–†–¢–°–ú–ï–ù–ê</h2>
        <div class="profile-grid" id="profile-stats" style="margin-bottom: 50px;"></div>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(450px, 1fr)); gap: 40px;">
            <div class="leaderboard">
                <h3 style="text-align: center; font-size: 2.5em; margin-bottom: 30px;">üèÜ –õ–£–ß–®–ò–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´</h3>
                <div id="profile-bests"></div>
            </div>
            <div class="leaderboard" style="background: linear-gradient(145deg, rgba(255,215,0,0.4), rgba(255,150,50,0.3)); border-color: #ffd700;">
                <h3 style="text-align: center; font-size: 2.5em; margin-bottom: 30px;">üéñÔ∏è –î–û–°–¢–ò–ñ–ï–ù–ò–Ø –•–ê–ö–ï–†–ê</h3>
                <div id="profile-achievements"></div>
            </div>
        </div>
    </div>

    <!-- üîê –ú–û–î–ê–õ–ö–ê –ê–í–¢–û–†–ò–ó–ê–¶–ò–ò -->
    <div id="auth-modal" class="modal">
        <div class="modal-content">
            <h3 style="font-size: 3em; text-align: center; margin-bottom: 40px; background: linear-gradient(45deg, #00ff88, #ff0088); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">üîê –ö–ò–ë–ï–†-–ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø v8.0</h3>
            <input id="auth-username" placeholder="üöÄ –í–≤–µ–¥–∏ –ª–æ–≥–∏–Ω —Ö–∞–∫–µ—Ä–∞">
            <input id="auth-password" type="password" placeholder="üîë –ö–æ–¥ –¥–æ—Å—Ç—É–ø–∞ –∫ –º–∞—Ç—Ä–∏—Ü–µ">
            <div style="display: flex; gap: 25px; justify-content: center; flex-wrap: wrap;">
                <button id="register-btn" class="nav-btn" style="padding: 25px 50px; font-size: 1.6em;">üìù –°–û–ó–î–ê–¢–¨ –ê–ö–ö–ê–£–ù–¢</button>
                <button id="login-btn" class="nav-btn" style="padding: 25px 50px; font-size: 1.6em; background: linear-gradient(145deg, #00ccff, #0088ff);">‚ö° –ê–í–¢–û–†–ò–ó–û–í–ê–¢–¨–°–Ø</button>
                <button onclick="closeAuth()" class="exit-btn" style="padding: 25px 50px; font-size: 1.6em;">‚ùå –û–¢–ú–ï–ù–ê</button>
            </div>
        </div>
    </div>

    <!-- üéÆ –ú–û–î–ê–õ–ö–ê –ò–ì–†–´ -->
    <div id="game-modal" class="modal">
        <div class="modal-content" style="width: 96%; height: 92%;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; flex-wrap: wrap; gap: 20px;">
                <h2 id="game-title-big" style="font-size: 3.2em; margin: 0;"></h2>
                <div style="display: flex; gap: 20px; align-items: center;">
                    <button onclick="changeDifficulty(-1)" style="padding: 20px; font-size: 1.8em; min-width: 70px;">‚óÄÔ∏è</button>
                    <span id="current-difficulty" style="font-size: 2.2em; font-weight: 900; min-width: 150px; text-align: center; padding: 15px 25px; background: rgba(0,0,0,0.5); border-radius: 20px; border: 2px solid #00ff88;"></span>
                    <button onclick="changeDifficulty(1)" style="padding: 20px; font-size: 1.8em; min-width: 70px;">‚ñ∂Ô∏è</button>
                </div>
            </div>
            <div id="game-score-big" style="font-size: 3.8em; font-weight: 900; text-align: center; margin-bottom: 25px; text-shadow: 0 0 30px #ffd700;"></div>
            <div id="guess-hint" style="font-size: 2.5em; color: #00ffff; text-align: center; margin: 25px 0; font-weight: 800; text-shadow: 0 0 20px #00ffff;"></div>
            <canvas id="game-canvas" width="1000" height="650"></canvas>
            <div style="text-align: center; margin: 40px 0; display: flex; justify-content: center; gap: 25px; flex-wrap: wrap;">
                <button onclick="restartGame()" class="nav-btn" style="padding: 25px 60px; font-size: 1.8em;">üîÑ –ù–û–í–ê–Ø –ò–ì–†–ê</button>
                <button onclick="saveAndExit()" class="nav-btn" style="background: linear-gradient(145deg, #ffaa44, #ff6600); padding: 25px 60px; font-size: 1.8em;">üíæ –°–û–•–†–ê–ù–ò–¢–¨ –†–ï–ó–£–õ–¨–¢–ê–¢</button>
                <button onclick="closeGame()" class="exit-btn" style="padding: 25px 60px; font-size: 1.8em;">‚ùå –í–´–•–û–î –ò–ó –ò–ì–†–´</button>
            </div>
            <div id="game-leaderboard" class="leaderboard" style="margin-top: 20px;"></div>
        </div>
    </div>

    <script>
        // üî• –£–õ–¨–¢–†–ê –ó–í–£–ö–û–í–ê–Ø –°–ò–°–¢–ï–ú–ê –•–ê–ö–ï–†–ê
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        const sounds = {
            click: [800, 1000, 1200],
            success: [1000, 1100, 1200, 1300],
            gameStart: [200, 400, 600, 800],
            eat: [600, 700, 800],
            win: [1200, 1400, 1600, 1800],
            lose: [200, 150, 100],
            hover: [400, 500]
        };

        function playSound(type, volume = 0.4, delay = 0) {
            setTimeout(() => {
                const freqs = sounds[type] || [800];
                freqs.forEach((freq, i) => {
                    setTimeout(() => {
                        const oscillator = audioCtx.createOscillator();
                        const gainNode = audioCtx.createGain();
                        oscillator.connect(gainNode);
                        gainNode.connect(audioCtx.destination);
                        oscillator.frequency.value = freq;
                        oscillator.type = type === 'lose' ? 'sawtooth' : 'sine';
                        gainNode.gain.setValueAtTime(volume * 0.8, audioCtx.currentTime);
                        gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.15);
                        oscillator.start(audioCtx.currentTime);
                        oscillator.stop(audioCtx.currentTime + 0.15);
                    }, i * 50);
                });
            }, delay);
        }

        // üåßÔ∏è –ú–ê–¢–†–ò–¶–ù–´–ô –î–û–ñ–î–¨ 4K
        function initMatrixRain() {
            const canvas = document.getElementById('matrix-bg');
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;

            const chars = '01„Ç¢„Ç§„Ç¶„Ç®„Ç™„Ç´„Ç≠„ÇØ„Ç±„Ç≥„Çµ„Ç∑„Çπ„Çª„ÇΩ„Çø„ÉÅ„ÉÑ„ÉÜ„Éà„Éä„Éã„Éå„Éç„Éé„Éè„Éí„Éï„Éò„Éõ„Éû„Éü„É†„É°„É¢„É§„É¶„É®„É©„É™„É´„É¨„É≠„ÉØ„É≤„É≥‚ñì‚ñà‚ñë‚ñí‚ñë‚ñì‚ñà‚ñì‚ñà‚ñë‚ñí‚ñì‚ñà';
            const fontSize = 18;
            const columns = Math.floor(canvas.width / fontSize);
            const drops = Array(columns).fill(1);

            function draw() {
                ctx.fillStyle = 'rgba(0, 20, 40, 0.1)';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                ctx.fillStyle = `hsl(${Date.now() * 0.01 % 60 * 6}, 100%, 60%)`;
                ctx.font = `${fontSize}px 'Orbitron', monospace`;
                
                drops.forEach((y, i) => {
                    const text = chars[Math.floor(Math.random() * chars.length)];
                    ctx.fillText(text, i * fontSize, y * fontSize);
                    
                    if (y * fontSize > canvas.height && Math.random() > 0.98) {
                        drops[i] = 0;
                    }
                    drops[i]++;
                });
            }
            setInterval(draw, 40);
            window.addEventListener('resize', () => {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            });
        }

        // üéÆ –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï
        let currentUser = localStorage.getItem('currentUser') || '–ì–æ—Å—Ç—å';
        let currentGame = '', currentDifficulty = 'easy', gameScore = 0, gameRunning = false;
        let snake = [], dx = 1, dy = 0, foodX, foodY, snakeLength = 1, snakeSpeed = 10;
        let guessNumber, guessAttempts = 0, guessMin = 1, guessMax = 1000, guessMaxOrig = 1000;
        let gameCanvas, gameCtx, touchStartX = 0, touchStartY = 0;
        let tournamentEndTime = Date.now() + 86340000; // 24 —á–∞—Å–∞

        // üöÄ –ü–û–õ–ù–ê–Ø –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø
        document.addEventListener('DOMContentLoaded', function() {
            initMatrixRain();
            updateUserDisplay();
            
            // –ù–∞–≤–∏–≥–∞—Ü–∏—è
            document.querySelectorAll('.nav-btn[data-page]').forEach(btn => {
                btn.addEventListener('mouseenter', () => playSound('hover', 0.2));
                btn.addEventListener('click', function() {
                    playSound('click'); 
                    showPage(this.dataset.page, this);
                });
            });
            
            // –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
            document.getElementById('auth-btn').addEventListener('click', () => { playSound('click', 0.3); toggleAuth(); });
            document.getElementById('register-btn').addEventListener('click', () => authUser('register'));
            document.getElementById('login-btn').addEventListener('click', () => authUser('login'));
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
            loadMiniLeaderboards();
            updateTournamentTimer();
            loadTop10();
            setTimeout(() => {
                loadTournament();
                loadProfile();
            }, 1000);
        });

        // üìä –ù–∞–≤–∏–≥–∞—Ü–∏—è
        function showPage(page, btn) {
            document.querySelectorAll('.content').forEach(c => c.classList.remove('active'));
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(page).classList.add('active');
            btn.classList.add('active');
        }

        // üë§ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function updateUserDisplay() {
            document.getElementById('user-status').textContent = currentUser;
            if (document.getElementById('nav-user')) {
                document.getElementById('nav-user').textContent = currentUser;
            }
        }

        // üîê –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø (–õ–û–ö–ê–õ–¨–ù–ê–Ø –ë–ê–ó–ê)
        function toggleAuth() {
            document.getElementById('auth-modal').style.display = 'flex';
            playSound('click', 0.4);
        }

        function closeAuth() {
            document.getElementById('auth-modal').style.display = 'none';
            document.getElementById('auth-username').value = '';
            document.getElementById('auth-password').value = '';
        }

        function authUser(type) {
            const username = document.getElementById('auth-username').value.trim();
            const password = document.getElementById('auth-password').value;
            
            if (!username || !password) {
                playSound('lose', 0.3);
                alert('üö´ –ó–∞–ø–æ–ª–Ω–∏ –≤—Å–µ –ø–æ–ª—è, —Ö–∞–∫–µ—Ä!');
                return;
            }

            playSound('success');
            setTimeout(() => {
                localStorage.setItem('currentUser', username);
                currentUser = username;
                updateUserDisplay();
                closeAuth();
                alert(`‚úÖ ${type === 'register' ? '–ê–∫–∫–∞—É–Ω—Ç —Å–æ–∑–¥–∞–Ω' : '–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞'}! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –º–∞—Ç—Ä–∏—Ü—É, ${username}!`);
                loadProfile();
            }, 1200);
        }

        // üèÜ –ó–∞–≥—Ä—É–∑–∫–∞ –º–∏–Ω–∏-–ª–∏–¥–µ—Ä–±–æ—Ä–¥–æ–≤
        async function loadMiniLeaderboards() {
            const leaderboards = {
                'lb-snake-easy-mini': [{name: 'ALEX', score: 1250}, {name: 'CYBER', score: 1180}],
                'lb-snake-medium-mini': [{name: 'HACKER', score: 980}, {name: 'NEO', score: 920}],
                'lb-snake-hard-mini': [{name: 'MATRIX', score: 650}, {name: 'ALEX', score: 580}],
                'lb-guess-1000-mini': [{name: 'ALEX', score: 850}, {name: 'LUCKY', score: 720}],
                'lb-guess-10000-mini': [{name: 'MATH', score: 420}, {name: 'ALEX', score: 380}],
                'lb-guess-100000-mini': [{name: 'GENIUS', score: 180}, {name: 'ALEX', score: 120}]
            };

            Object.entries(leaderboards).forEach(([id, top]) => {
                const el = document.getElementById(id);
                if (el) {
                    el.innerHTML = top.map((p, i) => `${i+1}. ${p.name}: ${p.score}`).join('<br>');
                }
            });
        }

        // üèÜ –¢–û–ü-10 –ü–û–õ–ù–´–ô
        async function loadTop10() {
            const games = [
                {name: 'üêç –ó–º–µ–π–∫–∞ EASY', game: 'snake', diff: 'easy'},
                {name: 'üêç –ó–º–µ–π–∫–∞ MEDIUM', game: 'snake', diff: 'medium'},
                {name: 'üêç –ó–º–µ–π–∫–∞ HARD', game: 'snake', diff: 'hard'},
                {name: 'üéØ NEURAL 1-1000', game: 'guess', diff: '1000'},
                {name: 'üéØ NEURAL 1-10000', game: 'guess', diff: '10000'},
                {name: 'üéØ NEURAL 1-100000', game: 'guess', diff: '100000'}
            ];

            const container = document.getElementById('top10-container');
            container.innerHTML = '<div style="text-align:center;font-size:2em;">üîÑ –ó–∞–≥—Ä—É–∑–∫–∞ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã...</div>';

            setTimeout(() => {
                container.innerHTML = games.map((game, i) => {
                    const top = Array(10).fill().map((_, j) => ({
                        name: ['ALEX', 'CYBER', 'HACKER', 'NEO', 'MATRIX', 'LUCKY', 'MATH', 'GENIUS', 'PRO', 'BOSS'][j] || `Player${j+1}`,
                        score: Math.floor(Math.random() * 2000 + 100)
                    }));
                    return `<div class="top10-card">
                        <h3 style="text-align: center; font-size: 2.5em; margin-bottom: 30px;">${game.name}</h3>
                        ${top.map((player, j) => `<div class="leaderboard ${['rank-1', 'rank-2', 'rank-3'][j] || ''}" style="margin: 15px 0; padding: 15px; border-radius: 15px; background: rgba(255,255,255,0.05);">
                            <span style="float:right;font-size:1.4em;">${player.score}</span>
                            ${j+1}. <strong style="font-size:1.6em;">${player.name}</strong>
                        </div>`).join('')}
                    </div>`;
                }).join('');
            }, 1500);
        }

        // ‚öîÔ∏è –¢—É—Ä–Ω–∏—Ä—ã
        async function loadTournament() {
            document.getElementById('tournament-title').textContent = '‚öîÔ∏è –ó–ú–ï–ô–ö–ê v4K - –ï–ñ–ï–î–ù–ï–í–ù–´–ô –¢–£–†–ù–ò–†';
            document.getElementById('tournament-game-info').textContent = '–ò–≥—Ä–∞–π –≤ üêç –ó–ú–ï–ô–ö–ê EASY –∏ –ø–æ–¥–Ω–∏–º–∞–π—Å—è –≤ —Ä–µ–π—Ç–∏–Ω–≥–µ!';
            document.getElementById('join-btn').style.display = currentUser !== '–ì–æ—Å—Ç—å' ? 'inline-flex' : 'none';
            
            document.getElementById('tournament-standings').innerHTML = `
                <div class="rank-1" style="margin: 20px 0; text-align:center;">1. ALEX - 12500</div>
                <div class="rank-2" style="margin: 15px 0;">2. CYBER - 11800</div>
                <div class="rank-3" style="margin: 15px 0;">3. HACKER - 10950</div>
                <div>4. NEO - 9800</div>
                <div>5. MATRIX - 9200</div>
            `;
            document.getElementById('tournament-personal').innerHTML = `
                <div style="font-size:2em;text-align:center;margin-bottom:20px;">${currentUser}</div>
                <div style="font-size:1.6em;">üìä –õ—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: 4500</div>
                <div style="font-size:1.6em;">‚öîÔ∏è –°–µ–≥–æ–¥–Ω—è: 3200 (4 –º–µ—Å—Ç–æ)</div>
            `;
        }

        function joinTournament() {
            playSound('gameStart', 0.5);
            alert('‚öîÔ∏è –¢—ã –≤—Å—Ç—É–ø–∏–ª –≤ —Ç—É—Ä–Ω–∏—Ä! –ò–≥—Ä–∞–π –≤ —É–∫–∞–∑–∞–Ω–Ω—É—é –∏–≥—Ä—É –¥–ª—è –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è –æ—á–∫–æ–≤!');
        }

        // üë§ –ü—Ä–æ—Ñ–∏–ª—å
        function loadProfile() {
            document.getElementById('profile-stats').innerHTML = `
                <div class="stat-box">
                    <div style="font-size:3em;margin-bottom:15px;">${currentUser}</div>
                    <div style="font-size:2.2em;color:#ffd700;">üëë –†–∞–Ω–≥: –•–ê–ö–ï–†</div>
                    <div style="font-size:1.8em;">‚≠ê –û–±—â–∏–π —Å—á—ë—Ç: 45,200</div>
                </div>
                <div class="stat-box">
                    <div style="font-size:2.5em;">üèÜ –ü–æ–±–µ–¥</div>
                    <div style="font-size:3em;color:#ffaa44;">127</div>
                </div>
                <div class="stat-box">
                    <div style="font-size:2.5em;">‚öîÔ∏è –¢—É—Ä–Ω–∏—Ä–æ–≤</div>
                    <div style="font-size:3em;color:#00ccff;">23</div>
                </div>
            `;
            
            document.getElementById('profile-bests').innerHTML = `
                <div style="font-size:1.8em;">üêç –ó–º–µ–π–∫–∞ EASY: 1250</div>
                <div style="font-size:1.8em;">üêç –ó–º–µ–π–∫–∞ HARD: 650</div>
                <div style="font-size:1.8em;">üéØ 1-1000: 850</div>
            `;
            
            document.getElementById('profile-achievements').innerHTML = `
                <div class="achievement">üêç –ú–∞—Å—Ç–µ—Ä –ó–º–µ–π–∫–∏</div>
                <div class="achievement">‚öîÔ∏è –ü–æ–±–µ–¥–∏—Ç–µ–ª—å –¢—É—Ä–Ω–∏—Ä–∞</div>
                <div class="achievement">üéØ –¢–µ–ª–µ–ø–∞—Ç</div>
            `;
        }

        // ‚è∞ –¢—É—Ä–Ω–∏—Ä–Ω—ã–π —Ç–∞–π–º–µ—Ä
        function updateTournamentTimer() {
            const now = Date.now();
            const timeLeft = Math.max(0, tournamentEndTime - now);
            if (timeLeft > 0) {
                const h = Math.floor(timeLeft / 3600000);
                const m = Math.floor((timeLeft % 3600000) / 60000);
                const s = Math.floor((timeLeft % 60000) / 1000);
                document.getElementById('tournament-timer').textContent = `${h}:${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
            } else {
                document.getElementById('tournament-timer').textContent = 'üéâ –ù–û–í–´–ô –¢–£–†–ù–ò–†!';
                tournamentEndTime = Date.now() + 86340000;
            }
            requestAnimationFrame(updateTournamentTimer);
        }

        // üéÆ –ò–ì–†–´ - –ü–û–õ–ù–ê–Ø –†–ï–ê–õ–ò–ó–ê–¶–ò–Ø

        function startGame(game, diff) {
            playSound('gameStart', 0.6);
            currentGame = game; 
            currentDifficulty = diff; 
            gameScore = 0; 
            gameRunning = true;
            
            document.getElementById('game-modal').style.display = 'flex';
            document.getElementById('game-title-big').textContent = `${game === 'snake' ? 'üêç –ó–ú–ï–ô–ö–ê v4K' : 'üéØ NEURAL NET'}: ${diff.toUpperCase()}`;
            document.getElementById('current-difficulty').textContent = diff.toUpperCase();
            
            gameCanvas = document.getElementById('game-canvas');
            gameCtx = gameCanvas.getContext('2d');
            gameCtx.imageSmoothingEnabled = false;
            
            if (game === 'snake') initSnake();
            else initGuess();
        }

        function changeDifficulty(dir) {
            playSound('click');
            const diffs = currentGame === 'snake' ? ['easy', 'medium', 'hard'] : ['1000', '10000', '100000'];
            let idx = diffs.indexOf(currentDifficulty);
            currentDifficulty = diffs[(idx + dir + diffs.length) % diffs.length];
            document.getElementById('current-difficulty').textContent = currentDifficulty.toUpperCase();
            if (currentGame === 'snake') initSnake();
            else initGuess();
        }

        function restartGame() {
            playSound('gameStart');
            if (currentGame === 'snake') initSnake();
            else initGuess();
        }

        function closeGame() {
            playSound('lose', 0.4);
            gameRunning = false;
            document.getElementById('game-modal').style.display = 'none';
        }

        async function saveAndExit() {
            playSound('success', 0.5);
            if (currentUser === '–ì–æ—Å—Ç—å') {
                alert('üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º —Ö–∞–∫–µ—Ä–∞–º!');
                return;
            }
            alert(`üíæ –†–µ–∑—É–ª—å—Ç–∞—Ç ${gameScore} —Å–æ—Ö—Ä–∞–Ω—ë–Ω –≤ –º–∞—Ç—Ä–∏—Ü—É –ª–∏–¥–µ—Ä–æ–≤!`);
            closeGame();
        }

        // üêç –ó–ú–ï–ô–ö–ê v4K –° –°–í–ê–ô–ü–ê–ú–ò
        function initSnake() {
            snakeSpeed = {easy: 12, medium: 15, hard: 18}[currentDifficulty] || 12;
            snake = [{x: 25, y: 25}];
            dx = 1; dy = 0; 
            snakeLength = 1;
            placeFood();
            gameLoopSnake();
        }

        function placeFood() {
            foodX = Math.floor(Math.random() * 98) + 1;
            foodY = Math.floor(Math.random() * 63) + 1;
            if (snake.some(s => s.x === foodX && s.y === foodY)) placeFood();
        }

        function gameLoopSnake() {
            if (!gameRunning) return;

            // –û—á–∏—Å—Ç–∫–∞
            gameCtx.fillStyle = '#000';
            gameCtx.fillRect(0, 0, 1000, 650);

            // –ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Ñ–æ–Ω
            const gradient = ctx.createLinearGradient(0, 0, 1000, 650);
            gradient.addColorStop(0, '#001100');
            gradient.addColorStop(1, '#000011');
            gameCtx.fillStyle = gradient;
            gameCtx.fillRect(0, 0, 1000, 650);

            // –î–≤–∏–∂–µ–Ω–∏–µ –∑–º–µ–π–∫–∏
            const head = {x: snake[0].x + dx, y: snake[0].y + dy};

            // –ö–æ–ª–ª–∏–∑–∏–∏
            if (head.x < 1 || head.x > 98 || head.y < 1 || head.y > 63 || 
                snake.some(s => s.x === head.x && s.y === head.y)) {
                playSound('lose', 0.5);
                alert(`üíÄ Game Over!\n–î–ª–∏–Ω–∞: ${snakeLength}\n–û—á–∫–∏: ${gameScore}`);
                closeGame();
                return;
            }

            snake.unshift(head);

            // –ï–¥–∞
            if (head.x === foodX && head.y === foodY) {
                playSound('eat');
                snakeLength++;
                gameScore = snakeLength * 15;
                placeFood();
            } else {
                snake.pop();
            }

            // –†–∏—Å–æ–≤–∞–Ω–∏–µ –∑–º–µ–π–∫–∏ (–≥—Ä–∞–¥–∏–µ–Ω—Ç)
            snake.forEach((segment, i) => {
                const alpha = i / snake.length;
                gameCtx.fillStyle = `rgba(0, 255, 100, ${0.3 + alpha * 0.7})`;
                gameCtx.shadowColor = '#00ff64';
                gameCtx.shadowBlur = 20;
                gameCtx.fillRect(segment.x * 10, segment.y * 10, 10, 10);
            });

            // –ï–¥–∞ —Å —ç—Ñ—Ñ–µ–∫—Ç–æ–º
            gameCtx.fillStyle = '#ff4444';
            gameCtx.shadowColor = '#ff4444';
            gameCtx.shadowBlur = 25;
            gameCtx.beginPath();
            gameCtx.arc(foodX * 10 + 5, foodY * 10 + 5, 6, 0, Math.PI * 2);
            gameCtx.fill();

            // –°—á—ë—Ç
            gameCtx.fillStyle = '#ffd700';
            gameCtx.font = 'bold 48px Orbitron';
            gameCtx.textAlign = 'center';
            gameCtx.shadowColor = '#ffd700';
            gameCtx.shadowBlur = 30;
            gameCtx.fillText(`–î–ª–∏–Ω–∞: ${snakeLength} | –û—á–∫–∏: ${gameScore}`, 500, 80);
            gameCtx.textAlign = 'left';

            setTimeout(gameLoopSnake, 1000 / snakeSpeed);
        }

        // üéØ NEURAL –£–ì–ê–î–ê–ô–ö–ê –° –ü–û–î–°–ö–ê–ó–ö–ê–ú–ò
        function initGuess() {
            guessMaxOrig = parseInt(currentDifficulty);
            guessMax = guessMaxOrig;
            guessMin = 1;
            guessNumber = Math.floor(Math.random() * guessMax) + 1;
            guessAttempts = 0;
            document.getElementById('guess-hint').style.display = 'block';
            document.getElementById('guess-hint').textContent = `üéØ –î–∏–∞–ø–∞–∑–æ–Ω: ${guessMin}-${guessMax}`;
            updateGuessDisplay();
        }

        function updateGuessDisplay() {
            document.getElementById('game-score-big').textContent = `–ü–æ–ø—ã—Ç–∫–∞ ${guessAttempts + 1} | –î–∏–∞–ø–∞–∑–æ–Ω: ${guessMin}-${guessMax}`;
            
            gameCtx.fillStyle = '#000';
            gameCtx.fillRect(0, 0, 1000, 650);

            // –§–æ–Ω –≥—Ä–∞–¥–∏–µ–Ω—Ç
            const gradient = gameCtx.createRadialGradient(500, 325, 0, 500, 325, 500);
            gradient.addColorStop(0, 'rgba(0, 50, 100, 0.3)');
            gradient.addColorStop(1, 'rgba(0, 0, 50, 0.8)');
            gameCtx.fillStyle = gradient;
            gameCtx.fillRect(0, 0, 1000, 650);

            // –î–∏–∞–ø–∞–∑–æ–Ω
            gameCtx.fillStyle = '#00ff88';
            gameCtx.shadowColor = '#00ff88';
            gameCtx.shadowBlur = 40;
            gameCtx.font = 'bold 72px Orbitron';
            gameCtx.textAlign = 'center';
            gameCtx.fillText(`${guessMin}-${guessMax}`, 500, 300);

            gameCtx.font = 'bold 36px Orbitron';
            gameCtx.fillStyle = '#ffffff';
            gameCtx.shadowBlur = 20;
            gameCtx.shadowColor = '#ffffff';
            gameCtx.fillText('üëÜ –ö–ª–∏–∫–Ω–∏ –ø–æ —ç–∫—Ä–∞–Ω—É –¥–ª—è –≤–≤–æ–¥–∞ —á–∏—Å–ª–∞', 500, 420);
            gameCtx.textAlign = 'left';
        }

        function guessInput() {
            const guess = prompt(`üéØ –ü–æ–ø—ã—Ç–∫–∞ ${guessAttempts + 1}\nüìè –î–∏–∞–ø–∞–∑–æ–Ω: ${guessMin}-${guessMax}\n\nüí≠ –í–≤–µ–¥–∏ —á–∏—Å–ª–æ:`);
            if (!guess) return;

            const num = parseInt(guess);
            if (isNaN(num) || num < guessMin || num > guessMax) {
                playSound('lose');
                alert(`‚ùå –ß–∏—Å–ª–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—Ç ${guessMin} –¥–æ ${guessMax}!`);
                return guessInput();
            }

            playSound('click', 0.3);
            guessAttempts++;

            if (num === guessNumber) {
                gameScore = Math.floor(guessMaxOrig / guessAttempts * 10);
                playSound('win', 0.6);
                setTimeout(() => {
                    alert(`üéâ –ü–û–ó–î–†–ê–í–õ–Ø–ï–ú!\n–ß–∏—Å–ª–æ: ${guessNumber}\n–ü–æ–ø—ã—Ç–æ–∫: ${guessAttempts}\n–û—á–∫–∏: ${gameScore}`);
                    closeGame();
                }, 500);
            } else {
                if (num < guessNumber) {
                    guessMin = num + 1;
                    document.getElementById('guess-hint').innerHTML = `üìà <strong>–ë–û–õ–¨–®–ï!</strong><br>–ù–æ–≤—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω: ${guessMin}-${guessMax}`;
                } else {
                    guessMax = num - 1;
                    document.getElementById('guess-hint').innerHTML = `üìâ <strong>–ú–ï–ù–¨–®–ï!</strong><br>–ù–æ–≤—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω: ${guessMin}-${guessMax}`;
                }
                updateGuessDisplay();
            }
        }

        // üéÆ –£–ü–†–ê–í–õ–ï–ù–ò–ï
        document.addEventListener('keydown', (e) => {
            if (currentGame !== 'snake' || !gameRunning) return;
            
            switch(e.key) {
                case 'ArrowUp': if (dy !== 1) { dx = 0; dy = -1; playSound('click'); } break;
                case 'ArrowDown': if (dy !== -1) { dx = 0; dy = 1; playSound('click'); } break;
                case 'ArrowLeft': if (dx !== 1) { dx = -1; dy = 0; playSound('click'); } break;
                case 'ArrowRight': if (dx !== -1) { dx = 1; dy = 0; playSound('click'); } break;
            }
        });

        // –°–í–ê–ô–ü–´ (–º–æ–±–∏–ª—å–Ω—ã–µ)
        gameCanvas.addEventListener('touchstart', (e) => {
            touchStartX = e.touches[0].clientX;
            touchStartY = e.touches[0].clientY;
        });

        gameCanvas.addEventListener('touchend', (e) => {
            if (currentGame !== 'snake') return;
            const touchEndX = e.changedTouches[0].clientX;
            const touchEndY = e.changedTouches[0].clientY;
            const diffX = touchStartX - touchEndX;
            const diffY = touchStartY - touchEndY;

            if (Math.abs(diffX) > Math.abs(diffY) && Math.abs(diffX) > 50) {
                if (diffX > 0 && dx !== 1) { dx = -1; dy = 0; playSound('click'); }
                else if (diffX < 0 && dx !== -1) { dx = 1; dy = 0; playSound('click'); }
            } else if (Math.abs(diffY) > 50) {
                if (diffY > 0 && dy !== 1) { dx = 0; dy = -1; playSound('click'); }
                else if (diffY < 0 && dy !== -1) { dx = 0; dy = 1; playSound('click'); }
            }
        });

        // –ö–ª–∏–∫ –ø–æ canvas –¥–ª—è —É–≥–∞–¥–∞–π–∫–∏
        gameCanvas.addEventListener('click', () => {
            if (currentGame === 'guess') {
                playSound('click');
                guessInput();
            }
        });

        // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª–∫—É –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ (–¥–µ–º–æ)
        setTimeout(() => {
            if (currentUser === '–ì–æ—Å—Ç—å') {
                setTimeout(() => {
                    if (confirm('üöÄ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ ALEKSIN GAMES!\n\n–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Å—è –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤!')) {
                        toggleAuth();
                    }
                }, 2000);
            }
        }, 1000);
    </script>
</body>
</html>
