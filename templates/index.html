<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üöÄ ALEKSIN GAMING UNIVERSE v4.2 üöÄ</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap');
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:'Orbitron',monospace;background:linear-gradient(135deg,#0a0a23 0%,#1a0a3a 50%,#000 100%);color:#00ffcc;min-height:100vh;overflow-x:hidden;position:relative}
        .stars{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:1}
        .star{position:absolute;background:#fff;border-radius:50%;animation:twinkle 2s infinite}
        @keyframes twinkle{0%,100%{opacity:0.3}50%{opacity:1}}
        .container{max-width:1400px;margin:0 auto;padding:20px;position:relative;z-index:10}
        .title{font-size:clamp(2.5rem,8vw,5rem);text-align:center;margin:30px 0;background:linear-gradient(45deg,#ff00ff,#00ffcc,#ffff00);-webkit-background-clip:text;-webkit-text-fill-color:transparent;text-shadow:0 0 40px #00ffcc}
        
        .glass{background:rgba(255,255,255,0.08);backdrop-filter:blur(20px);border:2px solid rgba(0,255,204,0.4);border-radius:25px;padding:30px;margin:20px 0;box-shadow:0 20px 60px rgba(0,0,0,0.6);transition:all 0.3s}
        .glass:hover{transform:translateY(-8px);box-shadow:0 30px 80px rgba(0,255,204,0.5);border-color:#00ffcc}
        input,select,button{font-family:'Orbitron',sans-serif;padding:15px 25px;font-size:1.1rem;border:2px solid rgba(0,255,204,0.5);border-radius:15px;background:rgba(0,0,0,0.6);color:#00ffcc;transition:all 0.3s}
        input:focus{outline:none;border-color:#00ffcc;box-shadow:0 0 25px rgba(0,255,204,0.6)}
        button{font-weight:700;text-transform:uppercase;letter-spacing:1px;cursor:pointer}
        button:hover{transform:scale(1.05);box-shadow:0 0 25px rgba(0,255,204,0.6)}
        button:disabled{background:#444;color:#666;cursor:not-allowed;transform:none}
        .btn-danger{background:linear-gradient(45deg,#ff416c,#ff4b2b);color:#fff}
        .games-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(350px,1fr));gap:25px;margin:30px 0}
        .game-title{font-size:1.8rem;margin-bottom:20px;background:linear-gradient(45deg,#00ffcc,#ff00ff);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
        canvas{border:3px solid rgba(0,255,204,0.7);border-radius:20px;background:rgba(0,15,40,0.95);box-shadow:0 0 40px rgba(0,255,204,0.4);margin:20px auto;display:block}
        .stats{display:flex;justify-content:space-around;margin:20px 0;font-size:1.2rem;font-weight:700;flex-wrap:wrap}
        .tabs{display:flex;flex-wrap:wrap;gap:15px;margin:20px 0}
        .tab-btn{padding:12px 25px;background:rgba(0,255,204,0.1);border:2px solid rgba(0,255,204,0.3);border-radius:10px;cursor:pointer}
        .tab-btn.active{background:#00ffcc;color:#000;border-color:#00ffcc;font-weight:700}
        .leaderboard-table{width:100%;border-collapse:collapse;font-size:1rem;margin:15px 0}
        th,td{padding:15px;background:rgba(0,255,204,0.1);border-bottom:1px solid rgba(0,255,204,0.2);text-align:center}
        th{background:rgba(0,255,204,0.2)}
        .tournament-timer{font-size:1.5rem;text-align:center;margin:15px 0;color:#ffff00;text-shadow:0 0 15px #ffff00}
        .hidden{display:none!important}
        .user-status{position:fixed;top:20px;right:20px;background:rgba(0,255,204,0.15);backdrop-filter:blur(20px);padding:15px 25px;border:2px solid rgba(0,255,204,0.5);border-radius:20px;z-index:100;box-shadow:0 10px 40px rgba(0,255,204,0.3)}
        .status-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px;font-size:0.9rem;color:#88ddff}
        .error{color:#ff4444;font-weight:700}
        .success{color:#00ff88;font-weight:700}
        @media(max-width:768px){.games-grid{grid-template-columns:1fr}.tabs{flex-direction:column}}
    </style>
</head>
<body>
    <div id="userStatus" class="user-status hidden">
        <div style="font-size:1.4rem;font-weight:700;color:#00ff88;margin-bottom:10px" id="currentNickname">-</div>
        <div class="status-grid">
            <span>‚≠ê <span id="userTotalScore">0</span></span>
            <span>‚öîÔ∏è <span id="userTournament">–ù–ï–¢</span></span>
        </div>
        <button class="logout-btn btn-danger" onclick="logoutUser()" style="margin-top:10px;width:100%">üö™ –í–´–•–û–î</button>
    </div>
    
    <div class="stars" id="stars"></div>
    <div class="container">
        <h1 class="title">üöÄ ALEKSIN GAMING UNIVERSE v4.2 - –í–°–Å –†–ê–ë–û–¢–ê–ï–¢! üöÄ</h1>
        
        <!-- ‚úÖ –°–£–ü–ï–† –ü–†–û–°–¢–ê–Ø –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø -->
        <div id="loginPanel" class="glass" style="max-width:500px;margin:100px auto;text-align:center">
            <h2 style="font-size:2.5rem;margin-bottom:30px">üéÆ –ù–ê–ß–ù–ò –ò–ì–†–£</h2>
            <input id="username" placeholder="üî• –í–≤–µ–¥–∏ –ª—é–±–æ–π –Ω–∏–∫ (3+ —Å–∏–º–≤–æ–ª–æ–≤)" style="width:100%;margin-bottom:20px">
            <button onclick="register()" style="width:100%;font-size:1.3rem">üöÄ –ò–ì–†–ê–¢–¨ –°–ï–ô–ß–ê–°</button>
            <div id="regStatus" style="margin-top:15px;font-size:1.1rem"></div>
            <div style="margin-top:20px;color:#88ddff">
                üíé –ü—Ä–∏–º–µ—Ä: <strong>alexin, pro_gamer, –∫–æ—Å–º–æ2026</strong>
            </div>
        </div>
        
        <!-- –ò–ì–†–´ -->
        <div id="gamesPanel" class="hidden">
            <div class="games-grid">
                <div class="glass">
                    <h3 class="game-title">üêç –ó–ú–ï–ô–ö–ê –ö–û–°–ú–û–° (0-29 –ø–∏–∫—Å–µ–ª–∏)</h3>
                    <select id="snakeDiff">
                        <option value="300-novice">üå± –õ–µ–≥–∫–æ (300–º—Å)</option>
                        <option value="200-pro" selected>‚ö° –°—Ä–µ–¥–Ω–µ (200–º—Å)</option>
                        <option value="120-legend">üî• –°–ª–æ–∂–Ω–æ (120–º—Å)</option>
                        <option value="80-master">üíé –ò–º–±–∞ (80–º—Å)</option>
                    </select><br><br>
                    <button onclick="startSnake()">üéÆ –ò–ì–†–ê–¢–¨</button>
                    <button class="btn-danger" onclick="stopSnake()">‚èπÔ∏è –°–¢–û–ü</button>
                    <canvas id="snakeCanvas" width="450" height="450" class="hidden"></canvas>
                    <div class="stats">
                        <span>üìä –°–µ–π—á–∞—Å: <span id="snakeScore">0</span></span>
                        <span>‚≠ê –†–µ–∫–æ—Ä–¥: <span id="snakeHigh">0</span></span>
                    </div>
                </div>
                
                <div class="glass">
                    <h3 class="game-title">üî¢ –£–ì–ê–î–ê–ô –ß–ò–°–õ–û</h3>
                    <select id="guessDiff">
                        <option value="100-easy">üå± 1-100</option>
                        <option value="1000-normal" selected>‚ö° 1-1000</option>
                        <option value="10000-hard">üî• 1-10000</option>
                        <option value="100000-insane">üíé 1-100000</option>
                    </select><br>
                    <input id="guessNum" type="number" placeholder="üéØ –£–≥–∞–¥–∞–π —á–∏—Å–ª–æ">
                    <br><button onclick="guessNumber()">üéØ –ü–†–û–í–ï–†–ò–¢–¨</button>
                    <button onclick="newGame()">üîÑ –ù–û–í–´–ô</button>
                    <div class="stats">
                        <span>üéØ –ü–æ–ø—ã—Ç–æ–∫: <span id="guessCount">0</span></span>
                        <span>üìä –î–∏–∞–ø–∞–∑–æ–Ω: <span id="guessRange">1-1000</span></span>
                    </div>
                    <div id="guessFeedback" style="margin-top:15px;padding:15px;background:rgba(0,255,204,0.1);border-radius:10px"></div>
                </div>
            </div>
            
            <!-- –¢–£–†–ù–ò–† -->
            <div class="glass">
                <h3 style="text-align:center;font-size:2rem;background:linear-gradient(45deg,#ffff00,#ff00ff);-webkit-background-clip:text;-webkit-text-fill-color:transparent">
                    ‚öîÔ∏è –¢–£–†–ù–ò–† 24/7 (x2 –û–ß–ö–ò)
                </h3>
                <div class="tournament-timer">
                    ‚è∞ –ê–∫—Ç–∏–≤–µ–Ω: <span id="tournamentStatus">–î–ê</span> | 
                    <button id="joinTournament" onclick="joinTournament()">‚öîÔ∏è –í –¢–£–†–ù–ò–† (x2 –æ—á–∫–∏)</button>
                </div>
                <button onclick="showLeaderboards()" style="margin-top:20px;width:100%;background:linear-gradient(45deg,#00ff88,#00cc66);font-size:1.2rem">üèÜ –†–ï–ô–¢–ò–ù–ì–ò</button>
            </div>
        </div>
        
        <!-- –õ–ò–î–ï–†–ë–û–†–î–´ -->
        <div id="leaderboards" class="hidden">
            <div class="tabs">
                <button class="tab-btn active" data-tab="main">üèÜ –û–°–ù–û–í–ù–û–ô –¢–û–ü-10</button>
                <button class="tab-btn" data-tab="snake">üêç –ó–ú–ï–ô–ö–ê</button>
                <button class="tab-btn" data-tab="guess">üî¢ –£–ì–ê–î–ê–ô–ö–ê</button>
                <button class="tab-btn" data-tab="tour">‚öîÔ∏è –¢–£–†–ù–ò–†</button>
            </div>
            
            <div id="mainTab" class="glass">
                <h3 style="text-align:center">üèÜ –ì–õ–ê–í–ù–´–ô –¢–û–ü-10 –ò–ì–†–û–ö–û–í</h3>
                <table class="leaderboard-table">
                    <thead><tr><th>–ú–µ—Å—Ç–æ</th><th>üë§ –ù–∏–∫</th><th>‚≠ê –û—á–∫–∏</th></tr></thead>
                    <tbody id="mainLeaderboard"></tbody>
                </table>
            </div>
            
            <div id="snakeTab" class="glass hidden">
                <h3 style="text-align:center">üêç –¢–û–ü –ó–ú–ï–ô–ö–ê –ü–û –°–õ–û–ñ–ù–û–°–¢–ò</h3>
                <table class="leaderboard-table">
                    <thead><tr><th>–°–ª–æ–∂–Ω–æ—Å—Ç—å</th><th>ü•á 1-–µ</th><th>ü•à 2-–µ</th><th>ü•â 3-–µ</th></tr></thead>
                    <tbody id="snakeLeaderboard"></tbody>
                </table>
            </div>
            
            <div id="guessTab" class="glass hidden">
                <h3 style="text-align:center">üî¢ –¢–û–ü –£–ì–ê–î–ê–ô–ö–ê –ü–û –°–õ–û–ñ–ù–û–°–¢–ò</h3>
                <table class="leaderboard-table">
                    <thead><tr><th>–°–ª–æ–∂–Ω–æ—Å—Ç—å</th><th>ü•á 1-–µ</th><th>ü•à 2-–µ</th><th>ü•â 3-–µ</th></tr></thead>
                    <tbody id="guessLeaderboard"></tbody>
                </table>
            </div>
            
            <div id="tourTab" class="glass hidden">
                <h3 style="text-align:center">‚öîÔ∏è –¢–£–†–ù–ò–†–ù–´–ô –¢–û–ü-10</h3>
                <table class="leaderboard-table">
                    <thead><tr><th>–ú–µ—Å—Ç–æ</th><th>üë§ –ù–∏–∫</th><th>üêç –ó–º–µ–π–∫–∞</th><th>üî¢ –£–≥–∞–¥–∞–π–∫–∞</th><th>‚≠ê –ò–¢–û–ì–û</th></tr></thead>
                    <tbody id="tourLeaderboard"></tbody>
                </table>
            </div>
            
            <button onclick="showGames()" class="btn-danger" style="margin:20px auto;display:block;width:300px;font-size:1.2rem">üéÆ –ö –ò–ì–†–ê–ú</button>
        </div>
    </div>

    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let currentUser = '';
        let snake = [{x:15,y:15}], snakeScore = 0, dx = 1, dy = 0, snakeActive = false;
        let guessNumber = 0, guessTries = 0, guessMax = 1000;
        let inTournament = false;
        const GRID_SIZE = 30; // 0-29 –ø–∏–∫—Å–µ–ª–∏
        
        // ‚úÖ –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø - –°–£–ü–ï–† –ü–†–û–°–¢–ê–Ø
        function register() {
            let username = document.getElementById('username').value.trim();
            let status = document.getElementById('regStatus');
            
            if(username.length < 3) {
                status.innerHTML = '<span class="error">‚ùå –ú–∏–Ω–∏–º—É–º 3 —Å–∏–º–≤–æ–ª–∞!</span>';
                return;
            }
            
            if(username.length > 20) {
                status.innerHTML = '<span class="error">‚ùå –ú–∞–∫—Å–∏–º—É–º 20 —Å–∏–º–≤–æ–ª–æ–≤!</span>';
                return;
            }
            
            currentUser = username.substring(0,20);
            localStorage.setItem('currentPlayer', currentUser);
            
            status.innerHTML = `<span class="success">‚úÖ ${currentUser} - –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</span>`;
            
            setTimeout(() => {
                document.getElementById('loginPanel').classList.add('hidden');
                document.getElementById('gamesPanel').classList.remove('hidden');
                initGame();
            }, 1000);
        }
        
        // ‚úÖ –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø
        function initGame() {
            createStars();
            loadPlayerData();
            updateLeaderboards();
            newGuessGame();
            updateStatus();
            setInterval(updateLeaderboards, 2000);
        }
        
        function createStars() {
            const stars = document.getElementById('stars');
            for(let i = 0; i < 100; i++) {
                let star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.animationDelay = Math.random() * 2 + 's';
                stars.appendChild(star);
            }
        }
        
        function loadPlayerData() {
            let saved = localStorage.getItem('currentPlayer');
            if(saved && !currentUser) {
                currentUser = saved;
                document.getElementById('username').value = currentUser;
            }
        }
        
        // ‚úÖ –ó–ú–ï–ô–ö–ê –° –ü–†–ê–í–ò–õ–¨–ù–´–ú–ò –ì–†–ê–ù–ò–¶–ê–ú–ò 0-29
        function startSnake() {
            if(snakeActive || !currentUser) return;
            
            snakeActive = true;
            snakeScore = 0;
            snake = [{x:15, y:15}];
            dx = 1; dy = 0;
            
            const canvas = document.getElementById('snakeCanvas');
            const ctx = canvas.getContext('2d');
            canvas.classList.remove('hidden');
            
            let food = {x: Math.floor(Math.random() * GRID_SIZE), y: Math.floor(Math.random() * GRID_SIZE)};
            
            const diff = document.getElementById('snakeDiff').value.split('-')[1];
            const speeds = {novice: 300, pro: 200, legend: 120, master: 80};
            const speed = speeds[diff];
            const category = `snake-${diff}`;
            
            let gameLoop = setInterval(() => {
                ctx.fillStyle = '#0a1428';
                ctx.fillRect(0, 0, 450, 450);
                
                let head = {x: snake[0].x + dx, y: snake[0].y + dy};
                
                // ‚úÖ –¢–û–ß–ù–´–ï –ì–†–ê–ù–ò–¶–´ 0-29
                if(head.x < 0 || head.x >= GRID_SIZE || head.y < 0 || head.y >= GRID_SIZE || 
                   snake.find((part, index) => index > 0 && part.x === head.x && part.y === head.y)) {
                    clearInterval(gameLoop);
                    snakeActive = false;
                    canvas.classList.add('hidden');
                    
                    let finalScore = inTournament ? snakeScore * 2 : snakeScore;
                    saveScore(category, snakeScore, finalScore);
                    
                    document.getElementById('snakeScore').textContent = '0';
                    alert(`üíÄ GAME OVER\nüìä –°—á—ë—Ç: ${snakeScore}\n‚≠ê –û–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω—ã–π: ${finalScore}`);
                    return;
                }
                
                snake.unshift(head);
                
                if(head.x === food.x && head.y === food.y) {
                    snakeScore++;
                    food = {x: Math.floor(Math.random() * GRID_SIZE), y: Math.floor(Math.random() * GRID_SIZE)};
                    while(snake.find(p => p.x === food.x && p.y === food.y)) {
                        food = {x: Math.floor(Math.random() * GRID_SIZE), y: Math.floor(Math.random() * GRID_SIZE)};
                    }
                } else {
                    snake.pop();
                }
                
                document.getElementById('snakeScore').textContent = snakeScore;
                
                // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –µ–¥—ã
                ctx.fillStyle = '#ff00ff';
                ctx.beginPath();
                ctx.arc(food.x * 15 + 7.5, food.y * 15 + 7.5, 6, 0, Math.PI * 2);
                ctx.fill();
                
                // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –∑–º–µ–π–∫–∏
                snake.forEach((part, i) => {
                    ctx.fillStyle = i === 0 ? '#00ff88' : '#44aa88';
                    ctx.fillRect(part.x * 15 + 1, part.y * 15 + 1, 13, 13);
                });
                
            }, speed);
            
            document.addEventListener('keydown', (e) => {
                if(!snakeActive) return;
                if(e.key === 'ArrowUp' && dy !== 1) { dx = 0; dy = -1; }
                if(e.key === 'ArrowDown' && dy !== -1) { dx = 0; dy = 1; }
                if(e.key === 'ArrowLeft' && dx !== 1) { dx = -1; dy = 0; }
                if(e.key === 'ArrowRight' && dx !== -1) { dx = 1; dy = 0; }
            });
        }
        
        function stopSnake() {
            snakeActive = false;
            document.getElementById('snakeCanvas').classList.add('hidden');
        }
        
        // ‚úÖ –£–ì–ê–î–ê–ô–ö–ê
        function newGuessGame() {
            guessMax = parseInt(document.getElementById('guessDiff').value.split('-')[0]);
            guessNumber = Math.floor(Math.random() * guessMax) + 1;
            guessTries = 0;
            document.getElementById('guessCount').textContent = '0';
            document.getElementById('guessRange').textContent = `1-${guessMax.toLocaleString()}`;
            document.getElementById('guessFeedback').innerHTML = 'üéØ –ó–∞–≥–∞–¥–∞–ª–∏ —á–∏—Å–ª–æ! –£–≥–∞–¥–∞–π!';
        }
        
        function guessNumber() {
            if(!currentUser) return;
            
            let guess = parseInt(document.getElementById('guessNum').value);
            let diff = document.getElementById('guessDiff').value.split('-')[1];
            let category = `guess-${diff}`;
            
            if(!guess || guess < 1 || guess > guessMax) {
                document.getElementById('guessFeedback').innerHTML = `<span class="error">‚ùå –ß–∏—Å–ª–æ –æ—Ç 1 –¥–æ ${guessMax}</span>`;
                return;
            }
            
            guessTries++;
            document.getElementById('guessCount').textContent = guessTries;
            
            if(guess === guessNumber) {
                let score = Math.max(0, 10000 - guessTries * 25);
                let finalScore = inTournament ? score * 2 : score;
                saveScore(category, score, finalScore);
                document.getElementById('guessFeedback').innerHTML = `<span class="success">üéâ –£–ì–ê–î–ê–õ –∑–∞ ${guessTries} –ø–æ–ø—ã—Ç–æ–∫! +${finalScore} –æ—á–∫–æ–≤</span>`;
                setTimeout(newGuessGame, 2000);
            } else {
                let diff = Math.abs(guessNumber - guess);
                if(diff <= 5) {
                    document.getElementById('guessFeedback').innerHTML = guess < guessNumber ? 'üî• –û–ß–ï–ù–¨ –±–ª–∏–∑–∫–æ! ‚ûï‚ûï‚ûï' : 'üî• –û–ß–ï–ù–¨ –±–ª–∏–∑–∫–æ! ‚ûñ‚ûñ‚ûñ';
                } else if(diff <= 20) {
                    document.getElementById('guessFeedback').innerHTML = guess < guessNumber ? 'üå°Ô∏è –ë–ª–∏–∑–∫–æ! ‚ûï‚ûï' : 'üå°Ô∏è –ë–ª–∏–∑–∫–æ! ‚ûñ‚ûñ';
                } else {
                    document.getElementById('guessFeedback').innerHTML = guess < guessNumber ? '‚ûï –ë–æ–ª—å—à–µ!' : '‚ûñ –ú–µ–Ω—å—à–µ!';
                }
            }
            document.getElementById('guessNum').value = '';
        }
        
        // ‚úÖ –°–û–•–†–ê–ù–ï–ù–ò–ï –û–ß–ö–û–í
        function saveScore(category, baseScore, finalScore) {
            let scores = JSON.parse(localStorage.getItem(category) || '[]');
            scores = scores.filter(s => s.user !== currentUser);
            scores.unshift({user: currentUser, score: finalScore, date: new Date().toLocaleString('ru-RU')});
            scores.sort((a, b) => b.score - a.score);
            localStorage.setItem(category, JSON.stringify(scores.slice(0, 100)));
            
            if(inTournament) {
                updateTournamentScore(finalScore, category.includes('snake') ? 'snake' : 'guess');
            }
        }
        
        // ‚úÖ –¢–£–†–ù–ò–†
        function joinTournament() {
            inTournament = !inTournament;
            localStorage.setItem(`tournament-${currentUser}`, inTournament);
            
            let btn = document.getElementById('joinTournament');
            btn.innerHTML = inTournament ? '‚úÖ –í –¢–£–†–ù–ò–†–ï (x2)' : '‚öîÔ∏è –í –¢–£–†–ù–ò–† (x2)';
            btn.style.background = inTournament ? '#00ff88' : '';
            
            document.getElementById('userTournament').textContent = inTournament ? 'x2 ‚úÖ' : '–ù–ï–¢';
        }
        
        function updateTournamentScore(score, game) {
            let tourData = JSON.parse(localStorage.getItem(`tour-${currentUser}`) || '{}');
            tourData[game] = (tourData[game] || 0) + score;
            tourData.total = (tourData.total || 0) + score;
            localStorage.setItem(`tour-${currentUser}`, JSON.stringify(tourData));
        }
        
        // ‚úÖ –õ–ò–î–ï–†–ë–û–†–î–´
        function updateLeaderboards() {
            updateMainLeaderboard();
            updateSnakeLeaderboard();
            updateGuessLeaderboard();
            updateTourLeaderboard();
        }
        
        function updateMainLeaderboard() {
            let allScores = [];
            ['snake-novice','snake-pro','snake-legend','snake-master','guess-easy','guess-normal','guess-hard','guess-insane'].forEach(cat => {
                let scores = JSON.parse(localStorage.getItem(cat) || '[]');
                scores.slice(0, 3).forEach(s => allScores.push({...s, cat}));
            });
            
            allScores.sort((a, b) => b.score - a.score);
            let unique = [];
            let seen = new Set();
            allScores.forEach(s => {
                if(!seen.has(s.user)) {
                    unique.push(s);
                    seen.add(s.user);
                }
            });
            
            let html = unique.slice(0, 10).map((s, i) => 
                `<tr><td>${i+1} ${i<3?'ü•áü•àü•â'[i]:''}</td><td><strong>${s.user}</strong></td><td>${s.score.toLocaleString()}</td></tr>`
            ).join('');
            
            if(!html) html = '<tr><td colspan="3">–ü–æ–∫–∞ –Ω–µ—Ç –∏–≥—Ä–æ–∫–æ–≤ üò¢</td></tr>';
            document.getElementById('mainLeaderboard').innerHTML = html;
        }
        
        function updateSnakeLeaderboard() {
            let html = '';
            ['novice','pro','legend','master'].forEach((level, i) => {
                let scores = JSON.parse(localStorage.getItem(`snake-${level}`) || '[]');
                html += `<tr>
                    <td>${['üå±','‚ö°','üî•','üíé'][i]} ${level.toUpperCase()}</td>
                    <td>${scores[0]?.user || '-'} ${scores[0]?.score || 0}</td>
                    <td>${scores[1]?.user || '-'} ${scores[1]?.score || 0}</td>
                    <td>${scores[2]?.user || '-'} ${scores[2]?.score || 0}</td>
                </tr>`;
            });
            document.getElementById('snakeLeaderboard').innerHTML = html;
        }
        
        function updateGuessLeaderboard() {
            let html = '';
            ['easy','normal','hard','insane'].forEach((level, i) => {
                let scores = JSON.parse(localStorage.getItem(`guess-${level}`) || '[]');
                html += `<tr>
                    <td>${['üå±','‚ö°','üî•','üíé'][i]} ${level.toUpperCase()}</td>
                    <td>${scores[0]?.user || '-'} ${scores[0]?.score || 0}</td>
                    <td>${scores[1]?.user || '-'} ${scores[1]?.score || 0}</td>
                    <td>${scores[2]?.user || '-'} ${scores[2]?.score || 0}</td>
                </tr>`;
            });
            document.getElementById('guessLeaderboard').innerHTML = html;
        }
        
        function updateTourLeaderboard() {
            let tourData = [];
            for(let i = 0; i < localStorage.length; i++) {
                let key = localStorage.key(i);
                if(key.startsWith('tour-')) {
                    let data = JSON.parse(localStorage.getItem(key));
                    tourData.push({user: key.replace('tour-', ''), ...data});
                }
            }
            tourData.sort((a, b) => (b.total || 0) - (a.total || 0));
            
            let html = tourData.slice(0, 10).map((s, i) => 
                `<tr><td>${i+1}</td><td><strong>${s.user}</strong></td><td>${s.snake || 0}</td><td>${s.guess || 0}</td><td>${s.total || 0}</td></tr>`
            ).join('');
            
            if(!html) html = '<tr><td colspan="5">–ù–∏–∫—Ç–æ –Ω–µ –≤ —Ç—É—Ä–Ω–∏—Ä–µ</td></tr>';
            document.getElementById('tourLeaderboard').innerHTML = html;
        }
        
        function updateStatus() {
            if(!currentUser) return;
            
            let total = 0;
            ['snake-novice','snake-pro','snake-legend','snake-master','guess-easy','guess-normal','guess-hard','guess-insane'].forEach(cat => {
                let scores = JSON.parse(localStorage.getItem(cat) || '[]');
                let userScore = scores.find(s => s.user === currentUser);
                if(userScore) total += userScore.score;
            });
            
            document.getElementById('currentNickname').textContent = currentUser;
            document.getElementById('userTotalScore').textContent = total.toLocaleString();
            document.getElementById('userTournament').textContent = inTournament ? 'x2 ‚úÖ' : '–ù–ï–¢';
            document.getElementById('userStatus').classList.remove('hidden');
            
            inTournament = localStorage.getItem(`tournament-${currentUser}`) === 'true';
            let btn = document.getElementById('joinTournament');
            btn.innerHTML = inTournament ? '‚úÖ –í –¢–£–†–ù–ò–†–ï (x2)' : '‚öîÔ∏è –í –¢–£–†–ù–ò–† (x2)';
            btn.style.background = inTournament ? '#00ff88' : '';
        }
        
        function showLeaderboards() {
            document.getElementById('gamesPanel').classList.add('hidden');
            document.getElementById('leaderboards').classList.remove('hidden');
            updateLeaderboards();
        }
        
        function showGames() {
            document.getElementById('leaderboards').classList.add('hidden');
            document.getElementById('gamesPanel').classList.remove('hidden');
        }
        
        function logoutUser() {
            currentUser = '';
            localStorage.removeItem('currentPlayer');
            document.getElementById('gamesPanel').classList.add('hidden');
            document.getElementById('leaderboards').classList.add('hidden');
            document.getElementById('loginPanel').classList.remove('hidden');
            document.getElementById('userStatus').classList.add('hidden');
            snakeActive = false;
        }
        
        window.onload = () => {
            let savedUser = localStorage.getItem('currentPlayer');
            if(savedUser) {
                currentUser = savedUser;
                document.getElementById('username').value = currentUser;
                register();
            }
        };
    </script>
</body>
</html>
