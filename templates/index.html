<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üöÄ ALEKSIN GAMES HUB v2.2 ‚úÖ</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap');
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:'Orbitron',monospace;background:linear-gradient(135deg,#0a0a23 0%,#1a0a3a 50%,#000 100%);color:#00ffcc;min-height:100vh;overflow-x:hidden}
        .container{max-width:1200px;margin:0 auto;padding:20px;position:relative}
        h1{font-size:clamp(2rem,5vw,4rem);text-align:center;background:linear-gradient(45deg,#00ffcc,#ff00ff,#00ffff);background-size:300% 300%;-webkit-background-clip:text;-webkit-text-fill-color:transparent;animation:gradient 3s ease infinite;text-shadow:0 0 30px rgba(0,255,204,0.5)}
        @keyframes gradient{0%,100%{background-position:0% 50%}50%{background-position:100% 50%}}
        
        .status-display{text-align:center;margin:20px 0;font-size:1.5rem;}
        .auth-buttons{display:flex;justify-content:center;gap:10px;flex-wrap:wrap;}
        .btn{display:inline-block;padding:12px 20px;background:linear-gradient(45deg,#00ffcc,#ff00ff);border:none;border-radius:10px;color:#000;font-weight:700;font-size:1rem;cursor:pointer;transition:all 0.3s;font-family:'Orbitron',monospace;text-transform:uppercase;margin:5px;flex:1;max-width:200px}
        .btn:hover{background:linear-gradient(45deg,#ff00ff,#00ffcc);transform:scale(1.05)}
        .btn-logout{background:linear-gradient(45deg,#ff4444,#ff6666)!important;}
        .btn-register{background:linear-gradient(45deg,#ffaa00,#ffcc00)!important;}
        
        .auth-form{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(0,0,0,0.9);backdrop-filter:blur(30px);padding:40px;border-radius:20px;border:2px solid #00ffcc;box-shadow:0 0 50px rgba(0,255,204,0.5);z-index:1000;width:90%;max-width:400px}
        .form-group{margin-bottom:20px}
        .form-group label{display:block;margin-bottom:8px;color:#00ffcc;font-weight:700}
        .form-group input{width:100%;padding:12px;border:2px solid rgba(0,255,204,0.3);border-radius:8px;background:rgba(255,255,255,0.1);color:#00ffcc;font-family:'Orbitron',monospace;font-size:16px}
        .form-group input:focus{outline:none;border-color:#00ffcc;box-shadow:0 0 15px rgba(0,255,204,0.5)}

        .game-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(320px,1fr));gap:20px;margin:40px 0}
        .game-card{background:rgba(255,255,255,0.05);backdrop-filter:blur(15px);border-radius:20px;padding:25px;border:1px solid rgba(0,255,204,0.2);transition:all 0.3s ease;box-shadow:0 8px 32px rgba(0,0,0,0.3);position:relative;overflow:hidden}
        .game-card::before{content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(0,255,204,0.2),transparent);transition:0.5s}
        .game-card:hover::before{left:100%}
        .game-card:hover{transform:translateY(-10px);box-shadow:0 20px 40px rgba(0,255,204,0.3)}
        #snakeCanvas{display:block;margin:20px auto;border:3px solid #00ffcc;border-radius:10px;background:#000;box-shadow:0 0 30px rgba(0,255,204,0.5)}
        .hidden{display:none!important}

        .leaderboard,.tournament{margin-top:40px}
        .table-container{background:rgba(0,0,0,0.5);backdrop-filter:blur(10px);border-radius:15px;overflow:hidden;border:1px solid rgba(0,255,204,0.3);margin:20px 0}
        table{width:100%;border-collapse:collapse}
        th,td{padding:12px;text-align:center;color:#00ffcc}
        th{background:linear-gradient(90deg,#00ffcc,#ff00ff);color:#000;font-weight:700}
        .top-1{background:linear-gradient(45deg,#ffd700,#ffed4e);color:#000}
        .top-2{background:linear-gradient(45deg,#c0c0c0,#e5e5e5);color:#000}
        .top-3{background:linear-gradient(45deg,#cd7f32,#deb887);color:#000}
        .timer{font-size:1.5rem;text-align:center;font-weight:700;color:#ff4444;text-shadow:0 0 20px #ff4444;margin:15px 0}
        
        @media (max-width:768px){.game-grid{grid-template-columns:1fr;gap:15px}}
    </style>
</head>
<body>
    <div class="container">
        <h1>üöÄ ALEKSIN GAMES HUB v2.2</h1>
        
        <!-- –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø -->
        <div class="status-display">
            üëã <span id="userStatus">–ì–æ—Å—Ç—å</span>
            <div class="auth-buttons">
                <button class="btn" onclick="showLogin()">üîê –í–û–ô–¢–ò</button>
                <button class="btn btn-register" onclick="showRegister()">üìù –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø</button>
                <button class="btn btn-logout" id="logoutBtn" onclick="logout()" style="display:none;">üö™ –í–´–ô–¢–ò</button>
            </div>
        </div>

        <!-- –ú–û–î–ê–õ–ö–ê -->
        <div id="authModal" class="auth-form hidden">
            <h3 id="authTitle">üîê –í—Ö–æ–¥</h3>
            <div class="form-group">
                <label>üë§ –õ–æ–≥–∏–Ω (–º–∏–Ω–∏–º—É–º 3 —Å–∏–º–≤–æ–ª–∞)</label>
                <input type="text" id="usernameInput" placeholder="test">
            </div>
            <div class="form-group">
                <label>üîë –ü–∞—Ä–æ–ª—å (–º–∏–Ω–∏–º—É–º 4 —Å–∏–º–≤–æ–ª–∞)</label>
                <input type="password" id="passwordInput" placeholder="123456">
            </div>
            <button class="btn" onclick="handleAuth()">‚úÖ –ì–û–¢–û–í–û</button>
            <button class="btn btn-logout" onclick="closeAuth()" style="margin-top:10px">‚úï –û–¢–ú–ï–ù–ê</button>
        </div>

        <!-- –ò–ì–†–´ -->
        <div class="game-grid">
            <div class="game-card">
                <h3>üêç –ó–º–µ–π–∫–∞ <span id="snakeDifficulty">(–ù–æ—Ä–º–∞–ª—å–Ω–∞—è)</span></h3>
                <div style="display:grid;gap:8px;margin:15px 0;">
                    <button class="btn" onclick="startSnake('easy')">üêå –õ—ë–≥–∫–∞—è (25x25, 200–º—Å)</button>
                    <button class="btn" onclick="startSnake('normal')">‚ö° –ù–æ—Ä–º–∞–ª—å–Ω–∞—è (20x20, 150–º—Å)</button>
                    <button class="btn" onclick="startSnake('hard')">üî• –°–ª–æ–∂–Ω–∞—è (15x15, 100–º—Å)</button>
                </div>
                <canvas id="snakeCanvas" width="400" height="400" class="hidden"></canvas>
                <div id="snakeScore" style="text-align:center;font-size:1.2rem;margin-top:10px;color:#00ffcc;">–°—á—ë—Ç: 0</div>
            </div>
            
            <div class="game-card">
                <h3>üéØ –£–≥–∞–¥–∞–π —á–∏—Å–ª–æ</h3>
                <div style="display:grid;gap:8px;margin:15px 0;">
                    <button class="btn" onclick="setDifficulty(1000)">–õ—ë–≥–∫–∞—è (1-1K)</button>
                    <button class="btn" onclick="setDifficulty(10000)">–°—Ä–µ–¥–Ω—è—è (1-10K)</button>
                    <button class="btn" onclick="setDifficulty(100000)">–°–ª–æ–∂–Ω–∞—è (1-100K)</button>
                </div>
                <div id="guessGame" class="hidden" style="margin-top:15px;">
                    <input type="number" id="guessInput" placeholder="–¢–≤–æ—ë —á–∏—Å–ª–æ" style="width:100%;padding:12px;margin:10px 0;border:2px solid #00ffcc;border-radius:8px;background:rgba(255,255,255,0.1);color:#00ffcc;">
                    <button class="btn" onclick="makeGuess()">üîç –£–ì–ê–î–ê–¢–¨</button>
                    <p id="guessHint" style="font-size:1.1rem;margin:10px 0;color:#ffaa00;"></p>
                    <p>–ü–æ–ø—ã—Ç–æ–∫: <span id="guessAttempts">0</span></p>
                </div>
            </div>
        </div>

        <!-- –ì–õ–û–ë–ê–õ–¨–ù–´–ô –¢–û–ü -->
        <div class="leaderboard">
            <h2>üèÜ –ì–õ–û–ë–ê–õ–¨–ù–´–ô –¢–û–ü-10</h2>
            <div class="table-container">
                <table id="globalLeaderboard">
                    <thead><tr><th>–ú–µ—Å—Ç–æ</th><th>–ò–≥—Ä–æ–∫</th><th>–û—á–∫–∏</th></tr></thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <!-- –¢–£–†–ù–ò–† -->
        <div class="tournament">
            <h2>‚öîÔ∏è –¢–£–†–ù–ò–† 24—á (00:00 –ú–°–ö)</h2>
            <div class="timer" id="tournamentTimer">‚è∞ –ó–∞–≥—Ä—É–∑–∫–∞...</div>
            <div class="table-container">
                <table id="tournamentTable">
                    <thead><tr><th>–¢–æ–ø-5</th><th>–ò–≥—Ä–æ–∫</th><th>–û—á–∫–∏</th></tr></thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        // –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï
        let currentUser = localStorage.getItem('currentUser') || null;
        let scores = JSON.parse(localStorage.getItem('scores')) || {};
        let snakeGame = null;
        let guessGame = {target:0, difficulty:1000, attempts:0};
        let touchStartX = 0, touchStartY = 0;

        // üêç –ó–ú–ï–ô–ö–ê –° –°–õ–û–ñ–ù–û–°–¢–Ø–ú–ò (–ó–ê–ú–ï–î–õ–ï–ù–ù–ê–Ø)
        function startSnake(difficulty = 'normal') {
            if (!currentUser) { alert('‚ùå –°–Ω–∞—á–∞–ª–∞ –≤–æ–π–¥–∏!'); return; }
            
            const canvas = document.getElementById('snakeCanvas');
            const ctx = canvas.getContext('2d');
            canvas.classList.remove('hidden');
            
            // –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø –°–õ–û–ñ–ù–û–°–¢–ï–ô
            const difficulties = {
                easy: {name:'easy', grid:16, speed:250, size:25},
                normal: {name:'normal', grid:20, speed:150, size:20},
                hard: {name:'hard', grid:26, speed:100, size:15}
            };
            const config = difficulties[difficulty] || difficulties.normal;
            
            document.getElementById('snakeDifficulty').textContent = `(${config.name.toUpperCase()})`;
            
            snakeGame = {
                snake: [{x:10,y:10}], dx:1, dy:0,
                food: {x:15,y:15}, score:0,
                grid: config.grid, speed: config.speed,
                canvas, ctx, config,
                lastMove: 0
            };
            
            document.getElementById('snakeScore').textContent = `üêç ${config.name.toUpperCase()}: 0`;
            requestAnimationFrame(gameLoop);
        }

        function gameLoop(time) {
            if (!snakeGame || time - snakeGame.lastMove < snakeGame.speed) {
                requestAnimationFrame(gameLoop);
                return;
            }
            snakeGame.lastMove = time;
            
            const {ctx, canvas, snake, dx, dy, food, grid, score, config} = snakeGame;
            
            // –û–ß–ò–°–¢–ö–ê
            ctx.fillStyle = '#000';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // –ï–î–ê
            ctx.fillStyle = '#ff4444';
            ctx.shadowColor = '#ff4444'; ctx.shadowBlur = 20;
            ctx.fillRect(food.x*grid, food.y*grid, grid-3, grid-3);
            ctx.shadowBlur = 0;
            
            // –ó–ú–ï–ô–ö–ê
            snake.forEach((part, i) => {
                ctx.fillStyle = i === 0 ? '#00ffcc' : '#00aa88';
                ctx.shadowColor = i === 0 ? '#00ffcc' : '#00aa88';
                ctx.shadowBlur = i === 0 ? 25 : 10;
                ctx.fillRect(part.x*grid, part.y*grid, grid-3, grid-3);
            });
            ctx.shadowBlur = 0;
            
            // –î–í–ò–ñ–ï–ù–ò–ï
            const head = {x: snake[0].x + dx, y: snake[0].y + dy};
            
            // –ì–†–ê–ù–ò–¶–´ + –ö –û–î–ù–û–ú–£ –°–ï–ë–ï
            if (head.x < 0 || head.x >= snakeGame.grid || head.y < 0 || head.y >= snakeGame.grid || 
                snake.some((part, i) => i > 0 && part.x === head.x && part.y === head.y)) {
                endSnakeGame();
                return;
            }
            
            snake.unshift(head);
            
            if (head.x === food.x && head.y === food.y) {
                snakeGame.score++;
                document.getElementById('snakeScore').textContent = `üêç ${snakeGame.config.name.toUpperCase()}: ${snakeGame.score}`;
                food.x = Math.floor(Math.random() * snakeGame.grid);
                food.y = Math.floor(Math.random() * snakeGame.grid);
            } else {
                snake.pop();
            }
            
            requestAnimationFrame(gameLoop);
        }

        function endSnakeGame() {
            if (snakeGame?.score > 0) {
                saveScore(`snake_${snakeGame.config.name}`, snakeGame.score);
            }
            snakeGame = null;
            document.getElementById('snakeCanvas').classList.add('hidden');
            document.getElementById('snakeScore').textContent = '–°—á—ë—Ç: 0';
            document.getElementById('snakeDifficulty').textContent = '(–ù–æ—Ä–º–∞–ª—å–Ω–∞—è)';
        }

        // üéØ –£–ì–ê–î–ê–ô–ö–ê (1K, 10K, 100K)
        function setDifficulty(max) {
            if (!currentUser) { alert('‚ùå –°–Ω–∞—á–∞–ª–∞ –≤–æ–π–¥–∏!'); return; }
            guessGame.target = Math.floor(Math.random() * max) + 1;
            guessGame.difficulty = max;
            guessGame.attempts = 0;
            document.getElementById('guessGame').classList.remove('hidden');
            document.getElementById('guessHint').textContent = `üéØ –ß–∏—Å–ª–æ –æ—Ç 1 –¥–æ ${max.toLocaleString()}`;
            document.getElementById('guessInput').value = '';
            document.getElementById('guessInput').focus();
        }

        function makeGuess() {
            const input = document.getElementById('guessInput');
            const guess = parseInt(input.value);
            
            if (!guess || guess < 1 || guess > guessGame.difficulty) {
                document.getElementById('guessHint').textContent = `‚ùå –û—Ç 1 –¥–æ ${guessGame.difficulty.toLocaleString()}`;
                return;
            }
            
            guessGame.attempts++;
            document.getElementById('guessAttempts').textContent = guessGame.attempts;
            
            if (guess === guessGame.target) {
                document.getElementById('guessHint').innerHTML = `üéâ –£–ì–ê–î–ê–õ –∑–∞ <strong>${guessGame.attempts}</strong> –ø–æ–ø—ã—Ç–æ–∫!`;
                saveScore(`guess_${guessGame.difficulty}`, guessGame.attempts);
                setTimeout(() => {
                    document.getElementById('guessGame').classList.add('hidden');
                }, 2000);
            } else if (guess < guessGame.target) {
                document.getElementById('guessHint').textContent = '‚ûï –ë–æ–ª—å—à–µ! üî•';
            } else {
                document.getElementById('guessHint').textContent = '‚ûñ –ú–µ–Ω—å—à–µ! ‚ùÑÔ∏è';
            }
            input.value = '';
            input.focus();
        }

        // üíæ –°–û–•–†–ê–ù–ï–ù–ò–ï
        function saveScore(type, score) {
            if (!currentUser) return;
            scores[currentUser] = scores[currentUser] || {};
            scores[currentUser][type] = Math.max(scores[currentUser][type] || 999999, score);
            localStorage.setItem('scores', JSON.stringify(scores));
            updateLeaderboards();
            updateTournamentTable();
        }

        // üèÜ –¢–û–ü–´ –ü–û –ò–ì–†–ê–ú –ò –°–õ–û–ñ–ù–û–°–¢–Ø–ú
        function updateLeaderboards() {
            // –ì–ª–æ–±–∞–ª—å–Ω—ã–π —Ç–æ–ø (–≤—Å–µ –∏–≥—Ä—ã)
            const globalScores = {};
            Object.entries(scores).forEach(([user, games]) => {
                const total = Object.values(games).reduce((sum, s) => sum + (1000000 / s), 0);
                globalScores[user] = total;
            });
            
            const sortedGlobal = Object.entries(globalScores)
                .sort(([,a], [,b]) => b - a)
                .slice(0, 10);
            
            const tbody = document.querySelector('#globalLeaderboard tbody');
            tbody.innerHTML = sortedGlobal.length ? 
                sortedGlobal.map(([user, score], i) => 
                    `<tr class="${i < 3 ? 'top-' + (i+1) : ''}"><td>${i+1}üèÜ</td><td>${user}</td><td>${Math.round(score)}</td></tr>`
                ).join('') : 
                '<tr><td colspan="3">–ü–æ–∫–∞ –Ω–µ—Ç —Ä–µ–∫–æ—Ä–¥–æ–≤</td></tr>';
        }

        // ‚öîÔ∏è –¢–£–†–ù–ò–†–ù–ê–Ø –¢–ê–ë–õ–ò–¶–ê (–¢–û–ü-5)
        function updateTournamentTable() {
            const tournamentScores = {};
            Object.entries(scores).forEach(([user, games]) => {
                const total = Object.values(games).reduce((sum, s) => sum + (1000000 / s), 0);
                tournamentScores[user] = total;
            });
            
            const sorted = Object.entries(tournamentScores)
                .sort(([,a], [,b]) => b - a)
                .slice(0, 5);
            
            const tbody = document.querySelector('#tournamentTable tbody');
            tbody.innerHTML = sorted.length ? 
                sorted.map(([user, score], i) => 
                    `<tr class="top-${i+1}"><td>${i+1}‚öîÔ∏è</td><td>${user}</td><td>${Math.round(score)}</td></tr>`
                ).join('') : 
                '<tr><td colspan="3">–¢—É—Ä–Ω–∏—Ä —Å–∫–æ—Ä–æ –Ω–∞—á–Ω—ë—Ç—Å—è</td></tr>';
        }

        // ‚è∞ –¢–ê–ô–ú–ï–† –¢–£–†–ù–ò–†–ê (00:00 –ú–°–ö)
        function updateTournament() {
            const now = new Date();
            const mskOffset = 3 * 60 * 60 * 1000; // MSK +3
            const mskTime = new Date(now.getTime() + mskOffset);
            const daySeconds = mskTime.getHours() * 3600 + mskTime.getMinutes() * 60 + mskTime.getSeconds();
            const secondsLeft = 86400 - daySeconds; // 24 —á–∞—Å–∞ = 86400 —Å–µ–∫—É–Ω–¥
            
            const hours = Math.floor(secondsLeft / 3600);
            const minutes = Math.floor((secondsLeft % 3600) / 60);
            document.getElementById('tournamentTimer').textContent = `‚è∞ –î–æ –∫–æ–Ω—Ü–∞: ${hours}—á ${minutes}–º`;
        }

        // üîê –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø
        function showLogin() {
            document.getElementById('authTitle').textContent = 'üîê –í—Ö–æ–¥';
            document.getElementById('authModal').classList.remove('hidden');
            document.getElementById('usernameInput').focus();
        }

        function showRegister() {
            document.getElementById('authTitle').textContent = 'üìù –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è';
            document.getElementById('authModal').classList.remove('hidden');
            document.getElementById('usernameInput').focus();
        }

        function handleAuth() {
            const username = document.getElementById('usernameInput').value.trim();
            const password = document.getElementById('passwordInput').value;
            
            if (username.length < 3) {
                alert('‚ùå –õ–æ–≥–∏–Ω –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–ª–∏–Ω–Ω–µ–µ 3 —Å–∏–º–≤–æ–ª–æ–≤!');
                return;
            }
            if (password.length < 4) {
                alert('‚ùå –ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–ª–∏–Ω–Ω–µ–µ 4 —Å–∏–º–≤–æ–ª–æ–≤!');
                return;
            }
            
            currentUser = username;
            localStorage.setItem('currentUser', username);
            
            document.getElementById('userStatus').textContent = username;
            document.getElementById('logoutBtn').style.display = 'inline-block';
            document.getElementById('authModal').classList.add('hidden');
            
            document.getElementById('usernameInput').value = '';
            document.getElementById('passwordInput').value = '';
            
            updateLeaderboards();
            updateTournamentTable();
            alert(`‚úÖ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ${username}! üéÆ`);
        }

        function closeAuth() {
            document.getElementById('authModal').classList.add('hidden');
            document.getElementById('usernameInput').value = '';
            document.getElementById('passwordInput').value = '';
        }

        function logout() {
            currentUser = null;
            localStorage.removeItem('currentUser');
            document.getElementById('userStatus').textContent = '–ì–æ—Å—Ç—å';
            document.getElementById('logoutBtn').style.display = 'none';
            document.getElementById('snakeCanvas').classList.add('hidden');
            document.getElementById('guessGame').classList.add('hidden');
            snakeGame = null;
            document.getElementById('snakeScore').textContent = '–°—á—ë—Ç: 0';
            document.getElementById('snakeDifficulty').textContent = '(–ù–æ—Ä–º–∞–ª—å–Ω–∞—è)';
            updateLeaderboards();
            updateTournamentTable();
        }

        // üéÆ –£–ü–†–ê–í–õ–ï–ù–ò–ï –ó–ú–ï–ô–ö–û–ô
        document.addEventListener('DOMContentLoaded', function() {
            // –ö–õ–ê–í–ò–ê–¢–£–†–ê
            document.addEventListener('keydown', function(e) {
                if (!snakeGame) return;
                e.preventDefault();
                switch(e.code) {
                    case 'ArrowUp': 
                        if (snakeGame.dy !== 1) { snakeGame.dy = -1; snakeGame.dx = 0; }
                        break;
                    case 'ArrowDown': 
                        if (snakeGame.dy !== -1) { snakeGame.dy = 1; snakeGame.dx = 0; }
                        break;
                    case 'ArrowLeft': 
                        if (snakeGame.dx !== 1) { snakeGame.dx = -1; snakeGame.dy = 0; }
                        break;
                    case 'ArrowRight': 
                        if (snakeGame.dx !== -1) { snakeGame.dx = 1; snakeGame.dy = 0; }
                        break;
                }
            });

            // –°–í–ê–ô–ü–´
            const canvas = document.getElementById('snakeCanvas');
            canvas.addEventListener('touchstart', function(e) {
                e.preventDefault();
                touchStartX = e.touches[0].clientX;
                touchStartY = e.touches[0].clientY;
            }, { passive: false });

            canvas.addEventListener('touchend', function(e) {
                e.preventDefault();
                if (!snakeGame) return;
                
                const touchEndX = e.changedTouches[0].clientX;
                const touchEndY = e.changedTouches[0].clientY;
                const diffX = touchStartX - touchEndX;
                const diffY = touchStartY - touchEndY;
                
                if (Math.abs(diffX) > Math.abs(diffY) && Math.abs(diffX) > 30) {
                    if (diffX > 0 && snakeGame.dx !== 1) { snakeGame.dx = -1; snakeGame.dy = 0; }
                    else if (diffX < 0 && snakeGame.dx !== -1) { snakeGame.dx = 1; snakeGame.dy = 0; }
                } else if (Math.abs(diffY) > 30) {
                    if (diffY > 0 && snakeGame.dy !== 1) { snakeGame.dx = 0; snakeGame.dy = -1; }
                    else if (diffY < 0 && snakeGame.dy !== -1) { snakeGame.dx = 0; snakeGame.dy = 1; }
                }
            }, { passive: false });
        });

        // üöÄ –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø
        window.onload = function() {
            if (currentUser) {
                document.getElementById('userStatus').textContent = currentUser;
                document.getElementById('logoutBtn').style.display = 'inline-block';
            }
            
            updateLeaderboards();
            updateTournament();
            updateTournamentTable();
            
            // –ê–í–¢–û–û–ë–ù–û–í–õ–ï–ù–ò–ï
            setInterval(updateLeaderboards, 5000);
            setInterval(updateTournament, 1000);
            
            // ENTER –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
            document.addEventListener('keypress', function(e) {
                if (e.key === 'Enter' && !document.getElementById('authModal').classList.contains('hidden')) {
                    handleAuth();
                }
            });
        };
    </script>
</body>
</html>
