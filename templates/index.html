<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéÆ ALEKSIN GAMES HUB 2026 ‚ú®</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Exo+2:wght@300;400;600;800&display=swap');
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Exo 2', sans-serif;
            background: linear-gradient(-45deg, #0f0f23, #1a0033, #330066, #0f0f23);
            color: #fff;
            min-height: 100vh;
            overflow-x: hidden;
            animation: bgShift 15s ease infinite;
            touch-action: none; /* üì± –ë–õ–û–ö–ò–†–£–ï–ú –ü–†–û–ö–†–£–¢–ö–£ */
        }
        @keyframes bgShift { 0%,100% {background-position: 0% 50%;} 50% {background-position: 100% 50%;} }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        h1 { 
            font-family: 'Orbitron', monospace; 
            font-size: clamp(2rem, 5vw, 3rem); 
            text-align: center; 
            margin-bottom: 30px; 
            background: linear-gradient(45deg, #ff00ff, #00ffff, #ffaa00); 
            -webkit-background-clip: text; 
            -webkit-text-fill-color: transparent; 
            text-shadow: 0 0 30px rgba(255,255,255,0.5);
            animation: glow 2s ease-in-out infinite alternate;
        }
        @keyframes glow { from {filter: drop-shadow(0 0 10px #00ffff);} to {filter: drop-shadow(0 0 20px #ff00ff);} }
        .section { 
            background: rgba(255,255,255,0.08); 
            backdrop-filter: blur(15px); 
            border-radius: 25px; 
            padding: 30px; 
            margin-bottom: 30px; 
            border: 1px solid rgba(255,255,255,0.15);
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            transition: all 0.3s;
        }
        button { 
            background: linear-gradient(45deg, #ff00ff, #00ffff); 
            border: none; 
            padding: 15px 30px; 
            border-radius: 50px; 
            color: #000; 
            font-weight: 700; 
            font-size: 1.1rem; 
            cursor: pointer; 
            transition: all 0.3s; 
            font-family: 'Orbitron', monospace;
            margin: 5px;
            box-shadow: 0 5px 15px rgba(0,255,255,0.3);
            touch-action: manipulation;
        }
        button:hover { transform: scale(1.05) translateY(-2px); box-shadow: 0 15px 30px rgba(255,0,255,0.5); }
        button:active { transform: scale(0.98); }
        input { 
            background: rgba(255,255,255,0.12); 
            border: 2px solid rgba(255,255,255,0.25); 
            padding: 18px; 
            border-radius: 15px; 
            color: #fff; 
            font-size: 1.1rem; 
            width: 220px; 
            margin: 10px; 
            backdrop-filter: blur(10px);
            transition: all 0.3s;
        }
        input:focus { outline: none; border-color: #00ffff; box-shadow: 0 0 20px rgba(0,255,255,0.5); }
        .top-list { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 15px; margin-top: 20px; }
        .top-item { 
            background: linear-gradient(135deg, rgba(0,255,255,0.15), rgba(255,0,255,0.15)); 
            padding: 20px; 
            border-radius: 20px; 
            text-align: center; 
            font-weight: 600;
            border: 1px solid rgba(255,255,255,0.2);
        }
        .medal { font-size: 2rem; display: block; margin-bottom: 10px; }
        canvas { 
            border: 4px solid #00ffff; 
            border-radius: 20px; 
            background: radial-gradient(circle, #000, #111); 
            display: block; 
            margin: 20px auto; 
            box-shadow: 0 20px 40px rgba(0,255,255,0.3);
            cursor: pointer;
            touch-action: none; /* üì± –ë–õ–û–ö–ò–†–£–ï–ú –ü–†–û–ö–†–£–¢–ö–£ –ù–ê –ö–ê–ù–í–ê–°–ï */
        }
        #userInfo { 
            position: fixed; 
            top: 20px; 
            right: 20px; 
            background: rgba(0,0,0,0.7); 
            backdrop-filter: blur(20px);
            padding: 20px; 
            border-radius: 20px; 
            font-weight: 700; 
            border: 2px solid #00ffff;
            min-width: 200px;
        }
        .hidden { display: none !important; }
        .status { padding: 15px; border-radius: 10px; margin: 15px 0; font-weight: 600; }
        .status.success { background: rgba(0,255,0,0.2); border-left: 5px solid #00ff00; }
        .status.error { background: rgba(255,0,0,0.2); border-left: 5px solid #ff4444; }
        @media (max-width: 768px) { 
            .container { padding: 15px; } 
            h1 { font-size: 2rem; margin-bottom: 20px; } 
            input { width: calc(100% - 30px); }
            canvas { width: 90vw; height: 40vh; max-width: 450px; max-height: 450px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéÆ ALEKSIN GAMES HUB 2026 ‚ú®</h1>
        
        <!-- üîê –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø -->
        <div id="authSection" class="section">
            <h2 style="font-family: 'Orbitron'; font-size: 1.8rem; margin-bottom: 25px;">üîê –í–•–û–î / –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø</h2>
            <input id="usernameInput" placeholder="üë§ –ù–∏–∫ (test)" type="text">
            <input id="passwordInput" placeholder="üîë –ü–∞—Ä–æ–ª—å (1234)" type="password">
            <br>
            <button onclick="login()">üöÄ –í–û–ô–¢–ò</button>
            <button onclick="register()">üìù –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø</button>
            <div id="authStatus" class="status"></div>
        </div>

        <!-- üéÆ –ò–ì–†–´ -->
        <div id="gamesSection" class="hidden">
            <div class="section">
                <h2 style="font-family: 'Orbitron';">üêç –ó–ú–ï–ô–ö–ê ULTRA (3 —É—Ä–æ–≤–Ω—è)</h2>
                <div style="display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; margin-bottom: 20px;">
                    <button onclick="setSnakeDifficulty(1)">üêå –õ–Å–ì–ö–ê–Ø</button>
                    <button onclick="setSnakeDifficulty(2)">‚ö° –ù–û–†–ú–ê–õ–¨–ù–ê–Ø</button>
                    <button onclick="setSnakeDifficulty(3)">üöÄ –•–ê–†–î–ö–û–†</button>
                </div>
                <canvas id="snakeCanvas" width="450" height="450"></canvas>
                <div style="text-align: center; font-size: 1.3rem; margin: 15px 0;">
                    –°—á—ë—Ç: <span id="snakeScore" style="color: #00ff00; font-family: Orbitron; font-weight: 900; font-size: 1.5rem;">0</span>
                </div>
                <button id="startSnakeBtn" onclick="startSnake()" style="display:none; font-size: 1.3rem;">‚ñ∂Ô∏è –ù–û–í–ê–Ø –ò–ì–†–ê</button>
                <div style="font-size: 0.9rem; opacity: 0.8; text-align: center;">
                    ‚å®Ô∏è –°—Ç—Ä–µ–ª–∫–∏/WASD | üì± –°–≤–∞–π–ø—ã | üñ±Ô∏è –ö–ª–∏–∫ –ø–æ canvas
                </div>
            </div>

            <div class="section">
                <h2 style="font-family: 'Orbitron';">üéØ –£–ì–ê–î–ê–ô –ß–ò–°–õ–û (—É–º–Ω—ã–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏)</h2>
                <div style="display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; margin-bottom: 20px;">
                    <button onclick="setGuessDifficulty(1)">1Ô∏è‚É£ 1-1 000</button>
                    <button onclick="setGuessDifficulty(2)">2Ô∏è‚É£ 1-10 000</button>
                    <button onclick="setGuessDifficulty(3)">3Ô∏è‚É£ 1-100 000</button>
                </div>
                <input id="guessInput" placeholder="üî¢ –í–≤–µ–¥–∏ —á–∏—Å–ª–æ" onkeypress="if(event.key==='Enter') checkGuess()">
                <div id="guessFeedback" style="font-size: 1.3rem; margin: 20px 0; min-height: 60px; line-height: 1.4;"></div>
                <div style="text-align: center; font-size: 1.2rem;">
                    –ü–æ–ø—ã—Ç–æ–∫: <span id="guessAttempts" style="color: #ffaa00;">0</span> | 
                    –î–∏–∞–ø–∞–∑–æ–Ω: <span id="guessRange" style="color: #00ffff;">1-1000</span>
                </div>
                <div style="text-align: center;">
                    <button onclick="startGuessGame()">üîÑ –ù–û–í–ê–Ø –ò–ì–†–ê</button>
                    <button onclick="checkGuess()">‚úÖ –ü–†–û–í–ï–†–ò–¢–¨</button>
                </div>
            </div>
        </div>

        <!-- üèÜ –õ–ò–î–ï–†–ë–û–†–î–´ -->
        <div id="leaderboardsSection" class="hidden">
            <div class="section">
                <h2 style="font-family: 'Orbitron'; font-size: 2rem;">üèÜ –¢–û–ü-10 –†–ï–ö–û–†–î–´</h2>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                    <div><h3 style="color: #00ff00;">üêç –ó–ú–ï–ô–ö–ê</h3><div id="snakeTop10" class="top-list"></div></div>
                    <div><h3 style="color: #ffaa00;">üéØ –£–ì–ê–î–ê–ô–ö–ê</h3><div id="guessTop10" class="top-list"></div></div>
                </div>
            </div>
            <div class="section">
                <h2 style="font-family: 'Orbitron'; font-size: 2rem;">‚öîÔ∏è –¢–£–†–ù–ò–†–´ (00:00 MSK)</h2>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                    <div><h3 style="color: #00ff00;">üêç –ó–ú–ï–ô–ö–ê –¢–£–†–ù–ò–†</h3><div id="snakeTournament"></div></div>
                    <div><h3 style="color: #ffaa00;">üéØ –£–ì–ê–î–ê–ô–ö–ê –¢–£–†–ù–ò–†</h3><div id="guessTournament"></div></div>
                </div>
            </div>
        </div>
    </div>

    <div id="userInfo" class="hidden">
        <div id="currentUser" style="font-size: 1.3rem;"></div>
        <div id="liveStats" style="font-size: 0.9rem;"></div>
        <button onclick="logout()">üö™ –í–´–•–û–î</button>
    </div>

    <script>
        let currentUser = '', snakeDifficulty = 1, guessDifficulty = 1;
        let guessNumber = 0, guessAttempts = 0, lastGuessedNumber = 0;
        let snakeScore = 0, gameInterval = null, snake = [], dx = 0, dy = 0, food = {};
        let tops = { snakeTop10: [], guessTop10: [] }, tournaments = { snake: {}, guess: {} }, tournamentStart = Date.now();
        let registeredUsers = JSON.parse(localStorage.getItem('registeredUsers') || '{}');

        // üîß –§–ò–ö–° –ó–ú–ï–ô–ö–ò + –ö–†–ê–°–û–¢–ê + üì±/üñ•Ô∏è –ë–ï–ó –ü–†–û–ö–†–£–¢–ö–ò
        function loadData() {
            tops.snakeTop10 = JSON.parse(localStorage.getItem('snakeTop10') || '[]');
            tops.guessTop10 = JSON.parse(localStorage.getItem('guessTop10') || '[]');
            tournaments.snake = JSON.parse(localStorage.getItem('snakeTournament') || '{}');
            tournaments.guess = JSON.parse(localStorage.getItem('guessTournament') || '{}');
            tournamentStart = parseInt(localStorage.getItem('tournamentStart') || Date.now());
        }

        function saveData(key, data) { localStorage.setItem(key, JSON.stringify(data)); }

        // üîê –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø (–ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–ô)
        function login() {
            const username = document.getElementById('usernameInput').value.trim();
            const password = document.getElementById('passwordInput').value;
            const status = document.getElementById('authStatus');
            if (registeredUsers[username] && registeredUsers[username] === password) {
                currentUser = username; showGames(); 
                status.innerHTML = `‚úÖ ${username} –≤–æ—à—ë–ª!`; status.className = 'status success';
            } else { status.innerHTML = '‚ùå –ù–µ–≤–µ—Ä–Ω–æ'; status.className = 'status error'; }
        }

        function register() {
            const username = document.getElementById('usernameInput').value.trim();
            const password = document.getElementById('passwordInput').value;
            const status = document.getElementById('authStatus');
            if (username && password.length >= 4) {
                if (registeredUsers[username]) { status.innerHTML = 'üë§ –£–∂–µ –µ—Å—Ç—å!'; status.className = 'status error'; return; }
                registeredUsers[username] = password; saveData('registeredUsers', registeredUsers);
                status.innerHTML = `üìù ${username} –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω!`; status.className = 'status success';
            }
        }

        function logout() {
            if (confirm('–í—ã–π—Ç–∏?')) {
                currentUser = ''; ['gamesSection','leaderboardsSection','userInfo'].forEach(id => document.getElementById(id).classList.add('hidden'));
                document.getElementById('authSection').classList.remove('hidden');
            }
        }

        function showGames() {
            ['authSection'].forEach(id => document.getElementById(id).classList.add('hidden'));
            ['gamesSection','leaderboardsSection','userInfo'].forEach(id => document.getElementById(id).classList.remove('hidden'));
            document.getElementById('currentUser').innerHTML = `üëë ${currentUser.toUpperCase()}`;
            loadData(); updateAllTops(); setInterval(saveAllData, 10000);
        }

        // üêç –ó–ú–ï–ô–ö–ê ULTRA HD (üé® –ö–†–ê–°–ò–í–ê–Ø + üì± –§–ò–ö–°)
        function setSnakeDifficulty(level) {
            snakeDifficulty = level;
            const levels = ['üêå –õ–Å–ì–ö–ê–Ø (200ms)', '‚ö° –ù–û–†–ú–ê–õ–¨–ù–ê–Ø (150ms)', 'üöÄ –•–ê–†–î–ö–û–† (100ms)'];
            alert(`üêç ${levels[level-1]}`);
        }

        function startSnake() {
            const canvas = document.getElementById('snakeCanvas');
            const ctx = canvas.getContext('2d');
            canvas.width = 450; canvas.height = 450;
            
            // üÜï –ü–ï–†–ï–ó–ê–ü–£–°–ö
            if (gameInterval) clearInterval(gameInterval);
            snake = [{x: 11, y: 11}]; dx = 0; dy = 0; snakeScore = 0;
            food = {x: Math.floor(Math.random()*21)+1, y: Math.floor(Math.random()*21)+1};
            
            document.getElementById('snakeScore').textContent = '0';
            document.getElementById('startSnakeBtn').style.display = 'none';
            
            const grid = 21; // 21x21 –ø–æ–ª–µ
            const speeds = [200, 150, 100];
            const speed = speeds[snakeDifficulty-1];

            // üéÆ –û–°–ù–û–í–ù–û–ô –¶–ò–ö–õ
            gameInterval = setInterval(() => {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                // üêç –î–í–ò–ñ–ï–ù–ò–ï –ì–õ–ê–í–´
                const head = {x: snake[0].x + dx, y: snake[0].y + dy};
                
                // üí• –ö–†–ê–°–ò–í–´–ô GAME OVER
                if (head.x < 1 || head.x > 20 || head.y < 1 || head.y > 20 || 
                    snake.some((part, i) => i > 0 && part.x === head.x && part.y === head.y)) {
                    
                    saveSnakeScore(Math.floor(snakeScore));
                    
                    // üé® –≠–§–§–ï–ö–¢ –í–ó–†–´–í–ê
                    ctx.fillStyle = 'rgba(255, 50, 50, 0.8)';
                    ctx.shadowColor = '#ff4444'; ctx.shadowBlur = 50;
                    ctx.font = 'bold 60px Orbitron'; ctx.textAlign = 'center';
                    ctx.fillText('üíÄ', canvas.width/2, canvas.height/2);
                    ctx.font = 'bold 32px Orbitron'; ctx.fillText(`${Math.floor(snakeScore)}`, canvas.width/2, canvas.height/2 + 40);
                    ctx.shadowBlur = 0;
                    
                    clearInterval(gameInterval);
                    document.getElementById('startSnakeBtn').style.display = 'block';
                    return;
                }
                
                snake.unshift(head);
                
                // üçé –°–™–ï–õ –ï–î–£
                if (head.x === food.x && head.y === food.y) {
                    snakeScore += 15 * snakeDifficulty;
                    food = {x: Math.floor(Math.random()*19)+1, y: Math.floor(Math.random()*19)+1};
                } else {
                    snake.pop();
                }
                
                // üåà –ì–†–ê–î–ò–ï–ù–¢–ù–ê–Ø –ó–ú–ï–ô–ö–ê (–£–õ–´–ë–ö–ê ‚ú®)
                snake.forEach((part, i) => {
                    const alpha = i / snake.length;
                    const gradient = ctx.createRadialGradient(part.x*grid, part.y*grid, 0, part.x*grid, part.y*grid, grid);
                    gradient.addColorStop(0, `rgba(0, 255, 100, ${0.9+alpha*0.3})`);
                    gradient.addColorStop(1, `rgba(0, 150, 50, ${0.6+alpha*0.2})`);
                    ctx.fillStyle = gradient;
                    ctx.shadowColor = '#00ff88'; ctx.shadowBlur = 15;
                    ctx.beginPath();
                    ctx.arc(part.x*grid+grid/2, part.y*grid+grid/2, grid/2-1, 0, Math.PI*2);
                    ctx.fill();
                });
                
                // ‚ú® –ë–õ–ï–°–¢–Ø–©–ï–ï –Ø–ë–õ–û–ö–û
                const appleGradient = ctx.createRadialGradient(food.x*grid+grid/2, food.y*grid+grid/2, 0, food.x*grid+grid/2, food.y*grid+grid/2, grid/2);
                appleGradient.addColorStop(0, '#ff6666'); appleGradient.addColorStop(0.7, '#ff2222'); appleGradient.addColorStop(1, '#cc0000');
                ctx.shadowColor = '#ff4444'; ctx.shadowBlur = 30;
                ctx.fillStyle = appleGradient;
                ctx.beginPath();
                ctx.arc(food.x*grid+grid/2, food.y*grid+grid/2, grid/2-2, 0, Math.PI*2);
                ctx.fill();
                ctx.shadowBlur = 0;
                
                // ‚ö° –ú–û–õ–ù–ò–ò –î–õ–Ø –•–ê–†–î–ö–û–†–ê
                if (snakeDifficulty === 3) {
                    ctx.strokeStyle = '#ffff00'; ctx.lineWidth = 2; ctx.shadowColor = '#ffff00'; ctx.shadowBlur = 10;
                    ctx.beginPath(); ctx.moveTo(0, 0); ctx.lineTo(canvas.width, canvas.height); ctx.stroke();
                }
                
                document.getElementById('snakeScore').textContent = Math.floor(snakeScore);
                
            }, speed);

            // ‚å®Ô∏è –£–ü–†–ê–í–õ–ï–ù–ò–ï (–ü–ö)
            const onKeyDown = (e) => {
                e.preventDefault();
                if (e.key === 'ArrowUp' && dy !== 1) { dx = 0; dy = -1; }
                if (e.key === 'ArrowDown' && dy !== -1) { dx = 0; dy = 1; }
                if (e.key === 'ArrowLeft' && dx !== 1) { dx = -1; dy = 0; }
                if (e.key === 'ArrowRight' && dx !== -1) { dx = 1; dy = 0; }
                if (e.key === 'w' && dy !== 1) { dx = 0; dy = -1; }
                if (e.key === 's' && dy !== -1) { dx = 0; dy = 1; }
                if (e.key === 'a' && dx !== 1) { dx = -1; dy = 0; }
                if (e.key === 'd' && dx !== -1) { dx = 1; dy = 0; }
            };
            
            // üì± –°–í–ê–ô–ü–´ (–§–ò–ö–° –ü–†–û–ö–†–£–¢–ö–ò)
            let startX, startY;
            const onTouchStart = (e) => {
                e.preventDefault();
                startX = e.touches[0].clientX;
                startY = e.touches[0].clientY;
            };
            
            const onTouchEnd = (e) => {
                e.preventDefault();
                if (!startX || !startY) return;
                const endX = e.changedTouches[0].clientX;
                const endY = e.changedTouches[0].clientY;
                const diffX = startX - endX;
                const diffY = startY - endY;
                
                if (Math.abs(diffX) > Math.abs(diffY) && Math.abs(diffX) > 30) {
                    if (diffX > 0 && dx !== 1) { dx = -1; dy = 0; }  // ‚Üê
                    else if (diffX < 0 && dx !== -1) { dx = 1; dy = 0; } // ‚Üí
                } else if (Math.abs(diffY) > 30) {
                    if (diffY > 0 && dy !== 1) { dx = 0; dy = -1; }  // ‚Üë
                    else if (diffY < 0 && dy !== -1) { dx = 0; dy = 1; } // ‚Üì
                }
                startX = startY = null;
            };
            
            // üñ±Ô∏è –ö–õ–ò–ö –ú–´–®–¨–Æ
            const onClick = (e) => {
                e.preventDefault();
                const rect = canvas.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                const grid = 21;
                const targetX = Math.floor(x / (canvas.width / grid));
                const targetY = Math.floor(y / (canvas.height / grid));
                
                if (targetX > snake[0].x && dx !== -1) { dx = 1; dy = 0; }
                else if (targetX < snake[0].x && dx !== 1) { dx = -1; dy = 0; }
                else if (targetY > snake[0].y && dy !== -1) { dx = 0; dy = 1; }
                else if (targetY < snake[0].y && dy !== 1) { dx = 0; dy = -1; }
            };

            // üéÆ –ü–†–ò–í–Ø–ó–ö–ê –°–û–ë–´–¢–ò–ô
            window.addEventListener('keydown', onKeyDown);
            canvas.addEventListener('touchstart', onTouchStart, { passive: false });
            canvas.addEventListener('touchend', onTouchEnd, { passive: false });
            canvas.addEventListener('click', onClick);
        }

        // üéØ –£–ì–ê–î–ê–ô–ö–ê –° –ü–û–î–†–û–ë–ù–´–ú–ò –ü–û–î–°–ö–ê–ó–ö–ê–ú–ò
        function setGuessDifficulty(level) {
            guessDifficulty = level;
            const ranges = ['1-1 000', '1-10 000', '1-100 000'];
            document.getElementById('guessRange').textContent = ranges[level-1];
        }

        function startGuessGame() {
            const ranges = [1000, 10000, 100000];
            guessNumber = Math.floor(Math.random() * ranges[guessDifficulty-1]) + 1;
            guessAttempts = 0; lastGuessedNumber = 0;
            document.getElementById('guessFeedback').innerHTML = 'üéØ –ß–∏—Å–ª–æ –∑–∞–≥–∞–¥–∞–Ω–æ! –ü–æ–ø—Ä–æ–±—É–π —É–≥–∞–¥–∞—Ç—å!';
            document.getElementById('guessAttempts').textContent = '0';
        }

        function checkGuess() {
            if (!guessNumber) {
                document.getElementById('guessFeedback').innerHTML = '‚ö†Ô∏è –ù–∞–∂–º–∏ "–ù–æ–≤–∞—è –∏–≥—Ä–∞" —Å–Ω–∞—á–∞–ª–∞!';
                return;
            }
            
            const guess = parseInt(document.getElementById('guessInput').value) || 0;
            if (guess <= 0) {
                document.getElementById('guessFeedback').innerHTML = '‚ùå –í–≤–µ–¥–∏ —á–∏—Å–ª–æ –±–æ–ª—å—à–µ 0!';
                return;
            }
            
            lastGuessedNumber = guess;
            guessAttempts++;
            
            if (guess === guessNumber) {
                const ranges = [1000, 10000, 100000];
                const score = Math.floor(ranges[guessDifficulty-1] / guessAttempts * 15);
                saveGuessScore(score);
                document.getElementById('guessFeedback').innerHTML = 
                    `üéâ –ü–û–ó–î–†–ê–í–õ–Ø–ï–ú! –£–≥–∞–¥–∞–ª –∑–∞ <strong style="color:#00ff00">${guessAttempts}</strong> –ø–æ–ø—ã—Ç–æ–∫!<br>
                    üèÜ –û—á–∫–∏: <strong style="color:#ffaa00">${score}</strong><br>
                    üìä –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å: <strong>${Math.floor(10000/guessAttempts)}%</strong>`;
                return;
            }
            
            // üß† –£–ú–ù–´–ï –ü–û–î–°–ö–ê–ó–ö–ò
            const diff = Math.abs(guess - guessNumber);
            let feedback = '';
            
            if (diff <= 5) {
                feedback = `üî•üî• –°–£–ü–ï–† –ë–õ–ò–ó–ö–û –∫ ${guess}! (${diff} –æ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ)`;
            } else if (diff <= 25) {
                feedback = `üî• –û—á–µ–Ω—å –±–ª–∏–∑–∫–æ –∫ ${guess}! –ï—â—ë —á—É—Ç—å-—á—É—Ç—å!`;
            } else if (diff <= 100) {
                feedback = `üå°Ô∏è –¢–µ–ø–ª–æ! ${guess < guessNumber ? '‚û°Ô∏è –ë–æ–ª—å—à–µ' : '‚¨ÖÔ∏è –ú–µ–Ω—å—à–µ'} ${guess}`;
            } else {
                feedback = `${guess < guessNumber ? 'üìà –ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –±–æ–ª—å—à–µ' : 'üìâ –ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –º–µ–Ω—å—à–µ'} ${guess}`;
            }
            
            if (guessAttempts >= 10) {
                feedback += `<br><small>üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞: –ø–æ–ø—Ä–æ–±—É–π –¥–∏–∞–ø–∞–∑–æ–Ω ${Math.min(guess*2, guessNumber*1.5)}-${Math.max(guess/2, guessNumber*0.5)}</small>`;
            }
            
            document.getElementById('guessFeedback').innerHTML = feedback;
            document.getElementById('guessAttempts').textContent = guessAttempts;
            document.getElementById('guessInput').value = '';
        }

        // üíé –°–û–•–†–ê–ù–ï–ù–ò–ï
        function saveSnakeScore(score) {
            let top = tops.snakeTop10; top.push({user: currentUser, score});
            top.sort((a,b) => b.score - a.score); tops.snakeTop10 = top.slice(0,10);
            saveData('snakeTop10', tops.snakeTop10);
            tournaments.snake[currentUser] = (tournaments.snake[currentUser] || 0) + score;
            saveData('snakeTournament', tournaments.snake);
            updateAllTops();
        }

        function saveGuessScore(score) {
            let top = tops.guessTop10; top.push({user: currentUser, score});
            top.sort((a,b) => b.score - a.score); tops.guessTop10 = top.slice(0,10);
            saveData('guessTop10', tops.guessTop10);
            tournaments.guess[currentUser] = (tournaments.guess[currentUser] || 0) + score;
            saveData('guessTournament', tournaments.guess);
            updateAllTops();
        }

        function updateTop10(id, data) {
            document.getElementById(id).innerHTML = data.length ? 
                data.map((item,i) => `<div class="top-item"><span class="medal">${['ü•á','ü•à','ü•â','‚öúÔ∏è','‚öúÔ∏è'][i]||`${i+1}`}</span>${item.user}: ${item.score}</div>`).join('') :
                '<div class="top-item"><span class="medal">üëë</span>–ë–£–î–¨ –ü–ï–†–í–´–ú!</div>';
        }

        function updateTournament(game) {
            const tourn = game === 'snake' ? tournaments.snake : tournaments.guess;
            const sorted = Object.entries(tourn).sort((a,b) => b[1]-a[1]).slice(0,10);
            const now = new Date();
            const nextMidnight = new Date(now.getFullYear(), now.getMonth(), now.getDate()+1, 3,0,0);
            const timeLeft = Math.floor((nextMidnight-now)/60000);
            document.getElementById(`${game}Tournament`).innerHTML = `
                <div style="text-align:center;font-size:1.3rem;margin-bottom:15px;color:${game==='snake'?'#00ff00':'#ffaa00'}">
                    ‚è∞ ${Math.floor(timeLeft/60)}—á ${timeLeft%60}–º
                </div>
                <div class="top-list">${sorted.length ? sorted.map(([u,s],i)=>`<div class="top-item"><span class="medal">${['ü•á','ü•à','ü•â','üéÅ','üéÅ'][i] || i+1}</span>${u}: ${Math.floor(s)}üíé</div>`).join('') : '<div class="top-item">‚è≥ –ñ–¥—ë–º –∏–≥—Ä–æ–∫–æ–≤</div>'}</div>`;
        }

        function updateAllTops() {
            updateTop10('snakeTop10', tops.snakeTop10); updateTop10('guessTop10', tops.guessTop10);
            updateTournament('snake'); updateTournament('guess');
            if (currentUser) {
                document.getElementById('liveStats').innerHTML = 
                    `üêç ${tournaments.snake[currentUser]||0}üíé + üéØ ${tournaments.guess[currentUser]||0}üíé`;
            }
        }

        function saveAllData() { 
            saveData('registeredUsers', registeredUsers); 
            saveData('tops', tops); 
            saveData('tournaments', tournaments); 
        }

        window.onload = () => { loadData(); updateAllTops(); setInterval(updateAllTops, 3000); };
    </script>
</body>
</html>
