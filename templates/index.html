<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üåå ALEKSIN COSMIC GAMES HUB</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Exo+2:wght@300;400;600;800&display=swap');
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            background: radial-gradient(ellipse at center, #0a0a23 0%, #000428 50%, #000000 100%);
            font-family: 'Exo 2', sans-serif; color: #00ff88; min-height: 100vh;
            overflow-x: hidden; position: relative;
        }
        .stars { position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background-image: radial-gradient(2px 2px at 20px 30px, #eee, transparent), 
                              radial-gradient(2px 2px at 40px 70px, #fff, transparent),
                              radial-gradient(1px 1px at 90px 40px, #00ff88, transparent);
            background-repeat: repeat; background-size: 100px 100px;
            animation: twinkle 4s ease-in-out infinite alternate; z-index: -1;
        }
        @keyframes twinkle { 0%,100%{opacity:0.6} 50%{opacity:1} }
        
        .container { max-width: 1400px; margin: 0 auto; padding: 20px; display: grid; 
            grid-template-columns: 1fr 1fr 1fr; gap: 20px; }
        @media (max-width: 1200px) { .container { grid-template-columns: 1fr 1fr; } }
        @media (max-width: 768px) { .container { grid-template-columns: 1fr; } }
        
        .panel { background: rgba(0,255,136,0.15); backdrop-filter: blur(15px); 
            border: 2px solid rgba(0,255,136,0.4); border-radius: 25px; padding: 30px;
            box-shadow: 0 20px 40px rgba(0,255,136,0.2); }
        
        .user-info { position: fixed; top: 20px; right: 20px; background: rgba(0,0,0,0.9); 
            border: 2px solid #00ff88; padding: 15px 25px; border-radius: 50px; 
            font-weight: 800; font-size: 18px; z-index: 1000; }
        .user-info.hidden { display: none; }
        .logout-btn { background: linear-gradient(45deg, #ff0080, #00ff88); border: none; 
            color: black; padding: 10px 20px; border-radius: 25px; cursor: pointer; 
            margin-left: 15px; font-weight: bold; transition: all 0.3s; }
        .logout-btn:hover { transform: scale(1.1); box-shadow: 0 0 25px #ff0080; }
        
        h1 { font-family: 'Orbitron', monospace; font-size: 2.2em; text-align: center; 
            margin-bottom: 25px; background: linear-gradient(45deg, #00ff88, #0080ff, #ff0080); 
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            background-clip: text; animation: glow 2s ease-in-out infinite alternate; }
        @keyframes glow { 0% { filter: drop-shadow(0 0 5px #00ff88); } 100% { filter: drop-shadow(0 0 20px #00ff88); } }
        
        input { width: 100%; padding: 18px; margin: 12px 0; border: 3px solid #00ff88; 
            border-radius: 15px; background: rgba(0,0,0,0.8); color: #00ff88; 
            font-size: 18px; font-family: 'Exo 2', sans-serif; }
        input:focus { outline: none; box-shadow: 0 0 25px rgba(0,255,136,0.6); border-color: #ff0080; }
        
        button { width: 100%; padding: 18px; margin: 12px 0; background: linear-gradient(45deg, #00ff88, #0080ff); 
            border: none; border-radius: 15px; color: black; font-weight: 800; font-size: 20px; 
            cursor: pointer; transition: all 0.3s; font-family: 'Orbitron', monospace; }
        button:hover { transform: translateY(-3px); box-shadow: 0 15px 35px rgba(0,255,136,0.7); }
        
        .game-btn { display: block; padding: 25px 40px; margin: 15px 0; background: linear-gradient(45deg, #ff0080, #00ff88, #0080ff); 
            border-radius: 20px; color: white; text-decoration: none; font-weight: 800; font-size: 22px; 
            text-align: center; transition: all 0.4s; font-family: 'Orbitron', monospace; }
        .game-btn:hover { transform: scale(1.05); box-shadow: 0 20px 40px rgba(255,0,128,0.8); }
        
        canvas { border: 4px solid #00ff88; border-radius: 20px; background: rgba(0,0,0,0.95); 
            display: block; margin: 15px auto; box-shadow: 0 0 40px rgba(0,255,136,0.6); }
        
        .tournament-info { text-align: center; font-size: 20px; color: #ff0080; font-weight: 800; }
        .time-left { color: #00ff88; font-size: 28px; font-family: 'Orbitron', monospace; margin: 15px 0; }
        .leaderboard { max-height: 250px; overflow-y: auto; margin-top: 20px; }
        .leaderboard div { padding: 15px; border-bottom: 2px solid rgba(0,255,136,0.3); 
            display: flex; justify-content: space-between; font-weight: 600; 
            background: rgba(255,255,255,0.05); margin: 5px 0; border-radius: 10px; }
        .rank-1 { border-left: 5px solid gold; background: rgba(255,215,0,0.2) !important; }
        .rank-2 { border-left: 5px solid silver; background: rgba(192,192,192,0.2) !important; }
        .rank-3 { border-left: 5px solid #cd7f32; background: rgba(205,127,50,0.2) !important; }
        
        .score-display { text-align: center; font-size: 24px; font-weight: 800; color: #ffaa00; margin: 15px 0; }
        .hidden { display: none !important; }
    </style>
</head>
<body>
    <div class="stars"></div>
    
    <!-- –ù–ò–ö –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø -->
    <div class="user-info hidden" id="userInfo">
        üëë <span id="userNick"></span> | <button class="logout-btn" onclick="logoutUser()">üö™ –í—ã—Ö–æ–¥</button>
    </div>
    
    <div class="container">
        <!-- –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø -->
        <div class="panel" id="authPanel">
            <h1>üåå COSMIC HUB</h1>
            <div style="text-align: center;">
                <input type="text" id="regNick" placeholder="üöÄ –¢–≤–æ–π –Ω–∏–∫ (3+ —Å–∏–º–≤–æ–ª–æ–≤)" maxlength="12">
                <input type="password" id="regPass" placeholder="üîê –ü–∞—Ä–æ–ª—å (4+ —Å–∏–º–≤–æ–ª–æ–≤)">
                <button onclick="createAccount()">‚≠ê –°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç</button>
                <input type="text" id="loginNick" placeholder="üë§ –í—Ö–æ–¥ –ø–æ –Ω–∏–∫—É">
                <input type="password" id="loginPass" placeholder="üîë –ü–∞—Ä–æ–ª—å">
                <button onclick="loginUser()">‚úÖ –í–æ–π—Ç–∏</button>
            </div>
        </div>
        
        <!-- –û–°–ù–û–í–ù–û–ï –ú–ï–ù–Æ -->
        <div class="panel hidden" id="gamesPanel">
            <h1>üéÆ –ò–ì–†–´</h1>
            <a href="#" class="game-btn" onclick="showSnake(); return false;">üêç –ó–º–µ–π–∫–∞ Pro</a>
            <a href="#" class="game-btn" onclick="showGuessGame(); return false;">üéØ –£–≥–∞–¥–∞–π —á–∏—Å–ª–æ</a>
            <div style="text-align:center; margin-top:20px;">
                <span style="font-size:18px; color:#ffaa00;">–¢–≤–æ–∏ –æ—á–∫–∏: <span id="totalScore">0</span></span>
            </div>
        </div>
        
        <!-- –¢–£–†–ù–ò–† (2 –∏–≥—Ä—ã —Å—É–º–º–∏—Ä—É—é—Ç—Å—è) -->
        <div class="panel hidden" id="tournamentPanel">
            <h1>‚öîÔ∏è –¢–£–†–ù–ò–† –¢–û–ü-100</h1>
            <div class="tournament-info">
                <div>ü•áü•àü•â –ü—Ä–∏–∑—ã —Ç–æ–ø-3! –ó–º–µ–π–∫–∞+–£–≥–∞–¥–∞–π–∫–∞</div>
                <div class="time-left" id="tournamentTimer">--:--:--</div>
                <button class="game-btn" onclick="joinTournament()" style="width:100%; font-size:18px;">‚öîÔ∏è –í—Å—Ç—É–ø–∏—Ç—å –≤ —Ç—É—Ä–Ω–∏—Ä</button>
            </div>
            <div class="leaderboard" id="tournamentLeaderboard"></div>
        </div>
        
        <!-- –ó–ú–ï–ô–ö–ê -->
        <div class="panel hidden" id="snakePanel">
            <h1>üêç –ó–ú–ï–ô–ö–ê PRO</h1>
            <canvas id="snakeCanvas" width="450" height="450"></canvas>
            <div class="score-display">–û—á–∫–∏: <span id="snakeScore">0</span> | –†–µ–∫–æ—Ä–¥: <span id="snakeRecord">0</span></div>
            <div style="text-align:center;">
                <button onclick="startSnakeGame()" class="game-btn" style="width:48%; font-size:16px;">üîÑ –ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
                <button onclick="backToMenu()" class="game-btn" style="width:48%; font-size:16px; background:linear-gradient(45deg,#ff0080,#ff6600);">üè† –ú–µ–Ω—é</button>
            </div>
        </div>
        
        <!-- –£–ì–ê–î–ê–ô–ö–ê -->
        <div class="panel hidden" id="guessPanel">
            <h1>üéØ –£–ì–ê–î–ê–ô –ß–ò–°–õ–û</h1>
            <div style="text-align:center;">
                <div style="font-size:20px; margin-bottom:15px;">–£—Ä–æ–≤–µ–Ω—å <span id="guessLevel">1</span> (1-<span id="guessRange">1000</span>)</div>
                <input type="number" id="guessInput" placeholder="–í–≤–µ–¥–∏ —á–∏—Å–ª–æ" style="width:80%; margin:10px auto; display:block;">
                <button onclick="checkGuess()" class="game-btn" style="width:80%; font-size:18px;">üéØ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
                <div id="guessResult" style="font-size:22px; margin:20px 0; min-height:30px;"></div>
                <div class="score-display">–ü–æ–ø—ã—Ç–æ–∫: <span id="guessAttempts">0</span> | –†–µ–∫–æ—Ä–¥: <span id="guessRecord">‚àû</span></div>
                <div style="text-align:center;">
                    <button onclick="newGuessGame()" class="game-btn" style="width:48%; font-size:16px;">üîÑ –ù–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å</button>
                    <button onclick="backToMenu()" class="game-btn" style="width:48%; font-size:16px; background:linear-gradient(45deg,#ff0080,#ff6600);">üè† –ú–µ–Ω—é</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let currentUser = null;
        let userData = {};
        let snake = { game: null, score: 0, record: 0, canvas: null, ctx: null, running: false };
        let guess = { target: 0, level: 1, attempts: 0, min: 1, max: 1000 };
        let tournamentJoined = false;
        
        // –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
        const storage = {
            get(key) { try { return JSON.parse(localStorage.getItem(key) || 'null'); } catch { return null; } },
            set(key, value) { localStorage.setItem(key, JSON.stringify(value)); }
        };
        
        // –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø
        function createAccount() {
            const nick = document.getElementById('regNick').value.trim();
            const pass = document.getElementById('regPass').value;
            if (nick.length < 3) return alert('‚ùå –ù–∏–∫ –º–∏–Ω–∏–º—É–º 3 —Å–∏–º–≤–æ–ª–∞!');
            if (pass.length < 4) return alert('‚ùå –ü–∞—Ä–æ–ª—å –º–∏–Ω–∏–º—É–º 4 —Å–∏–º–≤–æ–ª–∞!');
            
            const users = storage.get('users') || {};
            if (users[nick]) return alert('‚ùå –ù–∏–∫ —É–∂–µ –∑–∞–Ω—è—Ç!');
            
            users[nick] = { password: btoa(pass), score: 0, tournament: false, joined: Date.now() };
            storage.set('users', users);
            alert('‚úÖ –ê–∫–∫–∞—É–Ω—Ç —Å–æ–∑–¥–∞–Ω! –¢–µ–ø–µ—Ä—å –≤–æ–π–¥–∏.');
            document.getElementById('regNick').value = '';
            document.getElementById('regPass').value = '';
        }
        
        function loginUser() {
            const nick = document.getElementById('loginNick').value.trim();
            const pass = document.getElementById('loginPass').value;
            const users = storage.get('users') || {};
            
            if (!users[nick] || users[nick].password !== btoa(pass)) {
                return alert('‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –Ω–∏–∫ –∏–ª–∏ –ø–∞—Ä–æ–ª—å!');
            }
            
            currentUser = nick;
            userData = users[nick];
            storage.set('lastUser', nick);
            showMainInterface();
        }
        
        function logoutUser() {
            currentUser = null;
            userData = {};
            document.getElementById('userInfo').classList.add('hidden');
            document.querySelectorAll('.panel:not(#authPanel)').forEach(p => p.classList.add('hidden'));
            document.getElementById('authPanel').classList.remove('hidden');
            alert('üëã –î–æ –Ω–æ–≤—ã—Ö –≤—Å—Ç—Ä–µ—á!');
        }
        
        function showMainInterface() {
            document.getElementById('authPanel').classList.add('hidden');
            document.getElementById('gamesPanel').classList.remove('hidden');
            document.getElementById('tournamentPanel').classList.remove('hidden');
            document.getElementById('userInfo').classList.remove('hidden');
            document.getElementById('userNick').textContent = currentUser;
            document.getElementById('totalScore').textContent = userData.score || 0;
            updateTournamentTimer();
            updateTournamentLeaderboard();
        }
        
        // –ù–ê–í–ò–ì–ê–¶–ò–Ø
        function showSnake() {
            document.querySelectorAll('.panel').forEach(p => p.classList.add('hidden'));
            document.getElementById('snakePanel').classList.remove('hidden');
            loadSnakeRecord();
        }
        
        function showGuessGame() {
            document.querySelectorAll('.panel').forEach(p => p.classList.add('hidden'));
            document.getElementById('guessPanel').classList.remove('hidden');
            newGuessGame();
        }
        
        function backToMenu() {
            document.querySelectorAll('.panel').forEach(p => p.classList.add('hidden'));
            document.getElementById('gamesPanel').classList.remove('hidden');
            document.getElementById('tournamentPanel').classList.remove('hidden');
        }
        
        // –¢–£–†–ù–ò–†
        function updateTournamentTimer() {
            const now = new Date();
            const tomorrow = new Date(now.getTime());
            tomorrow.setHours(24, 0, 0, 0);
            const diff = tomorrow - now;
            
            const h = Math.floor(diff / 3600000);
            const m = Math.floor((diff % 3600000) / 60000);
            const s = Math.floor((diff % 60000) / 1000);
            document.getElementById('tournamentTimer').textContent = `${h}:${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
            setTimeout(updateTournamentTimer, 1000);
        }
        
        function joinTournament() {
            if (!currentUser) return alert('üë§ –°–Ω–∞—á–∞–ª–∞ –≤–æ–π–¥–∏!');
            userData.tournament = true;
            storage.set('users', storage.get('users'));
            tournamentJoined = true;
            alert('‚öîÔ∏è –¢—ã –≤ —Ç—É—Ä–Ω–∏—Ä–µ! –û—á–∫–∏ —Å—É–º–º–∏—Ä—É—é—Ç—Å—è!');
        }
        
        function updateTournamentLeaderboard() {
            const scores = storage.get('tournamentScores') || {};
            const sorted = Object.entries(scores)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 10)
                .map(([nick, score], i) => {
                    const div = document.createElement('div');
                    div.className = i < 3 ? `rank-${i+1}` : '';
                    div.innerHTML = `<span>${i+1}. ${nick}</span><span>${score} –æ—á–∫–æ–≤</span>`;
                    return div.outerHTML;
                }).join('');
            document.getElementById('tournamentLeaderboard').innerHTML = sorted || '<div>–ü—É—Å—Ç–æ. –ë—É–¥—å –ø–µ—Ä–≤—ã–º!</div>';
        }
        
        // –ó–ú–ï–ô–ö–ê
        function loadSnakeRecord() {
            const records = storage.get('snakeRecords') || {};
            snake.record = records[currentUser] || 0;
            document.getElementById('snakeRecord').textContent = snake.record;
        }
        
        function startSnakeGame() {
            const canvas = document.getElementById('snakeCanvas');
            snake.canvas = canvas;
            snake.ctx = canvas.getContext('2d');
            snake.snake = [{x: 20, y: 20}];
            snake.dx = 1; snake.dy = 0;
            snake.score = 0;
            snake.running = true;
            spawnSnakeFood();
            snakeGameLoop();
        }
        
        function spawnSnakeFood() {
            snake.food = {
                x: Math.floor(Math.random() * 44),
                y: Math.floor(Math.random() * 44)
            };
        }
        
        function snakeGameLoop() {
            if (!snake.running) return;
            
            // –û—á–∏—Å—Ç–∫–∞
            snake.ctx.fillStyle = '#0a0a1a';
            snake.ctx.fillRect(0, 0, 450, 450);
            
            // –î–≤–∏–∂–µ–Ω–∏–µ
            const head = {x: snake.snake[0].x + snake.dx, y: snake.snake[0].y + snake.dy};
            snake.snake.unshift(head);
            
            // –ï–¥–∞
            if (head.x === snake.food.x && head.y === snake.food.y) {
                snake.score += tournamentJoined ? 25 : 12;
                spawnSnakeFood();
            } else {
                snake.snake.pop();
            }
            
            // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –∑–º–µ–π–∫–∏
            snake.snake.forEach((part, i) => {
                snake.ctx.fillStyle = i === 0 ? '#ff0080' : '#00ff88';
                snake.ctx.shadowColor = '#00ff88';
                snake.ctx.shadowBlur = 15;
                snake.ctx.fillRect(part.x * 10 + 1, part.y * 10 + 1, 8, 8);
            });
            
            // –ï–¥–∞
            snake.ctx.fillStyle = '#ffaa00';
            snake.ctx.shadowColor = '#ffaa00';
            snake.ctx.shadowBlur = 20;
            snake.ctx.fillRect(snake.food.x * 10 + 2, snake.food.y * 10 + 2, 6, 6);
            
            document.getElementById('snakeScore').textContent = snake.score;
            
            // –ö–æ–ª–ª–∏–∑–∏–∏
            const hx = head.x, hy = head.y;
            if (hx < 0 || hx >= 45 || hy < 0 || hy >= 45 ||
                snake.snake.slice(2).some(p => p.x === hx && p.y === hy)) {
                endSnakeGame();
                return;
            }
            
            setTimeout(snakeGameLoop, Math.max(80, 200 - snake.score));
        }
        
        function endSnakeGame() {
            snake.running = false;
            if (snake.score > snake.record) {
                snake.record = snake.score;
                const records = storage.get('snakeRecords') || {};
                records[currentUser] = snake.score;
                storage.set('snakeRecords', records);
                document.getElementById('snakeRecord').textContent = snake.score;
            }
            
            // –¢—É—Ä–Ω–∏—Ä
            if (tournamentJoined && currentUser) {
                const scores = storage.get('tournamentScores') || {};
                scores[currentUser] = (scores[currentUser] || 0) + snake.score;
                storage.set('tournamentScores', scores);
                updateTournamentLeaderboard();
                userData.score += snake.score;
                document.getElementById('totalScore').textContent = userData.score;
            }
            
            alert(`üêç Game Over! ${snake.score} –æ—á–∫–æ–≤`);
        }
        
        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–º–µ–π–∫–æ–π
        document.addEventListener('keydown', e => {
            if (!snake.running) return;
            switch(e.key) {
                case 'ArrowUp': if (snake.dy === 0) { snake.dx = 0; snake.dy = -1; } break;
                case 'ArrowDown': if (snake.dy === 0) { snake.dx = 0; snake.dy = 1; } break;
                case 'ArrowLeft': if (snake.dx === 0) { snake.dx = -1; snake.dy = 0; } break;
                case 'ArrowRight': if (snake.dx === 0) { snake.dx = 1; snake.dy = 0; } break;
            }
        });
        
        // –£–ì–ê–î–ê–ô–ö–ê
        function newGuessGame() {
            const levels = [[1,1000], [1,10000], [1,100000]];
            guess.target = Math.floor(Math.random() * levels[guess.level-1][1]) + levels[guess.level-1][0];
            guess.attempts = 0;
            guess.min = levels[guess.level-1][0];
            guess.max = levels[guess.level-1][1];
            
            document.getElementById('guessLevel').textContent = guess.level;
            document.getElementById('guessRange').textContent = guess.max.toLocaleString();
            document.getElementById('guessAttempts').textContent = 0;
            document.getElementById('guessResult').textContent = '';
            document.getElementById('guessInput').value = '';
        }
        
        function checkGuess() {
            const input = parseInt(document.getElementById('guessInput').value);
            if (!input || input < guess.min || input > guess.max) {
                return document.getElementById('guessResult').textContent = '‚ùå –ß–∏—Å–ª–æ –≤–Ω–µ –¥–∏–∞–ø–∞–∑–æ–Ω–∞!';
            }
            
            guess.attempts++;
            document.getElementById('guessAttempts').textContent = guess.attempts;
            
            if (input === guess.target) {
                const points = Math.max(1, Math.floor(1500 / guess.attempts));
                document.getElementById('guessResult').innerHTML = `üéâ –£–≥–∞–¥–∞–ª –∑–∞ ${guess.attempts} –ø–æ–ø—ã—Ç–æ–∫! +${points} –æ—á–∫–æ–≤`;
                
                // –†–µ–∫–æ—Ä–¥
                const records = storage.get('guessRecords') || {};
                if (!records[currentUser] || guess.attempts < records[currentUser]) {
                    records[currentUser] = guess.attempts;
                    storage.set('guessRecords', records);
                }
                
                // –¢—É—Ä–Ω–∏—Ä
                if (tournamentJoined && currentUser) {
                    const scores = storage.get('tournamentScores') || {};
                    scores[currentUser] = (scores[currentUser] || 0) + points;
                    storage.set('tournamentScores', scores);
                    updateTournamentLeaderboard();
                }
                
                userData.score += points;
                document.getElementById('totalScore').textContent = userData.score;
                
                guess.level = Math.min(3, guess.level + 1);
                setTimeout(newGuessGame, 2500);
            } else if (input < guess.target) {
                document.getElementById('guessResult').textContent = `üìà –ë–æ–ª—å—à–µ! (${input})`;
                guess.min = input + 1;
            } else {
                document.getElementById('guessResult').textContent = `üìâ –ú–µ–Ω—å—à–µ! (${input})`;
                guess.max = input - 1;
            }
        }
        
        // –ê–í–¢–û–õ–û–ì–ò–ù
        window.onload = () => {
            const lastUser = storage.get('lastUser');
            const users = storage.get('users');
            if (lastUser && users && users[lastUser]) {
                currentUser = lastUser;
                userData = users[lastUser];
                showMainInterface();
            }
        };
    </script>
</body>
</html>
