<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéÆ ALEKSIN GAMES HUB 2026 ‚ú®</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Exo+2:wght@300;400;600;800&display=swap');
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Exo 2', sans-serif;
            background: linear-gradient(-45deg, #0f0f23, #1a0033, #330066, #0f0f23);
            color: #fff;
            min-height: 100vh;
            overflow-x: hidden;
            animation: bgShift 15s ease infinite;
        }
        @keyframes bgShift { 0%,100% {background-position: 0% 50%;} 50% {background-position: 100% 50%;} }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        h1 { 
            font-family: 'Orbitron', monospace; 
            font-size: clamp(2rem, 5vw, 3rem); 
            text-align: center; 
            margin-bottom: 30px; 
            background: linear-gradient(45deg, #ff00ff, #00ffff, #ffaa00); 
            -webkit-background-clip: text; 
            -webkit-text-fill-color: transparent; 
            text-shadow: 0 0 30px rgba(255,255,255,0.5);
            animation: glow 2s ease-in-out infinite alternate;
        }
        @keyframes glow { from {filter: drop-shadow(0 0 10px #00ffff);} to {filter: drop-shadow(0 0 20px #ff00ff);} }
        .section { 
            background: rgba(255,255,255,0.08); 
            backdrop-filter: blur(15px); 
            border-radius: 25px; 
            padding: 30px; 
            margin-bottom: 30px; 
            border: 1px solid rgba(255,255,255,0.15);
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            transition: all 0.3s;
        }
        .section:hover { transform: translateY(-5px); box-shadow: 0 25px 50px rgba(0,255,255,0.2); }
        button { 
            background: linear-gradient(45deg, #ff00ff, #00ffff); 
            border: none; 
            padding: 15px 30px; 
            border-radius: 50px; 
            color: #000; 
            font-weight: 700; 
            font-size: 1.1rem; 
            cursor: pointer; 
            transition: all 0.3s; 
            font-family: 'Orbitron', monospace;
            margin: 5px;
            box-shadow: 0 5px 15px rgba(0,255,255,0.3);
        }
        button:hover { transform: scale(1.05) translateY(-2px); box-shadow: 0 15px 30px rgba(255,0,255,0.5); }
        button:active { transform: scale(0.98); }
        input { 
            background: rgba(255,255,255,0.12); 
            border: 2px solid rgba(255,255,255,0.25); 
            padding: 18px; 
            border-radius: 15px; 
            color: #fff; 
            font-size: 1.1rem; 
            width: 220px; 
            margin: 10px; 
            backdrop-filter: blur(10px);
            transition: all 0.3s;
        }
        input:focus { outline: none; border-color: #00ffff; box-shadow: 0 0 20px rgba(0,255,255,0.5); }
        input::placeholder { color: rgba(255,255,255,0.6); }
        .top-list { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 15px; margin-top: 20px; }
        .top-item { 
            background: linear-gradient(135deg, rgba(0,255,255,0.15), rgba(255,0,255,0.15)); 
            padding: 20px; 
            border-radius: 20px; 
            text-align: center; 
            font-weight: 600;
            border: 1px solid rgba(255,255,255,0.2);
        }
        .medal { font-size: 2rem; display: block; margin-bottom: 10px; }
        canvas { 
            border: 4px solid #00ffff; 
            border-radius: 20px; 
            background: radial-gradient(circle, #000, #111); 
            display: block; 
            margin: 20px auto; 
            box-shadow: 0 20px 40px rgba(0,255,255,0.3);
            cursor: pointer;
        }
        #userInfo { 
            position: fixed; 
            top: 20px; 
            right: 20px; 
            background: rgba(0,0,0,0.7); 
            backdrop-filter: blur(20px);
            padding: 20px; 
            border-radius: 20px; 
            font-weight: 700; 
            border: 2px solid #00ffff;
            min-width: 200px;
        }
        #logoutBtn { 
            background: linear-gradient(45deg, #ff4444, #ff6666) !important; 
            color: #fff !important; 
            font-size: 1rem; 
            padding: 12px 20px; 
            margin-top: 15px; 
            width: 100%;
        }
        .hidden { display: none !important; }
        .status { padding: 15px; border-radius: 10px; margin: 15px 0; font-weight: 600; }
        .status.success { background: rgba(0,255,0,0.2); border-left: 5px solid #00ff00; }
        .status.error { background: rgba(255,0,0,0.2); border-left: 5px solid #ff4444; }
        @media (max-width: 768px) { 
            .container { padding: 15px; } 
            h1 { font-size: 2rem; margin-bottom: 20px; } 
            input { width: calc(100% - 30px); }
            canvas { width: 90vw; height: 40vh; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéÆ ALEKSIN GAMES HUB 2026 ‚ú®</h1>
        
        <!-- üîê –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø -->
        <div id="authSection" class="section">
            <h2 style="font-family: 'Orbitron'; font-size: 1.8rem; margin-bottom: 25px;">üîê –í–•–û–î / –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø</h2>
            <input id="usernameInput" placeholder="üë§ –ù–∏–∫ (test)" type="text">
            <input id="passwordInput" placeholder="üîë –ü–∞—Ä–æ–ª—å (1234)" type="password">
            <br>
            <button onclick="login()">üöÄ –í–û–ô–¢–ò</button>
            <button onclick="register()">üìù –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø</button>
            <div id="authStatus" class="status"></div>
        </div>

        <!-- üéÆ –ò–ì–†–´ (—Å–∫—Ä—ã—Ç—ã –¥–æ –≤—Ö–æ–¥–∞) -->
        <div id="gamesSection" class="hidden">
            <div class="section">
                <h2 style="font-family: 'Orbitron';">üêç –ó–ú–ï–ô–ö–ê PRO (3 —É—Ä–æ–≤–Ω—è)</h2>
                <div style="display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; margin-bottom: 20px;">
                    <button onclick="setSnakeDifficulty(1)">üêå –õ–Å–ì–ö–ê–Ø (200ms)</button>
                    <button onclick="setSnakeDifficulty(2)">‚ö° –ù–û–†–ú–ê–õ–¨–ù–ê–Ø (150ms)</button>
                    <button onclick="setSnakeDifficulty(3)">üöÄ –•–ê–†–î–ö–û–† (100ms)</button>
                </div>
                <canvas id="snakeCanvas" width="450" height="450"></canvas>
                <div style="text-align: center; font-size: 1.3rem; margin: 15px 0;">
                    –°—á—ë—Ç: <span id="snakeScore" style="color: #00ff00; font-family: Orbitron; font-weight: 900; font-size: 1.5rem;">0</span>
                </div>
                <button id="startSnakeBtn" onclick="startSnake()" style="display:none; font-size: 1.3rem;">‚ñ∂Ô∏è –ù–û–í–ê–Ø –ò–ì–†–ê</button>
            </div>

            <div class="section">
                <h2 style="font-family: 'Orbitron';">üéØ –£–ì–ê–î–ê–ô –ß–ò–°–õ–û (3 –¥–∏–∞–ø–∞–∑–æ–Ω–∞)</h2>
                <div style="display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; margin-bottom: 20px;">
                    <button onclick="setGuessDifficulty(1)">1Ô∏è‚É£ 1-1 000</button>
                    <button onclick="setGuessDifficulty(2)">2Ô∏è‚É£ 1-10 000</button>
                    <button onclick="setGuessDifficulty(3)">3Ô∏è‚É£ 1-100 000</button>
                </div>
                <input id="guessInput" placeholder="üî¢ –í–≤–µ–¥–∏ —á–∏—Å–ª–æ" onkeypress="if(event.key==='Enter') checkGuess()">
                <div id="guessFeedback" style="font-size: 1.3rem; margin: 20px 0; min-height: 40px;"></div>
                <div style="text-align: center; font-size: 1.2rem;">
                    –ü–æ–ø—ã—Ç–æ–∫: <span id="guessAttempts" style="color: #ffaa00;">0</span> | 
                    –î–∏–∞–ø–∞–∑–æ–Ω: <span id="guessRange" style="color: #00ffff;">1-1000</span>
                </div>
                <div style="text-align: center;">
                    <button onclick="startGuessGame()">üîÑ –ù–û–í–ê–Ø –ò–ì–†–ê</button>
                    <button onclick="checkGuess()">‚úÖ –ü–†–û–í–ï–†–ò–¢–¨</button>
                </div>
            </div>
        </div>

        <!-- üèÜ –õ–ò–î–ï–†–ë–û–†–î–´ –ò –¢–£–†–ù–ò–†–´ -->
        <div id="leaderboardsSection" class="hidden">
            <div class="section">
                <h2 style="font-family: 'Orbitron'; font-size: 2rem;">üèÜ –¢–û–ü-10 –†–ï–ö–û–†–î–´</h2>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                    <div>
                        <h3 style="color: #00ff00; text-align: center;">üêç –ó–ú–ï–ô–ö–ê</h3>
                        <div id="snakeTop10" class="top-list"></div>
                    </div>
                    <div>
                        <h3 style="color: #ffaa00; text-align: center;">üéØ –£–ì–ê–î–ê–ô–ö–ê</h3>
                        <div id="guessTop10" class="top-list"></div>
                    </div>
                </div>
            </div>
            
            <div class="section">
                <h2 style="font-family: 'Orbitron'; font-size: 2rem;">‚öîÔ∏è –¢–£–†–ù–ò–†–´ (—Å–±—Ä–æ—Å 00:00 MSK)</h2>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                    <div>
                        <h3 style="color: #00ff00; text-align: center;">üêç –ó–ú–ï–ô–ö–ê –¢–£–†–ù–ò–†</h3>
                        <div id="snakeTournament"></div>
                    </div>
                    <div>
                        <h3 style="color: #ffaa00; text-align: center;">üéØ –£–ì–ê–î–ê–ô–ö–ê –¢–£–†–ù–ò–†</h3>
                        <div id="guessTournament"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- üë§ –ò–ù–§–û –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø -->
    <div id="userInfo" class="hidden">
        <div id="currentUser" style="font-size: 1.3rem; margin-bottom: 10px;"></div>
        <div id="liveStats" style="font-size: 0.9rem; opacity: 0.8;"></div>
        <button id="logoutBtn" onclick="logout()">üö™ –í–´–•–û–î</button>
    </div>

    <script>
        // üéÆ –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï
        let currentUser = '', snakeDifficulty = 1, guessDifficulty = 1;
        let guessNumber = 0, guessAttempts = 0, lastGuessedNumber = 0;
        let snakeScore = 0, gameInterval, snake = [], dx = 0, dy = 0, food = {};
        
        // üèÜ –î–ê–ù–ù–´–ï –¢–û–ü–û–í –ò –¢–£–†–ù–ò–†–û–í (–û–¢–î–ï–õ–¨–ù–û –î–õ–Ø –ö–ê–ñ–î–û–ô –ò–ì–†–´)
        let tops = { snakeTop10: [], guessTop10: [] };
        let tournaments = { snake: {}, guess: {} };
        let tournamentStart = Date.now();
        let registeredUsers = JSON.parse(localStorage.getItem('registeredUsers') || '{}');

        // üíæ –°–û–•–†–ê–ù–ï–ù–ò–ï/–ó–ê–ì–†–£–ó–ö–ê
        function loadData() {
            tops.snakeTop10 = JSON.parse(localStorage.getItem('snakeTop10') || '[]');
            tops.guessTop10 = JSON.parse(localStorage.getItem('guessTop10') || '[]');
            tournaments.snake = JSON.parse(localStorage.getItem('snakeTournament') || '{}');
            tournaments.guess = JSON.parse(localStorage.getItem('guessTournament') || '{}');
            tournamentStart = parseInt(localStorage.getItem('tournamentStart') || Date.now());
            
            // üîÑ –°–ë–†–û–° –¢–£–†–ù–ò–†–û–í (24—á –∏–ª–∏ 00:00 MSK)
            const now = new Date();
            const nextMidnight = new Date(now.getFullYear(), now.getMonth(), now.getDate() + 1, 3, 0, 0); // 00:00 MSK = 21:00 UTC
            if (Date.now() > nextMidnight || Date.now() - tournamentStart > 24*60*60*1000) {
                resetTournaments();
            }
        }

        function saveData(key, data) { localStorage.setItem(key, JSON.stringify(data)); }
        function resetTournaments() {
            tournaments.snake = {}; tournaments.guess = {};
            tournamentStart = Date.now();
            saveData('snakeTournament', {}); saveData('guessTournament', {}); 
            saveData('tournamentStart', tournamentStart);
        }

        // üîê –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø
        function login() {
            const username = document.getElementById('usernameInput').value.trim();
            const password = document.getElementById('passwordInput').value;
            const status = document.getElementById('authStatus');
            
            if (!username || !password) {
                status.innerHTML = '‚ùå –í–≤–µ–¥–∏ –Ω–∏–∫ –∏ –ø–∞—Ä–æ–ª—å!'; status.className = 'status error';
                return;
            }
            
            if (registeredUsers[username] && registeredUsers[username] === password) {
                currentUser = username;
                status.innerHTML = `‚úÖ <strong>${username}</strong> –≤–æ—à—ë–ª –≤ –∏–≥—Ä—É!`; 
                status.className = 'status success';
                setTimeout(showGames, 1000);
            } else {
                status.innerHTML = '‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω/–ø–∞—Ä–æ–ª—å'; status.className = 'status error';
            }
        }

        function register() {
            const username = document.getElementById('usernameInput').value.trim();
            const password = document.getElementById('passwordInput').value;
            const status = document.getElementById('authStatus');
            
            if (!username || password.length < 4) {
                status.innerHTML = '‚ùå –ù–∏–∫ + –ø–∞—Ä–æ–ª—å (–º–∏–Ω–∏–º—É–º 4 —Å–∏–º–≤–æ–ª–∞)'; status.className = 'status error';
                return;
            }
            
            if (registeredUsers[username]) {
                status.innerHTML = `üë§ <strong>${username}</strong> —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç! –ù–∞–∂–º–∏ –í–û–ô–¢–ò`; 
                status.className = 'status error';
                return;
            }
            
            registeredUsers[username] = password;
            saveData('registeredUsers', registeredUsers);
            status.innerHTML = `üìù <strong>${username}</strong> —É—Å–ø–µ—à–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω!`; 
            status.className = 'status success';
        }

        function logout() {
            if (confirm('üö™ –î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –≤—ã–π—Ç–∏? –†–µ–∫–æ—Ä–¥—ã —Å–æ—Ö—Ä–∞–Ω—è—Ç—Å—è!')) {
                currentUser = '';
                document.getElementById('gamesSection').classList.add('hidden');
                document.getElementById('leaderboardsSection').classList.add('hidden');
                document.getElementById('userInfo').classList.add('hidden');
                document.getElementById('authSection').classList.remove('hidden');
                document.getElementById('usernameInput').value = '';
                document.getElementById('passwordInput').value = '';
                document.getElementById('authStatus').innerHTML = '';
            }
        }

        function showGames() {
            document.getElementById('authSection').classList.add('hidden');
            document.getElementById('gamesSection').classList.remove('hidden');
            document.getElementById('leaderboardsSection').classList.remove('hidden');
            document.getElementById('userInfo').classList.remove('hidden');
            
            document.getElementById('currentUser').innerHTML = `üëë ${currentUser.toUpperCase()}`;
            loadData();
            updateAllTops();
            setInterval(saveAllData, 10000); // üíæ –ö–∞–∂–¥—ã–µ 10 —Å–µ–∫
        }

        // üêç –ó–ú–ï–ô–ö–ê (–û–¢–î–ï–õ–¨–ù–´–ô –¢–û–ü + –¢–£–†–ù–ò–†)
        function setSnakeDifficulty(level) {
            snakeDifficulty = level;
            const levels = ['üêå –õ–Å–ì–ö–ê–Ø', '‚ö° –ù–û–†–ú–ê–õ–¨–ù–ê–Ø', 'üöÄ –•–ê–†–î–ö–û–†'];
            alert(`üêç –í—ã–±—Ä–∞–Ω–∞: ${levels[level-1]} (${[200,150,100][level-1]}ms)`);
        }

        function startSnake() {
            const canvas = document.getElementById('snakeCanvas');
            const ctx = canvas.getContext('2d');
            const grid = 20;
            
            // üÜï –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø
            snake = [{x: 10, y: 10}]; dx = 0; dy = 0; snakeScore = 0;
            food = {x: Math.floor(Math.random()*22), y: Math.floor(Math.random()*22)};
            
            document.getElementById('snakeScore').textContent = '0';
            document.getElementById('startSnakeBtn').style.display = 'none';
            
            const speeds = [200, 150, 100];
            const speed = speeds[snakeDifficulty-1];
            
            // ‚èπÔ∏è –£–ë–ò–†–ê–ï–ú –°–¢–ê–†–´–ô –ò–ù–¢–ï–†–í–ê–õ
            if (gameInterval) clearInterval(gameInterval);
            
            gameInterval = setInterval(() => {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                // üêç –î–í–ò–ñ–ï–ù–ò–ï
                const head = {x: snake[0].x + dx, y: snake[0].y + dy};
                
                // üí• –°–¢–û–õ–ö–ù–û–í–ï–ù–ò–ï
                if (head.x < 0 || head.x >= 22.5 || head.y < 0 || head.y >= 22.5 || 
                    snake.some((part, i) => i > 0 && part.x === head.x && part.y === head.y)) {
                    
                    saveSnakeScore(Math.floor(snakeScore));
                    ctx.fillStyle = '#ff4444';
                    ctx.font = 'bold 40px Orbitron';
                    ctx.textAlign = 'center';
                    ctx.fillText(`üíÄ ${Math.floor(snakeScore)}`, canvas.width/2, canvas.height/2);
                    clearInterval(gameInterval);
                    document.getElementById('startSnakeBtn').style.display = 'block';
                    return;
                }
                
                snake.unshift(head);
                
                // üçé –ï–î–ê
                if (head.x === food.x && head.y === food.y) {
                    snakeScore += 10 * snakeDifficulty;
                    food = {x: Math.floor(Math.random()*22), y: Math.floor(Math.random()*22)};
                } else {
                    snake.pop();
                }
                
                // üé® –†–ò–°–û–í–ê–ù–ò–ï –ó–ú–ï–ô–ö–ò (–ì–†–ê–î–ò–ï–ù–¢)
                const gradient = ctx.createLinearGradient(0, 0, canvas.width, 0);
                gradient.addColorStop(0, '#00ff00');
                gradient.addColorStop(0.5, '#00cc00');
                gradient.addColorStop(1, '#009900');
                ctx.fillStyle = gradient;
                snake.forEach((part, i) => {
                    ctx.shadowColor = '#00ff00';
                    ctx.shadowBlur = 20;
                    ctx.fillRect(part.x*grid-1, part.y*grid-1, grid+2, grid+2);
                });
                
                // üçé –ö–†–ê–°–ù–û–ï –Ø–ë–õ–û–ö–û
                ctx.shadowColor = '#ff0000';
                ctx.shadowBlur = 25;
                ctx.fillStyle = '#ff4444';
                ctx.beginPath();
                ctx.arc(food.x*grid + grid/2, food.y*grid + grid/2, grid/2-2, 0, Math.PI*2);
                ctx.fill();
                
                // üìä –°–ß–Å–¢
                document.getElementById('snakeScore').textContent = Math.floor(snakeScore);
                
            }, speed);
            
            // ‚å®Ô∏è –£–ü–†–ê–í–õ–ï–ù–ò–ï
            const keyHandler = (e) => {
                if (e.key === 'ArrowUp' && dy !== 1) { dx = 0; dy = -1; }
                if (e.key === 'ArrowDown' && dy !== -1) { dx = 0; dy = 1; }
                if (e.key === 'ArrowLeft' && dx !== 1) { dx = -1; dy = 0; }
                if (e.key === 'ArrowRight' && dx !== -1) { dx = 1; dy = 0; }
            };
            window.addEventListener('keydown', keyHandler);
            
            // üì± –°–í–ê–ô–ü–´ –î–õ–Ø –ú–û–ë–ò–õ–ö–ò
            let startX, startY;
            canvas.addEventListener('touchstart', e => {
                startX = e.touches[0].clientX;
                startY = e.touches[0].clientY;
            });
            canvas.addEventListener('touchmove', e => e.preventDefault());
            canvas.addEventListener('touchend', e => {
                if (!startX || !startY) return;
                const endX = e.changedTouches[0].clientX;
                const endY = e.changedTouches[0].clientY;
                const diffX = startX - endX;
                const diffY = startY - endY;
                
                if (Math.abs(diffX) > Math.abs(diffY)) {
                    if (diffX > 50 && dx !== 1) { dx = -1; dy = 0; }  // ‚Üê
                    if (diffX < -50 && dx !== -1) { dx = 1; dy = 0; } // ‚Üí
                } else {
                    if (diffY > 50 && dy !== 1) { dx = 0; dy = -1; }  // ‚Üë
                    if (diffY < -50 && dy !== -1) { dx = 0; dy = 1; } // ‚Üì
                }
                startX = startY = null;
            });
        }

        // üéØ –£–ì–ê–î–ê–ô–ö–ê (–û–¢–î–ï–õ–¨–ù–´–ô –¢–û–ü + –¢–£–†–ù–ò–†)
        function setGuessDifficulty(level) {
            guessDifficulty = level;
            const ranges = ['1-1 000', '1-10 000', '1-100 000'];
            document.getElementById('guessRange').textContent = ranges[level-1];
        }

        function startGuessGame() {
            const ranges = [1000, 10000, 100000];
            guessNumber = Math.floor(Math.random() * ranges[guessDifficulty-1]) + 1;
            guessAttempts = 0; lastGuessedNumber = 0;
            document.getElementById('guessFeedback').innerHTML = 'üéØ –ó–∞–≥–∞–¥–∞–ª–∏ —á–∏—Å–ª–æ! –£–≥–∞–¥–∞–π!';
            document.getElementById('guessInput').value = '';
            document.getElementById('guessAttempts').textContent = '0';
        }

        function checkGuess() {
            if (!guessNumber) {
                document.getElementById('guessFeedback').innerHTML = '‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –Ω–∞–∂–º–∏ "–ù–æ–≤–∞—è –∏–≥—Ä–∞"!';
                return;
            }
            
            const guess = parseInt(document.getElementById('guessInput').value) || 0;
            lastGuessedNumber = guess;
            guessAttempts++;
            
            if (guess === guessNumber) {
                const ranges = [1000, 10000, 100000];
                const score = Math.floor(ranges[guessDifficulty-1] / guessAttempts * 10);
                saveGuessScore(score);
                document.getElementById('guessFeedback').innerHTML = 
                    `‚úÖ –£–≥–∞–¥–∞–ª –∑–∞ <strong>${guessAttempts}</strong> –ø–æ–ø—ã—Ç–æ–∫! –û—á–∫–∏: <strong style="color:#00ff00">${score}</strong>`;
                return;
            }
            
            let feedback = '';
            if (Math.abs(guess - guessNumber) <= 50) {
                feedback = `üî• –û–ß–ï–ù–¨ –ë–õ–ò–ó–ö–û –∫ <strong>${guess}</strong>!`;
            } else if (guess < guessNumber) {
                feedback = `üìà –ë–æ–ª—å—à–µ —á–µ–º <strong>${guess}</strong>!`;
            } else {
                feedback = `üìâ –ú–µ–Ω—å—à–µ —á–µ–º <strong>${guess}</strong>!`;
            }
            
            document.getElementById('guessFeedback').innerHTML = feedback;
            document.getElementById('guessAttempts').textContent = guessAttempts;
            document.getElementById('guessInput').value = '';
        }

        // üíé –°–û–•–†–ê–ù–ï–ù–ò–ï –û–ß–ö–û–í (–û–¢–î–ï–õ–¨–ù–û –î–õ–Ø –ö–ê–ñ–î–û–ô –ò–ì–†–´)
        function saveSnakeScore(score) {
            // üèÜ –¢–û–ü-10 –ó–ú–ï–ô–ö–ò
            let top = tops.snakeTop10;
            top.push({user: currentUser, score});
            top.sort((a, b) => b.score - a.score);
            tops.snakeTop10 = top.slice(0, 10);
            saveData('snakeTop10', tops.snakeTop10);
            
            // ‚öîÔ∏è –¢–£–†–ù–ò–† –ó–ú–ï–ô–ö–ò (–ù–ê–ö–û–ü–ò–¢–ï–õ–¨–ù–´–ô)
            tournaments.snake[currentUser] = (tournaments.snake[currentUser] || 0) + Math.floor(score);
            saveData('snakeTournament', tournaments.snake);
            
            updateAllTops();
        }

        function saveGuessScore(score) {
            // üèÜ –¢–û–ü-10 –£–ì–ê–î–ê–ô–ö–ò
            let top = tops.guessTop10;
            top.push({user: currentUser, score});
            top.sort((a, b) => b.score - a.score);
            tops.guessTop10 = top.slice(0, 10);
            saveData('guessTop10', tops.guessTop10);
            
            // ‚öîÔ∏è –¢–£–†–ù–ò–† –£–ì–ê–î–ê–ô–ö–ò (–ù–ê–ö–û–ü–ò–¢–ï–õ–¨–ù–´–ô)
            tournaments.guess[currentUser] = (tournaments.guess[currentUser] || 0) + Math.floor(score);
            saveData('guessTournament', tournaments.guess);
            
            updateAllTops();
        }

        // üìä –û–¢–û–ë–†–ê–ñ–ï–ù–ò–ï –¢–û–ü–û–í
        function updateTop10(elementId, topData) {
            const container = document.getElementById(elementId);
            if (!topData.length) {
                container.innerHTML = '<div class="top-item"><span class="medal">üëë</span>–ë–£–î–¨ –ü–ï–†–í–´–ú!</div>';
                return;
            }
            container.innerHTML = topData.map((item, i) => {
                const medals = ['ü•á', 'ü•à', 'ü•â', '‚öúÔ∏è', '‚öúÔ∏è', '‚≠ê', '‚≠ê', '‚≠ê', '‚≠ê', '‚≠ê'];
                return `<div class="top-item">
                    <span class="medal">${medals[i] || `${i+1}Ô∏è‚É£`}</span>
                    ${item.user}: <strong>${item.score}</strong>
                </div>`;
            }).join('');
        }

        function updateTournament(game) {
            const tourn = game === 'snake' ? tournaments.snake : tournaments.guess;
            const sorted = Object.entries(tourn)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 10);
            
            const now = new Date();
            const nextMidnight = new Date(now.getFullYear(), now.getMonth(), now.getDate() + 1, 3, 0, 0); // 00:00 MSK
            const timeLeft = Math.floor((nextMidnight - now) / 1000 / 60);
            const hours = Math.floor(timeLeft / 60);
            const minutes = timeLeft % 60;
            
            const container = document.getElementById(`${game}Tournament`);
            container.innerHTML = `
                <div style="text-align: center; font-size: 1.3rem; margin-bottom: 15px; color: ${game === 'snake' ? '#00ff00' : '#ffaa00'};">
                    ‚è∞ –î–æ —Å–±—Ä–æ—Å–∞: ${hours}—á ${minutes}–º
                </div>
                <div class="top-list">
                    ${sorted.length ? sorted.map(([user, score], i) => {
                        const medals = ['ü•á', 'ü•à', 'ü•â', 'üéÅ', 'üéÅ'];
                        return `<div class="top-item">
                            <span class="medal">${medals[i] || `${i+1}Ô∏è‚É£`}</span>
                            ${user}: <strong>${Math.floor(score)}üíé</strong>
                        </div>`;
                    }).join('') : '<div class="top-item">‚è≥ –ñ–¥—ë–º –≥–µ—Ä–æ–µ–≤...</div>'}
                </div>
            `;
        }

        function updateAllTops() {
            updateTop10('snakeTop10', tops.snakeTop10);
            updateTop10('guessTop10', tops.guessTop10);
            updateTournament('snake');
            updateTournament('guess');
            
            // üìà –°–¢–ê–¢–ò–°–¢–ò–ö–ê –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø
            if (currentUser) {
                const snakeScore = tournaments.snake[currentUser] || 0;
                const guessScore = tournaments.guess[currentUser] || 0;
                const total = Math.floor(snakeScore + guessScore);
                document.getElementById('liveStats').innerHTML = 
                    `üêç ${Math.floor(snakeScore)}üíé + üéØ ${Math.floor(guessScore)}üíé = <strong>${total}üíé</strong>`;
            }
        }

        function saveAllData() {
            saveData('registeredUsers', registeredUsers);
            saveData('tops', tops);
            saveData('tournaments', tournaments);
        }

        // üöÄ –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø
        window.onload = () => {
            loadData();
            updateAllTops();
            setInterval(updateAllTops, 3000); // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 3 —Å–µ–∫
        };

        // üíæ –ê–í–¢–û–°–û–•–†–ê–ù–ï–ù–ò–ï –ü–†–ò –í–´–î–ï–õ–ï–ù–ò–ò –°–¢–†–ê–ù–ò–¶–´
        document.addEventListener('visibilitychange', () => {
            if (!document.hidden && currentUser) {
                setTimeout(() => {
                    saveAllData();
                    updateAllTops();
                }, 1000);
            }
        });
    </script>
</body>
</html>
