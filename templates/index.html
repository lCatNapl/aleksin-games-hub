<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéÆ ALEKSIN GAMES HUB</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Orbitron', monospace;
            background: #0f0f23;
            background: linear-gradient(-45deg, #0f0f23, #1a1a2e, #16213e, #0f3460);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }
        @keyframes gradientShift { 0%,100%{background-position:0% 50%} 50%{background-position:100% 50%}}
        
        /* ‚≠ê –ó–í–Å–ó–î–´ –ë–ï–ó SVG */
        body::before {
            content: '';
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-image: 
                radial-gradient(1px 1px at 20% 30%, #eee, transparent),
                radial-gradient(1px 1px at 80% 20%, #fff, transparent),
                radial-gradient(2px 2px at 40% 80%, rgba(255,255,255,0.6), transparent),
                radial-gradient(1px 1px at 90% 40%, #fff, transparent),
                radial-gradient(1px 1px at 10% 60%, rgba(255,255,255,0.8), transparent);
            background-repeat: repeat;
            background-size: 200px 150px;
            animation: twinkle 4s linear infinite;
            pointer-events: none;
            z-index: 0;
        }
        @keyframes twinkle { 0%,100%{opacity:0.6} 50%{opacity:1}}

        .container {
            max-width: 1400px; margin: 0 auto; padding: 20px;
            display: flex; flex-direction: column; min-height: 100vh;
            position: relative; z-index: 1;
        }
        
        .header {
            text-align: center; color: #44ff44; text-shadow: 0 0 20px #44ff44;
            margin-bottom: 30px; animation: glow 2s ease-in-out infinite alternate;
        }
        @keyframes glow { 
            from { text-shadow: 0 0 20px #44ff44; } 
            to { text-shadow: 0 0 30px #44ff44, 0 0 40px #44ff44; } 
        }
        
        h1 { font-size: clamp(2.5rem, 6vw, 5rem); font-weight: 900; margin-bottom: 10px; }
        
        #status {
            font-size: 1.8rem; padding: 20px 40px; border-radius: 50px;
            background: linear-gradient(45deg, rgba(68,255,68,0.3), rgba(0,255,0,0.2));
            border: 3px solid #44ff44; backdrop-filter: blur(15px);
            display: inline-block; box-shadow: 0 10px 40px rgba(68,255,68,0.3);
            margin-bottom: 20px;
        }
        
        .mega-buttons {
            display: flex; flex-wrap: wrap; justify-content: center; gap: 20px; margin: 30px 0;
        }
        
        .btn {
            padding: 20px 40px; border: none; border-radius: 50px; font-family: 'Orbitron', sans-serif;
            font-weight: 900; font-size: 1.3rem; cursor: pointer; transition: all .4s ease;
            background: linear-gradient(45deg, #44ff44, #00ff88); color: #000;
            box-shadow: 0 15px 45px rgba(68,255,68,0.5); position: relative; overflow: hidden;
        }
        
        .btn::before {
            content: ''; position: absolute; top: 0; left: -100%; width: 100%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            transition: left .6s;
        }
        
        .btn:hover::before { left: 100%; }
        .btn:hover { transform: translateY(-8px) scale(1.08); box-shadow: 0 30px 70px rgba(68,255,68,0.7); }
        .btn:active { transform: translateY(-4px) scale(1.04); }
        
        .logout-btn { 
            background: linear-gradient(45deg, #ff4444, #ff8888); color: #fff; 
            box-shadow: 0 15px 45px rgba(255,68,68,0.5);
        }
        .logout-btn:hover { box-shadow: 0 30px 70px rgba(255,68,68,0.7); }
        
        .games-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(380px, 1fr));
            gap: 35px; margin: 35px 0;
        }
        
        .game-card {
            background: linear-gradient(145deg, rgba(26,26,42,0.97), rgba(42,42,68,0.97));
            border: 3px solid rgba(68,255,68,0.6); border-radius: 35px; padding: 50px;
            text-align: center; cursor: pointer; transition: all .5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            backdrop-filter: blur(25px); position: relative; overflow: hidden;
        }
        
        .game-card::before {
            content: ''; position: absolute; top: 0; left: -100%; width: 100%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(68,255,68,0.4), transparent);
            transition: left .7s;
        }
        
        .game-card:hover::before { left: 100%; }
        .game-card:hover {
            transform: translateY(-25px) scale(1.04); border-color: #44ff44;
            box-shadow: 0 35px 90px rgba(68,255,68,0.6);
        }
        
        .game-title { 
            color: #44ff44; font-size: 2.2rem; font-weight: 900; margin-bottom: 20px; 
            text-shadow: 0 0 15px #44ff44;
        }
        .game-desc { color: #88ff88; line-height: 1.7; font-size: 1.2rem; }
        
        .dashboard-grid {
            display: grid; grid-template-columns: 1fr 1fr; gap: 35px; margin: 35px 0;
        }
        
        .leaderboard, .tournament {
            background: linear-gradient(145deg, rgba(20,20,40,0.97), rgba(40,40,80,0.97));
            border-radius: 30px; padding: 40px; border: 2px solid rgba(68,255,68,0.5);
        }
        
        .list-item {
            display: flex; justify-content: space-between; padding: 20px;
            background: rgba(68,255,68,0.15); margin: 12px 0; border-radius: 20px;
            border-left: 5px solid #44ff44; backdrop-filter: blur(10px); transition: all .3s ease;
        }
        
        .list-item:hover { transform: translateX(10px); background: rgba(68,255,68,0.25); }
        
        .modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85); backdrop-filter: blur(15px); z-index: 1000;
        }
        
        .modal-content {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            background: linear-gradient(145deg, #1a1a2e, #16213e); border-radius: 35px;
            padding: 60px; border: 4px solid #44ff44; width: 90%; max-width: 550px;
            box-shadow: 0 40px 120px rgba(68,255,68,0.6);
        }
        
        .input-field {
            width: 100%; padding: 25px; margin: 25px 0; border: 3px solid #44ff44;
            border-radius: 30px; background: rgba(0,0,0,0.6); color: #fff;
            font-family: 'Orbitron', sans-serif; font-size: 1.3rem; backdrop-filter: blur(15px);
            transition: all .3s ease;
        }
        
        .input-field:focus {
            outline: none; border-color: #00ff88; box-shadow: 0 0 20px rgba(0,255,136,0.5);
            transform: scale(1.02);
        }
        
        .modal-buttons { display: flex; gap: 25px; justify-content: center; margin-top: 35px; }
        .btn-primary { background: linear-gradient(45deg, #44ff44, #00ff88); }
        .btn-secondary { background: linear-gradient(45deg, #666, #999); color: #fff; }
        
        canvas { 
            border: 4px solid #44ff44; border-radius: 25px; background: #000; 
            display: block; margin: 25px auto; box-shadow: 0 20px 60px rgba(68,255,68,0.4);
        }
        
        @media (max-width: 768px) {
            .games-grid, .dashboard-grid { grid-template-columns: 1fr; }
            .modal-content { padding: 40px; margin: 20px; }
            .container { padding: 15px; }
            .mega-buttons { flex-direction: column; align-items: center; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéÆ ALEKSIN GAMES HUB</h1>
            <div id="status">‚ö° –ú–û–õ–ù–ò–ï–ò–û–°–ù–´–ô –°–¢–ê–†–¢</div>
            <div class="mega-buttons">
                <button class="btn demo-login" data-user="test">üöÄ –î–ï–ú–û test</button>
                <button class="btn demo-login" data-user="player1">üöÄ –î–ï–ú–û player1</button>
                <button class="btn" onclick="showModal('login')">üîë –í—Ö–æ–¥</button>
                <button class="btn" onclick="showModal('register')">üìù –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
            </div>
            <button id="logout" class="btn logout-btn" style="display:none;" onclick="logoutUser()">üö™ –í—ã—Ö–æ–¥</button>
        </div>

        <div id="gamesMenu" class="games-grid" style="display: grid;">
            <div class="game-card" onclick="loadSnakeGame()">
                <div class="game-title">üêç –ó–º–µ–π–∫–∞ –ü—Ä–æ</div>
                <div class="game-desc">–°–≤–∞–π–ø—ã üì± ‚Ä¢ WASD ‚Ä¢ –ì—Ä–∞–¥–∏–µ–Ω—Ç ‚Ä¢ –¢–µ–ª–µ–ø–æ—Ä—Ç ‚Ä¢ –†–µ–∫–æ—Ä–¥—ã</div>
            </div>
            <div class="game-card" onclick="loadGuessGame()">
                <div class="game-title">üéØ –£–≥–∞–¥–∞–π 1-10000</div>
                <div class="game-desc">üî• –û—á–µ–Ω—å –±–ª–∏–∑–∫–æ! ‚Ä¢ –ë–µ–∑–ª–∏–º–∏—Ç ‚Ä¢ –¢–æ—á–Ω—ã–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏ ‚Ä¢ –¢–æ–ø –æ—á–∫–∏</div>
            </div>
        </div>

        <div id="dashboard" class="dashboard-grid">
            <div class="leaderboard">
                <h3 style="color: #44ff44; margin-bottom: 25px; font-size: 1.8rem;">üèÜ –¢–æ–ø-10 –∏–≥—Ä–æ–∫–æ–≤</h3>
                <div id="leaderboard-list">üîÑ –ó–∞–≥—Ä—É–∑–∫–∞...</div>
            </div>
            <div class="tournament">
                <h3 style="color: #ffaa00; margin-bottom: 25px; font-size: 1.8rem;">‚öîÔ∏è –¢—É—Ä–Ω–∏—Ä (24—á)</h3>
                <div id="tournament-list">üîÑ –ó–∞–≥—Ä—É–∑–∫–∞...</div>
            </div>
        </div>
    </div>

    <div id="authModal" class="modal">
        <div class="modal-content">
            <h2 id="modalTitle">üîë –í—Ö–æ–¥</h2>
            <input type="text" class="input-field" id="username" placeholder="üë§ –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" maxlength="20">
            <input type="password" class="input-field" id="password" placeholder="üîí –ü–∞—Ä–æ–ª—å" maxlength="50">
            <div class="modal-buttons">
                <button class="btn btn-primary" id="submit-btn">üöÄ –í–æ–π—Ç–∏ / –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
                <button class="btn btn-secondary" onclick="closeAuth()">‚ùå –û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>

    <script>
        let currentGame = '', gameInterval = null;
        let snake = {x:20,y:20,dx:1,dy:0,cells:[],maxCells:4};
        let food = {x:15,y:15}, secretNumber = 0, attempts = 0, leaderboardInterval;

        // ‚ö° –ú–û–õ–ù–ò–ï–ò–û–°–ù–´–ô –°–¢–ê–†–¢
        window.addEventListener('load', () => {
            console.log('üéÆ ALEKSIN GAMES HUB ‚Äî –ì–æ—Ç–æ–≤!');
            leaderboardInterval = setInterval(() => { loadLeaderboard(); loadTournament(); }, 60000);
            loadLeaderboard(); loadTournament();
            initButtons();
            setInterval(initButtons, 2000); // üî• –ö–Ω–æ–ø–∫–∏ –∫–∞–∂–¥—ã–µ 2 —Å–µ–∫
        });

        // üî• 7x –ù–ï–£–ù–ò–ß–¢–û–ñ–ò–ú–´–ï –ö–ù–û–ü–ö–ò
        function initButtons() {
            // –û—Å–Ω–æ–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏
            const submitBtn = document.getElementById('submit-btn');
            if (submitBtn && !submitBtn.dataset.fixed) {
                submitBtn.dataset.fixed = 'true';
                ['click', 'mousedown', 'touchstart'].forEach(event => {
                    submitBtn.addEventListener(event, submitAuth, { passive: false });
                });
            }
            
            // –î–µ–º–æ –∫–Ω–æ–ø–∫–∏
            document.querySelectorAll('.demo-login').forEach(btn => {
                if (!btn.dataset.fixed) {
                    btn.dataset.fixed = 'true';
                    ['click', 'mousedown', 'touchstart'].forEach(event => {
                        btn.addEventListener(event, () => demoLogin(btn.dataset.user), { passive: false });
                    });
                }
            });
            
            // –í—ã—Ö–æ–¥
            const logoutBtn = document.getElementById('logout');
            if (logoutBtn && !logoutBtn.dataset.fixed) {
                logoutBtn.dataset.fixed = 'true';
                ['click', 'mousedown', 'touchstart'].forEach(event => {
                    logoutBtn.addEventListener(event, logoutUser, { passive: false });
                });
            }
        }

        async function demoLogin(username) {
            try {
                await fetch('/register', {
                    method: 'POST', headers: {'Content-Type': 'application/json'},
                    credentials: 'include',
                    body: JSON.stringify({username, password: '123456'})
                });
                await fetch('/login', {
                    method: 'POST', headers: {'Content-Type': 'application/json'},
                    credentials: 'include',
                    body: JSON.stringify({username, password: '123456'})
                });
                document.getElementById('status').innerHTML = `üëã ${username} ‚úì`;
                document.getElementById('logout').style.display = 'inline-block';
                loadLeaderboard(); loadTournament();
                console.log(`‚úÖ –î–ï–ú–û ${username} –≤–æ—à—ë–ª`);
            } catch(e) {
                console.error('–î–µ–º–æ:', e);
            }
        }

        function showModal(type) {
            document.getElementById('authModal').style.display = 'block';
            document.getElementById('modalTitle').textContent = type === 'login' ? 'üîë –í—Ö–æ–¥' : 'üìù –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è';
            document.getElementById('username').focus();
        }

        function closeAuth() {
            document.getElementById('authModal').style.display = 'none';
            document.getElementById('username').value = '';
            document.getElementById('password').value = '';
        }

        async function submitAuth(e) {
            if (e) e.preventDefault();
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value;
            
            if (!username || !password) return alert('üë§ –ò–º—è –∏ üîí –ø–∞—Ä–æ–ª—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã!');
            
            const endpoint = document.getElementById('modalTitle').textContent.includes('–í—Ö–æ–¥') ? '/login' : '/register';
            
            try {
                const res = await fetch(endpoint, {
                    method: 'POST', headers: {'Content-Type': 'application/json'},
                    credentials: 'include',
                    body: JSON.stringify({username, password})
                });
                const data = await res.json();
                
                if (data.success) {
                    document.getElementById('status').innerHTML = `üëã ${username} ‚úì`;
                    document.getElementById('logout').style.display = 'inline-block';
                    closeAuth();
                    loadLeaderboard(); loadTournament();
                } else {
                    alert(data.error || '‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞');
                }
            } catch(err) {
                alert('‚ùå –ù–µ—Ç —Å–≤—è–∑–∏ —Å —Å–µ—Ä–≤–µ—Ä–æ–º');
            }
        }

        async function logoutUser(e) {
            if (e) e.preventDefault();
            try {
                await fetch('/logout', {method: 'POST', credentials: 'include'});
                document.getElementById('status').innerHTML = 'üîí –ì–æ—Å—Ç—å';
                document.getElementById('logout').style.display = 'none';
                loadLeaderboard(); loadTournament();
            } catch(err) {
                location.reload();
            }
        }

        async function loadLeaderboard() {
            try {
                const res = await fetch('/leaderboard');
                const top = await res.json();
                document.getElementById('leaderboard-list').innerHTML = top.length ? 
                    top.map((p, i) => `<div class="list-item"><span>#${i+1} ${p.username}</span><span>${p.score.toLocaleString()}</span></div>`).join('') :
                    '<div class="list-item">–ü—É—Å—Ç–æ üò¥</div>';
            } catch(err) {
                document.getElementById('leaderboard-list').innerHTML = '‚ùå –û—à–∏–±–∫–∞';
            }
        }

        async function loadTournament() {
            try {
                const res = await fetch('/tournament');
                const top = await res.json();
                document.getElementById('tournament-list').innerHTML = top.length ? 
                    top.map((p, i) => `<div class="list-item"><span>#${i+1} ${p.username}</span><span>${p.score.toLocaleString()}</span></div>`).join('') :
                    '<div class="list-item">–ù–∏–∫—Ç–æ –Ω–µ –∏–≥—Ä–∞–ª</div>';
            } catch(err) {
                document.getElementById('tournament-list').innerHTML = '‚ùå –û—à–∏–±–∫–∞';
            }
        }

        // üêç –ó–ú–ï–ô–ö–ê –ü–†–û (–ø–æ–ª–Ω–∞—è –≤–µ—Ä—Å–∏—è)
        function loadSnakeGame() {
            currentGame = 'snake';
            const html = `
                <canvas id="gameCanvas" width="450" height="450"></canvas>
                <div style="text-align:center;color:#44ff44;font-size:1.8rem;margin:25px 0;">
                    –û—á–∫–∏: <span id="snakeScore">0</span> | –†–µ–∫–æ—Ä–¥: <span id="highScoreSnake">0</span>
                    <br><small style="color:#88ff88;">üì± –°–≤–∞–π–ø—ã | ‚Üë‚Üê‚Üì‚Üí WASD | üåÄ –¢–µ–ª–µ–ø–æ—Ä—Ç</small>
                </div>
                <div style="text-align:center;">
                    <button class="btn" onclick="saveSnakeScore()" style="margin:10px;">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ —Ç–æ–ø</button>
                    <button class="btn" onclick="loadSnakeGame()" style="margin:10px;">üîÑ –ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
                </div>
            `;
            document.getElementById('gamesMenu').innerHTML = html;
            initSnakeGame();
        }

        function initSnakeGame() {
            const canvas = document.getElementById('gameCanvas');
            const ctx = canvas.getContext('2d');
            let score = 0; 
            let highScore = parseInt(localStorage.getItem('snakeHigh')) || 0;
            document.getElementById('highScoreSnake').textContent = highScore;

            function createFood() {
                food.x = Math.floor(Math.random() * 43) + 1;
                food.y = Math.floor(Math.random() * 43) + 1;
                for (let cell of snake.cells) {
                    if (cell.x === food.x && cell.y === food.y) return createFood();
                }
            }

            function update() {
                ctx.fillStyle = '#0a0a0a';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                ctx.save();
                const gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
                gradient.addColorStop(0, '#00ff88');
                gradient.addColorStop(0.5, '#44ff44');
                gradient.addColorStop(1, '#00aa44');
                ctx.shadowColor = '#44ff44';
                ctx.shadowBlur = 15;
                ctx.fillStyle = gradient;
                ctx.fillRect(12 + food.x * 10, 12 + food.y * 10, 8, 8);
                ctx.restore();

                snake.x += snake.dx;
                snake.y += snake.dy;
                if (snake.x < 0) snake.x = 44;
                if (snake.x > 44) snake.x = 0;
                if (snake.y < 0) snake.y = 44;
                if (snake.y > 44) snake.y = 0;

                snake.cells.unshift({x: snake.x, y: snake.y});
                if (snake.cells.length > snake.maxCells) snake.cells.pop();

                if (snake.x === food.x && snake.y === food.y) {
                    snake.maxCells++;
                    score += 10;
                    document.getElementById('snakeScore').textContent = score;
                    createFood();
                }

                for (let i = 0; i < snake.cells.length; i++) {
                    ctx.save();
                    ctx.shadowColor = '#00ff88';
                    ctx.shadowBlur = 10;
                    ctx.fillStyle = `hsl(${120 - i * 2}, 100%, ${50 + i * 2}%)`;
                    ctx.fillRect(12 + snake.cells[i].x * 10, 12 + snake.cells[i].y * 10, 8, 8);
                    ctx.restore();
                }

                if (score > highScore) {
                    highScore = score;
                    localStorage.setItem('snakeHigh', highScore);
                    document.getElementById('highScoreSnake').textContent = highScore;
                }
            }

            if (gameInterval) clearInterval(gameInterval);
            gameInterval = setInterval(update, 140);

            let touchStartX, touchStartY;
            canvas.addEventListener('touchstart', (e) => {
                e.preventDefault();
                touchStartX = e.touches[0].clientX;
                touchStartY = e.touches[0].clientY;
            }, {passive: false});

            canvas.addEventListener('touchend', (e) => {
                e.preventDefault();
                const diffX = touchStartX - e.changedTouches[0].clientX;
                const diffY = touchStartY - e.changedTouches[0].clientY;
                if (Math.abs(diffX) > Math.abs(diffY) && Math.abs(diffX) > 35) {
                    if (diffX > 0 && snake.dx !== 1) { snake.dx = -1; snake.dy = 0; }
                                        else if (diffX < 0 && snake.dx !== -1) { snake.dx = 1; snake.dy = 0; }
                } else if (Math.abs(diffY) > 35) {
                    if (diffY > 0 && snake.dy !== 1) { snake.dx = 0; snake.dy = -1; }
                    else if (diffY < 0 && snake.dy !== -1) { snake.dx = 0; snake.dy = 1; }
                }
            }, {passive: false});

            document.addEventListener('keydown', (e) => {
                if (currentGame !== 'snake') return;
                switch(e.key.toLowerCase()) {
                    case 'arrowleft': case 'a': if (snake.dx !== 1) { snake.dx = -1; snake.dy = 0; } break;
                    case 'arrowup': case 'w': if (snake.dy !== 1) { snake.dx = 0; snake.dy = -1; } break;
                    case 'arrowright': case 'd': if (snake.dx !== -1) { snake.dx = 1; snake.dy = 0; } break;
                    case 'arrowdown': case 's': if (snake.dy !== -1) { snake.dx = 0; snake.dy = 1; } break;
                }
            });
        }

        function saveSnakeScore() {
            const score = parseInt(document.getElementById('snakeScore').textContent) || 0;
            fetch('/save_score', {
                method: 'POST', headers: {'Content-Type': 'application/json'},
                credentials: 'include',
                body: JSON.stringify({game: 'snake', score})
            }).then(res => res.json()).then(data => {
                if (data.success) {
                    alert(`‚úÖ ${score} –æ—á–∫–æ–≤ –≤ —Ç–æ–ø! üêç`);
                    loadSnakeGame();
                } else {
                    alert('üîí –í–æ–π–¥–∏ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è!');
                }
            }).catch(() => alert('üîí –í–æ–π–¥–∏ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è!'));
        }

        // üéØ –£–ì–ê–î–ê–ô–ö–ê 1-10000
        function loadGuessGame() {
            currentGame = 'guess';
            secretNumber = Math.floor(Math.random() * 10000) + 1;
            attempts = 0;
            const html = `
                <h2 style="color:#44ff44;text-align:center;font-size:2.5rem;margin:30px 0;">üéØ –£–≥–∞–¥–∞–π —á–∏—Å–ª–æ –æ—Ç 1 –¥–æ 10000</h2>
                <canvas id="guessCanvas" width="450" height="220" style="margin:25px auto;display:block;"></canvas>
                <div style="text-align:center;">
                    <input type="number" id="guessInput" min="1" max="10000" value=""
                           style="padding:20px;width:250px;font-size:1.8rem;border:3px solid #44ff44;border-radius:25px;background:rgba(0,0,0,0.8);color:#44ff44;font-family:'Orbitron';text-align:center;">
                    <br><button class="btn" onclick="checkGuess()" style="margin:25px;font-size:1.4rem;padding:20px 40px;">üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
                    <div id="guessFeedback" style="font-size:3rem;font-weight:900;margin:30px;"></div>
                    <div style="font-size:1.6rem;color:#88ff88;">
                        –•–æ–¥–æ–≤: <span id="attempts">0</span> | –û—á–∫–∏: <span id="guessScore">10000</span>
                    </div>
                    <div style="margin:25px 0;">
                        <button class="btn" onclick="newGame()" style="margin:10px;">üîÑ –ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
                        <button class="btn" onclick="saveGuessScore()" style="margin:10px;">üíæ –í —Ç–æ–ø</button>
                    </div>
                </div>
            `;
            document.getElementById('gamesMenu').innerHTML = html;
            document.getElementById('guessInput').focus();
        }

        function checkGuess() {
            const guess = parseInt(document.getElementById('guessInput').value);
            if (!guess || guess < 1 || guess > 10000) {
                document.getElementById('guessFeedback').textContent = '‚ùå –í–≤–µ–¥–∏ —á–∏—Å–ª–æ 1-10000!';
                document.getElementById('guessFeedback').style.color = '#ff4444';
                return;
            }
            
            attempts++;
            document.getElementById('attempts').textContent = attempts;
            const score = Math.max(0, 10000 - attempts * 5);
            document.getElementById('guessScore').textContent = score;

            const diff = Math.abs(guess - secretNumber);
            let feedback = '';

            if (diff === 0) {
                feedback = `üéâ –£–ì–ê–î–ê–õ! ${secretNumber} –∑–∞ ${attempts} —Ö–æ–¥–æ–≤! üî•`;
                document.getElementById('guessFeedback').style.color = '#ffd700';
            } else if (diff <= 50) {
                feedback = `üî• –û–ß–ï–ù–¨ –ë–õ–ò–ó–ö–û! (${diff})`;
                document.getElementById('guessFeedback').style.color = '#ffaa00';
            } else if (diff <= 200) {
                feedback = guess < secretNumber ? '‚ûï –ë–æ–ª—å—à–µ!' : '‚ûñ –ú–µ–Ω—å—à–µ!';
                document.getElementById('guessFeedback').style.color = '#44ff44';
            } else {
                feedback = guess < secretNumber ? `üìà –ù–∞–º–Ω–æ–≥–æ –±–æ–ª—å—à–µ! (+${diff})` : `üìâ –ù–∞–º–Ω–æ–≥–æ –º–µ–Ω—å—à–µ! (-${diff})`;
                document.getElementById('guessFeedback').style.color = '#8888ff';
            }

            document.getElementById('guessFeedback').textContent = feedback;
            document.getElementById('guessInput').value = '';
            document.getElementById('guessInput').focus();
        }

        function newGame() {
            secretNumber = Math.floor(Math.random() * 10000) + 1;
            attempts = 0;
            document.getElementById('attempts').textContent = 0;
            document.getElementById('guessScore').textContent = 10000;
            document.getElementById('guessFeedback').textContent = '';
            document.getElementById('guessInput').focus();
        }

        function saveGuessScore() {
            const score = parseInt(document.getElementById('guessScore').textContent) || 0;
            fetch('/save_score', {
                method: 'POST', headers: {'Content-Type': 'application/json'},
                credentials: 'include',
                body: JSON.stringify({game: 'guess', score})
            }).then(res => res.json()).then(data => {
                if (data.success) {
                    alert(`‚úÖ ${score} –æ—á–∫–æ–≤ –≤ —Ç–æ–ø! üéØ`);
                    loadGuessGame();
                } else {
                    alert('üîí –í–æ–π–¥–∏ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è!');
                }
            }).catch(() => alert('üîí –í–æ–π–¥–∏ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è!'));
        }

        // Enter –≤ —É–≥–∞–¥–∞–π–∫–µ
        document.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && currentGame === 'guess') checkGuess();
        });
    </script>
</body>
</html>
