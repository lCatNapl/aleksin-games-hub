<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéÆ Aleksin Games Hub</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap');
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Orbitron', monospace;
            background: linear-gradient(-45deg, #0f0f23, #1a1a2e, #16213e, #0f3460);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
            color: #e0e0e0; min-height: 100vh; overflow-x: hidden;
            position: relative;
        }
        
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .stars {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(2px 2px at 20px 30px, #eee, transparent),
                        radial-gradient(2px 2px at 40px 70px, #fff, transparent),
                        radial-gradient(1px 1px at 90px 40px, #fff, transparent);
            background-repeat: repeat; background-size: 100px 100px;
            animation: sparkle 20s linear infinite;
            z-index: -1;
        }
        
        @keyframes sparkle { 100% { transform: translateY(50px); } }
        
        .container { max-width: 1400px; margin: 0 auto; padding: 20px; position: relative; z-index: 1; }
        
        .logo {
            text-align: center; margin: 40px 0; position: relative;
        }
        .logo h1 {
            font-size: clamp(2.5em, 8vw, 6em); font-weight: 900;
            background: linear-gradient(45deg, #44ff44, #00ff88, #44ff44);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            text-shadow: 0 0 40px rgba(68, 255, 68, 0.6); animation: glow 2s ease-in-out infinite alternate;
        }
        @keyframes glow { from { filter: drop-shadow(0 0 20px #44ff44); } to { filter: drop-shadow(0 0 40px #44ff44); } }
        
        .status-bar {
            background: rgba(0,0,0,0.8); backdrop-filter: blur(20px); border: 2px solid rgba(68,255,68,0.3);
            border-radius: 25px; padding: 20px; margin-bottom: 30px; display: flex; justify-content: space-between;
            align-items: center; box-shadow: 0 10px 40px rgba(0,255,0,0.2);
        }
        
        .welcome-screen {
            min-height: 60vh; display: flex; flex-direction: column; justify-content: center; align-items: center;
            background: rgba(255,255,255,0.03); border-radius: 30px; border: 2px solid rgba(68,255,68,0.3);
            backdrop-filter: blur(20px); text-align: center; padding: 60px 40px;
        }
        
        .games-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 30px;
            margin-bottom: 40px; display: none; /* –°–ö–†–´–¢–û –¥–æ –ª–æ–≥–∏–Ω–∞ */
        }
        
        .game-card {
            background: linear-gradient(145deg, rgba(26,26,42,0.9), rgba(42,42,68,0.9));
            border: 2px solid rgba(68,255,68,0.4); border-radius: 25px; padding: 35px; text-align: center;
            cursor: pointer; transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            backdrop-filter: blur(15px); position: relative; overflow: hidden;
        }
        .game-card::before {
            content: ''; position: absolute; top: 0; left: -100%; width: 100%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(68,255,68,0.2), transparent);
            transition: left 0.5s; 
        }
        .game-card:hover::before { left: 100%; }
        .game-card:hover {
            transform: translateY(-15px) scale(1.02); border-color: #44ff44;
            box-shadow: 0 25px 60px rgba(68,255,68,0.4); background: rgba(68,255,68,0.1);
        }
        
        .game-icon { font-size: 5em; margin-bottom: 20px; filter: drop-shadow(0 0 20px currentColor); }
        .game-card h2 { font-size: 1.8em; margin-bottom: 15px; color: #44ff44; }
        .game-card p { font-size: 1.1em; opacity: 0.9; }
        
        .dashboard { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-top: 30px; display: none; }
        .leaderboard, .tournament {
            background: linear-gradient(145deg, rgba(0,0,0,0.8), rgba(20,20,50,0.8)); 
            border: 2px solid rgba(68,255,68,0.3); border-radius: 25px; padding: 30px;
            backdrop-filter: blur(20px); max-height: 400px; overflow-y: auto;
            box-shadow: 0 15px 50px rgba(0,0,0,0.5);
        }
        .leader-item, .tournament-item {
            display: flex; justify-content: space-between; padding: 15px 20px; margin: 10px 0;
            background: rgba(68,255,68,0.15); border-radius: 15px; font-size: 1.1em;
            border-left: 4px solid #44ff44; transition: all 0.3s;
        }
        .leader-item:hover { background: rgba(68,255,68,0.25); transform: translateX(10px); }
        
        .modal {
            display: none; position: fixed; z-index: 10000; left: 0; top: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9); backdrop-filter: blur(10px);
        }
        .modal-content {
            background: linear-gradient(145deg, rgba(15,15,35,0.95), rgba(26,26,42,0.95));
            margin: 8% auto; padding: 50px; border-radius: 30px; width: 90%; max-width: 500px;
            border: 2px solid rgba(68,255,68,0.5); box-shadow: 0 30px 80px rgba(68,255,68,0.3);
            backdrop-filter: blur(25px); position: relative; animation: modalSlide 0.5s ease;
        }
        @keyframes modalSlide { from { opacity: 0; transform: translateY(-50px); } to { opacity: 1; transform: translateY(0); } }
        
        .modal-buttons { display: flex; gap: 15px; justify-content: center; margin-top: 30px; }
        .modal-btn {
            padding: 18px 40px; border: none; border-radius: 20px; cursor: pointer; font-size: 1.2em;
            font-weight: 700; flex: 1; font-family: 'Orbitron', monospace; transition: all 0.3s;
            text-transform: uppercase; letter-spacing: 1px;
        }
        .btn-primary {
            background: linear-gradient(45deg, #44ff44, #00ff88); color: #000;
            box-shadow: 0 10px 30px rgba(68,255,68,0.4);
        }
        .btn-primary:hover { transform: translateY(-3px); box-shadow: 0 15px 40px rgba(68,255,68,0.6); }
        .btn-secondary { background: rgba(100,100,100,0.8); color: white; }
        #logout { padding: 12px 25px; border-radius: 15px; font-size: 1em; margin-left: 10px; }
        
        input {
            width: 100%; padding: 20px; font-size: 1.2em; border-radius: 20px;
            border: 2px solid rgba(68,255,68,0.4); background: rgba(0,0,0,0.7);
            color: #e0e0e0; margin: 15px 0; font-family: 'Orbitron', monospace;
            transition: all 0.3s; backdrop-filter: blur(10px);
        }
        input:focus { outline: none; border-color: #44ff44; box-shadow: 0 0 20px rgba(68,255,68,0.5); }
        
        #warning-text {
            background: linear-gradient(45deg, #ff4444, #ff8888); color: #000; padding: 20px;
            border-radius: 15px; margin: 20px 0; display: none; font-weight: 700; text-align: center;
            box-shadow: 0 10px 30px rgba(255,68,68,0.4); animation: shake 0.5s;
        }
        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-10px); } 75% { transform: translateX(10px); } }
        
        #game-container { min-height: 500px; display: none; }
        canvas { border: 4px solid #44ff44; border-radius: 20px; background: #000; display: block; margin: 20px auto; box-shadow: 0 20px 60px rgba(68,255,68,0.3); }
        
        .locked { opacity: 0.5; pointer-events: none; }
        @media (max-width: 768px) {
            .dashboard { grid-template-columns: 1fr; } .games-grid { grid-template-columns: 1fr; }
            .status-bar { flex-direction: column; gap: 15px; text-align: center; }
        }
    </style>
</head>
<body>
    <div class="stars"></div>
    <div class="container">
        <div class="logo">
            <h1>üéÆ ALEKSIN GAMES HUB</h1>
        </div>
        
        <div class="status-bar">
            <span id="status">üîí –ì–æ—Å—Ç—å</span>
            <div>
                <button id="loginBtn" onclick="showAuth('login')">–í–æ–π—Ç–∏</button>
                <button id="registerBtn" onclick="showAuth('register')" style="margin-left:15px;">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
                <button id="logout" onclick="logout()" style="display:none;">üö™ –í—ã—Ö–æ–¥</button>
            </div>
        </div>
        
        <!-- –≠–ö–†–ê–ù –î–û –õ–û–ì–ò–ù–ê -->
        <div id="welcomeScreen" class="welcome-screen">
            <h2 style="font-size: 2.5em; margin-bottom: 20px; color: #44ff44;">üöÄ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</h2>
            <p style="font-size: 1.5em; max-width: 600px; line-height: 1.6;">
                –í–æ–π–¥–∏ –∏–ª–∏ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Å—è, —á—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å <strong>üêç –ó–º–µ–π–∫—É</strong>, <strong>üéØ –£–≥–∞–¥–∞–π–∫—É 1-10000</strong>, 
                <strong>üèÜ –¢–æ–ø-10 –∏–≥—Ä–æ–∫–æ–≤</strong> –∏ <strong>‚öîÔ∏è –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ —Ç—É—Ä–Ω–∏—Ä—ã!</strong>
            </p>
        </div>
        
        <!-- –ò–ì–†–´ (—Å–∫—Ä—ã—Ç—ã –¥–æ –ª–æ–≥–∏–Ω–∞) -->
        <div class="games-grid" id="gamesMenu">
            <div class="game-card" onclick="loadSnakeGame()">
                <div class="game-icon" style="color: lime;">üêç</div>
                <h2>–ó–º–µ–π–∫–∞</h2>
                <p>–°–≤–∞–π–ø—ã üì± ‚Ä¢ WASD ‚Ä¢ –†–µ–∫–æ—Ä–¥—ã ‚Ä¢ –¢—É—Ä–Ω–∏—Ä—ã</p>
            </div>
            <div class="game-card" onclick="loadGuessGame()">
                <div class="game-icon" style="color: #ffaa00;">üéØ</div>
                <h2>–£–≥–∞–¥–∞–π —á–∏—Å–ª–æ</h2>
                <p>1-10000 ‚Ä¢ –ë–µ–∑–ª–∏–º–∏—Ç ‚Ä¢ üî• –û—á–µ–Ω—å –±–ª–∏–∑–∫–æ! ‚Ä¢ –¢–æ–ø –æ—á–∫–æ–≤</p>
            </div>
        </div>
        
        <div id="game-container"></div>
        
        <!-- –î–≠–®–ë–û–†–î (—Å–∫—Ä—ã—Ç –¥–æ –ª–æ–≥–∏–Ω–∞) -->
        <div class="dashboard" id="dashboard">
            <div class="leaderboard">
                <h3 style="color: #44ff44; margin-bottom: 20px;">üèÜ –¢–æ–ø-10 –∏–≥—Ä–æ–∫–æ–≤</h3>
                <div id="leaderboard-list">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
            </div>
            <div class="tournament">
                <h3 style="color: #ffaa00; margin-bottom: 20px;">‚öîÔ∏è –¢—É—Ä–Ω–∏—Ä (24—á)</h3>
                <div id="tournament-info">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
            </div>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–ö–ê –ê–í–¢–û–†–ò–ó–ê–¶–ò–ò -->
    <div id="auth-modal" class="modal">
        <div class="modal-content">
            <span onclick="closeAuth()" style="float:right; cursor:pointer; font-size:2.5em; color:#44ff44;">√ó</span>
            <h2 id="modal-title" style="color:#44ff44; margin-bottom:30px; font-size:2.2em;">–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è</h2>
            <div id="warning-text">‚ö†Ô∏è –≠—Ç–æ—Ç –ª–æ–≥–∏–Ω —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç!</div>
            <input type="text" id="username" placeholder="üë§ –õ–æ–≥–∏–Ω" maxlength="20">
            <input type="password" id="password" placeholder="üîí –ü–∞—Ä–æ–ª—å">
            <div class="modal-buttons">
                <button class="modal-btn btn-primary" id="submit-btn">–í–æ–π—Ç–∏</button>
                <button class="modal-btn btn-secondary" onclick="closeAuth()">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>

    <script>
        let currentGame = ''; let isLoggedIn = false; let gameData = {score: 0};
        let gameInterval, snake = {x:10,y:10,dx:0,dy:0,cells:[],maxCells:4}, food = {x:15,y:15};
        let secretNumber = 0, attempts = 0;

        // üî• 5x –ù–ï–£–ù–ò–ß–¢–û–ñ–ò–ú–´–ï –ö–ù–û–ü–ö–ò
        function initButtons() {
            const btn = document.getElementById('submit-btn');
            if (btn && !btn.dataset.fixed) {
                btn.dataset.fixed = 'true';
                btn.onclick = authUser; btn.onmousedown = authUser; btn.ontouchstart = authUser;
                btn.onpointerdown = authUser; console.log('üî• –ö–ù–û–ü–ö–ò –ù–ï–£–ù–ò–ß–¢–û–ñ–ò–ú–´!');
            }
        }

        async function checkUserStatus() {
            try {
                const res = await fetch('/status', {credentials: 'include'});
                const data = await res.json();
                if (data.logged_in) {
                    document.getElementById('status').textContent = `üëã ${data.username}`;
                    document.getElementById('logout').style.display = 'inline-block';
                    document.getElementById('welcomeScreen').style.display = 'none';
                    document.getElementById('gamesMenu').style.display = 'grid';
                    document.getElementById('dashboard').style.display = 'grid';
                    document.getElementById('game-container').style.display = 'block';
                    isLoggedIn = true; loadLeaderboard(); loadTournament();
                } else {
                    document.getElementById('status').textContent = 'üîí –ì–æ—Å—Ç—å';
                    document.getElementById('logout').style.display = 'none';
                    document.getElementById('welcomeScreen').style.display = 'flex';
                    document.getElementById('gamesMenu').style.display = 'none';
                    document.getElementById('dashboard').style.display = 'none';
                    document.getElementById('game-container').style.display = 'none';
                    isLoggedIn = false;
                }
            } catch (e) { console.error('Status check:', e); }
        }

        async function authUser() {
            console.log('üî• –ö–ù–û–ü–ö–ê –ñ–ò–í–ê!');
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value;
            const errorDiv = document.getElementById('warning-text'), mode = document.getElementById('modal-title').textContent;
            
            if (!username || !password) {
                errorDiv.textContent = '‚ö†Ô∏è –ó–∞–ø–æ–ª–Ω–∏ –≤—Å–µ –ø–æ–ª—è!'; errorDiv.style.display = 'block'; return;
            }
            
            try {
                const endpoint = mode === '–í—Ö–æ–¥' ? 'login' : 'register';
                const res = await fetch('/' + endpoint, {
                    method: 'POST', credentials: 'include',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({username, password})
                });
                const data = await res.json();
                
                if (data.success) {
                    checkUserStatus(); closeAuth(); console.log('‚úÖ –í–û–®–Å–õ:', data.username);
                } else {
                    errorDiv.textContent = data.error || '–û—à–∏–±–∫–∞!'; errorDiv.style.display = 'block';
                }
            } catch (e) {
                console.error('Auth:', e); errorDiv.textContent = '‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏!'; errorDiv.style.display = 'block';
            }
        }

        async function logout() {
            try {
                await fetch('/logout', {method: 'POST', credentials: 'include'});
                checkUserStatus();
            } catch (e) { console.error('Logout:', e); }
        }

        function showAuth(mode) {
            document.getElementById('auth-modal').style.display = 'block';
            document.getElementById('modal-title').textContent = mode === 'login' ? '–í—Ö–æ–¥' : '–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è';
            document.getElementById('username').value = ''; document.getElementById('password').value = '';
            document.getElementById('warning-text').style.display = 'none'; initButtons();
        }

        function closeAuth() { document.getElementById('auth-modal').style.display = 'none'; }

        async function loadLeaderboard() {
            try {
                const res = await fetch('/leaderboard');
                const leaders = await res.json();
                document.getElementById('leaderboard-list').innerHTML = 
                    leaders.length ? leaders.map((p,i) => `<div class="leader-item">${i+1}Ô∏è‚É£ ${p.username} - ${p.score}</div>`).join('') : 'üë• –ü—É—Å—Ç–æ...';
            } catch (e) { document.getElementById('leaderboard-list').innerHTML = '‚ùå –û—à–∏–±–∫–∞'; }
        }

        async function loadTournament() {
            try {
                const res = await fetch('/tournament');
                const data = await res.json();
                const info = document.getElementById('tournament-info');
                if (data.active) {
                    const timeLeft = new Date(data.end_time) - Date.now();
                    const hours = Math.floor(timeLeft / 3600000);
                    const minutes = Math.floor((timeLeft % 3600000) / 60000);
                    info.innerHTML = `‚è∞ <strong>${hours}—á ${minutes}–º</strong><br>` + 
                        Object.entries(data.scores || {}).slice(0,5).map(([u,s],i) => 
                            `<div class="tournament-item">${i+1}Ô∏è‚É£ ${u}: <strong>${s}</strong></div>`).join('') || '–ù–∏–∫—Ç–æ –Ω–µ –∏–≥—Ä–∞–ª...';
                }
            } catch (e) { document.getElementById('tournament-info').innerHTML = '‚ùå –û—à–∏–±–∫–∞'; }
        }

        // –ó–ú–ï–ô–ö–ê –∏ –£–ì–ê–î–ê–ô–ö–ê (–∫–∞–∫ —Ä–∞–Ω—å—à–µ - —Å–æ–∫—Ä–∞—â–µ–Ω–æ)
        function loadSnakeGame() { alert('üêç –ó–º–µ–π–∫–∞ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ! –ò–≥—Ä–∞–π –≤ üéØ –£–≥–∞–¥–∞–π–∫—É!'); }
        function loadGuessGame() { alert('üéØ –£–≥–∞–¥–∞–π–∫–∞ 1-10000 —Å–∫–æ—Ä–æ!'); }
        function saveScore() { if (!isLoggedIn) return; }

        // –°–¢–ê–†–¢
        document.addEventListener('DOMContentLoaded', () => {
            checkUserStatus();
            setInterval(() => { if (isLoggedIn) { loadLeaderboard(); loadTournament(); } }, 30000);
            setInterval(initButtons, 1000);
        });
    </script>
</body>
</html>
