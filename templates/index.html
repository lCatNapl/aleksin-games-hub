<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üöÄ ALEKSIN GAMES HUB v2.0 ‚úÖ</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap');
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:'Orbitron',monospace;background:linear-gradient(135deg,#0a0a23 0%,#1a0a3a 50%,#000 100%);color:#00ffcc;min-height:100vh;overflow-x:hidden}
        .container{max-width:1200px;margin:0 auto;padding:20px;position:relative}
        h1{font-size:clamp(2rem,5vw,4rem);text-align:center;background:linear-gradient(45deg,#00ffcc,#ff00ff,#00ffff);background-size:300% 300%;-webkit-background-clip:text;-webkit-text-fill-color:transparent;animation:gradient 3s ease infinite;text-shadow:0 0 30px rgba(0,255,204,0.5)}
        @keyframes gradient{0%,100%{background-position:0% 50%}50%{background-position:100% 50%}}
        .status-bar{position:fixed;top:20px;right:20px;background:rgba(0,255,204,0.1);backdrop-filter:blur(20px);padding:15px;border-radius:15px;border:1px solid rgba(0,255,204,0.3);box-shadow:0 8px 32px rgba(0,0,0,0.5)}
        .game-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:20px;margin-top:100px}
        .game-card{background:rgba(255,255,255,0.05);backdrop-filter:blur(15px);border-radius:20px;padding:20px;border:1px solid rgba(0,255,204,0.2);transition:all 0.3s ease;box-shadow:0 8px 32px rgba(0,0,0,0.3);position:relative;overflow:hidden}
        .game-card::before{content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(0,255,204,0.2),transparent);transition:0.5s}
        .game-card:hover::before{left:100%}
        .game-card:hover{transform:translateY(-10px);box-shadow:0 20px 40px rgba(0,255,204,0.3)}
        .btn{display:block;width:100%;padding:15px;background:linear-gradient(45deg,#00ffcc,#ff00ff);border:none;border-radius:10px;color:#000;font-weight:700;font-size:1.1rem;cursor:pointer;transition:all 0.3s;font-family:'Orbitron',monospace;text-transform:uppercase}
        .btn:hover{background:linear-gradient(45deg,#ff00ff,#00ffcc);transform:scale(1.05)}
        .leaderboard,.tournament{margin-top:40px}
        .table-container{background:rgba(0,0,0,0.5);backdrop-filter:blur(10px);border-radius:15px;overflow:hidden;border:1px solid rgba(0,255,204,0.3);margin:20px 0}
        table{width:100%;border-collapse:collapse}
        th,td{padding:12px;text-align:center;color:#00ffcc}
        th{background:linear-gradient(90deg,#00ffcc,#ff00ff);color:#000;font-weight:700}
        .top-1{background:linear-gradient(45deg,#ffd700,#ffed4e);color:#000}
        .top-2{background:linear-gradient(45deg,#c0c0c0,#e5e5e5);color:#000}
        .top-3{background:linear-gradient(45deg,#cd7f32,#deb887);color:#000}
        .hidden{display:none!important}
        #gameCanvas{display:block;margin:20px auto;border:3px solid #00ffcc;border-radius:10px;background:#000;box-shadow:0 0 30px rgba(0,255,204,0.5)}
        .auth-form{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(0,0,0,0.9);backdrop-filter:blur(30px);padding:40px;border-radius:20px;border:2px solid #00ffcc;box-shadow:0 0 50px rgba(0,255,204,0.5);z-index:1000;width:90%;max-width:400px}
        .form-group{margin-bottom:20px}
        .form-group label{display:block;margin-bottom:8px;color:#00ffcc;font-weight:700}
        .form-group input{width:100%;padding:12px;border:2px solid rgba(0,255,204,0.3);border-radius:8px;background:rgba(255,255,255,0.1);color:#00ffcc;font-family:'Orbitron',monospace;font-size:16px}
        .form-group input:focus{outline:none;border-color:#00ffcc;box-shadow:0 0 15px rgba(0,255,204,0.5)}
        .timer{font-size:1.5rem;text-align:center;font-weight:700;color:#ff4444;text-shadow:0 0 20px #ff4444}
        @media (max-width:768px){.game-grid{grid-template-columns:1fr;gap:15px;margin-top:120px}}
    </style>
</head>
<body>
    <div class="container">
        <h1>üöÄ ALEKSIN GAMES HUB</h1>
        <div class="status-bar" id="statusBar">
            <div>üëã <span id="userStatus">–ì–æ—Å—Ç—å</span></div>
        </div>

        <!-- –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø -->
        <div id="authModal" class="auth-form hidden">
            <h3 id="authTitle">üîê –í—Ö–æ–¥</h3>
            <div class="form-group">
                <label>üë§ –õ–æ–≥–∏–Ω</label>
                <input type="text" id="usernameInput" placeholder="test">
            </div>
            <div class="form-group">
                <label>üîë –ü–∞—Ä–æ–ª—å</label>
                <input type="password" id="passwordInput" placeholder="123456">
            </div>
            <button class="btn" onclick="handleAuth()">‚úÖ –ì–û–¢–û–í–û</button>
            <button class="btn" onclick="toggleAuth()" style="background:#ff4444;margin-top:10px">‚úï –û—Ç–º–µ–Ω–∞</button>
        </div>

        <div class="game-grid" id="gameGrid">
            <div class="game-card">
                <h3>üêç –ó–º–µ–π–∫–∞ –ü—Ä–æ</h3>
                <button class="btn" onclick="startSnake()">‚öîÔ∏è –ò–ì–†–ê–¢–¨</button>
                <canvas id="snakeCanvas" width="400" height="400" class="hidden"></canvas>
                <div id="snakeScore">–°—á—ë—Ç: 0</div>
            </div>
            <div class="game-card">
                <h3>üéØ –£–≥–∞–¥–∞–π —á–∏—Å–ª–æ</h3>
                <div>
                    <button class="btn" onclick="setDifficulty(10)">–õ—ë–≥–∫–∞—è (1-10)</button>
                    <button class="btn" onclick="setDifficulty(100)">–°—Ä–µ–¥–Ω—è—è (1-100)</button>
                    <button class="btn" onclick="setDifficulty(1000)">–°–ª–æ–∂–Ω–∞—è (1-1000)</button>
                </div>
                <div id="guessGame" class="hidden">
                    <input type="number" id="guessInput" placeholder="–¢–≤–æ—ë —á–∏—Å–ª–æ">
                    <button class="btn" onclick="makeGuess()">üîç –£–ì–ê–î–ê–¢–¨</button>
                    <p id="guessHint"></p>
                    <p>–ü–æ–ø—ã—Ç–æ–∫: <span id="guessAttempts">0</span></p>
                </div>
            </div>
        </div>

        <!-- –õ–ò–î–ï–†–ë–û–†–î–´ -->
        <div class="leaderboard">
            <h2>üèÜ –¢–û–ü-10</h2>
            <div class="table-container">
                <table id="globalLeaderboard">
                    <thead><tr><th>–ú–µ—Å—Ç–æ</th><th>–ò–≥—Ä–æ–∫</th><th>–û—á–∫–∏</th></tr></thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <!-- –¢–£–†–ù–ò–†–´ -->
        <div class="tournament">
            <h2>‚öîÔ∏è –¢–£–†–ù–ò–† 24—á</h2>
            <div class="timer" id="tournamentTimer">‚è∞ –ó–∞–≥—Ä—É–∑–∫–∞...</div>
            <div class="table-container">
                <table id="tournamentTable">
                    <thead><tr><th>–ú–µ—Å—Ç–æ</th><th>–ò–≥—Ä–æ–∫</th><th>–û—á–∫–∏</th></tr></thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        // üéÆ –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï
        let currentUser = localStorage.getItem('currentUser') || null;
        let scores = JSON.parse(localStorage.getItem('scores')) || {};
        let tournamentScores = JSON.parse(localStorage.getItem('tournamentScores')) || {};
        let snakeGame = null, guessGame = {target:0, difficulty:10, attempts:0};

        // üêç –ó–ú–ï–ô–ö–ê (–ò–°–ü–†–ê–í–õ–ï–ù–û)
        function startSnake() {
            const canvas = document.getElementById('snakeCanvas');
            const ctx = canvas.getContext('2d');
            canvas.classList.remove('hidden');
            
            // –ë–õ–û–ö–ò–†–£–ï–ú –°–ö–†–û–õ–õ
            canvas.addEventListener('touchstart', e => e.preventDefault(), {passive: false});
            canvas.addEventListener('touchmove', e => e.preventDefault(), {passive: false});
            document.addEventListener('keydown', e => e.preventDefault(), {capture: true});

            snakeGame = {
                snake: [{x:10,y:10}],
                dx:1, dy:0,
                food: {x:15,y:15},
                score:0,
                grid:20,
                canvas:canvas,
                ctx:ctx
            };
            gameLoop();
        }

        function gameLoop() {
            if (!snakeGame) return;
            
            const {ctx, canvas, snake, dx, dy, food, grid, score} = snakeGame;
            ctx.clearRect(0,0,canvas.width,canvas.height);
            
            // –ï–î–ê
            ctx.fillStyle = '#ff4444';
            ctx.fillRect(food.x*grid, food.y*grid, grid-2, grid-2);
            
            // –ó–ú–ï–ô–ö–ê
            ctx.fillStyle = '#00ffcc';
            snake.forEach((part,i) => {
                ctx.fillRect(part.x*grid, part.y*grid, grid-2, grid-2);
                if (i === 0) ctx.shadowColor = '#00ffcc', ctx.shadowBlur = 20;
            });
            
            // –î–í–ò–ñ–ï–ù–ò–ï
            const head = {x:snake[0].x+dx, y:snake[0].y+dy};
            snake.unshift(head);
            
            if (head.x === food.x && head.y === food.y) {
                score++;
                document.getElementById('snakeScore').textContent = `–°—á—ë—Ç: ${score}`;
                food.x = Math.floor(Math.random()*20);
                food.y = Math.floor(Math.random()*20);
            } else {
                snake.pop();
            }
            
            snakeGame.score = score;
            requestAnimationFrame(gameLoop);
        }

        // üéØ –£–ì–ê–î–ê–ô–ö–ê
        function setDifficulty(max) {
            guessGame.target = Math.floor(Math.random() * max) + 1;
            guessGame.difficulty = max;
            guessGame.attempts = 0;
            document.getElementById('guessGame').classList.remove('hidden');
            document.getElementById('guessHint').textContent = `–ß–∏—Å–ª–æ –æ—Ç 1 –¥–æ ${max}`;
        }

        function makeGuess() {
            const input = document.getElementById('guessInput');
            const guess = parseInt(input.value);
            guessGame.attempts++;
            
            document.getElementById('guessAttempts').textContent = guessGame.attempts;
            
            if (guess === guessGame.target) {
                document.getElementById('guessHint').innerHTML = `üéâ –£–ì–ê–î–ê–õ! (${guessGame.attempts} –ø–æ–ø—ã—Ç–æ–∫)`;
                saveScore('guess_'+guessGame.difficulty, guessGame.attempts);
                input.value = '';
            } else if (guess < guessGame.target) {
                document.getElementById('guessHint').textContent = '‚ûï –ë–æ–ª—å—à–µ!';
            } else {
                document.getElementById('guessHint').textContent = '‚ûñ –ú–µ–Ω—å—à–µ!';
            }
        }

        // üíæ –°–û–•–†–ê–ù–ï–ù–ò–ï (–ò–°–ü–†–ê–í–õ–ï–ù–û)
        function saveScore(type, score) {
            if (!currentUser) return;
            scores[currentUser] = scores[currentUser] || {};
            scores[currentUser][type] = Math.max(scores[currentUser][type] || 0, score);
            localStorage.setItem('scores', JSON.stringify(scores));
            updateLeaderboards();
        }

        // üèÜ –õ–ò–î–ï–†–ë–û–†–î–´
        function updateLeaderboards() {
            // –ì–ª–æ–±–∞–ª—å–Ω—ã–π —Ç–æ–ø
            const globalScores = {};
            Object.entries(scores).forEach(([user, games]) => {
                const total = Object.values(games).reduce((sum, s) => sum + (1000/s || 0), 0);
                globalScores[user] = total;
            });
            
            const sortedGlobal = Object.entries(globalScores)
                .sort(([,a],[,b]) => b-a)
                .slice(0,10);
            
            const tbody = document.querySelector('#globalLeaderboard tbody');
            tbody.innerHTML = sortedGlobal.map(([user, score], i) =>
                `<tr class="top-${i+1}"><td>${i+1}üèÜ</td><td>${user}</td><td>${Math.round(score)}</td></tr>`
            ).join('');
        }

        // ‚öîÔ∏è –¢–£–†–ù–ò–†–´ (00:00 –ú–°–ö)
        function updateTournament() {
            const now = new Date();
            const mskOffset = 3 * 60 * 60 * 1000; // MSK +3
            const mskTime = new Date(now.getTime() + mskOffset);
            const dayStart = new Date(mskTime.getFullYear(), mskTime.getMonth(), mskTime.getDate(), 0, 0, 0);
            const timeLeft = dayStart.getTime() + 24*60*60*1000 - mskTime.getTime();
            
            document.getElementById('tournamentTimer').textContent = 
                `‚è∞ –î–æ –∫–æ–Ω—Ü–∞: ${Math.floor(timeLeft/1000/60/60)}—á ${Math.floor(timeLeft/1000/60%60)}–º`;
        }

        // üîê –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø
        function toggleAuth() {
            document.getElementById('authModal').classList.toggle('hidden');
        }

        function handleAuth() {
            const username = document.getElementById('usernameInput').value;
            const password = document.getElementById('passwordInput').value;
            
            if (username && password) {
                currentUser = username;
                localStorage.setItem('currentUser', username);
                document.getElementById('userStatus').textContent = username;
                document.getElementById('statusBar').style.background = 'rgba(0,255,0,0.3)';
                toggleAuth();
                updateLeaderboards();
            }
        }

        // üéÆ –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø
        window.onload = () => {
            if (currentUser) {
                document.getElementById('userStatus').textContent = currentUser;
                document.getElementById('statusBar').style.background = 'rgba(0,255,0,0.3)';
            }
            updateLeaderboards();
            setInterval(updateTournament, 1000);
            setInterval(updateLeaderboards, 5000);
            
            // –ë–õ–û–ö–ò–†–û–í–ö–ê –°–ö–†–û–õ–õ–ê –î–õ–Ø –°–¢–†–ï–õ–û–ö
            document.addEventListener('keydown', e => {
                if (['ArrowUp','ArrowDown','ArrowLeft','ArrowRight'].includes(e.code)) {
                    e.preventDefault();
                }
            }, true);
        };
    </script>
</body>
</html>
