<!DOCTYPE html>
<html>
<head>
    <title>–ò–≥—Ä–æ–≤–æ–π –•–∞–±</title>
    <style>
        body { background: linear-gradient(45deg, #667eea, #764ba2); color: white; font-family: Arial; text-align: center; padding: 50px; }
        button { font-size: 24px; padding: 20px 40px; margin: 20px; border: none; border-radius: 20px; cursor: pointer; }
        .register-btn { background: #4ecdc4; color: white; }
        .login-btn { background: #45b7aa; color: white; }
        .logout-btn { background: #ff4757; color: white; }
        .game-btn { background: #ff6b6b; font-size: 28px; padding: 25px 50px; }
        .modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); display: none; align-items: center; justify-content: center; }
        .modal-content { background: white; color: black; padding: 40px; border-radius: 20px; width: 400px; }
        input { width: 100%; padding: 15px; margin: 10px 0; font-size: 18px; border-radius: 10px; border: 2px solid #ddd; }
        #user-status { font-size: 28px; margin: 20px; padding: 15px; background: rgba(255,255,255,0.2); border-radius: 20px; display: inline-block; }
    </style>
</head>
<body>
    <h1 style="font-size: 48px; margin-bottom: 30px;">üéÆ –ò–≥—Ä–æ–≤–æ–π –•–∞–± –ù–∞–∑–∞—Ä</h1>
    
    <div id="user-status">üëã –ì–æ—Å—Ç—å</div>
    
    <!-- üî• –ö–ù–û–ü–ö–ò –û–ì–†–û–ú–ù–´–ï üî• -->
    <div>
        <button class="register-btn" onclick="showAuth('register')">üìù –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø</button>
        <button class="login-btn" onclick="showAuth('login')">üîë –í–•–û–î</button>
        <button class="logout-btn" onclick="logout()" id="logout-btn" style="display:none">üö™ –í—ã–π—Ç–∏</button>
    </div>
    
    <div style="margin: 50px 0;">
        <button class="game-btn" onclick="playGame('guess')">üéØ –£–ì–ê–î–ê–ô –ß–ò–°–õ–û</button>
        <button class="game-btn" onclick="playGame('snake')">üêç –ó–ú–ï–ô–ö–ê</button>
    </div>
    
    <div id="leaderboard" style="margin-top: 50px;"></div>

    <!-- –ú–û–î–ê–õ–ö–ê -->
    <div id="auth-modal" class="modal">
        <div class="modal-content">
            <h2 id="modal-title">–†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø</h2>
            <input id="username" placeholder="–ò–º—è (nazar)" maxlength="20">
            <input id="password" type="password" placeholder="–ü–∞—Ä–æ–ª—å (123456)" maxlength="30">
            <br><button onclick="authUser()" style="width: 100%; font-size: 20px; padding: 15px; margin-top: 20px;">‚úÖ –†–ï–ì–ò–°–¢–†–ò–†–û–í–ê–¢–¨–°–Ø / –í–û–ô–¢–ò</button>
            <div id="auth-error" style="color: red; margin-top: 15px;"></div>
        </div>
    </div>

    <script>
        let isLoggedIn = false;
        
        function showAuth(type) {
            document.getElementById('modal-title').innerText = type === 'register' ? 'üìù –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø' : 'üîë –í–•–û–î';
            document.getElementById('auth-modal').style.display = 'flex';
        }
        
        function closeAuth() {
            document.getElementById('auth-modal').style.display = 'none';
        }
        
        async function authUser() {
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value;
            if (username.length < 3 || password.length < 6) {
                return document.getElementById('auth-error').innerText = '–ò–º—è ‚â•3, –ø–∞—Ä–æ–ª—å ‚â•6!';
            }
            
            const isRegister = document.getElementById('modal-title').innerText.includes('–†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø');
            const url = isRegister ? '/api/register' : '/api/login';
            
            try {
                const res = await fetch(url, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({username, password})
                });
                const data = await res.json();
                
                if (data.success) {
                    document.getElementById('user-status').innerText = `üëã ${data.username || username} ‚úÖ`;
                    document.getElementById('logout-btn').style.display = 'inline-block';
                    closeAuth();
                    alert('‚úÖ –£—Å–ø–µ—Ö! –ò–≥—Ä–∞–π –∏ –±–µ–π —Ä–µ–∫–æ—Ä–¥—ã!');
                } else {
                    document.getElementById('auth-error').innerText = data.error;
                }
            } catch(e) {
                document.getElementById('auth-error').innerText = '–°–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω';
            }
        }
        
        async function logout() {
            await fetch('/api/logout', {method: 'POST'});
            location.reload();
        }
        
        function playGame(game) {
            alert(`üéÆ ${game.toUpperCase()}! ${isLoggedIn ? '–†–µ–∫–æ—Ä–¥—ã —Å–æ—Ö—Ä–∞–Ω—è—Ç—Å—è!' : '–ó–∞–ª–æ–≥–∏–Ω—å—Å—è –¥–ª—è —Ç–æ–ø–∞!'}`);
        }
        
        document.addEventListener('keydown', e => {
            if (e.key === 'Escape') closeAuth();
            if (document.getElementById('auth-modal').style.display === 'flex' && e.key === 'Enter') authUser();
        });
    </script>
</body>
</html>
