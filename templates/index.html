<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéÆ ALEKSIN GAMES HUB 2026 ‚ú®</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Exo+2:wght@300;400;600;800&display=swap');
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Exo 2', sans-serif;
            background: linear-gradient(-45deg, #0f0f23, #1a0033, #330066, #0f0f23);
            color: #fff;
            min-height: 100vh;
            overflow-x: hidden;
            animation: bgShift 15s ease infinite;
            touch-action: none;
        }
        @keyframes bgShift { 0%,100% {background-position: 0% 50%;} 50% {background-position: 100% 50%;} }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        h1 { 
            font-family: 'Orbitron', monospace; 
            font-size: clamp(2rem, 5vw, 3rem); 
            text-align: center; 
            margin-bottom: 30px; 
            background: linear-gradient(45deg, #ff00ff, #00ffff, #ffaa00); 
            -webkit-background-clip: text; 
            -webkit-text-fill-color: transparent; 
            text-shadow: 0 0 30px rgba(255,255,255,0.5);
            animation: glow 2s ease-in-out infinite alternate;
        }
        @keyframes glow { from {filter: drop-shadow(0 0 10px #00ffff);} to {filter: drop-shadow(0 0 20px #ff00ff);} }
        .section { 
            background: rgba(255,255,255,0.08); 
            backdrop-filter: blur(15px); 
            border-radius: 25px; 
            padding: 30px; 
            margin-bottom: 30px; 
            border: 1px solid rgba(255,255,255,0.15);
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            transition: all 0.3s;
        }
        button { 
            background: linear-gradient(45deg, #ff00ff, #00ffff); 
            border: none; 
            padding: 15px 30px; 
            border-radius: 50px; 
            color: #000; 
            font-weight: 700; 
            font-size: 1.1rem; 
            cursor: pointer; 
            transition: all 0.3s; 
            font-family: 'Orbitron', monospace;
            margin: 5px;
            box-shadow: 0 5px 15px rgba(0,255,255,0.3);
            touch-action: manipulation;
        }
        button:hover { transform: scale(1.05) translateY(-2px); box-shadow: 0 15px 30px rgba(255,0,255,0.5); }
        button:active { transform: scale(0.98); }
        input { 
            background: rgba(255,255,255,0.12); 
            border: 2px solid rgba(255,255,255,0.25); 
            padding: 18px; 
            border-radius: 15px; 
            color: #fff; 
            font-size: 1.1rem; 
            width: 220px; 
            margin: 10px; 
            backdrop-filter: blur(10px);
        }
        input:focus { outline: none; border-color: #00ffff; box-shadow: 0 0 20px rgba(0,255,255,0.5); }
        .top-list { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 15px; margin-top: 20px; }
        .top-item { 
            background: linear-gradient(135deg, rgba(0,255,255,0.15), rgba(255,0,255,0.15)); 
            padding: 20px; 
            border-radius: 20px; 
            text-align: center; 
            font-weight: 600;
            border: 1px solid rgba(255,255,255,0.2);
        }
        .medal { font-size: 2rem; display: block; margin-bottom: 10px; }
        canvas { 
            border: 4px solid #00ffff; 
            border-radius: 20px; 
            background: #0a0a0a; 
            display: block; 
            margin: 20px auto; 
            box-shadow: 0 20px 40px rgba(0,255,255,0.3);
            cursor: pointer;
            touch-action: none;
        }
        #userInfo { 
            position: fixed; 
            top: 20px; 
            right: 20px; 
            background: rgba(0,0,0,0.7); 
            backdrop-filter: blur(20px);
            padding: 20px; 
            border-radius: 20px; 
            font-weight: 700; 
            border: 2px solid #00ffff;
            min-width: 200px;
        }
        .hidden { display: none !important; }
        .status { padding: 15px; border-radius: 10px; margin: 15px 0; font-weight: 600; }
        .status.success { background: rgba(0,255,0,0.2); border-left: 5px solid #00ff00; }
        .status.error { background: rgba(255,0,0,0.2); border-left: 5px solid #ff4444; }
        @media (max-width: 768px) { 
            .container { padding: 15px; } 
            h1 { font-size: 2rem; margin-bottom: 20px; } 
            input { width: calc(100% - 30px); }
            canvas { width: 90vw; height: 40vh; max-width: 450px; max-height: 450px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéÆ ALEKSIN GAMES HUB 2026 ‚ú®</h1>
        
        <!-- üîê –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø -->
        <div id="authSection" class="section">
            <h2 style="font-family: 'Orbitron'; font-size: 1.8rem; margin-bottom: 25px;">üîê –í–•–û–î / –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø</h2>
            <input id="usernameInput" placeholder="üë§ –ù–∏–∫ (test)" type="text">
            <input id="passwordInput" placeholder="üîë –ü–∞—Ä–æ–ª—å (1234)" type="password">
            <br>
            <button onclick="login()">üöÄ –í–û–ô–¢–ò</button>
            <button onclick="register()">üìù –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø</button>
            <div id="authStatus" class="status"></div>
        </div>

        <!-- üéÆ –ò–ì–†–´ -->
        <div id="gamesSection" class="hidden">
            <!-- üêç –ó–ú–ï–ô–ö–ê (–ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø) -->
            <div class="section">
                <h2 style="font-family: 'Orbitron';">üêç –ó–ú–ï–ô–ö–ê ULTRA HD</h2>
                <div style="display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; margin-bottom: 20px;">
                    <button onclick="setSnakeDifficulty(1)">üêå –õ–Å–ì–ö–ê–Ø</button>
                    <button onclick="setSnakeDifficulty(2)">‚ö° –ù–û–†–ú–ê–õ–¨–ù–ê–Ø</button>
                    <button onclick="setSnakeDifficulty(3)">üöÄ –•–ê–†–î–ö–û–†</button>
                </div>
                <canvas id="snakeCanvas" width="450" height="450" style="touch-action: none;"></canvas>
                <div style="text-align: center; font-size: 1.3rem; margin: 15px 0;">
                    –°—á—ë—Ç: <span id="snakeScore" style="color: #00ff00; font-family: Orbitron; font-weight: 900; font-size: 1.5rem;">0</span>
                </div>
                <div style="text-align: center;">
                    <button id="startSnakeBtn" onclick="startSnake()" style="display:block; font-size: 1.3rem; padding: 20px 40px;">‚ñ∂Ô∏è –°–¢–ê–†–¢ –ó–ú–ï–ô–ö–ò</button>
                </div>
                <div style="font-size: 0.9rem; opacity: 0.8; text-align: center;">
                    ‚å®Ô∏è –°—Ç—Ä–µ–ª–∫–∏/WASD | üì± –°–≤–∞–π–ø—ã | üñ±Ô∏è –ö–ª–∏–∫
                </div>
            </div>

            <!-- üéØ –£–ì–ê–î–ê–ô–ö–ê -->
            <div class="section">
                <h2 style="font-family: 'Orbitron';">üéØ –£–ì–ê–î–ê–ô –ß–ò–°–õ–û (—É–º–Ω—ã–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏)</h2>
                <div style="display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; margin-bottom: 20px;">
                    <button onclick="setGuessDifficulty(1)">1Ô∏è‚É£ 1-1 000</button>
                    <button onclick="setGuessDifficulty(2)">2Ô∏è‚É£ 1-10 000</button>
                    <button onclick="setGuessDifficulty(3)">3Ô∏è‚É£ 1-100 000</button>
                </div>
                <input id="guessInput" placeholder="üî¢ –í–≤–µ–¥–∏ —á–∏—Å–ª–æ" onkeypress="if(event.key==='Enter') checkGuess()">
                <div id="guessFeedback" style="font-size: 1.3rem; margin: 20px 0; min-height: 60px; line-height: 1.4;"></div>
                <div style="text-align: center; font-size: 1.2rem;">
                    –ü–æ–ø—ã—Ç–æ–∫: <span id="guessAttempts" style="color: #ffaa00;">0</span> | 
                    –î–∏–∞–ø–∞–∑–æ–Ω: <span id="guessRange" style="color: #00ffff;">1-1000</span>
                </div>
                <div style="text-align: center;">
                    <button onclick="startGuessGame()">üîÑ –ù–û–í–ê–Ø –ò–ì–†–ê</button>
                    <button onclick="checkGuess()">‚úÖ –ü–†–û–í–ï–†–ò–¢–¨</button>
                </div>
            </div>
        </div>

        <!-- üèÜ –õ–ò–î–ï–†–ë–û–†–î–´ -->
        <div id="leaderboardsSection" class="hidden">
            <div class="section">
                <h2 style="font-family: 'Orbitron'; font-size: 2rem;">üèÜ –¢–û–ü-10 –†–ï–ö–û–†–î–´</h2>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                    <div><h3 style="color: #00ff00;">üêç –ó–ú–ï–ô–ö–ê</h3><div id="snakeTop10" class="top-list"></div></div>
                    <div><h3 style="color: #ffaa00;">üéØ –£–ì–ê–î–ê–ô–ö–ê</h3><div id="guessTop10" class="top-list"></div></div>
                </div>
            </div>
            <div class="section">
                <h2 style="font-family: 'Orbitron'; font-size: 2rem;">‚öîÔ∏è –¢–£–†–ù–ò–†–´ (00:00 MSK)</h2>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                    <div><h3 style="color: #00ff00;">üêç –ó–ú–ï–ô–ö–ê –¢–£–†–ù–ò–†</h3><div id="snakeTournament"></div></div>
                    <div><h3 style="color: #ffaa00;">üéØ –£–ì–ê–î–ê–ô–ö–ê –¢–£–†–ù–ò–†</h3><div id="guessTournament"></div></div>
                </div>
            </div>
        </div>
    </div>

    <div id="userInfo" class="hidden">
        <div id="currentUser" style="font-size: 1.3rem;"></div>
        <div id="liveStats" style="font-size: 0.9rem;"></div>
        <button onclick="logout()" style="background: linear-gradient(45deg, #ff4444, #ff6666) !important; color: #fff !important; width: 100%;">üö™ –í–´–•–û–î</button>
    </div>

    <script>
        // üéÆ –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï
        let currentUser = '', snakeDifficulty = 1, guessDifficulty = 1;
        let guessNumber = 0, guessAttempts = 0, lastGuessedNumber = 0;
        let snakeScore = 0, gameInterval = null, snake = [], dx = 0, dy = 0, food = {};
        let snakeGameActive = false;
        let tops = { snakeTop10: [], guessTop10: [] }, tournaments = { snake: {}, guess: {} };
        let registeredUsers = JSON.parse(localStorage.getItem('registeredUsers') || '{}');

        // üíæ –°–û–•–†–ê–ù–ï–ù–ò–ï
        function saveData(key, data) { localStorage.setItem(key, JSON.stringify(data)); }
        function loadData() {
            tops.snakeTop10 = JSON.parse(localStorage.getItem('snakeTop10') || '[]');
            tops.guessTop10 = JSON.parse(localStorage.getItem('guessTop10') || '[]');
            tournaments.snake = JSON.parse(localStorage.getItem('snakeTournament') || '{}');
            tournaments.guess = JSON.parse(localStorage.getItem('guessTournament') || '{}');
        }

        // üîê –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø
        function login() {
            const username = document.getElementById('usernameInput').value.trim();
            const password = document.getElementById('passwordInput').value;
            const status = document.getElementById('authStatus');
            if (registeredUsers[username] && registeredUsers[username] === password) {
                currentUser = username; showGames(); 
                status.innerHTML = `‚úÖ ${username} –≤–æ—à—ë–ª!`; status.className = 'status success';
            } else { status.innerHTML = '‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω/–ø–∞—Ä–æ–ª—å'; status.className = 'status error'; }
        }

        function register() {
            const username = document.getElementById('usernameInput').value.trim();
            const password = document.getElementById('passwordInput').value;
            const status = document.getElementById('authStatus');
            if (username && password.length >= 4) {
                if (registeredUsers[username]) { status.innerHTML = 'üë§ –£–∂–µ –µ—Å—Ç—å, –≤–æ–π–¥–∏!'; status.className = 'status error'; return; }
                registeredUsers[username] = password; saveData('registeredUsers', registeredUsers);
                status.innerHTML = `üìù ${username} –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω!`; status.className = 'status success';
            } else { status.innerHTML = '‚ùå –ù–∏–∫ + –ø–∞—Ä–æ–ª—å 4+ —Å–∏–º–≤–æ–ª–∞'; status.className = 'status error'; }
        }

        function logout() {
            if (confirm('üö™ –í—ã–π—Ç–∏ –∏–∑ –∏–≥—Ä—ã?')) {
                if (gameInterval) clearInterval(gameInterval);
                currentUser = ''; snakeGameActive = false;
                document.getElementById('startSnakeBtn').style.display = 'block';
                ['gamesSection','leaderboardsSection','userInfo'].forEach(id => document.getElementById(id).classList.add('hidden'));
                document.getElementById('authSection').classList.remove('hidden');
            }
        }

        function showGames() {
            document.getElementById('authSection').classList.add('hidden');
            document.getElementById('gamesSection').classList.remove('hidden');
            document.getElementById('leaderboardsSection').classList.remove('hidden');
            document.getElementById('userInfo').classList.remove('hidden');
            document.getElementById('currentUser').innerHTML = `üëë ${currentUser.toUpperCase()}`;
            loadData(); updateAllTops(); setInterval(saveAllData, 10000);
        }

        // üêç –ó–ú–ï–ô–ö–ê (100% –†–ê–ë–û–¢–ê–ï–¢)
        function setSnakeDifficulty(level) {
            snakeDifficulty = level;
            const levels = ['üêå –õ–Å–ì–ö–ê–Ø (200ms)', '‚ö° –ù–û–†–ú–ê–õ–¨–ù–ê–Ø (150ms)', 'üöÄ –•–ê–†–î–ö–û–† (100ms)'];
            document.getElementById('snakeScore').textContent = `–í—ã–±—Ä–∞–Ω–æ: ${levels[level-1]}`;
        }

        function startSnake() {
            if (snakeGameActive) return;
            
            snakeGameActive = true;
            const canvas = document.getElementById('snakeCanvas');
            const ctx = canvas.getContext('2d');
            
            // üÜï –°–ë–†–û–°
            snake = [{x: 10, y: 10}]; dx = 0; dy = 0; snakeScore = 0;
            food = {x: 15, y: 15};
            document.getElementById('startSnakeBtn').style.display = 'none';
            document.getElementById('snakeScore').textContent = '0';
            
            const gridSize = 20;
            const speeds = [200, 150, 100];
            
            // üéÆ –û–°–ù–û–í–ù–û–ô –¶–ò–ö–õ
            function gameLoop() {
                // üßπ –û–ß–ò–°–¢–ö–ê –≠–ö–†–ê–ù–ê
                ctx.fillStyle = '#0a0a0a';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                // üêç –ù–û–í–ê–Ø –ì–û–õ–û–í–ê
                const head = {x: snake[0].x + dx, y: snake[0].y + dy};
                
                // üí• GAME OVER
                if (head.x < 0 || head.x >= 22 || head.y < 0 || head.y >= 22 || 
                    snake.some((part, i) => i > 0 && part.x === head.x && part.y === head.y)) {
                    
                    saveSnakeScore(Math.floor(snakeScore));
                    
                    // üíÄ GAME OVER –≠–ö–†–ê–ù
                    ctx.fillStyle = 'rgba(255, 0, 0, 0.9)';
                    ctx.fillRect(0, 0, canvas.width, canvas.height);
                    ctx.fillStyle = '#fff';
                    ctx.shadowColor = '#ff4444'; ctx.shadowBlur = 20;
                    ctx.font = 'bold 48px Orbitron';
                    ctx.textAlign = 'center';
                    ctx.fillText('GAME OVER', canvas.width/2, canvas.height/2);
                    ctx.font = 'bold 36px Orbitron';
                    ctx.fillText(`${Math.floor(snakeScore)}`, canvas.width/2, canvas.height/2 + 60);
                    ctx.shadowBlur = 0;
                    
                    snakeGameActive = false;
                    document.getElementById('startSnakeBtn').style.display = 'block';
                    return;
                }
                
                snake.unshift(head);
                
                // üçé –ï–î–ê
                if (head.x === food.x && head.y === food.y) {
                    snakeScore += 20 * snakeDifficulty;
                    food = {
                        x: Math.floor(Math.random() * 20) + 1,
                        y: Math.floor(Math.random() * 20) + 1
                    };
                } else {
                    snake.pop();
                }
                
                // üé® –ó–ú–ï–ô–ö–ê
                for (let i = 0; i < snake.length; i++) {
                    ctx.shadowBlur = 15;
                    ctx.shadowColor = '#00ff88';
                    const alpha = i / snake.length;
                    ctx.fillStyle = `rgba(0, 255, 100, ${0.8 - alpha * 0.3})`;
                    ctx.fillRect(snake[i].x * gridSize, snake[i].y * gridSize, gridSize-2, gridSize-2);
                }
                
                // üçé –Ø–ë–õ–û–ö–û
                ctx.shadowBlur = 25;
                ctx.shadowColor = '#ff4444';
                ctx.fillStyle = '#ff6666';
                ctx.beginPath();
                ctx.arc(food.x * gridSize + gridSize/2, food.y * gridSize + gridSize/2, gridSize/2 - 3, 0, Math.PI * 2);
                ctx.fill();
                ctx.shadowBlur = 0;
                
                document.getElementById('snakeScore').textContent = Math.floor(snakeScore);
            }
            
            gameInterval = setInterval(gameLoop, speeds[snakeDifficulty - 1]);
            
            // ‚å®Ô∏è –£–ü–†–ê–í–õ–ï–ù–ò–ï
            document.addEventListener('keydown', snakeKeyHandler);
        }

        function snakeKeyHandler(e) {
            if (!snakeGameActive) return;
            e.preventDefault();
            const key = e.key;
            if (key === 'ArrowUp' && dy !== 1) { dx = 0; dy = -1; }
            if (key === 'ArrowDown' && dy !== -1) { dx = 0; dy = 1; }
            if (key === 'ArrowLeft' && dx !== 1) { dx = -1; dy = 0; }
            if (key === 'ArrowRight' && dx !== -1) { dx = 1; dy = 0; }
        }

        // üì± –°–í–ê–ô–ü–´
        let touchStartX = 0, touchStartY = 0;
        document.getElementById('snakeCanvas').addEventListener('touchstart', (e) => {
            e.preventDefault();
            touchStartX = e.touches[0].clientX;
            touchStartY = e.touches[0].clientY;
        });
        document.getElementById('snakeCanvas').addEventListener('touchend', (e) => {
            if (!snakeGameActive) return;
            e.preventDefault();
            const touchEndX = e.changedTouches[0].clientX;
            const touchEndY = e.changedTouches[0].clientY;
            const diffX = touchStartX - touchEndX;
            const diffY = touchStartY - touchEndY;
            if (Math.abs(diffX) > Math.abs(diffY) && Math.abs(diffX) > 40) {
                if (diffX > 0 && dx !== 1) { dx = -1; dy = 0; }
                else if (diffX < 0 && dx !== -1) { dx = 1; dy = 0; }
            } else if (Math.abs(diffY) > 40) {
                if (diffY > 0 && dy !== 1) { dx = 0; dy = -1; }
                else if (diffY < 0 && dy !== -1) { dx = 0; dy = 1; }
            }
        });

        // üéØ –£–ì–ê–î–ê–ô–ö–ê
        function setGuessDifficulty(level) {
            guessDifficulty = level;
            const ranges = ['1-1 000', '1-10 000', '1-100 000'];
            document.getElementById('guessRange').textContent = ranges[level-1];
        }

        function startGuessGame() {
            const ranges = [1000, 10000, 100000];
            guessNumber = Math.floor(Math.random() * ranges[guessDifficulty-1]) + 1;
            guessAttempts = 0; lastGuessedNumber = 0;
            document.getElementById('guessFeedback').innerHTML = 'üéØ –ß–∏—Å–ª–æ –∑–∞–≥–∞–¥–∞–Ω–æ! –£–≥–∞–¥–∞–π!';
            document.getElementById('guessAttempts').textContent = '0';
        }

        function checkGuess() {
            if (!guessNumber) {
                document.getElementById('guessFeedback').innerHTML = '‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ "–ù–æ–≤–∞—è –∏–≥—Ä–∞"!';
                return;
            }
            const guess = parseInt(document.getElementById('guessInput').value) || 0;
            if (guess <= 0) {
                document.getElementById('guessFeedback').innerHTML = '‚ùå –ß–∏—Å–ª–æ –±–æ–ª—å—à–µ 0!';
                return;
            }
            lastGuessedNumber = guess;
            guessAttempts++;
            if (guess === guessNumber) {
                const ranges = [1000, 10000, 100000];
                const score = Math.floor(ranges[guessDifficulty-1] / guessAttempts * 15);
                saveGuessScore(score);
                document.getElementById('guessFeedback').innerHTML = 
                    `‚úÖ –£–≥–∞–¥–∞–ª –∑–∞ ${guessAttempts} –ø–æ–ø—ã—Ç–æ–∫! –û—á–∫–∏: ${score}`;
                return;
            }
            const diff = Math.abs(guess - guessNumber);
            let feedback = '';
            if (diff <= 5) feedback = `üî•üî• –°—É–ø–µ—Ä –±–ª–∏–∑–∫–æ –∫ ${guess}!`;
            else if (diff <= 25) feedback = `üî• –û—á–µ–Ω—å –±–ª–∏–∑–∫–æ –∫ ${guess}!`;
            else if (diff <= 100) feedback = `üå°Ô∏è –¢–µ–ø–ª–æ –∫ ${guess}!`;
            else feedback = `${guess < guessNumber ? 'üìà –ë–æ–ª—å—à–µ' : 'üìâ –ú–µ–Ω—å—à–µ'} ${guess}`;
            document.getElementById('guessFeedback').innerHTML = feedback;
            document.getElementById('guessAttempts').textContent = guessAttempts;
            document.getElementById('guessInput').value = '';
        }

        // üíé –°–û–•–†–ê–ù–ï–ù–ò–ï –û–ß–ö–û–í
        function saveSnakeScore(score) {
            let top = tops.snakeTop10; top.push({user: currentUser, score});
            top.sort((a,b) => b.score - a.score); tops.snakeTop10 = top.slice(0,10);
            saveData('snakeTop10', tops.snakeTop10);
            tournaments.snake[currentUser] = (tournaments.snake[currentUser] || 0) + score;
            saveData('snakeTournament', tournaments.snake);
            updateAllTops();
        }

        function saveGuessScore(score) {
            let top = tops.guessTop10; top.push({user: currentUser, score});
            top.sort((a,b) => b.score - a.score); tops.guessTop10 = top.slice(0,10);
            saveData('guessTop10', tops.guessTop10);
            tournaments.guess[currentUser] = (tournaments.guess[currentUser] || 0) + score;
            saveData('guessTournament', tournaments.guess);
            updateAllTops();
        }

        // üìä –¢–û–ü–´
        function updateTop10(id, data) {
            document.getElementById(id).innerHTML = data.length ? 
                data.map((item,i) => `<div class="top-item"><span class="medal">${['ü•á','ü•à','ü•â','‚öúÔ∏è','‚öúÔ∏è'][i]||`${i+1}`}</span>${item.user}: ${item.score}</div>`).join('') :
                '<div class="top-item"><span class="medal">üëë</span>–ë–£–î–¨ –ü–ï–†–í–´–ú!</div>';
        }

        function updateTournament(game) {
            const tourn = game === 'snake' ? tournaments.snake : tournaments.guess;
            const sorted = Object.entries(tourn).sort((a,b) => b[1]-a[1]).slice(0,10);
            const now = new Date();
            const nextMidnight = new Date(now.getFullYear(), now.getMonth(), now.getDate()+1, 3,0,0);
            const timeLeft = Math.floor((nextMidnight-now)/60000);
            document.getElementById(`${game}Tournament`).innerHTML = `
                <div style="text-align:center;font-size:1.3rem;margin-bottom:15px;color:${game==='snake'?'#00ff00':'#ffaa00'}">
                    ‚è∞ ${Math.floor(timeLeft/60)}—á ${timeLeft%60}–º
                </div>
                <div class="top-list">${sorted.length ? sorted.map(([u,s],i)=>`<div class="top-item"><span class="medal">${['ü•á','ü•à','ü•â','üéÅ','üéÅ'][i] || i+1}</span>${u}: ${Math.floor(s)}üíé</div>`).join('') : '<div class="top-item">‚è≥ –ñ–¥—ë–º –∏–≥—Ä–æ–∫–æ–≤</div>'}</div>`;
        }

        function updateAllTops() {
            updateTop10('snakeTop10', tops.snakeTop10); updateTop10('guessTop10', tops.guessTop10);
            updateTournament('snake'); updateTournament('guess');
            if (currentUser) {
                document.getElementById('liveStats').innerHTML = 
                    `üêç ${tournaments.snake[currentUser]||0}üíé + üéØ ${tournaments.guess[currentUser]||0}üíé`;
            }
        }

        function saveAllData() { 
            saveData('registeredUsers', registeredUsers); 
            saveData('tops', tops); 
            saveData('tournaments', tournaments); 
        }

        // üöÄ –°–¢–ê–†–¢
        window.onload = () => { 
            loadData(); 
            updateAllTops(); 
            setInterval(updateAllTops, 3000); 
        };
    </script>
</body>
</html>
