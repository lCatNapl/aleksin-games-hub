<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéÆ ALEKSIN GAMES HUB 2026 ‚ú®</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Exo+2:wght@300;400;600;800&display=swap');
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Exo 2', sans-serif;
            background: linear-gradient(-45deg, #0c0c0c, #1a0033, #000, #330066);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .container {
            max-width: 1200px; margin: 0 auto; padding: 20px;
        }

        .header {
            text-align: center; margin-bottom: 40px;
        }

        .header h1 {
            font-family: 'Orbitron', monospace;
            font-size: clamp(2.5em, 8vw, 5em);
            background: linear-gradient(45deg, #00ff88, #ffd700, #ff00ff, #00ff88);
            background-size: 300% 300%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: neonGlow 2s ease-in-out infinite alternate;
            text-shadow: 0 0 30px rgba(0,255,136,0.5);
            margin-bottom: 20px;
        }

        @keyframes neonGlow {
            from { filter: hue-rotate(0deg); }
            to { filter: hue-rotate(360deg); }
        }

        .glass-card {
            background: rgba(255,255,255,0.05);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            border: 1px solid rgba(255,255,255,0.1);
            box-shadow: 0 25px 50px rgba(0,0,0,0.5), inset 0 1px 0 rgba(255,255,255,0.2);
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            position: relative;
            overflow: hidden;
        }

        .glass-card::before {
            content: '';
            position: absolute;
            top: 0; left: -100%; width: 100%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.6s;
        }

        .glass-card:hover::before { left: 100%; }
        .glass-card:hover {
            transform: translateY(-15px) scale(1.02);
            box-shadow: 0 35px 70px rgba(0,255,136,0.3);
            border-color: rgba(0,255,136,0.5);
        }

        #authSection { text-align: center; max-width: 500px; margin: 0 auto; }
        .auth-input { 
            width: 100%; max-width: 350px; padding: 18px 25px; 
            margin: 15px 0; border: none; border-radius: 50px; 
            background: rgba(255,255,255,0.1); backdrop-filter: blur(10px);
            color: white; font-size: 1.1em; text-align: center;
            border: 2px solid rgba(255,255,255,0.2);
            transition: all 0.3s ease;
        }
        .auth-input:focus {
            outline: none; border-color: #00ff88; box-shadow: 0 0 20px rgba(0,255,136,0.5);
        }
        .btn {
            padding: 18px 40px; border: none; border-radius: 50px;
            font-size: 1.2em; font-weight: 600; cursor: pointer;
            transition: all 0.3s ease; font-family: 'Orbitron', monospace;
            text-transform: uppercase; letter-spacing: 2px;
        }
        .btn-primary {
            background: linear-gradient(45deg, #00ff88, #00cc66);
            color: #000; box-shadow: 0 10px 30px rgba(0,255,136,0.4);
        }
        .btn-primary:hover { transform: scale(1.05); box-shadow: 0 15px 40px rgba(0,255,136,0.6); }
        .btn-game {
            background: linear-gradient(45deg, #ff00ff, #ff6b9d);
            color: white; width: 100%; margin-top: 20px; padding: 20px;
            font-size: 1.3em;
        }
        .btn-game:hover { box-shadow: 0 15px 40px rgba(255,0,255,0.6); }
        .btn-tournament {
            background: linear-gradient(45deg, #ffd700, #ffed4a);
            color: #000; width: 100%; margin: 15px 0;
        }

        .games-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px; margin-top: 50px;
        }

        .game-card {
            padding: 30px; text-align: center;
        }

        .game-icon {
            font-size: 4em; margin-bottom: 20px; filter: drop-shadow(0 0 20px currentColor);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .game-title {
            font-family: 'Orbitron', monospace; font-size: 1.8em; margin-bottom: 15px;
            background: linear-gradient(45deg, #00ff88, #ffd700); -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .features {
            display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; margin: 20px 0;
        }

        .feature {
            background: rgba(255,255,255,0.1); padding: 8px 16px; border-radius: 25px;
            font-size: 0.9em; border: 1px solid rgba(255,255,255,0.2);
        }

        #userInfo {
            display: flex; align-items: center; justify-content: center; gap: 20px;
            background: rgba(0,255,136,0.1); padding: 15px 30px; border-radius: 50px;
            margin-bottom: 30px; backdrop-filter: blur(10px);
        }

        .leaderboard {
            grid-column: span 2; max-width: 700px; margin: 0 auto;
        }

        .top-list, .tournament-list {
            list-style: none; padding: 0; max-height: 400px; overflow-y: auto;
        }

        .top-list li, .tournament-list li {
            padding: 15px; margin: 8px 0; border-radius: 15px;
            backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.2);
            transition: all 0.3s ease; display: flex; justify-content: space-between;
        }

        .tournament-list {
            max-height: 300px;
        }

        .tournament-list li {
            background: rgba(255,255,255,0.1); margin: 4px 0;
        }

        .tournament-list li:hover {
            transform: translateX(10px); box-shadow: 0 10px 30px rgba(255,215,0,0.4);
        }

        .top-1 { border-left: 5px solid #ffd700 !important; background: rgba(255,215,0,0.2); }
        .top-2 { border-left: 5px solid #c0c0c0 !important; background: rgba(192,192,192,0.2); }
        .top-3 { border-left: 5px solid #cd7f32 !important; background: rgba(205,127,50,0.2); }
        .top-4, .top-5 { border-left: 5px solid #00ff88 !important; background: rgba(0,255,136,0.2); }

        #gameCanvas {
            border: 3px solid rgba(255,255,255,0.3); border-radius: 20px;
            background: rgba(0,0,0,0.8); display: block; margin: 20px auto;
            box-shadow: 0 20px 50px rgba(0,0,0,0.8);
        }

        .game-controls {
            text-align: center; margin: 20px 0;
        }

        .score-display {
            font-family: 'Orbitron', monospace; font-size: 2em; color: #00ff88;
            text-shadow: 0 0 20px rgba(0,255,136,0.5); margin: 20px 0;
        }

        #loginPrompt {
            background: rgba(255,0,0,0.2); border: 2px solid #ff4757; padding: 20px;
            border-radius: 20px; margin-top: 20px;
        }

        @media (max-width: 768px) {
            .games-grid { grid-template-columns: 1fr; }
            .leaderboard { grid-column: span 1; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéÆ ALEKSIN GAMES HUB 2026 ‚ú®</h1>
            <div id="userInfo" style="display: none;">
                <span>üëã <span id="welcomeUser"></span></span>
                <button class="btn" onclick="logout()">üö™ –í—ã–π—Ç–∏</button>
            </div>
        </div>

        <div id="authSection">
            <div style="font-size: 1.5em; margin-bottom: 30px; color: #00ff88;">
                üîê –í–û–ô–î–ò –ò –°–¢–ê–ù–¨ –õ–ï–ì–ï–ù–î–û–ô –ê–õ–ï–ö–°–ò–ù–ê!
            </div>
            <input type="text" id="usernameInput" class="auth-input" placeholder="üëë –¢–≤–æ–π –ù–∏–∫ (–ê–ª–µ–∫—Å–∏–Ω–õ–µ–≥–µ–Ω–¥–∞)" maxlength="20">
            <br>
            <button class="btn btn-primary" onclick="login()">‚ö° –í–û–ô–¢–ò –í –•–ê–ë</button>
            <div id="loginPrompt" style="display: none;">
                üîê –°–Ω–∞—á–∞–ª–∞ –≤–æ–π–¥–∏, —á—Ç–æ–±—ã –∏–≥—Ä–∞—Ç—å –≤ —Ç—É—Ä–Ω–∏—Ä—ã! üöÄ
            </div>
        </div>

        <div id="gamesSection" style="display: none;">
            <div class="games-grid">
                <!-- üî• –ó–ú–ï–ô–ö–ê PRO 2.0 -->
                <div class="glass-card game-card" id="snakeCard">
                    <div class="game-icon" style="color: #00ff88;">üêç</div>
                    <div class="game-title">–ó–º–µ–π–∫–∞ Pro 2.0</div>
                    <div class="features">
                        <span class="feature">üß± –°—Ç–µ–Ω—ã + 3 —É—Ä–æ–≤–Ω—è</span>
                        <span class="feature">üåà –ì—Ä–∞–¥–∏–µ–Ω—Ç –∑–º–µ–π–∫–∞</span>
                        <span class="feature">‚ö° –¢–µ–ª–µ–ø–æ—Ä—Ç –µ–¥–∞</span>
                        <span class="feature">üì± –°–≤–∞–π–ø—ã</span>
                    </div>
                    <div style="margin: 20px 0;">
                        <select id="wallDifficulty" style="padding: 12px 20px; border-radius: 25px; 
                                border: 2px solid #00ff88; background: rgba(0,255,136,0.1); 
                                color: white; font-size: 1em; width: 100%;">
                            <option value="0">üòå –õ–µ–≥–∫–æ (–±–µ–∑ —Å—Ç–µ–Ω)</option>
                            <option value="1">üß± –°—Ä–µ–¥–Ω–µ (—Å—Ç–µ–Ω—ã –ø–æ –∫—Ä–∞—è–º)</option>
                            <option value="2">üíÄ –•–∞—Ä–¥–∫–æ—Ä (4 —Å—Ç–µ–Ω—ã)</option>
                        </select>
                    </div>
                    <button class="btn btn-game" onclick="startSnakeGame()">üöÄ –ò–ì–†–ê–¢–¨ PRO 2.0</button>
                </div>

                <!-- üéØ –£–ì–ê–î–ê–ô –ß–ò–°–õ–û -->
                <div class="glass-card game-card" id="guessCard">
                    <div class="game-icon" style="color: #ff6b9d;">üéØ</div>
                    <div class="game-title">–£–≥–∞–¥–∞–π 1-10000</div>
                    <div class="features">
                        <span class="feature">üî• –ü–æ–¥—Å–∫–∞–∑–∫–∏ –±–ª–∏–∑–∫–æ/–¥–∞–ª–µ–∫–æ</span>
                        <span class="feature">‚öîÔ∏è –¢—É—Ä–Ω–∏—Ä —Ö1.5 –æ—á–∫–æ–≤</span>
                        <span class="feature">üèÜ –ú–∏–Ω–∏–º—É–º –ø–æ–ø—ã—Ç–æ–∫ = –ø–æ–±–µ–¥–∞</span>
                    </div>
                    <button class="btn btn-game" onclick="startGuessGame()">üéØ –ò–ì–†–ê–¢–¨</button>
                </div>

                <!-- ‚öîÔ∏è –¢–£–†–ù–ò–† –¢–û–ü-100 -->
                <div class="glass-card game-card leaderboard">
                    <div class="game-icon" style="color: #ffd700; font-size: 3em;">‚öîÔ∏è</div>
                    <div class="game-title">üèÜ –¢–£–†–ù–ò–† –¢–û–ü-100</div>
                    <button class="btn btn-tournament" onclick="joinTournament()">‚öîÔ∏è –£–ß–ê–°–¢–í–û–í–ê–¢–¨ 24—á</button>
                    <div id="tournamentStatus" style="margin: 20px 0; font-size: 1.3em; font-family: 'Orbitron';"></div>
                    
                    <div class="top-100-container" style="max-height: 300px; overflow-y: auto;">
                        <ul id="tournamentTop100" class="tournament-list">
                            <li>‚öîÔ∏è –ö–ª–∏–∫–Ω–∏ –£–ß–ê–°–¢–í–û–í–ê–¢–¨ ‚Üí —É–≤–∏–¥–∏—à—å –¢–û–ü-100! üî•</li>
                        </ul>
                    </div>
                </div>

                <!-- üèÜ –ì–õ–ê–í–ù–´–ô –¢–û–ü-10 -->
                <div class="glass-card game-card leaderboard">
                    <div class="game-icon" style="color: #ffd700; font-size: 3em;">üèÜ</div>
                    <div class="game-title">–¢–æ–ø-10 –õ–µ–≥–µ–Ω–¥</div>
                    <button class="btn btn-tournament" onclick="loadRealLeaderboard()" style="margin-bottom: 20px;">
                        üîÑ –û–ë–ù–û–í–ò–¢–¨ –¢–û–ü
                    </button>
                    <ul id="topPlayersList" class="top-list">
                        <li>üëë –ë–£–î–¨ –ü–ï–†–í–´–ú! –ò–≥—Ä–∞–π ‚Üí –†–µ–∫–æ—Ä–¥—ã ‚Üí –¢–û–ü –ê–õ–ï–ö–°–ò–ù–ê! üî•</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <canvas id="gameCanvas" style="display: none;"></canvas>
    <div id="gameControls" class="game-controls" style="display: none;"></div>

    <script>
        let currentGameSecret = 0;
        let gameCanvas = null;
        let tournamentActive = true;
        let snake = [{x: 10, y: 10}];
        let food = {};
        let dx = 0, dy = 0;
        let score = 0;
        let wallDifficulty = 0;
        let walls = [];
        let gameLoopId = null;

        window.onload = () => checkAuth();

        function checkAuth() {
            const token = localStorage.getItem('userToken');
            const name = localStorage.getItem('userName');
            
            if (token && name) {
                document.getElementById('authSection').style.display = 'none';
                document.getElementById('gamesSection').style.display = 'block';
                document.getElementById('userInfo').style.display = 'flex';
                document.getElementById('welcomeUser').textContent = name;
                updateTournament();
                loadRealLeaderboard();
            } else {
                document.getElementById('gamesSection').style.display = 'none';
                document.getElementById('userInfo').style.display = 'none';
                document.getElementById('authSection').style.display = 'block';
            }
        }

        function login() {
            const name = document.getElementById('usernameInput').value.trim();
            if (name.length < 2) {
                alert('üëë –ù–∏–∫ –æ—Ç 2 —Å–∏–º–≤–æ–ª–æ–≤! (–ê–ª–µ–∫—Å–∏–Ω–õ–µ–≥–µ–Ω–¥–∞)');
                return;
            }
            localStorage.setItem('userName', name);
            localStorage.setItem('userToken', Date.now().toString());
            checkAuth();
            updateTournament();
        }

        function logout() {
            if (!confirm('–ò–≥—Ä–∞ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ? –í—ã–π—Ç–∏ –∏–∑ ALEKSIN GAMES?')) return;
            localStorage.clear();
            location.reload();
        }

        // üî• –ó–ú–ï–ô–ö–ê PRO 2.0
        function startSnakeGame() {
            const token = localStorage.getItem('userToken');
            if (!token) { 
                alert('üîê –í–æ–π–¥–∏ –¥–ª—è –∏–≥—Ä—ã!'); 
                showLogin(); 
                return; 
            }

            wallDifficulty = parseInt(document.getElementById('wallDifficulty').value);
            setupWalls();
            
            document.getElementById('snakeCard').innerHTML = `
                <canvas id="gameCanvas" width="400" height="400"></canvas>
                <div class="score-display">–û—á–∫–∏: <span id="snakeScore">0</span></div>
                <div>–°–ª–æ–∂–Ω–æ—Å—Ç—å: ${['üòå –õ–µ–≥–∫–æ', 'üß± –°—Ä–µ–¥–Ω–µ', 'üíÄ –•–∞—Ä–¥–∫–æ—Ä'][wallDifficulty]}</div>
                <button class="btn" onclick="closeGame()" style="background: #ff4757;">‚ùå –í—ã–π—Ç–∏</button>
            `;
            
            gameCanvas = document.getElementById('gameCanvas');
            const ctx = gameCanvas.getContext('2d');
            
            // –ù–∞—á–∞–ª—å–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è
            snake = [{x: 10, y: 10}];
            dx = 0; dy = 0; score = 0;
            spawnFood();
            
            gameLoopId = requestAnimationFrame(gameLoop);
        }

        function setupWalls() {
            walls = [];
            const gridSize = 20;
            
            if (wallDifficulty === 1) {
                // üß± –°—Ç–µ–Ω—ã –ø–æ –∫—Ä–∞—è–º
                for (let i = 0; i < 20; i++) {
                    walls.push({x: 0, y: i}, {x: 19, y: i});
                }
            } else if (wallDifficulty === 2) {
                // üíÄ 4 –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Å—Ç–µ–Ω—ã
                for (let i = 2; i < 18; i++) {
                    walls.push({x: 2, y: i}, {x: 17, y: i});
                    walls.push({x: i, y: 2}, {x: i, y: 17});
                }
            }
        }

        function spawnFood() {
            food = {
                x: Math.floor(Math.random() * 20),
                y: Math.floor(Math.random() * 20)
            };
            // –¢–µ–ª–µ–ø–æ—Ä—Ç –µ–¥–∞ –Ω–µ –Ω–∞ —Å—Ç–µ–Ω–∞—Ö
            if (checkWallCollision(food.x, food.y)) spawnFood();
        }

        function gameLoop() {
            const ctx = gameCanvas.getContext('2d');
            ctx.clearRect(0, 0, 400, 400);
            
            // –î–≤–∏–∂–µ–Ω–∏–µ
            const head = {x: snake[0].x + dx, y: snake[0].y + dy};
            
            // –°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è
            if (head.x < 0 || head.x >= 20 || head.y < 0 || head.y >= 20 || 
                checkWallCollision(head.x, head.y) ||
                snake.some(segment => segment.x === head.x && segment.y === head.y)) {
                gameOver();
                return;
            }
            
            snake.unshift(head);
            
            // –ï–¥–∞
            if (head.x === food.x && head.y === food.y) {
                score += wallDifficulty ? 200 : 100;
                document.getElementById('snakeScore').textContent = score;
                spawnFood();
            } else {
                snake.pop();
            }
            
            // –û—Ç—Ä–∏—Å–æ–≤–∫–∞
            drawWalls(ctx);
            drawSnake(ctx);
            drawFood(ctx);
            
            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∫–æ—Ä–¥–∞
            localStorage.setItem('highScore', Math.max(
                parseInt(localStorage.getItem('highScore') || '0'), score
            ));
            
            gameLoopId = requestAnimationFrame(gameLoop);
        }

        function drawSnake(ctx) {
            snake.forEach((segment, index) => {
                const gradient = ctx.createLinearGradient(
                    segment.x * 20, segment.y * 20, 
                    (segment.x + 1) * 20, (segment.y + 1) * 20
                );
                gradient.addColorStop(0, index === 0 ? '#00ff88' : '#00aa55');
                gradient.addColorStop(1, '#004d2d');
                
                ctx.fillStyle = gradient;
                ctx.shadowColor = '#00ff88';
                ctx.shadowBlur = 25;
                ctx.fillRect(segment.x * 20 + 2, segment.y * 20 + 2, 16, 16);
                ctx.shadowBlur = 0;
                
                // –ì–æ–ª–æ–≤–∞ –≥–ª–∞–∑–∞
                if (index === 0) {
                    ctx.fillStyle = '#fff';
                    ctx.fillRect(segment.x * 20 + 6, segment.y * 20 + 6, 3, 3);
                    ctx.fillRect(segment.x * 20 + 11, segment.y * 20 + 6, 3, 3);
                }
            });
        }

        function drawFood(ctx) {
            ctx.fillStyle = '#ff4757';
            ctx.shadowColor = '#ff4757';
            ctx.shadowBlur = 20;
            ctx.beginPath();
            ctx.arc((food.x + 0.5) * 20, (food.y + 0.5) * 20, 8, 0, Math.PI * 2);
            ctx.fill();
            ctx.shadowBlur = 0;
        }

        function drawWalls(ctx) {
            if (wallDifficulty > 0) {
                ctx.fillStyle = '#444';
                ctx.shadowColor = '#888';
                ctx.shadowBlur = 15;
                walls.forEach(wall => {
                    ctx.fillRect(wall.x * 20 + 2, wall.y * 20 + 2, 16, 16);
                });
                ctx.shadowBlur = 0;
            }
        }

        function checkWallCollision(x, y) {
            return walls.some(wall => wall.x === x && wall.y === y);
        }

        function gameOver() {
            cancelAnimationFrame(gameLoopId);
            saveScore('snake', score * (tournamentActive ? 2 : 1));
            alert(`üèÜ –ò–ì–†–ê –û–ö–û–ù–ß–ï–ù–ê!\n–¢–≤–æ–∏ –æ—á–∫–∏: ${score}\n‚öîÔ∏è –¢—É—Ä–Ω–∏—Ä: ${tournamentActive ? 'x2' : 'x1'}`);
            closeGame();
        }

        // üéØ –£–ì–ê–î–ê–ô –ß–ò–°–õ–û
        function startGuessGame() {
            const token = localStorage.getItem('userToken');
            if (!token) { showLogin(); return; }
            
            currentGameSecret = Math.floor(Math.random() * 10000) + 1;
            let attempts = 0;
            
            document.getElementById('guessCard').innerHTML = `
                <canvas id="gameCanvas" width="400" height="200" style="height: 200px;"></canvas>
                <div class="score-display">–ü–æ–ø—ã—Ç–æ–∫: <span id="attempts">0</span> | –ß–∏—Å–ª–æ: 1-10000</div>
                <input type="number" id="guessInput" min="1" max="10000" 
                       style="width: 200px; padding: 15px; border-radius: 25px; border: 2px solid #ff6b9d; 
                              background: rgba(255,107,157,0.1); color: white; font-size: 1.2em; text-align: center;">
                <div id="feedback" style="font-size: 1.5em; margin: 20px 0; min-height: 50px;"></div>
                <button class="btn" onclick="closeGame()" style="background: #ff4757;">‚ùå –í—ã–π—Ç–∏</button>
            `;
            
            document.getElementById('guessInput').focus();
        }

        function makeGuess() {
            const guess = parseInt(document.getElementById('guessInput').value);
            const attempts = parseInt(document.getElementById('attempts').textContent) + 1;
            
            if (guess === currentGameSecret) {
                const finalScore = 10000 - (attempts * 10);
                saveScore('guess', finalScore * (tournamentActive ? 1.5 : 1));
                alert(`üéâ –ü–†–ê–í–ò–õ–¨–ù–û! ${currentGameSecret}\n–ü–æ–ø—ã—Ç–æ–∫: ${attempts}\n–û—á–∫–∏: ${finalScore.toLocaleString()}`);
                closeGame();
                return;
            }
            
            document.getElementById('attempts').textContent = attempts;
            
            if (guess < currentGameSecret) {
                document.getElementById('feedback').innerHTML = '<div style="color: #00ff88; font-size: 2em;">üî• –°–õ–ò–®–ö–û–ú –ú–ê–õ–û! –ë–µ—Ä–∏ –ë–û–õ–¨–®–ï!</div>';
            } else {
                document.getElementById('feedback').innerHTML = '<div style="color: #ff4757; font-size: 2em;">‚ùÑÔ∏è –°–õ–ò–®–ö–û–ú –ú–ù–û–ì–û! –ë–µ—Ä–∏ –ú–ï–ù–¨–®–ï!</div>';
            }
            
            document.getElementById('guessInput').value = '';
            document.getElementById('guessInput').focus();
        }

        // –¢—É—Ä–Ω–∏—Ä
        function joinTournament() {
            const token = localStorage.getItem('userToken');
            if (!token) { 
                alert('üîê –í–æ–π–¥–∏—Ç–µ –¥–ª—è —Ç—É—Ä–Ω–∏—Ä–∞!'); 
                showLogin(); 
                return; 
            }
            tournamentActive = true;
            alert(`‚öîÔ∏è ${localStorage.getItem('userName')} –≤—Å—Ç—É–ø–∏–ª –≤ —Ç—É—Ä–Ω–∏—Ä 24—á!\n\nüéÆ –ò–≥—Ä–∞–π –≤ –ó–º–µ–π–∫—É/–£–≥–∞–¥–∞–π ‚Üí –Ω–∞–±–∏—Ä–∞–π –æ—á–∫–∏ ‚Üí –ø–æ–±–µ–∂–¥–∞–π –≤ –ê–ª–µ–∫—Å–∏–Ω–∞! üèÜ`);
            loadTournamentTop100();
        }

        function updateTournament() {
            const now = Date.now();
            let endTime = parseInt(localStorage.getItem('tournamentEnd'));
            
            // üî• –ù–û–í–´–ô –¢–£–†–ù–ò–†
            if (!endTime || now > endTime) {
                endTime = now + 24 * 60 * 60 * 1000; // +24 —á–∞—Å–∞
                localStorage.setItem('tournamentEnd', endTime);
                tournamentActive = true;
            }
            
            if (now > endTime) {
                document.getElementById('tournamentStatus').innerHTML = 'üèÜ –¢–£–†–ù–ò–† –û–ö–û–ù–ß–ï–ù! –ù–æ–≤—ã–π —á–µ—Ä–µ–∑ 5 —Å–µ–∫...';
                setTimeout(updateTournament, 5000);
            } else {
                const leftHours = Math.floor((endTime - now) / (1000 * 60 * 60));
                document.getElementById('tournamentStatus').innerHTML = `‚öîÔ∏è –ê–ö–¢–ò–í–ï–ù! ${leftHours}—á –æ—Å—Ç–∞–ª–æ—Å—å`;
            }
        }

        function loadTournamentTop100() {
            const scores = JSON.parse(localStorage.getItem('tournamentScores') || '[]');
            const list = document.getElementById('tournamentTop100');
            list.innerHTML = '';
            
            scores.slice(0, 100).forEach((player, index) => {
                const li = document.createElement('li');
                li.className = index < 5 ? `top-${index + 1}` : '';
                
                const medal = index === 0 ? 'ü•á' : index === 1 ? 'ü•à' : index === 2 ? 'ü•â' : 
                             index < 5 ? 'üéÅ' : '';
                li.innerHTML = `
                    ${index + 1}. ${medal} <strong>${player.name}</strong> 
                    <span style="float: right; color: #ffd700;">${player.score.toLocaleString()}üî•</span>
                `;
                list.appendChild(li);
            });
            
            if (scores.length === 0) {
                list.innerHTML = '<li>‚öîÔ∏è –ü–ï–†–í–´–ô –ë–£–î–ï–¢ –õ–ï–ì–ï–ù–î–û–ô! –ò–≥—Ä–∞–π –≤ —Ç—É—Ä–Ω–∏—Ä–µ! üî•</li>';
            }
        }

        function loadRealLeaderboard() {
            const scores = JSON.parse(localStorage.getItem('leaderboard') || '[]');
            const list = document.getElementById('topPlayersList');
            
            if (scores.length === 0) {
                list.innerHTML = '<li>üëë –ë–£–î–¨ –ü–ï–†–í–´–ú! –ò–≥—Ä–∞–π ‚Üí –†–µ–∫–æ—Ä–¥—ã ‚Üí –¢–û–ü! üî•</li>';
                return;
            }
            
            list.innerHTML = '';
            scores.slice(0, 10).forEach((player, index) => {
                const li = document.createElement('li');
                li.style = `border-left: 5px solid ${index === 0 ? '#ffd700' : '#00ff88'}`;
                li.innerHTML = `
                    ${index + 1}üî• <strong>${player.name}</strong> 
                    <span style="float: right; color: #ffd700;">${player.score.toLocaleString()}</span>
                `;
                list.appendChild(li);
            });
        }

        function saveScore(gameType, scoreValue) {
            const userName = localStorage.getItem('userName');
            const scores = JSON.parse(localStorage.getItem('leaderboard') || '[]');
            const tournamentScores = JSON.parse(localStorage.getItem('tournamentScores') || '[]');
            
            // –ì–ª–∞–≤–Ω—ã–π —Ç–æ–ø
            const existing = scores.find(p => p.name === userName);
            if (existing) {
                if (scoreValue > existing.score) existing.score = scoreValue;
            } else {
                scores.push({name: userName, score: scoreValue});
            }
            scores.sort((a, b) => b.score - a.score);
            localStorage.setItem('leaderboard', JSON.stringify(scores.slice(0, 100)));
            
            // –¢—É—Ä–Ω–∏—Ä —Ç–æ–ø
            if (tournamentActive) {
                const tExisting = tournamentScores.find(p => p.name === userName);
                if (tExisting) {
                    tExisting.score = Math.max(tExisting.score, scoreValue);
                } else {
                    tournamentScores.push({name: userName, score: scoreValue});
                }
                tournamentScores.sort((a, b) => b.score - a.score);
                localStorage.setItem('tournamentScores', JSON.stringify(tournamentScores.slice(0, 100)));
            }
            
            loadRealLeaderboard();
            loadTournamentTop100();
        }

        function showLogin() {
            document.getElementById('gamesSection').style.display = 'none';
            document.getElementById('authSection').style.display = 'block';
            document.getElementById('loginPrompt').style.display = 'block';
        }

        function closeGame() {
            if (gameLoopId) cancelAnimationFrame(gameLoopId);
            document.getElementById('snakeCard').innerHTML = `
                <div class="game-icon" style="color: #00ff88;">üêç</div>
                <div class="game-title">–ó–º–µ–π–∫–∞ Pro 2.0</div>
                <div class="features">
                    <span class="feature">üß± –°—Ç–µ–Ω—ã + 3 —É—Ä–æ–≤–Ω—è</span>
                    <span class="feature">üåà –ì—Ä–∞–¥–∏–µ–Ω—Ç –∑–º–µ–π–∫–∞</span>
                    <span class="feature">‚ö° –¢–µ–ª–µ–ø–æ—Ä—Ç –µ–¥–∞</span>
                    <span class="feature">üì± –°–≤–∞–π–ø—ã</span>
                </div>
                <div style="margin: 20px 0;">
                    <select id="wallDifficulty" style="padding: 12px 20px; border-radius: 25px; 
                            border: 2px solid #00ff88; background: rgba(0,255,136,0.1); 
                            color: white; font-size: 1em; width: 100%;">
                        <option value="0">üòå –õ–µ–≥–∫–æ (–±–µ–∑ —Å—Ç–µ–Ω)</option>
                        <option value="1">üß± –°—Ä–µ–¥–Ω–µ (—Å—Ç–µ–Ω—ã –ø–æ –∫—Ä–∞—è–º)</option>
                        <option value="2">üíÄ –•–∞—Ä–¥–∫–æ—Ä (4 —Å—Ç–µ–Ω—ã)</option>
                    </select>
                </div>
                <button class="btn btn-game" onclick="startSnakeGame()">üöÄ –ò–ì–†–ê–¢–¨ PRO 2.0</button>
            `;
            gameCanvas = null;
        }

        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
        document.addEventListener('keydown', (e) => {
            if (!gameCanvas) return;
            switch(e.key) {
                case 'ArrowUp': if (dy !== 1) {dx=0; dy=-1;} break;
                case 'ArrowDown': if (dy !== -1) {dx=0; dy=1;} break;
                case 'ArrowLeft': if (dx !== 1) {dx=-1; dy=0;} break;
                case 'ArrowRight': if (dx !== -1) {dx=1; dy=0;} break;
                case 'Enter': if (document.getElementById('guessInput')) makeGuess(); break;
            }
        });

        // –ú–æ–±–∏–ª—å–Ω—ã–µ —Å–≤–∞–π–ø—ã
        let touchStartX = 0, touchStartY = 0;
        document.addEventListener('touchstart', (e) => {
            touchStartX = e.touches[0].clientX;
            touchStartY = e.touches[0].clientY;
        });
        document.addEventListener('touchend', (e) => {
            if (!gameCanvas) return;
            const touchEndX = e.changedTouches[0].clientX;
            const touchEndY = e.changedTouches[0].clientY;
            const diffX = touchStartX - touchEndX;
            const diffY = touchStartY - touchEndY;
            
            if (Math.abs(diffX) > Math.abs(diffY)) {
                if (diffX > 0 && dx !== 1) { dx = 1; dy = 0; } // Right
                else if (diffX < 0 && dx !== -1) { dx = -1; dy = 0; } // Left
            } else {
                if (diffY > 0 && dy !== 1) { dx = 0; dy = 1; } // Down
                else if (diffY < 0 && dy !== -1) { dx = 0; dy = -1; } // Up
            }
        });

        // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ —É—Ö–æ–¥–∞
        window.addEventListener('beforeunload', () => {
            const gameActive = document.getElementById('snakeGame') || document.getElementById('guessGame');
            if (gameActive) return '–ò–≥—Ä–∞ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ! –¢—ã —Ç–æ—á–Ω–æ —Ö–æ—á–µ—à—å –≤—ã–π—Ç–∏?';
        });
    </script>
</body>
</html>
