<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéÆ ALEKSIN GAMES HUB 2026 ‚ú®</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Exo+2:wght@300;400;600;800&display=swap');
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Exo 2', sans-serif;
            background: linear-gradient(-45deg, #0f0f23, #1a0033, #0f0f23, #2d004d);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
            color: #fff;
            min-height: 100vh;
            overflow-x: hidden;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        h1 {
            font-family: 'Orbitron', monospace; font-size: clamp(2rem, 5vw, 4rem); text-align: center;
            background: linear-gradient(45deg, #ff00ff, #00ffff, #ffff00); -webkit-background-clip: text;
            -webkit-text-fill-color: transparent; text-shadow: 0 0 30px #ff00ff; margin-bottom: 30px;
            animation: glow 2s ease-in-out infinite alternate;
        }
        @keyframes glow {
            from { filter: drop-shadow(0 0 20px #ff00ff); }
            to { filter: drop-shadow(0 0 30px #00ffff); }
        }

        #authSection {
            max-width: 400px; margin: 0 auto; padding: 40px; background: rgba(0,0,0,0.8); border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,255,255,0.3); border: 2px solid #00ffff; text-align: center;
        }
        #gamesSection, #userInfo { display: none; }

        input {
            width: 100%; padding: 15px; margin: 15px 0; border: none; border-radius: 10px;
            background: rgba(255,255,255,0.1); color: #fff; font-size: 16px; backdrop-filter: blur(10px);
            transition: all 0.3s;
        }
        input::placeholder { color: #aaa; }
        button {
            width: 100%; padding: 15px; margin: 10px 0; border: none; border-radius: 10px;
            background: linear-gradient(45deg, #ff00ff, #00ffff); color: #000; font-family: 'Orbitron', monospace;
            font-size: 16px; font-weight: 700; cursor: pointer; transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(0,255,255,0.4);
        }
        button:hover { transform: translateY(-2px); box-shadow: 0 10px 25px rgba(0,255,255,0.6); }

        .game-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 25px; margin: 40px 0; }
        .game-card {
            background: rgba(0,0,0,0.7); border-radius: 20px; padding: 25px; border: 2px solid #ff00ff;
            box-shadow: 0 15px 35px rgba(255,0,255,0.3); transition: all 0.3s;
        }
        .game-card:hover { transform: translateY(-10px); border-color: #00ffff; box-shadow: 0 25px 50px rgba(0,255,255,0.4); }

        .game-title {
            font-family: 'Orbitron', monospace; font-size: 1.5rem; text-align: center; margin-bottom: 20px;
            background: linear-gradient(45deg, #ff00ff, #00ffff); -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }

        canvas { width: 100%; height: 250px; border-radius: 15px; background: rgba(0,0,0,0.9); border: 2px solid #00ffff; display: block; margin: 0 auto; }
        #leaderboard, #tournament {
            background: rgba(0,0,0,0.7); border-radius: 20px; padding: 25px; margin: 20px 0; border: 2px solid #ffff00;
        }
        .top-list { list-style: none; }
        .top-list li {
            padding: 10px; margin: 5px 0; background: rgba(255,255,255,0.1); border-radius: 10px;
            display: flex; justify-content: space-between;
        }
        #userInfo {
            display: flex; align-items: center; justify-content: center; gap: 15px;
            background: rgba(0,255,0,0.2); padding: 15px; border-radius: 15px; margin-bottom: 30px; border: 2px solid #00ff00;
        }
        .status-message {
            font-family: 'Orbitron', monospace; font-size: 1rem; margin: 10px 0; padding: 10px; border-radius: 8px;
            background: rgba(0,255,0,0.2); border-left: 4px solid #00ff00;
        }
        .difficulty-btn { width: 32%; font-size: 0.9rem; padding: 8px; margin: 2px; }
        .difficulty-btn.active { background: linear-gradient(45deg, #ffff00, #ffaa00); color: #000; }
    </style>
</head>
<body onload="checkAuth()">
    <div class="container">
        <h1>üéÆ ALEKSIN GAMES HUB 2026 ‚ú®</h1>
        
        <div id="authSection">
            <h2>üîê –í–•–û–î –í –õ–ï–ì–ï–ù–î–£ –ê–õ–ï–ö–°–ò–ù–ê</h2>
            <div id="authStatus" style="min-height: 20px; margin: 10px 0;"></div>
            <input id="usernameInput" placeholder="üëë –¢–≤–æ–π –Ω–∏–∫..." maxlength="20">
            <input id="passwordInput" type="password" placeholder="üîë –ü–∞—Ä–æ–ª—å (–º–∏–Ω–∏–º—É–º 4 —Å–∏–º–≤–æ–ª–∞)" maxlength="20">
            <button onclick="login()">üöÄ –í–û–ô–¢–ò</button>
            <button onclick="register()">üìù –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø</button>
            <p style="font-size: 0.9rem; opacity: 0.8;">üí° test/1234 | –ê–ª–µ–∫—Å–∏–Ω–õ–µ–≥–µ–Ω–¥–∞/12345</p>
        </div>

        <div id="userInfo">
            <span>üëã <span id="currentUser">-</span></span>
            <button onclick="logout()" style="width: auto; padding: 10px 20px;">üö™ –í–´–•–û–î</button>
        </div>

        <div id="gamesSection">
            <div class="game-grid">
                <!-- üêç –ó–ú–ï–ô–ö–ê ULTRA -->
                <div class="game-card" id="snakeCard">
                    <div class="game-title">üêç –ó–ú–ï–ô–ö–ê ULTRA ‚ö°üçé</div>
                    <div style="text-align: center; margin-bottom: 15px;">
                        <button class="difficulty-btn active" onclick="setSnakeDifficulty(1)">üêå –õ—ë–≥–∫–∞—è</button>
                        <button class="difficulty-btn" onclick="setSnakeDifficulty(2)">‚ö° –ù–æ—Ä–º–∞–ª—å–Ω–∞—è</button>
                        <button class="difficulty-btn" onclick="setSnakeDifficulty(3)">üöÄ –•–∞—Ä–¥–∫–æ—Ä</button>
                    </div>
                    <canvas id="snakeCanvas"></canvas>
                    <div style="text-align: center; margin-top: 15px;">
                        <button onclick="startSnake()">‚ñ∂Ô∏è –ù–û–í–ê–Ø –ò–ì–†–ê</button>
                        <div id="snakeScore" style="font-family: Orbitron; font-size: 1.4rem; margin-top: 10px;">0</div>
                        <div id="snakeLevel" style="font-size: 0.9rem; opacity: 0.8;">–£—Ä–æ–≤–µ–Ω—å: –õ—ë–≥–∫–∞—è</div>
                    </div>
                </div>

                <!-- üéØ –£–ì–ê–î–ê–ô–ö–ê -->
                <div class="game-card" id="guessCard">
                    <div class="game-title">üéØ –£–ì–ê–î–ê–ô–ö–ê PRO üé≤</div>
                    <div style="text-align: center; margin-bottom: 15px;">
                        <button class="difficulty-btn active" onclick="setGuessDifficulty(1)">1-1K</button>
                        <button class="difficulty-btn" onclick="setGuessDifficulty(2)">1-10K</button>
                        <button class="difficulty-btn" onclick="setGuessDifficulty(3)">1-100K</button>
                    </div>
                    <div style="text-align: center;">
                        <input id="guessInput" placeholder="üîç –¢–≤–æ—ë —á–∏—Å–ª–æ..." maxlength="8">
                        <br><button onclick="checkGuess()">üîç –ü–†–û–í–ï–†–ò–¢–¨</button>
                        <div id="guessFeedback" style="font-family: Orbitron; font-size: 1.1rem; margin: 10px 0;">
                            üéØ –í—ã–±–µ—Ä–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç—å!
                        </div>
                        <div id="guessAttempts" style="font-family: Orbitron; font-size: 1.2rem;">0 –ø–æ–ø—ã—Ç–æ–∫</div>
                        <div id="guessRange" style="font-size: 0.9rem; opacity: 0.8;">–î–∏–∞–ø–∞–∑–æ–Ω: 1-1000</div>
                    </div>
                </div>
            </div>

            <div id="leaderboard">
                <h3 style="text-align: center; margin-bottom: 20px;">üèÜ –¢–û–ü-10 –ò–ì–†–û–ö–û–í üêç+üéØ</h3>
                <ul id="topList" class="top-list"></ul>
            </div>

            <div id="tournament">
                <h3 style="text-align: center; margin-bottom: 20px;">‚öîÔ∏è –¢–£–†–ù–ò–† 24—á üèÜ</h3>
                <div id="tournamentInfo" style="text-align: center; font-size: 1.2rem;">
                    <div id="timerLive">‚öîÔ∏è –ó–∞–≥—Ä—É–∑–∫–∞ —Ç—É—Ä–Ω–∏—Ä–∞...</div>
                    <div id="statusLive">‚è≥ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–≥—Ä–æ–∫–æ–≤...</div>
                </div>
                <ul id="tournamentList" class="top-list"></ul>
            </div>
        </div>
    </div>

    <script>
        let currentUser = null;
        let guessNumber = null; let guessAttempts = 0; let lastGuessedNumber = 0;
        let registeredUsers = JSON.parse(localStorage.getItem('registeredUsers') || '{}');
        let snakeDifficulty = 1; let guessDifficulty = 1;
        let gameInterval = null;

        function saveData(key, data) {
            localStorage.setItem(key, JSON.stringify(data));
            sessionStorage.setItem(key, JSON.stringify(data));
        }

        // üïê –¢–£–†–ù–ò–†–ù–ê–Ø –õ–û–ì–ò–ö–ê 00:00 –ú–°–ö
        function getNextMidnightMSK() {
            const now = new Date();
            const mskOffset = 3 * 60; // –ú–°–ö +3 UTC
            const utcNow = now.getTime() + (now.getTimezoneOffset() * 60 * 1000);
            const mskNow = new Date(utcNow + (mskOffset * 60 * 1000));
            
            const nextMidnight = new Date(mskNow);
            nextMidnight.setHours(24, 0, 0, 0); // –ó–∞–≤—Ç—Ä–∞ 00:00 –ú–°–ö
            return nextMidnight.getTime();
        }

        function checkTournamentReset() {
            const lastReset = parseInt(localStorage.getItem('tournamentLastReset') || 0);
            const nowMSK = getNextMidnightMSK() - (24 * 60 * 60 * 1000); // –°–µ–≥–æ–¥–Ω—è 00:00 –ú–°–ö
            
            if (nowMSK > lastReset) {
                // ‚úÖ –ù–û–í–´–ô –¢–£–†–ù–ò–† - —Å–±—Ä–∞—Å—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –ª–∏–¥–µ—Ä–±–æ—Ä–¥ —Ç—É—Ä–Ω–∏—Ä–∞
                const tournamentScores = JSON.parse(localStorage.getItem('tournamentScores') || '{}');
                Object.keys(tournamentScores).forEach(user => {
                    if (!tournamentScores[user].locked) delete tournamentScores[user];
                });
                saveData('tournamentScores', tournamentScores);
                localStorage.setItem('tournamentLastReset', nowMSK.toString());
            }
        }

        // üîê –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø
        function login() {
            const username = document.getElementById('usernameInput').value.trim();
            const password = document.getElementById('passwordInput').value;
            const statusEl = document.getElementById('authStatus');
            
            if (!username || password.length < 4) {
                statusEl.innerHTML = '‚ùå –ù–∏–∫ –∏ –ø–∞—Ä–æ–ª—å (4+ —Å–∏–º–≤–æ–ª–∞)'; 
                statusEl.style.background = 'rgba(255,0,0,0.3)'; 
                statusEl.style.borderLeftColor = '#ff4444';
                setTimeout(() => { statusEl.innerHTML = ''; statusEl.style.background = ''; }, 2000); 
                return;
            }

            const testAccounts = { '–ê–ª–µ–∫—Å–∏–Ω–õ–µ–≥–µ–Ω–¥–∞': '12345', 'GamingPro2026': 'aleksin1', 'test': '1234' };
            const savedPassword = registeredUsers[username] || testAccounts[username];
            
            if (savedPassword && savedPassword === password) {
                localStorage.setItem('userToken', 'valid'); localStorage.setItem('userName', username);
                sessionStorage.setItem('userToken', 'valid'); sessionStorage.setItem('userName', username);
                currentUser = username; 
                document.getElementById('authSection').style.display = 'none';
                document.getElementById('gamesSection').style.display = 'block'; 
                document.getElementById('userInfo').style.display = 'flex';
                document.getElementById('currentUser').textContent = username; 
                updateAllTops(); 
                return;
            }
            
            statusEl.innerHTML = '‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω/–ø–∞—Ä–æ–ª—å'; 
            statusEl.style.background = 'rgba(255,0,0,0.3)'; 
            statusEl.style.borderLeftColor = '#ff4444';
            setTimeout(() => { statusEl.innerHTML = ''; statusEl.style.background = ''; }, 2000);
        }

        function register() {
            const username = document.getElementById('usernameInput').value.trim();
            const password = document.getElementById('passwordInput').value;
            const statusEl = document.getElementById('authStatus');
            
            if (!username || password.length < 4) {
                statusEl.innerHTML = '‚ùå –ù–∏–∫ –∏ –ø–∞—Ä–æ–ª—å (4+ —Å–∏–º–≤–æ–ª–∞)'; 
                statusEl.style.background = 'rgba(255,0,0,0.3)'; 
                statusEl.style.borderLeftColor = '#ff4444';
                setTimeout(() => { statusEl.innerHTML = ''; statusEl.style.background = ''; }, 2000); 
                return;
            }
            
            if (registeredUsers[username]) {
                statusEl.innerHTML = `‚úÖ ${username} —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω! –ù–∞–∂–º–∏ –í–û–ô–¢–ò`; 
                statusEl.style.background = 'rgba(0,255,0,0.3)'; 
                statusEl.style.borderLeftColor = '#00ff00';
                setTimeout(() => { statusEl.innerHTML = ''; statusEl.style.background = ''; }, 3000); 
                return;
            }
            
            registeredUsers[username] = password;
            saveData('registeredUsers', registeredUsers);
            statusEl.innerHTML = `‚úÖ ${username} –ó–ê–†–ï–ì–ò–°–¢–†–ò–†–û–í–ê–ù! –¢–µ–ø–µ—Ä—å –í–û–ô–î–ò`; 
            statusEl.style.background = 'rgba(0,255,0,0.3)'; 
            statusEl.style.borderLeftColor = '#00ff00';
            setTimeout(() => { statusEl.innerHTML = ''; statusEl.style.background = ''; }, 3000);
        }

        function logout() {
            currentUser = null;
            localStorage.removeItem('userToken'); localStorage.removeItem('userName');
            sessionStorage.removeItem('userToken'); sessionStorage.removeItem('userName');
            if (gameInterval) clearInterval(gameInterval);
            document.getElementById('authSection').style.display = 'block';
            document.getElementById('gamesSection').style.display = 'none';
            document.getElementById('userInfo').style.display = 'none';
            document.getElementById('usernameInput').value = ''; 
            document.getElementById('passwordInput').value = '';
        }

        function checkAuth() {
            const token = localStorage.getItem('userToken');
            const userName = localStorage.getItem('userName');
            if (token === 'valid' && userName) {
                currentUser = userName;
                document.getElementById('authSection').style.display = 'none';
                document.getElementById('gamesSection').style.display = 'block';
                document.getElementById('userInfo').style.display = 'flex';
                document.getElementById('currentUser').textContent = userName;
                updateAllTops();
            }
            checkTournamentReset();
        }

        // üêç –ó–ú–ï–ô–ö–ê –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø
        function setSnakeDifficulty(level) {
            snakeDifficulty = level;
            const btns = document.querySelectorAll('#snakeCard .difficulty-btn');
            btns.forEach((b, i) => b.classList.toggle('active', i+1 === level));
            document.getElementById('snakeLevel').textContent = 
                level === 1 ? 'üêå –õ—ë–≥–∫–∞—è' : level === 2 ? '‚ö° –ù–æ—Ä–º–∞–ª—å–Ω–∞—è' : 'üöÄ –•–∞—Ä–¥–∫–æ—Ä';
        }

        function startSnake() {
            if (gameInterval) clearInterval(gameInterval);
            
            const canvas = document.getElementById('snakeCanvas');
            const ctx = canvas.getContext('2d');
            canvas.width = 300; canvas.height = 250;
            
            const grid = 15;
            let snake = [{x: 10, y: 10}];
            let dx = 0, dy = 0;
            let food = {x: Math.floor(Math.random()*20), y: Math.floor(Math.random()*17)};
            let score = 0;
            let gameSpeed = snakeDifficulty === 1 ? 200 : snakeDifficulty === 2 ? 150 : 100;
            
            document.getElementById('snakeScore').textContent = score;

            // üßπ –û—á–∏—â–∞–µ–º —Å—Ç–∞—Ä—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
            canvas.onkeydown = null;
            window.onkeydown = null;
            
            // –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞
            const keys = {};
            const keyHandler = (e) => keys[e.key] = true;
            const keyUpHandler = (e) => keys[e.key] = false;
            window.addEventListener('keydown', keyHandler);
            window.addEventListener('keyup', keyUpHandler);
            
            // Touch —Å–≤–∞–π–ø—ã
            let touchStartX = 0, touchStartY = 0;
            canvas.addEventListener('touchstart', (e) => {
                e.preventDefault();
                touchStartX = e.touches[0].clientX;
                touchStartY = e.touches[0].clientY;
            }, {passive: false});
            
            canvas.addEventListener('touchend', (e) => {
                e.preventDefault();
                const touchEndX = e.changedTouches[0].clientX;
                const touchEndY = e.changedTouches[0].clientY;
                const diffX = touchStartX - touchEndX;
                const diffY = touchStartY - touchEndY;
                
                if (Math.abs(diffX) > Math.abs(diffY) && Math.abs(diffX) > 30) {
                    if (diffX > 0 && dx !== 1) { dx = -1; dy = 0; } // Left
                    else if (diffX < 0 && dx !== -1) { dx = 1; dy = 0; } // Right
                } else if (Math.abs(diffY) > 30) {
                    if (diffY > 0 && dy !== 1) { dy = -1; dx = 0; } // Up
                    else if (diffY < 0 && dy !== -1) { dy = 1; dx = 0; } // Down
                }
            }, {passive: false});

            function update() {
                const head = {x: snake[0].x + dx, y: snake[0].y + dy};
                
                // –°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è
                if (head.x < 0 || head.x >= 20 || head.y < 0 || head.y >= 17 || 
                    snake.some((part, i) => i > 0 && part.x === head.x && part.y === head.y)) {
                    saveScore('snake', Math.floor(score));
                    document.getElementById('snakeScore').textContent = `üíÄ ${Math.floor(score)}`;
                    clearInterval(gameInterval);
                    window.removeEventListener('keydown', keyHandler);
                    window.removeEventListener('keyup', keyUpHandler);
                    return;
                }
                
                snake.unshift(head);
                
                // –ï–¥–∞
                if (head.x === food.x && head.y === food.y) {
                    score += snakeDifficulty * 10;
                    document.getElementById('snakeScore').textContent = Math.floor(score);
                    food = {x: Math.floor(Math.random()*20), y: Math.floor(Math.random()*17)};
                } else {
                    snake.pop();
                }
                
                // –û—Ç—Ä–∏—Å–æ–≤–∫–∞
                ctx.fillStyle = 'rgba(3,5,10,0.95)';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                // –ó–º–µ–π–∫–∞ –≥—Ä–∞–¥–∏–µ–Ω—Ç
                snake.forEach((part, i) => {
                    const gradient = ctx.createLinearGradient(part.x*grid, part.y*grid, (part.x+1)*grid, (part.y+1)*grid);
                    gradient.addColorStop(0, i === 0 ? '#00ff88' : '#00aa55');
                    gradient.addColorStop(1, i === 0 ? '#44ffaa' : '#008844');
                    ctx.fillStyle = gradient;
                    ctx.fillRect(part.x*grid, part.y*grid, grid-1, grid-1);
                });
                
                // –ï–¥–∞
                ctx.fillStyle = '#ff4444';
                ctx.shadowColor = '#ff0000';
                ctx.shadowBlur = 10;
                ctx.fillRect(food.x*grid+2, food.y*grid+2, grid-5, grid-5);
                ctx.shadowBlur = 0;
                
                // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
                if (keys['ArrowUp'] && dy !== 1) { dy = -1; dx = 0; }
                if (keys['ArrowDown'] && dy !== -1) { dy = 1; dx = 0; }
                if (keys['ArrowLeft'] && dx !== 1) { dx = -1; dy = 0; }
                if (keys['ArrowRight'] && dx !== -1) { dx = 1; dy = 0; }
            }
            
            gameInterval = setInterval(update, gameSpeed);
        }

        // üéØ –£–ì–ê–î–ê–ô–ö–ê
        function setGuessDifficulty(level) {
            guessDifficulty = level;
            const btns = document.querySelectorAll('#guessCard .difficulty-btn');
            btns.forEach((b, i) => b.classList.toggle('active', i+1 === level));
            const ranges = ['1-1000', '1-10000', '1-100000'];
            document.getElementById('guessRange').textContent = `–î–∏–∞–ø–∞–∑–æ–Ω: ${ranges[level-1]}`;
            if (guessNumber) {
                guessNumber = null; guessAttempts = 0;
                document.getElementById('guessFeedback').innerHTML = 'üéØ –ù–æ–≤–∞—è –∏–≥—Ä–∞!';
                document.getElementById('guessAttempts').textContent = '0 –ø–æ–ø—ã—Ç–æ–∫';
            }
        }

        function checkGuess() {
            if (!guessNumber) {
                const ranges = [1000, 10000, 100000];
                guessNumber = Math.floor(Math.random() * ranges[guessDifficulty-1]) + 1;
            }
            
            const guess = parseInt(document.getElementById('guessInput').value) || 0;
            if (guess < 1) {
                document.getElementById('guessFeedback').innerHTML = '‚ùå –ß–∏—Å–ª–æ –æ—Ç 1!'; 
                document.getElementById('guessFeedback').style.color = '#ff4444';
                return;
            }
            
            lastGuessedNumber = guess; guessAttempts++;
            document.getElementById('guessAttempts').textContent = `${guessAttempts} –ø–æ–ø—ã—Ç–æ–∫`;
            
            const feedbackEl = document.getElementById('guessFeedback');
            if (guess === guessNumber) {
                const score = Math.floor(Math.max(1000, 100000 / guessAttempts * guessDifficulty));
                feedbackEl.innerHTML = `‚úÖ –£–≥–∞–¥–∞–ª ${guessNumber}! ${score}üíé`;
                feedbackEl.style.color = '#00ff00'; 
                saveScore('guess', score);
                guessNumber = null; guessAttempts = 0; 
                document.getElementById('guessInput').value = '';
            } else if (guess < guessNumber) {
                feedbackEl.innerHTML = `üìà –ë–æ–ª—å—à–µ —á–µ–º <strong>${guess}</strong>!`;
                feedbackEl.style.color = '#ffaa00';
            } else {
                feedbackEl.innerHTML = `üìâ –ú–µ–Ω—å—à–µ —á–µ–º <strong>${guess}</strong>!`;
                feedbackEl.style.color = '#ffaa00';
            }
            
            document.getElementById('guessInput').value = '';
            document.getElementById('guessInput').focus();
        }

        // üíæ –°–û–•–†–ê–ù–ï–ù–ò–ï - –ë—Ä–∏–ª–ª–∏–∞–Ω—Ç—ã –ù–ê–ö–û–ü–ò–¢–ï–õ–¨–ù–´–ï
        function saveScore(game, score) {
            if (!currentUser) return;
            
            // –û–±—ã—á–Ω—ã–µ —Ä–µ–∫–æ—Ä–¥—ã (–º–∞–∫—Å–∏–º—É–º)
            const scores = JSON.parse(localStorage.getItem('userScores') || '{}');
            if (!scores[currentUser]) scores[currentUser] = {snake: 0, guess: 0};
            if (score > scores[currentUser][game]) {
                scores[currentUser][game] = Math.floor(score);
            }
            saveData('userScores', scores);
            
            // –¢—É—Ä–Ω–∏—Ä–Ω—ã–µ –±—Ä–∏–ª–ª–∏–∞–Ω—Ç—ã (–Ω–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω—ã–µ)
            const tournamentScores = JSON.parse(localStorage.getItem('tournamentScores') || '{}');
            if (!tournamentScores[currentUser]) tournamentScores[currentUser] = {total: 0, locked: false};
            tournamentScores[currentUser].total += Math.floor(score);
            saveData('tournamentScores', tournamentScores);
        }

        // üèÜ –¢–û–ü–´
        function updateAllTops() {
            checkTournamentReset();
            updateLeaderboard(); 
            updateTournament();
        }

        function updateLeaderboard() {
            const scores = JSON.parse(localStorage.getItem('userScores') || '{}');
            const topList = Object.entries(scores)
                .map(([user, games]) => ({
                    user,
                    total: Math.floor((games.snake || 0) + (games.guess || 0))
                }))
                .sort((a, b) => b.total - a.total)
                .slice(0, 10);
            
            const listEl = document.getElementById('topList');
            listEl.innerHTML = topList.map((item, i) => 
                `<li>${i+1}. <strong>${item.user}</strong> ${item.total}üíé`
            ).join('') || '<li>üë• –†–µ–∫–æ—Ä–¥–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç...</li>';
        }

        function updateTournament() {
            const nextMidnight = getNextMidnightMSK();
            const now = Date.now();
            const remainingMs = nextMidnight - now;
            const hours = Math.floor(remainingMs / (1000 * 60 * 60));
            const minutes = Math.floor((remainingMs % (1000 * 60 * 60)) / (1000 * 60));
            
            document.getElementById('timerLive').textContent = 
                `‚öîÔ∏è –î–æ –∫–æ–Ω—Ü–∞: ${hours}—á ${minutes}–º`;
            
            const tournamentScores = JSON.parse(localStorage.getItem('tournamentScores') || '{}');
            const tournamentList = Object.entries(tournamentScores)
                .filter(([_, data]) => !data.locked)
                .map(([user, data]) => ({
                    user,
                    total: Math.floor(data.total)
                }))
                .sort((a, b) => b.total - a.total)
                .slice(0, 5);
            
            const listEl = document.getElementById('tournamentList');
            listEl.innerHTML = tournamentList.map((item, i) => {
                const medals = ['ü•á', 'ü•à', 'ü•â', '‚öúÔ∏è', '‚öúÔ∏è'];
                return `<li>${medals[i] || i+1} ${item.user}: ${item.total}üíé`;
            }).join('') || '<li>üë• –ò–≥—Ä–æ–∫–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç...</li>';
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('guessInput').addEventListener('keypress', e => {
                if (e.key === 'Enter') checkGuess();
            });
            
            setInterval(updateAllTops, 5000); // –ö–∞–∂–¥—ã–µ 5 —Å–µ–∫
            updateAllTops();
            setSnakeDifficulty(1); 
            setGuessDifficulty(1);
        });

        // –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
        setInterval(() => {
            if (currentUser) {
                const scores = JSON.parse(localStorage.getItem('userScores') || '{}');
                const tournamentScores = JSON.parse(localStorage.getItem('tournamentScores') || '{}');
                if (scores[currentUser] || tournamentScores[currentUser]) {
                    saveData('userScores', scores);
                    saveData('tournamentScores', tournamentScores);
                }
            }
            saveData('registeredUsers', registeredUsers);
        }, 10000);
    </script>
</body>
</html>
