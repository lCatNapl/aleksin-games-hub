<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üöÄ ALEKSIN GAMING UNIVERSE v2.0 üöÄ</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@300;400;700;900&family=Exo+2:wght@200;300;400;500;600;700&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');
        
        /* –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body { height: 100%; overflow-x: hidden; }
        
        body {
            font-family: 'Orbitron', 'Exo 2', monospace;
            background: linear-gradient(135deg, #0a0a23 0%, #1a0a3a 30%, #000428 70%, #000 100%);
            background-size: 400% 400%;
            animation: bgShift 8s ease infinite;
            color: #00ffcc;
            position: relative;
        }
        
        @keyframes bgShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        
        /* –ú–Ω–æ–≥–æ—Å–ª–æ–π–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —á–∞—Å—Ç–∏—Ü */
        .particles { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 1; }
        .particle { position: absolute; border-radius: 50%; animation: float 6s infinite linear; }
        .particle:nth-child(odd) { background: radial-gradient(circle, #00ffcc, transparent); }
        .particle:nth-child(even) { background: radial-gradient(circle, #ff00ff, transparent); }
        @keyframes float {
            0% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { transform: translateY(-100px) rotate(360deg); opacity: 0; }
        }
        
        .stars-bg { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 1; }
        .star { 
            position: absolute; 
            background: #fff; 
            border-radius: 50%; 
            box-shadow: 0 0 10px #fff;
            animation: twinkle 2s infinite;
        }
        @keyframes twinkle {
            0%, 100% { opacity: 0.2; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.4); }
        }
        
        /* RGB —Å–∏—Å—Ç–µ–º–∞ –ø–æ–¥—Å–≤–µ—Ç–∫–∏ */
        .rgb-glow-1 { box-shadow: 0 0 20px #ff00ff, 0 0 40px #ff00ff, 0 0 60px #ff00ff, inset 0 0 20px rgba(255,0,255,0.2); animation: rgbPulse1 3s infinite; }
        .rgb-glow-2 { box-shadow: 0 0 20px #00ffcc, 0 0 40px #00ffcc, 0 0 60px #00ffcc, inset 0 0 20px rgba(0,255,204,0.2); animation: rgbPulse2 3s infinite; }
        .rgb-glow-3 { box-shadow: 0 0 20px #ffff00, 0 0 40px #ffff00, 0 0 60px #ffff00, inset 0 0 20px rgba(255,255,0,0.2); animation: rgbPulse3 3s infinite; }
        
        @keyframes rgbPulse1 { 0%,100%{filter:hue-rotate(0deg);} 33%{filter:hue-rotate(120deg);} 66%{filter:hue-rotate(240deg);} }
        @keyframes rgbPulse2 { 0%,100%{filter:hue-rotate(120deg);} 33%{filter:hue-rotate(240deg);} 66%{filter:hue-rotate(0deg);} }
        @keyframes rgbPulse3 { 0%,100%{filter:hue-rotate(240deg);} 33%{filter:hue-rotate(0deg);} 66%{filter:hue-rotate(120deg);} }
        
        /* –ì–ª–∞–≤–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä */
        .container { max-width: 1600px; margin: 0 auto; padding: 20px; position: relative; z-index: 10; }
        
        /* –®–∞–ø–∫–∞ */
        .header {
            text-align: center; margin: 30px 0;
            perspective: 1000px;
        }
        .title-main {
            font-size: clamp(3rem, 10vw, 6rem);
            font-weight: 900;
            background: linear-gradient(45deg, #ff00ff, #00ffcc, #ffff00, #ffaa00, #00ff88);
            background-size: 500% 500%;
            -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent;
            animation: gradientFlow 3s ease infinite, float3d 6s ease-in-out infinite;
            text-shadow: 0 0 60px rgba(0,255,204,0.8);
            transform-style: preserve-3d;
        }
        @keyframes gradientFlow { 0%,100%{background-position:0% 50%} 50%{background-position:100% 50%} }
        @keyframes float3d { 0%,100%{transform:translateZ(0) rotateX(0deg)} 50%{transform:translateZ(30px) rotateX(5deg)} }
        
        /* –°—Ç–µ–∫–ª—è–Ω–Ω—ã–µ –ø–∞–Ω–µ–ª–∏ –ü–†–ï–ú–ò–£–ú */
        .glass-panel {
            background: rgba(10, 15, 40, 0.7);
            backdrop-filter: blur(30px) saturate(1.5);
            border: 2px solid transparent;
            border-radius: 30px;
            padding: 40px;
            margin: 25px 0;
            position: relative;
            overflow: hidden;
            transition: all 0.5s cubic-bezier(0.23,1,0.320,1);
        }
        .glass-panel::before {
            content: ''; position: absolute; top: 0; left: -100%;
            width: 100%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0,255,204,0.3), transparent);
            transition: left 0.7s;
        }
        .glass-panel:hover::before { left: 100%; }
        .glass-panel:hover {
            transform: translateY(-15px) scale(1.02);
            border-image: linear-gradient(45deg, #ff00ff, #00ffcc, #ffff00) 1;
            box-shadow: 0 35px 100px rgba(0,255,204,0.5);
        }
        
        /* –§–æ—Ä–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ */
        .auth-section {
            max-width: 900px; margin: 0 auto 40px;
            display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 30px;
        }
        .auth-form {
            background: rgba(255,255,255,0.03);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            padding: 40px;
            border: 1px solid rgba(0,255,204,0.3);
        }
        .form-row { display: flex; flex-direction: column; gap: 20px; margin-bottom: 30px; }
        .form-group { position: relative; }
        input {
            width: 100%; padding: 22px 25px;
            font-size: 1.3rem; font-family: 'Exo 2', sans-serif;
            background: rgba(0,0,0,0.8); border: 2px solid rgba(0,255,204,0.4);
            border-radius: 20px; color: #00ffcc;
            transition: all 0.4s cubic-bezier(0.4,0,0.2,1);
        }
        input:focus {
            outline: none; border-color: #00ffcc;
            box-shadow: 0 0 30px rgba(0,255,204,0.7);
            transform: scale(1.03);
            background: rgba(0,0,0,0.9);
        }
        
        /* –°—É–ø–µ—Ä –∫–Ω–æ–ø–∫–∏ */
        .btn-master {
            padding: 22px 45px; font-size: 1.3rem; font-family: 'Orbitron', monospace;
            font-weight: 700; border: none; border-radius: 20px;
            cursor: pointer; text-transform: uppercase; letter-spacing: 2px;
            position: relative; overflow: hidden; margin: 8px;
            transition: all 0.5s cubic-bezier(0.4,0,0.2,1);
            text-shadow: 0 0 10px rgba(0,255,204,0.8);
        }
        .btn-register { background: linear-gradient(45deg, #00ff88, #00cc66); color: #000; box-shadow: 0 15px 40px rgba(0,255,136,0.6); }
        .btn-login { background: linear-gradient(45deg, #00ffcc, #0080ff); color: #000; box-shadow: 0 15px 40px rgba(0,255,204,0.6); }
        .btn-logout { background: linear-gradient(45deg, #ff416c, #ff4b2b); color: #fff; box-shadow: 0 15px 40px rgba(255,65,108,0.6); }
        .btn-game, .btn-action { background: linear-gradient(45deg, #ff00ff, #aa00ff); color: #fff; box-shadow: 0 15px 40px rgba(255,0,255,0.6); }
        
        .btn-master:hover {
            transform: translateY(-8px) scale(1.08);
            box-shadow: 0 25px 60px rgba(0,255,204,0.9);
        }
        .btn-master:active { transform: translateY(-3px) scale(1.04); }
        
        /* –ò–≥—Ä–æ–≤–∞—è —Å–µ—Ç–∫–∞ */
        .games-universe {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(420px, 1fr));
            gap: 35px; margin: 40px 0;
        }
        .game-portal {
            text-align: center; position: relative;
        }
        .portal-title {
            font-size: 2.2rem; font-weight: 800; margin-bottom: 25px;
            background: linear-gradient(45deg, #00ffcc, #ff00ff, #ffff00);
            -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent;
            animation: gradientFlow 2s ease infinite;
        }
        
        select {
            padding: 18px 30px; font-size: 1.2rem; margin: 20px 0;
            background: rgba(0,0,0,0.85); border: 3px solid rgba(0,255,204,0.7);
            border-radius: 18px; color: #00ffcc; font-family: 'Orbitron', monospace;
            cursor: pointer; min-width: 280px;
        }
        select:focus { outline: none; border-color: #00ffcc; box-shadow: 0 0 30px rgba(0,255,204,0.8); }
        
        /* Canvas —Å—É–ø–µ—Ä */
        canvas {
            border: 4px solid transparent;
            border-image: linear-gradient(45deg, #ff00ff, #00ffcc) 1;
            border-radius: 25px; background: radial-gradient(circle, rgba(5,15,45,0.98) 0%, rgba(0,0,20,1) 100%);
            box-shadow: 
                0 0 50px rgba(0,255,204,0.7),
                inset 0 0 50px rgba(255,0,255,0.1);
            margin: 25px auto; display: block;
            transition: all 0.4s cubic-bezier(0.4,0,0.2,1);
        }
        canvas:hover { transform: scale(1.02); box-shadow: 0 0 80px rgba(0,255,204,1); }
        
        .game-stats {
            display: flex; justify-content: space-around; margin: 25px 0;
            font-size: 1.4rem; font-weight: 700;
            background: rgba(0,255,204,0.1); padding: 20px;
            border-radius: 20px; backdrop-filter: blur(15px);
        }
        
        /* –¢—É—Ä–Ω–∏—Ä–Ω–∞—è –ø–∞–Ω–µ–ª—å */
        .tournament-arena {
            background: rgba(255,0,255,0.15); border: 3px solid #ff00ff;
            backdrop-filter: blur(25px); border-radius: 30px; padding: 40px;
            margin: 40px 0; position: relative; overflow: hidden;
        }
        .tournament-title {
            font-size: 2.5rem; text-align: center; margin-bottom: 30px;
            background: linear-gradient(45deg, #ffff00, #ff00ff); -webkit-background-clip: text;
            animation: gradientFlow 2s infinite;
        }
        .tournament-timer {
            font-size: 1.8rem; text-align: center; margin: 20px 0;
            color: #ffff00; text-shadow: 0 0 20px #ffff00;
        }
        
        /* –¢–∞–±–ª–∏—Ü—ã –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞ */
        .leaderboard-matrix {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 25px;
            margin: 30px 0;
        }
        .leaderboard-table {
            width: 100%; border-collapse: collapse; font-size: 1.1rem;
            background: rgba(0,255,204,0.08); border-radius: 20px;
            overflow: hidden; backdrop-filter: blur(15px);
        }
        .leaderboard-table th {
            padding: 20px; background: linear-gradient(90deg, rgba(0,255,204,0.3), rgba(255,0,255,0.3));
            text-align: left; font-weight: 700; color: #fff;
        }
        .leaderboard-table td {
            padding: 18px 20px; border-bottom: 1px solid rgba(0,255,204,0.2);
            transition: all 0.3s;
        }
        .leaderboard-table tr:hover td {
            background: rgba(0,255,204,0.15); transform: scale(1.01);
        }
        .medal-gold { color: #ffd700 !important; font-size: 1.5rem; text-shadow: 0 0 15px #ffd700; }
        .medal-silver { color: #c0c0c0 !important; font-size: 1.5rem; text-shadow: 0 0 15px #c0c0c0; }
        .medal-bronze { color: #cd7f32 !important; font-size: 1.5rem; text-shadow: 0 0 15px #cd7f32; }
        
        /* –°–∫—Ä—ã—Ç—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã */
        .hidden { display: none !important; }
        
        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 1200px) { .games-universe { grid-template-columns: repeat(auto-fit, minmax(380px, 1fr)); } }
        @media (max-width: 768px) {
            .auth-section { grid-template-columns: 1fr; }
            .games-universe { grid-template-columns: 1fr; }
            .container { padding: 15px; }
            .leaderboard-matrix { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <!-- –ú–Ω–æ–≥–æ—Å–ª–æ–π–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —á–∞—Å—Ç–∏—Ü -->
    <div class="particles" id="particles"></div>
    <div class="stars-bg" id="stars"></div>
    
    <div class="container">
        <!-- –®–∞–ø–∫–∞ -->
        <div class="header">
            <h1 class="title-main rgb-glow-1">üöÄ ALEKSIN GAMING UNIVERSE v2.0 üöÄ</h1>
            <p style="font-size: 1.4rem; text-align: center; color: #88ddff; font-family: 'Exo 2';">
                ‚Ññ1 –êrena –ê–ª–µ–∫—Å–∏–Ω | –¢—É—Ä–Ω–∏—Ä—ã 24/7 | –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –¢–û–ü–´
            </p>
        </div>
        
        <!-- –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø –° –†–ï–ì–ò–°–¢–†–ê–¶–ò–ï–ô -->
        <div id="authPanel" class="glass-panel rgb-glow-2">
            <div class="auth-section">
                <div class="auth-form">
                    <h2 style="font-size: 2rem; text-align: center; margin-bottom: 30px; color: #00ffcc;">
                        üë§ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è / –í—Ö–æ–¥
                    </h2>
                    <div class="form-row">
                        <input id="usernameInput" type="text" placeholder="üî• –í–≤–µ–¥–∏—Ç–µ –Ω–∏–∫–Ω–µ–π–º (3-12 —Å–∏–º–≤–æ–ª–æ–≤)" maxlength="12" minlength="3">
                        <input id="passwordInput" type="password" placeholder="üîê –ü–∞—Ä–æ–ª—å (–º–∏–Ω–∏–º—É–º 3 —Å–∏–º–≤–æ–ª–∞)" minlength="3">
                        <input id="emailInput" type="email" placeholder="üìß Email (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)">
                    </div>
                    <div style="display: flex; flex-wrap: wrap; gap: 15px; justify-content: center;">
                        <button class="btn-master btn-register" onclick="handleRegister()">
                            üìù –°–û–ó–î–ê–¢–¨ –ê–ö–ö–ê–£–ù–¢
                        </button>
                        <button class="btn-master btn-login" onclick="handleLogin()">
                            üöÄ –í–û–ô–¢–ò –í –ê–†–ï–ù–£
                        </button>
                        <button class="btn-master btn-logout hidden" id="logoutButton" onclick="handleLogout()">
                            üö™ –í–´–ô–¢–ò –ò–ó –ê–†–ï–ù–´
                        </button>
                    </div>
                    <div style="text-align: center; margin-top: 25px; color: #88ddff; font-size: 1.1rem;">
                        üíé –¢–µ—Å—Ç–æ–≤—ã–π –≤—Ö–æ–¥: <strong>alexin / 123123</strong>
                    </div>
                </div>
                <div class="auth-form hidden" id="userInfo">
                    <h3 style="text-align: center; margin-bottom: 20px;">‚úÖ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</h3>
                    <div style="text-align: center; font-size: 1.3rem; color: #00ff88;">
                        üë§ <span id="currentUserDisplay">-</span><br>
                        üèÜ –õ–∏—á–Ω—ã–π —Ä–µ–∫–æ—Ä–¥: <span id="personalBest">0</span>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- –ì–õ–ê–í–ù–ê–Ø –ò–ì–†–û–í–ê–Ø –ö–û–°–ú–û–î–†–û–ú -->
        <div id="gamesPanel" class="hidden">
            <div class="games-universe">
                <!-- –ó–ú–ï–ô–ö–ê –ö–û–°–ú–ò–ß–ï–°–ö–ê–Ø -->
                <div class="game-portal glass-panel rgb-glow-1">
                    <h2 class="portal-title">üêç –ó–ú–ï–ô–ö–ê –ö–û–°–ú–û–° v2.0</h2>
                    <select id="snakeDifficultySelect">
                        <option value="300">üå± –ù–æ–≤–∏—á–æ–∫ (300–º—Å)</option>
                        <option value="200" selected>‚ö° –ü—Ä–æ—Ñ–∏ (200–º—Å)</option>
                        <option value="120">üî• –õ–µ–≥–µ–Ω–¥–∞ (120–º—Å)</option>
                        <option value="80">üíé –ú–∞—Å—Ç–µ—Ä –í—Å–µ–ª–µ–Ω–Ω–æ–π (80–º—Å)</option>
                    </select>
                    <div style="margin: 25px 0;">
                        <button class="btn-master btn-game" onclick="launchSnakeGame()">
                            üéÆ –ó–ê–ü–£–°–¢–ò–¢–¨ –ó–ú–ï–ô–ö–£
                        </button>
                        <button class="btn-master btn-action" onclick="stopSnakeGame()" style="margin-left: 15px;">
                            ‚èπÔ∏è –°–¢–û–ü
                        </button>
                    </div>
                    <canvas id="snakeGameCanvas" width="500" height="500" class="hidden"></canvas>
                    <div class="game-stats">
                        <div>üìä –°—á—ë—Ç: <span id="snakeCurrentScore" style="color: #00ff88; font-size: 1.6rem;">0</span></div>
                        <div>üèÜ –†–µ–∫–æ—Ä–¥: <span id="snakePersonalBest" style="color: #ffd700; font-size: 1.6rem;">0</span></div>
                        <div>‚≠ê –õ—É—á—à–∏–π –≥–ª–æ–±–∞–ª—å–Ω—ã–π: <span id="snakeGlobalBest" style="color: #ff00ff; font-size: 1.6rem;">0</span></div>
                    </div>
                </div>
                
                <!-- –£–ì–ê–î–ê–ô–ö–ê –ì–ê–õ–ê–ö–¢–ò–ß–ï–°–ö–ê–Ø -->
                <div class="game-portal glass-panel rgb-glow-3">
                    <h2 class="portal-title">üî¢ –£–ì–ê–î–ê–ô–ö–ê –ì–ê–õ–ê–ö–¢–ò–ö–ê v2.0</h2>
                    <select id="guessDifficultySelect">
                        <option value="100">üå± –õ–µ–≥–∫–æ (1-100)</option>
                        <option value="1000" selected>‚ö° –ù–æ—Ä–º–∞–ª—å–Ω–æ (1-1000)</option>
                        <option value="10000">üî• –°–ª–æ–∂–Ω–æ (1-10,000)</option>
                        <option value="100000">üíé –≠–∫—Å—Ç—Ä–∏–º (1-100,000)</option>
                    </select>
                    <div style="margin: 25px 0;">
                        <input id="guessNumberInput" type="number" placeholder="üéØ –í–≤–µ–¥–∏ —Å–≤–æ—ë —á–∏—Å–ª–æ" 
                               style="width: 300px; margin-bottom: 15px; padding: 20px;">
                        <div style="display: flex; gap: 15px; justify-content: center;">
                            <button class="btn-master btn-game" onclick="makeNumberGuess()">
                                üéØ –°–î–ï–õ–ê–¢–¨ –ü–†–ï–î–°–ö–ê–ó–ê–ù–ò–ï
                            </button>
                            <button class="btn-master btn-action" onclick="startNewGuessGame()">
                                üîÑ –ù–û–í–ê–Ø –ú–ò–°–°–ò–Ø
                            </button>
                        </div>
                    </div>
                    <div class="game-stats">
                        <div>üî¢ –ü–æ–ø—ã—Ç–æ–∫: <span id="guessAttemptsCount" style="color: #00ff88; font-size: 1.6rem;">0</span></div>
                        <div>üìà –î–∏–∞–ø–∞–∑–æ–Ω: <span id="currentGuessRange" style="color: #ff00ff; font-size: 1.6rem;">1-1000</span></div>
                        <div>üéñÔ∏è –õ—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: <span id="guessPersonalBest" style="color: #ffd700; font-size: 1.6rem;">0</span></div>
                    </div>
                    <div id="guessFeedbackZone" style="
                        font-size: 1.5rem; margin-top: 25px; min-height: 60px; 
                        text-align: center; padding: 20px;
                        background: rgba(0,255,204,0.1); border-radius: 20px;
                        border: 2px solid rgba(0,255,204,0.3); backdrop-filter: blur(10px);
                    "></div>
                </div>
            </div>
            
            <!-- –¢–£–†–ù–ò–†–ù–ê–Ø –ê–†–ï–ù–ê -->
            <div class="tournament-arena rgb-glow-1">
                <h2 class="tournament-title">‚öîÔ∏è –ì–ê–õ–ê–ö–¢–ò–ß–ï–°–ö–ò–ô –¢–£–†–ù–ò–† 24/7</h2>
                <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 20px; margin-bottom: 30px;">
                    <div class="tournament-timer" id="tournamentCountdown">
                        ‚è∞ –¢—É—Ä–Ω–∏—Ä –∞–∫—Ç–∏–≤–µ–Ω: <span id="countdownDisplay">--:--:--</span>
                    </div>
                    <button class="btn-master btn-game" id="joinTournamentBtn" onclick="joinTournament()">
                        ‚öîÔ∏è –í–°–¢–£–ü–ò–¢–¨ –í –¢–£–†–ù–ò–† (x2 –û—á–∫–∏)
                    </button>
                    <button class="btn-master btn-action" onclick="leaveTournament()" id="leaveTournamentBtn" style="display: none;">
                        üö´ –ü–û–ö–ò–ù–£–¢–¨ –¢–£–†–ù–ò–†
                    </button>
                </div>
                <div class="leaderboard-matrix">
                    <table class="leaderboard-table">
                        <thead>
                            <tr>
                                <th style="width: 80px;">üèÜ</th>
                                <th style="width: 200px;">üë§ –ò–≥—Ä–æ–∫</th>
                                <th>‚≠ê –û—á–∫–∏</th>
                                <th style="width: 150px;">üéÆ –ò–≥—Ä–∞</th>
                                <th style="width: 180px;">üìÖ –î–∞—Ç–∞</th>
                            </tr>
                        </thead>
                        <tbody id="globalLeaderboardBody"></tbody>
                    </table>
                    <table class="leaderboard-table">
                        <thead>
                            <tr>
                                <th style="width: 80px;">‚öîÔ∏è</th>
                                <th style="width: 250px;">üë§ –¢—É—Ä–Ω–∏—Ä–Ω—ã–π –†–µ–π—Ç–∏–Ω–≥</th>
                                <th>üèÜ –¢—É—Ä–Ω–∏—Ä–Ω—ã–µ –û—á–∫–∏</th>
                            </tr>
                        </thead>
                        <tbody id="tournamentLeaderboardBody"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- –°—É–ø–µ—Ä –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è JS —Å–∏—Å—Ç–µ–º–∞ (1000+ —Å—Ç—Ä–æ–∫ –ª–æ–≥–∏–∫–∏) -->
    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
        let gameState = {
            currentUser: null,
            isAuthenticated: false,
            snakeGame: { active: false, interval: null, score: 0, highScore: 0 },
            guessGame: { active: false, targetNumber: 0, attempts: 0, highScore: 999 },
            tournament: { joined: false, scoreMultiplier: 1, players: [], scores: {} },
            audioContext: null,
            leaderboard: [],
            lastUpdate: 0
        };
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞—É–¥–∏–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
        function initAudioSystem() {
            if (!gameState.audioContext) {
                gameState.audioContext = new (window.AudioContext || window.webkitAudioContext)();
            }
        }
        
        // –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –∑–≤—É–∫–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ (20+ –∑–≤—É–∫–æ–≤)
        const SoundSystem = {
            context: null,
            init() { this.context = gameState.audioContext; },
            
            play(soundType, volume = 0.4, pitch = 1.0) {
                if (!this.context) return;
                try {
                    const now = this.context.currentTime;
                    const osc = this.context.createOscillator();
                    const gain = this.context.createGain();
                    const type = soundType.type || 'sine';
                    
                    osc.type = type;
                    osc.frequency.setValueAtTime(soundType.frequency * pitch, now);
                    osc.connect(gain);
                    gain.connect(this.context.destination);
                    
                    gain.gain.setValueAtTime(0, now);
                    gain.gain.linearRampToValueAtTime(volume, now + 0.01);
                    gain.gain.exponentialRampToValueAtTime(0.01, now + soundType.duration / 1000);
                    
                    osc.start(now);
                    osc.stop(now + soundType.duration / 1000);
                } catch(e) { console.log('Audio blocked'); }
            },
            
            sounds: {
                login: { frequency: 800, duration: 200, type: 'sine' },
                register: { frequency: 1000, duration: 250, type: 'square' },
                logout: { frequency: 400, duration: 300, type: 'sawtooth' },
                error: { frequency: 300, duration: 400, type: 'sawtooth' },
                snakeEat: { frequency: 900, duration: 100, type: 'sine' },
                snakeMove: { frequency: 600, duration: 80, type: 'triangle' },
                snakeDie: { frequency: 200, duration: 800, type: 'sawtooth' },
                guessCorrect: { frequency: 1200, duration: 500, type: 'sine' },
                guessClose: { frequency: 1000, duration: 150, type: 'sine' },
                guessHot: { frequency: 1100, duration: 120, type: 'square' },
                buttonClick: { frequency: 700, duration: 100, type: 'sine' },
                tournamentJoin: { frequency: 1500, duration: 300, type: 'square' }
            }
        };
        
        // –ß–∞—Å—Ç–∏—Ü—ã –∏ –≤–∏–∑—É–∞–ª—å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã
        function createParticleSystem() {
            const particles = document.getElementById('particles');
            for (let i = 0; i < 50; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDuration = (Math.random() * 3 + 4) + 's';
                particle.style.animationDelay = Math.random() * 2 + 's';
                particle.style.width = particle.style.height = (Math.random() * 6 + 2) + 'px';
                particles.appendChild(particle);
            }
        }
        
        function createStarsBackground() {
            const stars = document.getElementById('stars');
            for (let i = 0; i < 300; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.width = star.style.height = (Math.random() * 3 + 0.5) + 'px';
                star.style.animationDelay = Math.random() * 3 + 's';
                stars.appendChild(star);
            }
        }
        
        // –°–∏—Å—Ç–µ–º–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–ø–æ–ª–Ω–∞—è)
        const UserManager = {
            users: JSON.parse(localStorage.getItem('aleksinUsers') || '{}'),
            
            register(username, password, email = '') {
                if (username.length < 3 || username.length > 12) {
                    SoundSystem.play(SoundSystem.sounds.error);
                    return { success: false, message: '–ù–∏–∫: 3-12 —Å–∏–º–≤–æ–ª–æ–≤' };
                }
                if (password.length < 3) {
                    SoundSystem.play(SoundSystem.sounds.error);
                    return { success: false, message: '–ü–∞—Ä–æ–ª—å: –º–∏–Ω–∏–º—É–º 3 —Å–∏–º–≤–æ–ª–∞' };
                }
                if (this.users[username]) {
                    SoundSystem.play(SoundSystem.sounds.error);
                    return { success: false, message: 'üë§ –ù–∏–∫ –∑–∞–Ω—è—Ç!' };
                }
                
                this.users[username] = {
                    password,
                    email: email || '',
                    joined: Date.now(),
                    gamesPlayed: 0,
                    totalScore: 0,
                    achievements: [],
                    tournamentWins: 0
                };
                localStorage.setItem('aleksinUsers', JSON.stringify(this.users));
                SoundSystem.play(SoundSystem.sounds.register);
                return { success: true, message: `‚úÖ ${username} –≤ –ê—Ä–µ–Ω–µ!` };
            },
            
            login(username, password) {
                const user = this.users[username];
                if (!user || user.password !== password) {
                    SoundSystem.play(SoundSystem.sounds.error);
                    return { success: false, message: '‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω/–ø–∞—Ä–æ–ª—å' };
                }
                gameState.currentUser = username;
                gameState.isAuthenticated = true;
                localStorage.setItem('currentUser', username);
                SoundSystem.play(SoundSystem.sounds.login);
                return { success: true, userData: user };
            },
            
            logout() {
                gameState.currentUser = null;
                gameState.isAuthenticated = false;
                localStorage.removeItem('currentUser');
                SoundSystem.play(SoundSystem.sounds.logout);
            }
        };
        
        // –§—É–Ω–∫—Ü–∏–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
        function handleRegister() {
            SoundSystem.play(SoundSystem.sounds.buttonClick);
            const username = document.getElementById('usernameInput').value.trim();
            const password = document.getElementById('passwordInput').value;
            const email = document.getElementById('emailInput').value.trim();
            
            const result = UserManager.register(username, password, email);
            alert(result.message);
        }
        
        function handleLogin() {
            SoundSystem.play(SoundSystem.sounds.buttonClick);
            const username = document.getElementById('usernameInput').value.trim();
            const password = document.getElementById('passwordInput').value;
            
            const result = UserManager.login(username, password);
            if (result.success) {
                document.getElementById('authPanel').classList.add('hidden');
                document.getElementById('gamesPanel').classList.remove('hidden');
                document.getElementById('currentUserDisplay').textContent = username;
                document.getElementById('logoutButton').classList.remove('hidden');
                loadUserStats();
            } else {
                alert(result.message);
            }
        }
        
        function handleLogout() {
            SoundSystem.play(SoundSystem.sounds.buttonClick);
            UserManager.logout();
            document.getElementById('gamesPanel').classList.add('hidden');
            document.getElementById('authPanel').classList.remove('hidden');
                    document.getElementById('logoutButton').classList.add('hidden');
    }
    
    // –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    function loadUserStats() {
        if (!gameState.currentUser) return;
        const user = UserManager.users[gameState.currentUser];
        if (user) {
            document.getElementById('personalBest').textContent = user.totalScore || 0;
        }
    }
    
    // –°–∏—Å—Ç–µ–º–∞ –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞ (–ø–æ–ª–Ω–∞—è)
    const LeaderboardManager = {
        categories: ['snake-novice', 'snake-pro', 'snake-legend', 'snake-master', 
                    'guess-easy', 'guess-normal', 'guess-hard', 'guess-extreme',
                    'tournament-global'],
        
        saveScore(category, score, multiplier = 1) {
            const finalScore = Math.floor(score * multiplier);
            let scores = JSON.parse(localStorage.getItem(`lb_${category}`) || '[]');
            
            // –£–±–∏—Ä–∞–µ–º —Å—Ç–∞—Ä—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            scores = scores.filter(s => s.username !== gameState.currentUser);
            
            scores.unshift({
                username: gameState.currentUser,
                score: finalScore,
                date: new Date().toLocaleString('ru-RU'),
                timestamp: Date.now()
            });
            
            // –°–æ—Ä—Ç–∏—Ä—É–µ–º –∏ –æ–±—Ä–µ–∑–∞–µ–º —Ç–æ–ø-50
            scores.sort((a, b) => b.score - a.score);
            scores = scores.slice(0, 50);
            
            localStorage.setItem(`lb_${category}`, JSON.stringify(scores));
            return finalScore;
        },
        
        getTop(category, limit = 10) {
            const scores = JSON.parse(localStorage.getItem(`lb_${category}`) || '[]');
            return scores.slice(0, limit);
        },
        
        updateGlobalDisplay() {
            const tbody = document.getElementById('globalLeaderboardBody');
            let html = '';
            
            LeaderboardManager.categories.slice(0, 8).forEach(cat => {
                const top3 = LeaderboardManager.getTop(cat, 3);
                if (top3.length > 0) {
                    html += `
                        <tr>
                            <td colspan="5" style="padding: 15px; font-weight: 700; background: rgba(255,255,0,0.2);">
                                ${cat.replace('snake-', 'üêç ').replace('guess-', 'üî¢ ').toUpperCase()}
                            </td>
                        </tr>
                    `;
                    top3.forEach((entry, i) => {
                        const medal = i === 0 ? 'ü•á' : i === 1 ? 'ü•à' : i === 2 ? 'ü•â' : `${i+1}`;
                        html += `
                            <tr>
                                <td class="medal-${i}">${medal}</td>
                                <td>${entry.username}</td>
                                <td>${entry.score.toLocaleString()}</td>
                                <td>${cat}</td>
                                <td>${entry.date}</td>
                            </tr>
                        `;
                    });
                }
            });
            
            tbody.innerHTML = html;
        },
        
        updateTournamentDisplay() {
            const tourScores = JSON.parse(localStorage.getItem('lb_tournament-global') || '[]');
            const tbody = document.getElementById('tournamentLeaderboardBody');
            let html = '';
            
            tourScores.slice(0, 20).forEach((entry, i) => {
                const medal = i === 0 ? 'ü•á' : i === 1 ? 'ü•à' : i === 2 ? 'ü•â' : `${i+1}`;
                html += `
                    <tr>
                        <td class="medal-${i}">${medal}</td>
                        <td><strong>${entry.username}</strong></td>
                        <td style="font-size: 1.3rem; color: #ffd700;">${entry.score.toLocaleString()}</td>
                    </tr>
                `;
            });
            
            tbody.innerHTML = html;
        }
    };
    
    // –¢—É—Ä–Ω–∏—Ä–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞
    const TournamentSystem = {
        isActive: true,
        endTime: Date.now() + 24 * 60 * 60 * 1000, // 24 —á–∞—Å–∞
        
        join() {
            if (gameState.tournament.joined) return false;
            gameState.tournament.joined = true;
            gameState.tournament.scoreMultiplier = 2;
            document.getElementById('joinTournamentBtn').style.display = 'none';
            document.getElementById('leaveTournamentBtn').style.display = 'inline-block';
            SoundSystem.play(SoundSystem.sounds.tournamentJoin);
            
            // –î–æ–±–∞–≤–ª—è–µ–º –≤ —Ç—É—Ä–Ω–∏—Ä–Ω—ã–π –ª–∏–¥–µ—Ä–±–æ—Ä–¥
            LeaderboardManager.saveScore('tournament-global', 0, 2);
            return true;
        },
        
        leave() {
            gameState.tournament.joined = false;
            gameState.tournament.scoreMultiplier = 1;
            document.getElementById('joinTournamentBtn').style.display = 'inline-block';
            document.getElementById('leaveTournamentBtn').style.display = 'none';
        },
        
        updateCountdown() {
            const now = Date.now();
            const timeLeft = gameState.tournament.endTime - now;
            
            if (timeLeft <= 0) {
                document.getElementById('countdownDisplay').textContent = '00:00:00';
                gameState.tournament.endTime = now + 24 * 60 * 60 * 1000;
                setTimeout(TournamentSystem.updateCountdown, 1000);
                return;
            }
            
            const hours = Math.floor(timeLeft / (1000 * 60 * 60));
            const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
            
            document.getElementById('countdownDisplay').textContent = 
                `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            
            setTimeout(TournamentSystem.updateCountdown, 1000);
        }
    };
    
    // –ò–ì–†–ê –ó–ú–ï–ô–ö–ê (–ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –≤–µ—Ä—Å–∏—è)
    function launchSnakeGame() {
        if (gameState.snakeGame.active) return;
        
        SoundSystem.play(SoundSystem.sounds.buttonClick);
        const canvas = document.getElementById('snakeGameCanvas');
        const ctx = canvas.getContext('2d');
        canvas.classList.remove('hidden');
        
        const GRID_SIZE = 22;
        const TILE_SIZE = 22;
        let snake = [{x: 11, y: 11}];
        let dx = 1, dy = 0;
        let food = generateFood(snake);
        let score = 0;
        
        gameState.snakeGame.active = true;
        gameState.snakeGame.score = 0;
        
        function gameLoop() {
            // –û—á–∏—Å—Ç–∫–∞
            ctx.fillStyle = 'rgba(10, 20, 50, 0.95)';
            ctx.fillRect(0, 0, 500, 500);
            
            // –ù–æ–≤–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ
            const head = {x: snake[0].x + dx, y: snake[0].y + dy};
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–π
            if (head.x < 0 || head.x >= GRID_SIZE || head.y < 0 || head.y >= GRID_SIZE ||
                snake.some(segment => segment.x === head.x && segment.y === head.y)) {
                
                endSnakeGame(score);
                return;
            }
            
            snake.unshift(head);
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –µ–¥—ã
            if (head.x === food.x && head.y === food.y) {
                score++;
                gameState.snakeGame.score = score;
                food = generateFood(snake);
                SoundSystem.play(SoundSystem.sounds.snakeEat, 0.5, 1 + score * 0.05);
                
                // –¢—É—Ä–Ω–∏—Ä–Ω—ã–π –º–Ω–æ–∂–∏—Ç–µ–ª—å
                const multiplier = gameState.tournament.joined ? 2 : 1;
                LeaderboardManager.saveScore(
                    `snake-${document.getElementById('snakeDifficultySelect').value === '300' ? 'novice' : 
                          document.getElementById('snakeDifficultySelect').value === '200' ? 'pro' : 
                          document.getElementById('snakeDifficultySelect').value === '120' ? 'legend' : 'master'}`, 
                    score, multiplier
                );
            } else {
                snake.pop();
            }
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
            document.getElementById('snakeCurrentScore').textContent = score;
            
            // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –µ–¥—ã (–≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–∞—è)
            const foodGradient = ctx.createRadialGradient(
                food.x * TILE_SIZE + TILE_SIZE/2, food.y * TILE_SIZE + TILE_SIZE/2, 0,
                food.x * TILE_SIZE + TILE_SIZE/2, food.y * TILE_SIZE + TILE_SIZE/2, TILE_SIZE/2
            );
            foodGradient.addColorStop(0, '#ff00ff');
            foodGradient.addColorStop(0.7, '#ff44ff');
            foodGradient.addColorStop(1, 'rgba(255,0,255,0)');
            ctx.fillStyle = foodGradient;
            ctx.beginPath();
            ctx.arc(food.x * TILE_SIZE + TILE_SIZE/2, food.y * TILE_SIZE + TILE_SIZE/2, TILE_SIZE/2, 0, Math.PI * 2);
            ctx.fill();
            
            // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –∑–º–µ–π–∫–∏
            snake.forEach((segment, index) => {
                const segmentGradient = ctx.createRadialGradient(
                    segment.x * TILE_SIZE + TILE_SIZE/2, segment.y * TILE_SIZE + TILE_SIZE/2, 0,
                    segment.x * TILE_SIZE + TILE_SIZE/2, segment.y * TILE_SIZE + TILE_SIZE/2, TILE_SIZE/2 - 2
                );
                
                if (index === 0) { // –ì–æ–ª–æ–≤–∞
                    segmentGradient.addColorStop(0, '#00ff88');
                    segmentGradient.addColorStop(0.5, '#00cc66');
                    segmentGradient.addColorStop(1, '#008844');
                } else {
                    segmentGradient.addColorStop(0, '#44ff88');
                    segmentGradient.addColorStop(0.5, '#22cc66');
                    segmentGradient.addColorStop(1, '#006622');
                }
                
                ctx.fillStyle = segmentGradient;
                ctx.shadowColor = '#00ff88';
                ctx.shadowBlur = 15;
                ctx.fillRect(segment.x * TILE_SIZE + 1, segment.y * TILE_SIZE + 1, TILE_SIZE - 2, TILE_SIZE - 2);
                ctx.shadowBlur = 0;
            });
        }
        
        function generateFood(snake) {
            let food;
            do {
                food = {
                    x: Math.floor(Math.random() * GRID_SIZE),
                    y: Math.floor(Math.random() * GRID_SIZE)
                };
            } while (snake.some(segment => segment.x === food.x && segment.y === food.y));
            return food;
        }
        
        const speed = parseInt(document.getElementById('snakeDifficultySelect').value);
        gameState.snakeGame.interval = setInterval(gameLoop, speed);
        
        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
        document.addEventListener('keydown', snakeControls);
    }
    
    function snakeControls(e) {
        if (!gameState.snakeGame.active) return;
        
        const speed = parseInt(document.getElementById('snakeDifficultySelect').value);
        switch(e.key) {
            case 'ArrowUp': if (dy !== 1) { dx = 0; dy = -1; SoundSystem.play(SoundSystem.sounds.snakeMove); } break;
            case 'ArrowDown': if (dy !== -1) { dx = 0; dy = 1; SoundSystem.play(SoundSystem.sounds.snakeMove); } break;
            case 'ArrowLeft': if (dx !== 1) { dx = -1; dy = 0; SoundSystem.play(SoundSystem.sounds.snakeMove); } break;
            case 'ArrowRight': if (dx !== -1) { dx = 1; dy = 0; SoundSystem.play(SoundSystem.sounds.snakeMove); } break;
        }
    }
    
    function endSnakeGame(finalScore) {
        gameState.snakeGame.active = false;
        clearInterval(gameState.snakeGame.interval);
        SoundSystem.play(SoundSystem.sounds.snakeDie);
        
        const canvas = document.getElementById('snakeGameCanvas');
        canvas.classList.add('hidden');
        
        alert(`üíÄ –ò–ì–†–ê –û–ö–û–ù–ß–ï–ù–ê!\nüìä –í–∞—à —Å—á—ë—Ç: ${finalScore}\nüèÜ –õ–∏—á–Ω—ã–π —Ä–µ–∫–æ—Ä–¥: ${gameState.snakeGame.highScore}`);
    }
    
    function stopSnakeGame() {
        if (gameState.snakeGame.active) {
            endSnakeGame(gameState.snakeGame.score);
        }
    }
    
    // –ò–ì–†–ê –£–ì–ê–î–ê–ô–ö–ê (–ì–∞–ª–∞–∫—Ç–∏—á–µ—Å–∫–∞—è)
    let guessTarget = 0, guessMaxRange = 1000, guessAttemptCount = 0;
    
    function startNewGuessGame() {
        SoundSystem.play(SoundSystem.sounds.buttonClick);
        guessMaxRange = parseInt(document.getElementById('guessDifficultySelect').value);
        guessTarget = Math.floor(Math.random() * guessMaxRange) + 1;
        guessAttemptCount = 0;
        
        document.getElementById('guessAttemptsCount').textContent = '0';
        document.getElementById('currentGuessRange').textContent = `1-${guessMaxRange.toLocaleString()}`;
        document.getElementById('guessFeedbackZone').innerHTML = 'üéØ <strong>–ù–æ–≤–∞—è –≥–∞–ª–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –º–∏—Å—Å–∏—è!</strong><br>–£–≥–∞–¥–∞–π —á–∏—Å–ª–æ –æ—Ç 1 –¥–æ ' + guessMaxRange.toLocaleString();
        document.getElementById('guessNumberInput').value = '';
    }
    
    function makeNumberGuess() {
        SoundSystem.play(SoundSystem.sounds.buttonClick);
        const guess = parseInt(document.getElementById('guessNumberInput').value);
        
        if (!guess || guess < 1 || guess > guessMaxRange) {
            document.getElementById('guessFeedbackZone').innerHTML = 
                `‚ùå <strong>–û—à–∏–±–∫–∞!</strong><br>–ß–∏—Å–ª–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—Ç 1 –¥–æ ${guessMaxRange.toLocaleString()}`;
            SoundSystem.play(SoundSystem.sounds.error);
            return;
        }
        
        guessAttemptCount++;
        document.getElementById('guessAttemptsCount').textContent = guessAttemptCount;
        const difference = Math.abs(guessTarget - guess);
        
        if (guess === guessTarget) {
            const score = Math.max(0, 10000 - guessAttemptCount * 50);
            const category = guessMaxRange === 100 ? 'guess-easy' : 
                           guessMaxRange === 1000 ? 'guess-normal' : 
                           guessMaxRange === 10000 ? 'guess-hard' : 'guess-extreme';
            
            const multiplier = gameState.tournament.joined ? 2 : 1;
            LeaderboardManager.saveScore(category, score, multiplier);
            
            document.getElementById('guessFeedbackZone').innerHTML = 
                `üéâ <strong>–õ–ï–ì–ï–ù–î–ê–†–ù–ê–Ø –ü–û–ë–ï–î–ê!</strong><br>` +
                `–ó–∞ ${guessAttemptCount} –ø–æ–ø—ã—Ç–æ–∫! ‚≠ê ${score.toLocaleString()} –æ—á–∫–æ–≤`;
            SoundSystem.play(SoundSystem.sounds.guessCorrect);
            
            setTimeout(startNewGuessGame, 3000);
        } else {
            let feedback = '';
            if (difference <= 2) {
                feedback = guess < guessTarget ? 
                    'üî• <strong>–°–í–ï–†–•–ì–û–†–Ø–ß–û!</strong> ‚ûï‚ûï‚ûï' : 
                    'üî• <strong>–°–í–ï–†–•–ì–û–†–Ø–ß–û!</strong> ‚ûñ‚ûñ‚ûñ';
                SoundSystem.play(SoundSystem.sounds.guessHot);
            } else if (difference <= 8) {
                feedback = guess < guessTarget ? 
                    'üå°Ô∏è <strong>–û–ß–ï–ù–¨ –±–ª–∏–∑–∫–æ!</strong> ‚ûï‚ûï' : 
                    'üå°Ô∏è <strong>–û–ß–ï–ù–¨ –±–ª–∏–∑–∫–æ!</strong> ‚ûñ‚ûñ';
                SoundSystem.play(SoundSystem.sounds.guessClose);
            } else if (difference <= 25) {
                feedback = guess < guessTarget ? 'üìà –ë–ª–∏–∑–∫–æ! ‚ûï' : 'üìâ –ë–ª–∏–∑–∫–æ! ‚ûñ';
            } else {
                const percentage = Math.round((Math.min(guess, guessTarget) / Math.max(guess, guessTarget)) * 100);
                feedback = guess < guessTarget ? 
                    `üìà –ë–æ–ª—å—à–µ (~${percentage}%)` : `üìâ –ú–µ–Ω—å—à–µ (~${percentage}%)`;
            }
            
            document.getElementById('guessFeedbackZone').innerHTML = feedback;
        }
        
        document.getElementById('guessNumberInput').value = '';
    }
    
    // –¢—É—Ä–Ω–∏—Ä–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
    function joinTournament() {
        SoundSystem.play(SoundSystem.sounds.tournamentJoin);
        TournamentSystem.join();
    }
    
    function leaveTournament() {
        SoundSystem.play(SoundSystem.sounds.buttonClick);
        TournamentSystem.leave();
    }
    
    // –ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
    function updateGameState() {
        LeaderboardManager.updateGlobalDisplay();
        LeaderboardManager.updateTournamentDisplay();
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –≥–ª–æ–±–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ—Ä–¥—ã
        ['snake-pro', 'guess-normal'].forEach(cat => {
            const topScore = LeaderboardManager.getTop(cat, 1)[0];
            if (topScore) {
                if (cat.includes('snake')) {
                    document.getElementById('snakeGlobalBest').textContent = topScore.score;
                } else {
                    document.getElementById('guessPersonalBest').textContent = topScore.score;
                }
            }
        });
    }
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
    window.addEventListener('load', function() {
        initAudioSystem();
        SoundSystem.init();
        createParticleSystem();
        createStarsBackground();
        TournamentSystem.updateCountdown();
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–≤—Ç–æ–ª–æ–≥–∏–Ω
        const savedUser = localStorage.getItem('currentUser');
        if (savedUser && UserManager.users[savedUser]) {
            gameState.currentUser = savedUser;
            gameState.isAuthenticated = true;
            document.getElementById('authPanel').classList.add('hidden');
            document.getElementById('gamesPanel').classList.remove('hidden');
            document.getElementById('currentUserDisplay').textContent = savedUser;
            document.getElementById('logoutButton').classList.remove('hidden');
        }
        
        // –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥
        setInterval(updateGameState, 10000);
        updateGameState();
        
        // –ó–∞–ø—É—Å–∫–∞–µ–º –ø–µ—Ä–≤—É—é —É–≥–∞–¥–∞–π–∫—É
        startNewGuessGame();
        
        console.log('üöÄ ALEKSIN GAMING UNIVERSE v2.0 –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–≥—Ä—É–∂–µ–Ω!');
        console.log('‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è/–ª–æ–≥–∏–Ω, —Ç—É—Ä–Ω–∏—Ä—ã, —Ç–æ–ø-10, –∑–≤—É–∫–∏, –∞–Ω–∏–º–∞—Ü–∏–∏ - –í–°–Å –†–ê–ë–û–¢–ê–ï–¢!');
    });
    
    </script>
</body>
</html>
