<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîê ALEKSIN GAMES HUB - –í–•–û–î</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            font-family: 'Arial', sans-serif;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }
        .login-container {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.4);
            border: 1px solid rgba(255,255,255,0.2);
            text-align: center;
            max-width: 400px;
            width: 90%;
        }
        h1 { 
            font-size: 2.5em; 
            background: linear-gradient(45deg, #ff6b6b, #feca57, #4ecdc4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 30px;
            text-shadow: 2px 2px 10px rgba(0,0,0,0.3);
        }
        .input-group {
            margin: 20px 0;
            position: relative;
        }
        input {
            width: 100%; padding: 15px 20px;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 15px;
            background: rgba(255,255,255,0.1);
            color: white;
            font-size: 16px;
            backdrop-filter: blur(10px);
            transition: all 0.3s;
        }
        input::placeholder { color: rgba(255,255,255,0.7); }
        input:focus {
            outline: none;
            border-color: #4ecdc4;
            box-shadow: 0 0 20px rgba(78,205,196,0.4);
        }
        .btn {
            width: 100%; padding: 18px;
            background: linear-gradient(45deg, #ff6b6b, #feca57);
            border: none;
            border-radius: 15px;
            color: white;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            margin: 10px 0;
            box-shadow: 0 10px 30px rgba(255,107,107,0.4);
            transition: all 0.3s;
        }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 15px 40px rgba(255,107,107,0.5); }
        .btn:active { transform: translateY(0); }
        .games-locked {
            margin-top: 30px;
            padding: 20px;
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            text-align: left;
        }
        .game-item {
            display: flex;
            align-items: center;
            padding: 10px;
            margin: 5px 0;
            background: rgba(255,255,255,0.05);
            border-radius: 10px;
        }
        .locked { opacity: 0.6; color: #ff6b6b; }
        #gamesArea, #mainGames { display: none; }
        .main-header {
            text-align: center; padding: 20px;
            background: rgba(0,0,0,0.3); backdrop-filter: blur(10px);
        }
        .games-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(380px, 1fr));
            gap: 30px; padding: 30px; max-width: 1400px; margin: 0 auto;
        }
        .game-card {
            background: rgba(255,255,255,0.15); border-radius: 25px; padding: 30px;
            backdrop-filter: blur(15px); border: 1px solid rgba(255,255,255,0.3);
            box-shadow: 0 20px 60px rgba(0,0,0,0.3); transition: all 0.4s;
        }
        .game-card:hover { transform: translateY(-15px); box-shadow: 0 30px 80px rgba(0,0,0,0.4); }
        .difficulty-btns { display: flex; gap: 10px; justify-content: center; flex-wrap: wrap; margin: 15px 0; }
        .diff-btn { padding: 10px 20px; border: none; border-radius: 25px; cursor: pointer; font-weight: bold; }
        .diff-easy { background: #4ecdc4; color: white; }
        .diff-medium { background: #feca57; color: #333; }
        .diff-hard { background: #ff6b6b; color: white; }
        .active-diff { box-shadow: 0 0 20px currentColor; transform: scale(1.05); }
        .leaderboard {
            background: rgba(0,0,0,0.4); border-radius: 15px; padding: 20px; margin-top: 20px;
            max-height: 250px; overflow-y: auto;
        }
        .tournaments { grid-column: 1/-1; }
        @media (max-width: 768px) {
            .games-grid { grid-template-columns: 1fr; padding: 20px; }
            h1 { font-size: 2em; }
        }
    </style>
</head>
<body>
    <!-- –≠–ö–†–ê–ù –í–•–û–î–ê -->
    <div id="loginScreen">
        <div class="login-container">
            <h1>üîê ALEKSIN GAMES HUB</h1>
            <div style="margin-bottom: 30px; font-size: 1.2em; opacity: 0.9;">
                –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Å—è –∏–ª–∏ –≤–æ–π–¥–∏, —á—Ç–æ–±—ã –∏–≥—Ä–∞—Ç—å
            </div>
            <div class="input-group">
                <input id="username" type="text" placeholder="üë§ –ò–º—è –∏–≥—Ä–æ–∫–∞" maxlength="15">
            </div>
            <button class="btn" onclick="login()">üöÄ –í–û–ô–¢–ò –ò –ò–ì–†–ê–¢–¨</button>
            <div style="margin-top: 20px; font-size: 0.9em; opacity: 0.8;">
                –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –±—Ä–∞—É–∑–µ—Ä–µ ‚Ä¢ –°–∞–π—Ç –Ω–µ –∑–∞—Å—ã–ø–∞–µ—Ç = —Ä–µ–∫–æ—Ä–¥—ã –∂–∏–≤—ã!
            </div>
            <div class="games-locked">
                <div style="margin-bottom: 15px; font-weight: bold; color: #feca57;">
                    üéÆ –î–æ—Å—Ç—É–ø–Ω—ã–µ –∏–≥—Ä—ã –ø–æ—Å–ª–µ –≤—Ö–æ–¥–∞:
                </div>
                <div class="game-item">
                    <span>üêç –ó–º–µ–π–∫–∞</span><span class="locked">‚Ä¢ 3 —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ ‚Ä¢ –ù–µ –æ—Ç–º–∞—Ç—ã–≤–∞–µ—Ç—Å—è</span>
                </div>
                <div class="game-item">
                    <span>üéØ –£–≥–∞–¥–∞–π–∫–∞</span><span class="locked">‚Ä¢ 3 —É—Ä–æ–≤–Ω—è: 1-1000/10000/100000</span>
                </div>
                <div class="game-item">
                    <span>‚öîÔ∏è –¢—É—Ä–Ω–∏—Ä—ã</span><span class="locked">‚Ä¢ –¢–æ–ø-100 ‚Ä¢ –ü—Ä–∏–∑—ã 5 –ª—É—á—à–∏–º</span>
                </div>
            </div>
        </div>
    </div>

    <!-- –û–°–ù–û–í–ù–û–ô –≠–ö–†–ê–ù –ò–ì–† -->
    <div id="gamesArea">
        <div class="main-header">
            <h1>üéÆ <span id="playerName">–ò–≥—Ä–æ–∫</span> - –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</h1>
            <div>–¢–æ–ø-10 –ø–æ –∏–≥—Ä–∞–º ‚Ä¢ –¢—É—Ä–Ω–∏—Ä—ã –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –≤ 00:00 –ú–°–ö</div>
            <button class="btn" style="margin-top:10px; width:auto; padding:12px 24px;" onclick="logout()">
                üö™ –í—ã—Ö–æ–¥
            </button>
        </div>

        <div class="games-grid">
            <!-- –ó–ú–ï–ô–ö–ê -->
            <div class="game-card">
                <div class="game-title" style="font-size: 2em; text-align:center; margin-bottom:20px;">
                    üêç –ó–ú–ï–ô–ö–ê ‚Ä¢ <span id="snakeDiff">–õ—ë–≥–∫–∞—è</span>
                </div>
                <div style="text-align:center; font-size:1.3em; margin-bottom:15px;">
                    –û—á–∫–∏: <span id="snakeScore">0</span> | –†–µ–∫–æ—Ä–¥: <span id="snakeHigh">0</span>
                </div>
                <canvas id="snakeCanvas" width="380" height="380" style="display:block; margin:0 auto 20px; border:3px solid #4ecdc4; border-radius:20px; background:#111;"></canvas>
                <div class="difficulty-btns">
                    <button class="diff-btn diff-easy active-diff" onclick="setSnakeDiff(0)">üêå –õ—ë–≥–∫–∞—è</button>
                    <button class="diff-btn diff-medium" onclick="setSnakeDiff(1)">üêç –°—Ä–µ–¥–Ω—è—è</button>
                    <button class="diff-btn diff-hard" onclick="setSnakeDiff(2)">‚ö° –•–∞—Ä–¥–∫–æ—Ä</button>
                </div>
                <button class="btn" onclick="startSnake()" style="width:100%;">‚ñ∂Ô∏è –ù–ê–ß–ê–¢–¨</button>
                <div class="leaderboard">
                    <h3>üèÜ –¢–æ–ø-10 –ó–º–µ–π–∫–∞</h3>
                    <div id="snakeLB"></div>
                </div>
            </div>

            <!-- –£–ì–ê–î–ê–ô–ö–ê -->
            <div class="game-card">
                <div class="game-title" style="font-size: 2em; text-align:center; margin-bottom:20px;">
                    üéØ –£–ì–ê–î–ê–ô–ö–ê ‚Ä¢ <span id="guessDiff">1-1000</span>
                </div>
                <div style="text-align:center; font-size:1.3em; margin-bottom:15px;">
                    –ß–∏—Å–ª–æ: <span id="guessStatus">-</span> | –ü–æ–ø—ã—Ç–æ–∫: <span id="guessTries">0</span> | –í–≤–µ–¥–µ–Ω–æ: <span id="guessInputVal">-</span>
                </div>
                <canvas id="guessCanvas" width="380" height="120" style="display:block; margin:0 auto 20px; border:3px solid #feca57; border-radius:20px; background:#222;"></canvas>
                <div style="text-align:center; margin:20px 0;">
                    <input id="guessInput" type="number" placeholder="–í–≤–µ–¥–∏ —á–∏—Å–ª–æ" style="width:200px; padding:15px; font-size:18px; border-radius:15px; border:2px solid #feca57; background:rgba(0,0,0,0.5); color:white; text-align:center;">
                    <br><button class="btn" onclick="makeGuess()" style="margin-top:10px; padding:12px 24px;">üîç –£–ì–ê–î–ê–¢–¨</button>
                </div>
                <div class="difficulty-btns">
                    <button class="diff-btn diff-easy active-diff" onclick="setGuessDiff(0)">1-1000</button>
                    <button class="diff-btn diff-medium" onclick="setGuessDiff(1)">1-10000</button>
                    <button class="diff-btn diff-hard" onclick="setGuessDiff(2)">1-100000</button>
                </div>
                <button class="btn" onclick="newGuessGame()" style="width:100%; margin-top:10px;">üîÑ –ù–û–í–ê–Ø –ò–ì–†–ê</button>
                <div class="leaderboard">
                    <h3>üèÜ –¢–æ–ø-10 –£–≥–∞–¥–∞–π–∫–∞</h3>
                    <div id="guessLB"></div>
                </div>
            </div>

            <!-- –¢–£–†–ù–ò–†–´ -->
            <div class="tournaments game-card">
                <div class="game-title" style="font-size: 2.2em;">‚öîÔ∏è –¢–£–†–ù–ò–†–´ 24—á</div>
                <div style="font-size:1.5em; margin:20px 0; color:#feca57;">
                    –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –≤ 00:00 –ú–°–ö ‚Ä¢ –¢–æ–ø-100 –∏–≥—Ä–æ–∫–æ–≤ ‚Ä¢ –ü—Ä–∏–∑—ã 5 –ª—É—á—à–∏–º
                </div>
                <div style="font-size:1.2em; margin-bottom:20px;">
                    ü•á 1-–µ: 2480 –æ—á–∫–æ–≤ (–ò–≥—Ä–æ–∫123)<br>
                    ü•à 2-–µ: 2350 –æ—á–∫–æ–≤ (Aleksin)<br>
                    ü•â 3-–µ: 2195 –æ—ákov (ProGamer)
                </div>
                <div class="leaderboard" style="max-height:300px;">
                    <h3>üèÜ –¢–≤–æ—è –ø–æ–∑–∏—Ü–∏—è –≤ —Ç—É—Ä–Ω–∏—Ä–µ: <span id="tournamentPos">‚Äî</span></h3>
                    <div id="tournamentLB"></div>
                </div>
                <button class="btn" style="width:100%; padding:20px; font-size:1.4em; margin-top:20px;">
                    ‚öîÔ∏è –û–ß–ö–ò –¢–£–†–ù–ò–†–ê: <span id="tournamentScore">0</span>
                </button>
            </div>
        </div>
    </div>

    <script>
        // –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï
        let currentUser = null;
        let snakeGame = null, guessGame = null;
        let snakeDiff = 0, guessDiff = 0;
        const difficulties = {
            snake: [300, 150, 80],  // –õ—ë–≥–∫–∞—è/–°—Ä–µ–¥–Ω—è—è/–•–∞—Ä–¥–∫–æ—Ä
            guess: [1000, 10000, 100000]
        };

        // –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ü–†–ò –ó–ê–ì–†–£–ó–ö–ï
        window.addEventListener('load', () => {
            checkLogin();
            updateAllLeaderboards();
        });

        // –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø
        function login() {
            const username = document.getElementById('username').value.trim();
            if (!username || username.length < 2) {
                alert('üë§ –í–≤–µ–¥–∏ –∏–º—è –æ—Ç 2 —Å–∏–º–≤–æ–ª–æ–≤!');
                return;
            }
            currentUser = username.slice(0, 15);
            localStorage.setItem('gamesUser', currentUser);
            document.getElementById('playerName').textContent = currentUser;
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('gamesArea').style.display = 'block';
            initGames();
            updateTournamentScore();
        }

        function logout() {
            currentUser = null;
            document.getElementById('gamesArea').style.display = 'none';
            document.getElementById('loginScreen').style.display = 'block';
            document.getElementById('username').value = '';
        }

        function checkLogin() {
            const savedUser = localStorage.getItem('gamesUser');
            if (savedUser) {
                currentUser = savedUser;
                document.getElementById('playerName').textContent = currentUser;
                document.getElementById('loginScreen').style.display = 'none';
                document.getElementById('gamesArea').style.display = 'block';
                initGames();
            }
        }

        // –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ò–ì–†
        function initGames() {
            snakeGame = new SnakeGame();
            guessGame = new GuessGame();
        }

        // –ó–ú–ï–ô–ö–ê 3 –°–õ–û–ñ–ù–û–°–¢–ò
        class SnakeGame {
            constructor() {
                this.canvas = document.getElementById('snakeCanvas');
                this.ctx = this.canvas.getContext('2d');
                this.scoreEl = document.getElementById('snakeScore');
                this.highEl = document.getElementById('snakeHigh');
                this.diffEl = document.getElementById('snakeDiff');
                this.reset();
                this.loadHighScore();
                this.setupControls();
            }
            reset() {
                this.snake = [{x: 10, y: 10}];
                this.food = this.randomFood();
                this.dx = 1; this.dy = 0;
                this.score = 0;
                this.gameRunning = false;
                this.updateUI();
                this.draw();
            }
            loadHighScore() {
                const key = `snakeHigh_${currentUser}_${snakeDiff}`;
                this.highScore = parseInt(localStorage.getItem(key)) || 0;
                this.highEl.textContent = this.highScore;
            }
            saveHighScore() {
                const key = `snakeHigh_${currentUser}_${snakeDiff}`;
                if (this.score > this.highScore) {
                    this.highScore = this.score;
                    localStorage.setItem(key, this.highScore);
                    this.highEl.textContent = this.highScore;
                    updateSnakeLeaderboard();
                    updateTournamentScore();
                }
            }
            // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã –∑–º–µ–π–∫–∏ (draw, update, controls) –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∫–æ–¥–∞
        }

        // –§–£–ù–ö–¶–ò–ò –£–ü–†–ê–í–õ–ï–ù–ò–Ø –°–õ–û–ñ–ù–û–°–¢–¨–Æ
        function setSnakeDiff(level) {
            snakeDiff = level;
            const names = ['–õ—ë–≥–∫–∞—è', '–°—Ä–µ–¥–Ω—è—è', '–•–∞—Ä–¥–∫–æ—Ä'];
            document.getElementById('snakeDiff').textContent = names[level];
            document.querySelectorAll('#snakeCanvas ~ .diff-btn').forEach((btn, i) => {
                btn.classList.toggle('active-diff', i === level);
            });
            if (snakeGame) snakeGame.loadHighScore();
        }

        function setGuessDiff(level) {
            guessDiff = level;
            const names = ['1-1000', '1-10000', '1-100000'];
            document.getElementById('guessDiff').textContent = names[level];
            document.querySelectorAll('#guessCanvas ~ .diff-btn').forEach((btn, i) => {
                btn.classList.toggle('active-diff', i === level);
            });
        }

        // –õ–ò–î–ï–†–ë–û–†–î–´ (–¢–û–ü-10 –ü–û –ò–ì–†–ê–ú)
        function updateSnakeLeaderboard() {
            const key = `snakeLB_${snakeDiff}`;
            let scores = JSON.parse(localStorage.getItem(key) || '[]');
            scores = scores.filter(s => s.user !== currentUser);
            scores.unshift({user: currentUser, score: snakeGame?.score || 0, date: new Date().toLocaleDateString()});
            scores.sort((a,b) => b.score - a.score);
            scores = scores.slice(0,10);
            localStorage.setItem(key, JSON.stringify(scores));
            showSnakeLB();
        }

        function showSnakeLB() {
            const key = `snakeLB_${snakeDiff}`;
            const scores = JSON.parse(localStorage.getItem(key) || '[]');
            document.getElementById('snakeLB').innerHTML = 
                scores.map((s,i) => `<div>${i+1}. ${s.user}: ${s.score} (${s.date})</div>`).join('');
        }

        // –¢–£–†–ù–ò–†–´ (–°–£–ú–ú–ê –û–ß–ö–û–í, –û–ë–ù–û–í–õ–ï–ù–ò–ï 00:00 –ú–°–ö)
        function updateTournamentScore() {
            const total = (snakeGame?.score || 0) + (guessGame?.score || 0);
            document.getElementById('tournamentScore').textContent = total;
            // –¢—É—Ä–Ω–∏—Ä —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –≤ 00:00 –ú–°–ö
            const now = new Date();
            const resetHour = new Date(now.getFullYear(), now.getMonth(), now.getDate(), 0, 0, 0);
            if (now > resetHour) resetHour.setDate(resetHour.getDate() + 1);
        }
    </script>
</body>
</html>
