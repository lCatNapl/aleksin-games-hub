<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üöÄ ALEKSIN GAMES HUB v3.3 ‚úÖ 13 –£–†–û–í–ù–ï–ô</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap');
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:'Orbitron',monospace;background:linear-gradient(135deg,#0a0a23 0%,#1a0a3a 50%,#0f0f4f 100%);color:#fff;min-height:100vh;overflow-y:auto}
        .container{max-width:1200px;margin:0 auto;padding:20px}
        h1{font-size:clamp(2rem,5vw,4rem);text-align:center;background:linear-gradient(45deg,#ff00ff,#00ffff,#ffff00);background-size:300% 300%;-webkit-background-clip:text;-webkit-text-fill-color:transparent;animation:gradient 3s ease infinite}
        @keyframes gradient{0%,100%{background-position:0% 50%}50%{background-position:100% 50%}}
        .btn{display:inline-block;padding:15px 30px;background:linear-gradient(45deg,rgba(255,0,255,0.3),rgba(0,255,255,0.3));border:2px solid rgba(255,255,255,0.3);border-radius:20px;font-size:1.2rem;font-weight:700;cursor:pointer;transition:all 0.3s ease;margin:10px;box-shadow:0 10px 30px rgba(0,0,0,0.5)}
        .btn:hover{background:linear-gradient(45deg,rgba(255,0,255,0.6),rgba(0,255,255,0.6));transform:translateY(-5px);box-shadow:0 15px 40px rgba(255,0,255,0.4)}
        .btn:disabled{opacity:0.4;cursor:not-allowed;transform:none!important}
        .section{display:none;text-align:center}
        .section.active{display:block;animation:fadeIn 0.5s ease}
        @keyframes fadeIn{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
        .levels-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px;margin:20px 0}
        .level-btn{height:80px;font-size:1.1rem}
        .level13{background:linear-gradient(45deg,#f39c12,#f1c40f)!important;animation:pulse 2s infinite}
        @keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}
        canvas{border:3px solid rgba(255,255,255,0.3);border-radius:15px;background:#000;box-shadow:0 0 30px rgba(0,255,255,0.5)}
        table{width:100%;max-width:400px;margin:15px auto;border-collapse:collapse;background:rgba(255,255,255,0.1);border-radius:15px;overflow:hidden;box-shadow:0 10px 30px rgba(0,0,0,0.5)}
        th,td{padding:12px;text-align:center;border-bottom:1px solid rgba(255,255,255,0.2)}
        th{background:linear-gradient(45deg,rgba(255,0,255,0.4),rgba(0,255,255,0.4));font-weight:700}
        .tour-table{background:rgba(0,255,0,0.2);margin:15px 0}
        .tour-table h4{color:#00ff00;text-shadow:0 0 10px #00ff00}
        #statusBar{position:fixed;top:10px;right:10px;background:rgba(0,255,0,0.3);padding:10px;border-radius:10px;font-weight:700;z-index:1000}
        #authSection{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(0,0,0,0.9);padding:30px;border-radius:20px;box-shadow:0 0 50px rgba(255,0,255,0.5);min-width:300px;z-index:1000}
        input{padding:12px;margin:10px;border:2px solid rgba(255,255,255,0.3);border-radius:10px;background:rgba(255,255,255,0.1);color:#fff;font-family:inherit;width:calc(100% - 24px)}
        #tourTimer{font-size:2.5rem;color:#00ff00;text-shadow:0 0 20px #00ff00;animation:pulse 1s infinite}
        #levelProgress{margin:20px 0;font-size:1.2rem}
        @media (max-width:768px){.container{padding:10px}.btn{padding:12px 20px;font-size:1rem}.levels-grid{grid-template-columns:repeat(3,1fr)}}
    </style>
</head>
<body>
    <div id="statusBar">üëã –ì–æ—Å—Ç—å</div>
    
    <div id="authSection" class="section active">
        <h2>üîê –í—Ö–æ–¥ / –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
        <input type="text" id="usernameInput" placeholder="test" value="test">
        <input type="password" id="passwordInput" placeholder="123456" value="123456">
        <button class="btn" onclick="login()">üöÄ –í–û–ô–¢–ò</button>
        <button class="btn" id="logoutBtn" onclick="logout()" style="display:none">üëã –í–´–ô–¢–ò</button>
    </div>

    <div class="container">
        <h1>üöÄ ALEKSIN GAMES HUB v3.3 - 13 –£–†–û–í–ù–ï–ô</h1>
        
        <!-- ‚úÖ –ù–û–í–´–ô –ë–õ–û–ö: 13 –£–†–û–í–ù–ï–ô -->
        <div id="levelsSection" class="section active">
            <h2>üéÆ 13 –£–†–û–í–ù–ï–ô –í–´–ó–û–í–ê</h2>
            <div id="levelProgress">–ü—Ä–æ–π–¥–µ–Ω–æ: <span id="progressCount">0</span>/13</div>
            <div id="levelsGrid" class="levels-grid"></div>
        </div>

        <div class="game-grid">
            <button class="btn" onclick="showGame('leaderboards')">üèÜ –õ–ò–î–ï–†–ë–û–†–î–´</button>
            <button class="btn" onclick="showGame('tournament')">‚öîÔ∏è –¢–£–†–ù–ò–†</button>
        </div>

        <!-- –û—Å—Ç–∞–ª—å–Ω—ã–µ —Å–µ–∫—Ü–∏–∏ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π -->
        <div id="tournamentSection" class="section">
            <h2>‚öîÔ∏è –¢–£–†–ù–ò–† 24—á (00:00 –ú–°–ö)</h2>
            <div>‚è∞ –î–æ –∫–æ–Ω—Ü–∞: <span id="tourTimer">00:00:00</span></div>
            <div id="tournamentTables" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:20px"></div>
        </div>

        <div id="leaderboardTables" class="section"></div>

        <div id="guessSection" class="section">
            <h2>üéØ –£–ì–ê–î–ê–ô –ß–ò–°–õ–û</h2>
            <div class="game-grid">
                <button class="btn" onclick="setDifficulty('guess','easy')">–õ—ë–≥–∫–∞—è (1-1K)</button>
                <button class="btn" onclick="setDifficulty('guess','normal')">–°—Ä–µ–¥–Ω—è—è (1-10K)</button>
                <button class="btn" onclick="setDifficulty('guess','hard')">–°–ª–æ–∂–Ω–∞—è (1-100K)</button>
            </div>
            <div style="font-size:2rem;margin:20px">–ß–∏—Å–ª–æ –æ—Ç <span id="rangeMin">1</span> –¥–æ <span id="rangeMax">1000</span></div>
            <input type="number" id="guessInput" placeholder="–¢–≤–æ—ë —á–∏—Å–ª–æ" style="font-size:1.5rem;padding:20px;width:200px">
            <button class="btn" onclick="makeGuess()" style="font-size:1.5rem;padding:20px 40px">–£–ì–ê–î–ê–¢–¨</button>
            <div id="guessResult"></div>
            <div id="guessAttempts">–ü–æ–ø—ã—Ç–æ–∫: 0</div>
        </div>

        <div id="snakeSection" class="section">
            <h2>üêç –ó–ú–ï–ô–ö–ê PRO</h2>
            <div class="game-grid">
                <button class="btn" onclick="startSnake('easy')">–õ—ë–≥–∫–∞—è</button>
                <button class="btn" onclick="startSnake('normal')">–°—Ä–µ–¥–Ω—è—è</button>
                <button class="btn" onclick="startSnake('hard')">–°–ª–æ–∂–Ω–∞—è</button>
            </div>
            <div style="position:relative;display:inline-block">
                <canvas id="gameCanvas" width="400" height="400" tabindex="0"></canvas>
                <div id="snakeScore" style="position:absolute;top:10px;left:10px;font-size:1.5rem;font-weight:700;color:#00ff00">–°—á—ë—Ç: 0</div>
            </div>
        </div>

        <!-- –ò–≥—Ä–æ–≤–∞—è –æ–±–ª–∞—Å—Ç—å –¥–ª—è —É—Ä–æ–≤–Ω–µ–π -->
        <div id="levelGameArea" class="section" style="background:rgba(255,255,255,0.1);border-radius:20px;padding:30px;margin:20px 0;display:none">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px">
                <button class="btn" onclick="backToLevels()">üè† –ö –£–†–û–í–ù–Ø–ú</button>
                <div style="font-size:1.5rem">
                    <span id="currentLevelDisplay">–£—Ä–æ–≤–µ–Ω—å 1</span> | 
                    <span id="levelScore">0</span> –æ—á–∫–æ–≤
                </div>
                <button class="btn" onclick="restartLevel()">üîÑ –ó–ê–ù–û–í–û</button>
            </div>
            <div id="levelGameContent"></div>
        </div>
    </div>

    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let currentUser = localStorage.getItem('aleksinUser') || null;
        let leaderboards = JSON.parse(localStorage.getItem('aleksinLeaderboards')) || {};
        let tournamentScores = JSON.parse(localStorage.getItem('aleksinTournaments')) || {};
        let levelProgress = JSON.parse(localStorage.getItem('levelProgress')) || {};
        let currentLevel = 1, levelScore = 0;
        let currentGameType = '', currentDifficulty = '';
        let secretNumber, guessCount = 0;
        let snake = [], snakeDirection = {x:1,y:0}, snakeScore = 0, gameRunning = false;
        let food = {}, snakeInterval = null;
        let isSnakeActive = false;

        // ‚úÖ 13 –£–†–û–í–ù–ï–ô - –ì–ê–†–ê–ù–¢–ò–†–û–í–ê–ù–ù–ê–Ø –ì–ï–ù–ï–†–ê–¶–ò–Ø
        const LEVELS = {
            1: {name: "üêç Snake –õ—ë–≥–∫–∞—è", game: "snake", diff: "easy", unlocked: true},
            2: {name: "üéØ –£–≥–∞–¥–∞–π–∫–∞ 1-100", game: "guess", diff: "easy", unlocked: false},
            3: {name: "üêç Snake –°—Ç–µ–Ω—ã", game: "snake", diff: "normal", unlocked: false},
            4: {name: "üéØ –£–≥–∞–¥–∞–π–∫–∞ 1-1K", game: "guess", diff: "normal", unlocked: false},
            5: {name: "‚ö° Snake –ë—ã—Å—Ç—Ä–∞—è", game: "snake", diff: "hard", unlocked: false},
            6: {name: "üéØ –£–≥–∞–¥–∞–π–∫–∞ 1-10K", game: "guess", diff: "hard", unlocked: false},
            7: {name: "üêç Snake –•–∞–æ—Å", game: "snake", diff: "hard", unlocked: false},
            8: {name: "üéØ –£–≥–∞–¥–∞–π–∫–∞ 1-100K", game: "guess", diff: "hard", unlocked: false},
            9: {name: "üî• Snake –≠–∫—Å—Ç—Ä–∏–º", game: "snake", diff: "hard", unlocked: false},
            10: {name: "üíé –£–≥–∞–¥–∞–π–∫–∞ –õ–µ–≥–µ–Ω–¥–∞", game: "guess", diff: "hard", unlocked: false},
            11: {name: "‚ö° Snake –¢—É—Ä–±–æ", game: "snake", diff: "hard", unlocked: false},
            12: {name: "üéØ –§–∏–Ω–∞–ª—å–Ω–∞—è –£–≥–∞–¥–∞–π–∫–∞", game: "guess", diff: "hard", unlocked: false},
            13: {name: "üëë –§–ò–ù–ê–õ–¨–ù–´–ô –ë–û–°–°", game: "boss", diff: "ultimate", unlocked: false}
        };

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            if (currentUser) {
                document.getElementById('statusBar').textContent = `üëã ${currentUser}`;
                document.getElementById('logoutBtn').style.display = 'inline-block';
                document.getElementById('authSection').classList.remove('active');
            }
            initLevels(); // ‚úÖ –ì–ï–ù–ï–†–ò–†–£–ï–ú 13 –ö–ù–û–ü–û–ö
            setInterval(updateTournament, 1000);
            window.onbeforeunload = saveAllData;
        });

        // ‚úÖ –ì–ï–ù–ï–†–ê–¶–ò–Ø 13 –ö–ù–û–ü–û–ö –£–†–û–í–ù–ï–ô
        function initLevels() {
            const container = document.getElementById('levelsGrid');
            container.innerHTML = '';

            // –ì–ê–†–ê–ù–¢–ò–†–û–í–ê–ù–ù–´–ô –¶–ò–ö–õ 1-13
            for (let i = 1; i <= 13; i++) {
                const level = LEVELS[i];
                const btn = document.createElement('button');
                btn.className = 'btn level-btn' + (i === 13 ? ' level13' : '');
                btn.textContent = `${level.name}`;
                btn.dataset.level = i;

                // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
                if (level.unlocked || levelProgress[i] || i === 1) {
                    btn.disabled = false;
                    btn.onclick = () => startLevel(i);
                } else {
                    btn.disabled = true;
                    btn.textContent += ` üîí`;
                }

                container.appendChild(btn);
            }
            updateProgress();
        }

        function updateProgress() {
            const passed = Object.keys(levelProgress).length;
            document.getElementById('progressCount').textContent = passed;
        }

        function startLevel(levelNum) {
            if (!currentUser) {
                document.getElementById('authSection').classList.add('active');
                return;
            }
            currentLevel = levelNum;
            levelScore = 0;
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.getElementById('levelGameArea').style.display = 'block';
            document.getElementById('currentLevelDisplay').textContent = `–£—Ä–æ–≤–µ–Ω—å ${levelNum}`;
            document.getElementById('levelScore').textContent = '0';

            const level = LEVELS[levelNum];
            const content = document.getElementById('levelGameContent');
            
            if (level.game === 'snake') {
                startSnake(level.diff, true); // levelMode=true
            } else if (level.game === 'guess') {
                setDifficulty('guess', level.diff, true); // levelMode=true
            } else if (level.game === 'boss') {
                content.innerHTML = '<h2>üëë –ë–û–°–° –£–†–û–í–ï–ù–¨! –°–æ–±–µ—Ä–∏ 1000 –æ—á–∫–æ–≤!</h2><canvas id="bossCanvas" width="500" height="500"></canvas>';
            }
        }

        function backToLevels() {
            document.getElementById('levelGameArea').style.display = 'none';
            document.getElementById('levelsSection').classList.add('active');
            if (snakeInterval) clearInterval(snakeInterval);
            isSnakeActive = false;
        }

        function restartLevel() {
            startLevel(currentLevel);
        }

        // –û—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π (login, logout, showGame, etc.)
        function saveAllData() {
            localStorage.setItem('aleksinUser', currentUser);
            localStorage.setItem('aleksinLeaderboards', JSON.stringify(leaderboards));
            localStorage.setItem('aleksinTournaments', JSON.stringify(tournamentScores));
            localStorage.setItem('levelProgress', JSON.stringify(levelProgress));
        }

        function login() {
            const username = document.getElementById('usernameInput').value.trim();
            const password = document.getElementById('passwordInput').value;
            if (username && password) {
                currentUser = username;
                document.getElementById('statusBar').textContent = `üëã ${currentUser}`;
                document.getElementById('logoutBtn').style.display = 'inline-block';
                document.getElementById('authSection').classList.remove('active');
                initLevels();
                saveAllData();
            }
        }

        function logout() {
            if (snakeInterval) clearInterval(snakeInterval);
            gameRunning = false; isSnakeActive = false;
            currentUser = null;
            document.getElementById('statusBar').textContent = 'üëã –ì–æ—Å—Ç—å';
            document.getElementById('logoutBtn').style.display = 'none';
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.getElementById('authSection').classList.add('active');
            saveAllData();
        }

        // –û—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ (snake, guess, tournament) –æ—Å—Ç–∞–µ—Ç—Å—è —Ç–∞–∫–∏–º –∂–µ...
        // [–í–µ—Å—å –æ—Å—Ç–∞–ª—å–Ω–æ–π JavaScript –∫–æ–¥ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π - —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–π –¥–ª—è –ø–æ–∫–∞–∑–∞]
        // –î–æ–±–∞–≤—å —Å—é–¥–∞ —Ñ—É–Ω–∫—Ü–∏–∏ showGame, updateLeaderboards, updateTournament, setDifficulty, makeGuess, startSnake –∏–∑ –æ—Ä–∏–≥–∏–Ω–∞–ª–∞
    </script>
</body>
</html>
