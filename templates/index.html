<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üöÄ ALEKSIN GAMING UNIVERSE v3.3 üöÄ</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap');
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:'Orbitron',monospace;background:linear-gradient(135deg,#0a0a23 0%,#1a0a3a 50%,#000 100%);color:#00ffcc;min-height:100vh;overflow-x:hidden;position:relative}
        .stars{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:1}
        .star{position:absolute;background:#fff;border-radius:50%;animation:twinkle 2s infinite}
        @keyframes twinkle{0%,100%{opacity:0.3}50%{opacity:1}}
        .container{max-width:1400px;margin:0 auto;padding:20px;position:relative;z-index:10}
        .title{font-size:clamp(2.5rem,8vw,5rem);text-align:center;margin:30px 0;background:linear-gradient(45deg,#ff00ff,#00ffcc,#ffff00);-webkit-background-clip:text;-webkit-text-fill-color:transparent;text-shadow:0 0 40px #00ffcc}
        
        .user-status{position:fixed;top:20px;right:20px;background:rgba(0,255,204,0.15);backdrop-filter:blur(20px);padding:15px 25px;border:2px solid rgba(0,255,204,0.5);border-radius:20px;z-index:100;box-shadow:0 10px 40px rgba(0,255,204,0.3)}
        .user-status.hidden{display:none}
        .user-nickname{font-size:1.4rem;font-weight:700;color:#00ff88;text-shadow:0 0 10px #00ff88;margin-bottom:8px}
        .user-stats{display:flex;gap:15px;font-size:0.95rem;color:#88ddff}
        .logout-btn{background:linear-gradient(45deg,#ff416c,#ff4b2b);color:#fff;border:none;padding:8px 16px;border-radius:10px;font-size:0.9rem;cursor:pointer;font-weight:700;transition:all 0.3s}
        .logout-btn:hover{transform:scale(1.05);box-shadow:0 0 20px rgba(255,65,108,0.6)}
        
        .glass{background:rgba(255,255,255,0.08);backdrop-filter:blur(20px);border:2px solid rgba(0,255,204,0.4);border-radius:25px;padding:30px;margin:20px 0;box-shadow:0 20px 60px rgba(0,0,0,0.6);transition:all 0.3s}
        .glass:hover{transform:translateY(-8px);box-shadow:0 30px 80px rgba(0,255,204,0.5);border-color:#00ffcc}
        input,select,button{font-family:'Orbitron',sans-serif;padding:15px 25px;font-size:1.1rem;border:2px solid rgba(0,255,204,0.5);border-radius:15px;background:rgba(0,0,0,0.6);color:#00ffcc;cursor:pointer;transition:all 0.3s}
        input:focus,select:focus{outline:none;border-color:#00ffcc;box-shadow:0 0 25px rgba(0,255,204,0.6);transform:scale(1.05)}
        button{font-weight:700;text-transform:uppercase;letter-spacing:1px}
        button:hover{transform:scale(1.05);box-shadow:0 0 25px rgba(0,255,204,0.6)}
        .btn-danger{background:linear-gradient(45deg,#ff416c,#ff4b2b);color:#fff;border-color:#ff416c}
        .games-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(350px,1fr));gap:25px;margin:30px 0}
        .game-title{font-size:1.8rem;margin-bottom:20px;background:linear-gradient(45deg,#00ffcc,#ff00ff);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
        canvas{border:3px solid rgba(0,255,204,0.7);border-radius:20px;background:rgba(0,15,40,0.95);box-shadow:0 0 40px rgba(0,255,204,0.4);display:block;margin:20px auto}
        .stats{display:flex;justify-content:space-around;margin:20px 0;font-size:1.2rem;font-weight:700}
        .tabs{display:flex;flex-wrap:wrap;gap:15px;margin:20px 0}
        .tab-btn{padding:12px 25px;background:rgba(0,255,204,0.1);border:2px solid rgba(0,255,204,0.3);border-radius:10px;cursor:pointer}
        .tab-btn.active{background:#00ffcc;color:#000;border-color:#00ffcc;font-weight:700}
        .leaderboard-table{width:100%;border-collapse:collapse;font-size:1rem;margin:15px 0}
        th{padding:15px;background:rgba(0,255,204,0.2);border-bottom:2px solid rgba(0,255,204,0.4);text-align:left}
        td{padding:12px;border-bottom:1px solid rgba(0,255,204,0.2)}
        .medal-0::before{content:"ü•á";font-size:1.4rem}
        .medal-1::before{content:"ü•à";font-size:1.4rem}
        .medal-2::before{content:"ü•â";font-size:1.4rem}
        .tournament-timer{font-size:1.5rem;text-align:center;margin:15px 0;color:#ffff00;text-shadow:0 0 15px #ffff00}
        .hidden{display:none!important}
        #leaderboards{display:none}
        @media(max-width:768px){.games-grid{grid-template-columns:1fr}.tabs{flex-direction:column}.user-status{top:10px;right:10px;padding:12px 20px;font-size:0.9rem}}
    </style>
</head>
<body>
    <div id="userStatus" class="user-status hidden">
        <div class="user-nickname" id="currentNickname">-</div>
        <div class="user-stats">
            <span>‚≠ê <span id="userTotalScore">0</span></span>
            <span>‚öîÔ∏è <span id="userTournament">–ù–ï–¢</span></span>
        </div>
        <button class="logout-btn" onclick="logoutUser()">üö™ –í–´–•–û–î</button>
    </div>
    
    <div class="stars" id="stars"></div>
    <div class="container">
        <h1 class="title">üöÄ ALEKSIN GAMING UNIVERSE v3.3 üöÄ</h1>
        
        <div id="loginPanel">
            <div class="glass" style="max-width:500px;margin:0 auto;text-align:center">
                <h2 style="margin-bottom:20px;font-size:2rem">üë§ –í–•–û–î –í –ê–†–ï–ù–£</h2>
                <input id="username" placeholder="–ù–∏–∫–Ω–µ–π–º (alexin)" value="alexin">
                <input id="password" type="password" placeholder="–ü–∞—Ä–æ–ª—å (123)" value="123">
                <br><br>
                <button onclick="loginUser()">üöÄ –í–û–ô–¢–ò / –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø</button>
                <div style="margin-top:15px;color:#88ddff;font-size:1.1rem">
                    üíé –¢–µ—Å—Ç: <strong>alexin / 123</strong>
                </div>
            </div>
        </div>
        
        <div id="gamesPanel" class="hidden">
            <div class="games-grid">
                <div class="glass">
                    <h3 class="game-title">üêç –ó–ú–ï–ô–ö–ê –ö–û–°–ú–û–° v3.3</h3>
                    <select id="snakeDiff">
                        <option value="300-snake-novice">üå± –ù–æ–≤–∏—á–æ–∫ (300–º—Å)</option>
                        <option value="200-snake-pro" selected>‚ö° –ü—Ä–æ—Ñ–∏ (200–º—Å)</option>
                        <option value="120-snake-legend">üî• –õ–µ–≥–µ–Ω–¥–∞ (120–º—Å)</option>
                        <option value="80-snake-master">üíé –ú–∞—Å—Ç–µ—Ä (80–º—Å)</option>
                    </select>
                    <br>
                    <button onclick="startSnake()">üéÆ –ó–ê–ü–£–°–¢–ò–¢–¨ –ó–ú–ï–ô–ö–£</button>
                    <button class="btn-danger" onclick="stopSnake()" style="margin-left:10px">‚èπÔ∏è –°–¢–û–ü</button>
                    <canvas id="snakeCanvas" width="450" height="450" class="hidden"></canvas>
                    <div class="stats">
                        <span>üìä –°—á—ë—Ç: <span id="snakeScore">0</span></span>
                        <span>‚≠ê –ì–ª–æ–±–∞–ª—å–Ω—ã–π: <span id="snakeGlobal">0</span></span>
                    </div>
                </div>
                
                <div class="glass">
                    <h3 class="game-title">üî¢ –£–ì–ê–î–ê–ô–ö–ê –ì–ê–õ–ê–ö–¢–ò–ö–ê v3.3</h3>
                    <select id="guessDiff">
                        <option value="100-guess-easy">üå± –õ–µ–≥–∫–æ (1-100)</option>
                        <option value="1000-guess-normal" selected>‚ö° –ù–æ—Ä–º–∞–ª—å–Ω–æ (1-1000)</option>
                        <option value="10000-guess-hard">üî• –°–ª–æ–∂–Ω–æ (1-10k)</option>
                        <option value="100000-guess-extreme">üíé –≠–∫—Å—Ç—Ä–∏–º (1-100k)</option>
                    </select>
                    <br>
                    <input id="guessInput" type="number" placeholder="üéØ –í–≤–µ–¥–∏ —á–∏—Å–ª–æ">
                    <br>
                    <button onclick="makeGuess()">üéØ –£–ì–ê–î–ê–¢–¨</button>
                    <button onclick="newGuessGame()" style="margin-left:10px">üîÑ –ù–û–í–ê–Ø –ò–ì–†–ê</button>
                    <div class="stats">
                        <span>üî¢ –ü–æ–ø—ã—Ç–æ–∫: <span id="guessTries">0</span></span>
                        <span>üìà –î–∏–∞–ø–∞–∑–æ–Ω: <span id="guessRange">1-1000</span></span>
                    </div>
                    <div id="guessHint" style="margin-top:15px;font-size:1.2rem;text-align:center;min-height:40px;padding:15px;background:rgba(0,255,204,0.1);border-radius:10px"></div>
                </div>
            </div>
            
            <div class="glass">
                <h3 style="text-align:center;font-size:2rem;background:linear-gradient(45deg,#ffff00,#ff00ff);-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:15px">
                    ‚öîÔ∏è –ì–ê–õ–ê–ö–¢–ò–ß–ï–°–ö–ò–ô –¢–£–†–ù–ò–† 24/7
                </h3>
                <div class="tournament-timer">
                    ‚è∞ –î–æ –∫–æ–Ω—Ü–∞: <span id="countdown">23:59:59</span> | 
                    <button id="tournamentBtn" onclick="toggleTournament()">‚öîÔ∏è –í–°–¢–£–ü–ò–¢–¨ (x2 –æ—á–∫–∏)</button>
                </div>
                <button onclick="showLeaderboards()" style="margin-top:20px;display:block;width:100%;background:linear-gradient(45deg,#00ff88,#00cc66)">üèÜ –ü–û–°–ú–û–¢–†–ï–¢–¨ –¢–û–ü–´</button>
            </div>
        </div>
        
        <!-- –õ–ò–î–ï–†–ë–û–†–î–´ -->
        <div id="leaderboards" class="hidden">
            <div class="tabs">
                <button class="tab-btn active" data-tab="global" onclick="showTab('global')">üåü –ì–ª–æ–±–∞–ª—å–Ω—ã–π –¢–æ–ø</button>
                <button class="tab-btn" data-tab="snake" onclick="showTab('snake')">üêç –ó–º–µ–π–∫–∞</button>
                <button class="tab-btn" data-tab="guess" onclick="showTab('guess')">üî¢ –£–≥–∞–¥–∞–π–∫–∞</button>
                <button class="tab-btn" data-tab="tournament" onclick="showTab('tournament')">‚öîÔ∏è –¢—É—Ä–Ω–∏—Ä</button>
            </div>
            
            <div id="globalTab" class="glass hidden">
                <h3 style="text-align:center">üèÜ –ì–õ–û–ë–ê–õ–¨–ù–´–ô –¢–û–ü-10</h3>
                <table class="leaderboard-table">
                    <thead><tr><th>–ú–µ—Å—Ç–æ</th><th>üë§ –ò–≥—Ä–æ–∫</th><th>‚≠ê –û—á–∫–∏</th><th>üéÆ –ò–≥—Ä–∞</th></tr></thead>
                    <tbody id="globalTop"></tbody>
                </table>
            </div>
            
            <div id="snakeTab" class="glass hidden">
                <h3 style="text-align:center">üêç –¢–û–ü–´ –ü–û –°–õ–û–ñ–ù–û–°–¢–Ø–ú –ó–ú–ï–ô–ö–ò</h3>
                <table class="leaderboard-table">
                    <thead><tr><th>–°–ª–æ–∂–Ω–æ—Å—Ç—å</th><th>ü•á 1-–µ</th><th>ü•à 2-–µ</th><th>ü•â 3-–µ</th></tr></thead>
                    <tbody id="snakeTops"></tbody>
                </table>
            </div>
            
            <div id="guessTab" class="glass hidden">
                <h3 style="text-align:center">üî¢ –¢–û–ü–´ –ü–û –°–õ–û–ñ–ù–û–°–¢–Ø–ú –£–ì–ê–ô–î–ö–ò</h3>
                <table class="leaderboard-table">
                    <thead><tr><th>–°–ª–æ–∂–Ω–æ—Å—Ç—å</th><th>ü•á 1-–µ</th><th>ü•à 2-–µ</th><th>ü•â 3-–µ</th></tr></thead>
                    <tbody id="guessTops"></tbody>
                </table>
            </div>
            
            <div id="tournamentTab" class="glass hidden">
                <h3 style="text-align:center">‚öîÔ∏è –¢–£–†–ù–ò–†–ù–´–ô –¢–û–ü-20</h3>
                <table class="leaderboard-table">
                    <thead><tr><th>‚öîÔ∏è</th><th>üë§ –ò–≥—Ä–æ–∫</th><th>üèÜ –û—á–∫–∏</th></tr></thead>
                    <tbody id="tourTop"></tbody>
                </table>
            </div>
            
            <button onclick="showGames()" class="btn-danger" style="margin:20px auto;display:block;width:300px">üéÆ –ù–ê–ó–ê–î –ö –ò–ì–†–ê–ú</button>
        </div>
    </div>

    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let currentUser = '', snakeActive = false, snakeInterval = null;
        let guessNumber = 0, guessMax = 1000, guessTries = 0, dx = 1, dy = 0, snake = [{x:10,y:10}];
        let tournamentJoined = false, tournamentEndTime = Date.now() + 24*60*60*1000;
        
        // ‚úÖ –§–ò–ö–° 1: –ü–ï–†–ò–°–¢–ò–°–¢–ï–ù–¢–ù–´–ô –¢–£–†–ù–ò–†
        function loadTournamentStatus() {
            if(currentUser) {
                let tourData = JSON.parse(localStorage.getItem('tournament-' + currentUser) || '{}');
                tournamentJoined = tourData.joined || false;
                document.getElementById('tournamentBtn').innerHTML = tournamentJoined ? 
                    '‚úÖ –í –¢–£–†–ù–ò–†–ï (x2 –æ—á–∫–∏)' : '‚öîÔ∏è –í–°–¢–£–ü–ò–¢–¨ (x2 –æ—á–∫–∏)';
                if(tournamentJoined) document.getElementById('tournamentBtn').style.background = '#00ff88';
            }
        }
        
        function saveTournamentStatus() {
            if(currentUser) {
                localStorage.setItem('tournament-' + currentUser, JSON.stringify({joined: tournamentJoined}));
            }
        }
        
        // ‚≠ê –°–¢–ê–¢–£–°-–ë–ê–†
        function updateUserStatus() {
            const statusDiv = document.getElementById('userStatus');
            if(currentUser) {
                let totalScore = 0;
                ['snake-novice','snake-pro','snake-legend','snake-master','guess-easy','guess-normal','guess-hard','guess-extreme','tournament-global'].forEach(cat => {
                    let scores = JSON.parse(localStorage.getItem(cat) || '[]');
                    let userScore = scores.find(s => s.user === currentUser);
                    if(userScore) totalScore += userScore.score;
                });
                
                document.getElementById('currentNickname').textContent = currentUser;
                document.getElementById('userTotalScore').textContent = totalScore.toLocaleString();
                document.getElementById('userTournament').textContent = tournamentJoined ? 'x2 –û—á–∫–∏ ‚úÖ' : '–ù–ï –í –¢–£–†–ù–ò–†–ï';
                statusDiv.classList.remove('hidden');
            } else {
                statusDiv.classList.add('hidden');
            }
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        function init() {
            // –ó–≤—ë–∑–¥—ã
            for(let i = 0; i < 150; i++) {
                let star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random()*100 + '%';
                star.style.top = Math.random()*100 + '%';
                star.style.width = star.style.height = (Math.random()*3 + 0.5) + 'px';
                document.getElementById('stars').appendChild(star);
            }
            
            updateAllLeaderboards();
            updateTournamentTimer();
            setInterval(updateAllLeaderboards, 10000);
            setInterval(updateUserStatus, 2000);
            
            if(localStorage.currentUser) {
                document.getElementById('username').value = localStorage.currentUser;
                loginUser();
            }
            
            newGuessGame();
        }
        
        // ‚úÖ –õ–û–ì–ò–ù
        function loginUser() {
            currentUser = document.getElementById('username').value.trim() || 'guest';
            localStorage.currentUser = currentUser;
            
            document.getElementById('loginPanel').classList.add('hidden');
            document.getElementById('gamesPanel').classList.remove('hidden');
            
            loadTournamentStatus(); // ‚úÖ –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç—É—Ä–Ω–∏—Ä
            updateUserStatus();
            updateAllLeaderboards();
        }
        
        function logoutUser() {
            if(snakeInterval) {
                clearInterval(snakeInterval);
                snakeActive = false;
            }
            currentUser = '';
            localStorage.removeItem('currentUser');
            document.getElementById('loginPanel').classList.remove('hidden');
            document.getElementById('gamesPanel').classList.add('hidden');
            document.getElementById('leaderboards').classList.add('hidden');
            updateUserStatus();
        }
        
        // ‚úÖ –§–ò–ö–° 2: –ó–ú–ï–ô–ö–ê (–≥—Ä–∞–Ω–∏—Ü—ã 0-20 –≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ)
        function startSnake() {
            if(snakeActive) return;
            snakeActive = true;
            
            const canvas = document.getElementById('snakeCanvas');
            const ctx = canvas.getContext('2d');
            canvas.classList.remove('hidden');
            
            let score = 0;
            let food = {x:15,y:15};
            snake = [{x:10,y:10}]; // ‚úÖ –°–ë–†–û–° –ó–ú–ï–ô–ö–ò
            
            const diffData = document.getElementById('snakeDiff').value.split('-');
            const speed = parseInt(diffData[0]);
            const category = diffData[1];
            
            snakeInterval = setInterval(() => {
                ctx.fillStyle = '#0a1428';
                ctx.fillRect(0, 0, 450, 450);
                
                let head = {x: snake[0].x + dx, y: snake[0].y + dy};
                
                // ‚úÖ –§–ò–ö–° 3: –¢–û–ß–ù–´–ï –ì–†–ê–ù–ò–¶–´ 0-20
                if(head.x < 0 || head.x > 20 || head.y < 0 || head.y > 20 || 
                   snake.some((s, i) => i > 0 && s.x === head.x && s.y === head.y)) {
                    clearInterval(snakeInterval);
                    snakeActive = false;
                    canvas.classList.add('hidden');
                    
                    const finalScore = tournamentJoined ? score * 2 : score;
                    saveScore(category, score, finalScore);
                    
                    document.getElementById('snakeScore').textContent = '0';
                    alert(`üíÄ GAME OVER!\nüìä –°—á—ë—Ç: ${score}\n‚≠ê –ò—Ç–æ–≥: ${finalScore.toLocaleString()}`);
                    updateUserStatus();
                    return;
                }
                
                snake.unshift(head);
                
                if(head.x === food.x && head.y === food.y) {
                    score++;
                    food = {x: Math.floor(Math.random()*21), y: Math.floor(Math.random()*21)};
                    while(snake.some(s => s.x === food.x && s.y === food.y)) {
                        food = {x: Math.floor(Math.random()*21), y: Math.floor(Math.random()*21)};
                    }
                } else {
                    snake.pop();
                }
                
                document.getElementById('snakeScore').textContent = score;
                
                // –ï–¥–∞
                ctx.fillStyle = '#ff00ff';
                ctx.beginPath();
                ctx.arc(food.x*22.5 + 11.25, food.y*22.5 + 11.25, 10, 0, Math.PI*2);
                ctx.fill();
                
                // –ó–º–µ–π–∫–∞
                snake.forEach((part, i) => {
                    ctx.fillStyle = i === 0 ? '#00ff88' : '#44aa88';
                    ctx.fillRect(part.x*22.5 + 1, part.y*22.5 + 1, 21, 21);
                });
                
            }, speed);
            
            // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (–±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏)
            const snakeControl = (e) => {
                if(!snakeActive) return;
                if(e.key === 'ArrowUp' && dy !== 1) { dx = 0; dy = -1; }
                if(e.key === 'ArrowDown' && dy !== -1) { dx = 0; dy = 1; }
                if(e.key === 'ArrowLeft' && dx !== 1) { dx = -1; dy = 0; }
                if(e.key === 'ArrowRight' && dx !== -1) { dx = 1; dy = 0; }
            };
            document.addEventListener('keydown', snakeControl);
        }
        
        function stopSnake() {
            if(snakeInterval) {
                clearInterval(snakeInterval);
                snakeActive = false;
                document.getElementById('snakeCanvas').classList.add('hidden');
            }
        }
        
        // –û—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (—É–≥–∞–¥–∞–π–∫–∞, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ, –ª–∏–¥–µ—Ä–±–æ—Ä–¥—ã)
        function newGuessGame() {
            guessMax = parseInt(document.getElementById('guessDiff').value.split('-')[0]);
            guessNumber = Math.floor(Math.random() * guessMax) + 1;
            guessTries = 0;
            document.getElementById('guessTries').textContent = '0';
            document.getElementById('guessRange').textContent = `1-${guessMax.toLocaleString()}`;
            document.getElementById('guessHint').innerHTML = 'üéØ <strong>–ù–∞—á–Ω–∏ —É–≥–∞–¥—ã–≤–∞—Ç—å!</strong>';
            document.getElementById('guessInput').value = '';
        }
        
        function makeGuess() {
            let guess = parseInt(document.getElementById('guessInput').value);
            let diffData = document.getElementById('guessDiff').value.split('-');
            let category = diffData[1];
            
            if(!guess || guess < 1 || guess > guessMax) {
                document.getElementById('guessHint').innerHTML = `‚ùå –ß–∏—Å–ª–æ –æ—Ç 1 –¥–æ ${guessMax.toLocaleString()}`;
                return;
            }
            
            guessTries++;
            document.getElementById('guessTries').textContent = guessTries;
            
            let delta = Math.abs(guessNumber - guess);
            if(guess === guessNumber) {
                let score = Math.max(0, 10000 - guessTries * 30);
                let finalScore = tournamentJoined ? score * 2 : score;
                saveScore(category, score, finalScore);
                document.getElementById('guessHint').innerHTML = 
                    `üéâ <strong>–£–ì–ê–î–ê–õ –∑–∞ ${guessTries} –ø–æ–ø—ã—Ç–æ–∫!</strong><br>‚≠ê ${finalScore.toLocaleString()} –æ—á–∫–æ–≤`;
                setTimeout(newGuessGame, 2500);
            } else if(delta <= 3) {
                document.getElementById('guessHint').innerHTML = 
                    guess < guessNumber ? 'üî• <strong>–û–ß–ï–ù–¨ –±–ª–∏–∑–∫–æ!</strong> ‚ûï‚ûï‚ûï' : 'üî• <strong>–û–ß–ï–ù–¨ –±–ª–∏–∑–∫–æ!</strong> ‚ûñ‚ûñ‚ûñ';
            } else if(delta <= 15) {
                document.getElementById('guessHint').innerHTML = 
                    guess < guessNumber ? 'üå°Ô∏è –ë–ª–∏–∑–∫–æ! ‚ûï‚ûï' : 'üå°Ô∏è –ë–ª–∏–∑–∫–æ! ‚ûñ‚ûñ';
            } else {
                document.getElementById('guessHint').innerHTML = 
                    guess < guessNumber ? '‚ûï –ë–æ–ª—å—à–µ' : '‚ûñ –ú–µ–Ω—å—à–µ';
            }

            document.getElementById('guessInput').value = '';
            updateUserStatus();
        }
        
        // ‚úÖ –§–ò–ö–° 4: –°–û–•–†–ê–ù–ï–ù–ò–ï –û–ß–ö–û–í
        function saveScore(category, score, finalScore) {
            let scores = JSON.parse(localStorage.getItem(category) || '[]');
            scores = scores.filter(s => s.user !== currentUser);
            scores.unshift({user: currentUser, score: finalScore, date: new Date().toLocaleString('ru-RU')});
            scores.sort((a, b) => b.score - a.score);
            localStorage.setItem(category, JSON.stringify(scores.slice(0, 20)));
            saveTournamentStatus(); // ‚úÖ –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç—É—Ä–Ω–∏—Ä
            updateAllLeaderboards();
            updateUserStatus();
        }
        
        // ‚úÖ –§–ò–ö–° 5: –õ–ò–î–ï–†–ë–û–†–î–´ (–ø–æ–ª–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏)
        function updateAllLeaderboards() {
            updateGlobalTop();
            updateSnakeTops();
            updateGuessTops();
            updateTournamentTop();
            updateGlobalBests();
        }
        
        function updateGlobalTop() {
            let allScores = [];
            ['snake-novice','snake-pro','snake-legend','snake-master','guess-easy','guess-normal','guess-hard','guess-extreme'].forEach(cat => {
                let scores = JSON.parse(localStorage.getItem(cat) || '[]');
                scores.slice(0, 3).forEach(s => allScores.push({...s, cat: cat}));
            });
            allScores.sort((a, b) => b.score - a.score);
            let unique = [], seenUsers = new Set();
            allScores.forEach(s => {
                if(!seenUsers.has(s.user)) {
                    unique.push(s);
                    seenUsers.add(s.user);
                }
            });
            document.getElementById('globalTop').innerHTML = unique.slice(0, 10).map((s, i) => 
                `<tr><td class="medal-${i}">${i + 1}</td><td><strong>${s.user}</strong></td><td>${s.score.toLocaleString()}</td><td>${s.cat.replace('snake-', 'üêç ').replace('guess-', 'üî¢ ').toUpperCase()}</td></tr>`
            ).join('');
        }
        
        function updateSnakeTops() {
            let html = '';
            ['novice', 'pro', 'legend', 'master'].forEach((level, i) => {
                let scores = JSON.parse(localStorage.getItem('snake-' + level) || '[]');
                html += `<tr>
                    <td>${['üå±', '‚ö°', 'üî•', 'üíé'][i]} ${level.toUpperCase()}</td>
                    <td>${scores[0] ? scores[0].user + ' (' + scores[0].score + ')' : '-'}</td>
                    <td>${scores[1] ? scores[1].user + ' (' + scores[1].score + ')' : '-'}</td>
                    <td>${scores[2] ? scores[2].user + ' (' + scores[2].score + ')' : '-'}</td>
                </tr>`;
            });
            document.getElementById('snakeTops').innerHTML = html;
        }
        
        function updateGuessTops() {
            let html = '';
            ['easy', 'normal', 'hard', 'extreme'].forEach((level, i) => {
                let scores = JSON.parse(localStorage.getItem('guess-' + level) || '[]');
                html += `<tr>
                    <td>${['üå±', '‚ö°', 'üî•', 'üíé'][i]} ${level.toUpperCase()}</td>
                    <td>${scores[0] ? scores[0].user + ' (' + scores[0].score + ')' : '-'}</td>
                    <td>${scores[1] ? scores[1].user + ' (' + scores[1].score + ')' : '-'}</td>
                    <td>${scores[2] ? scores[2].user + ' (' + scores[2].score + ')' : '-'}</td>
                </tr>`;
            });
            document.getElementById('guessTops').innerHTML = html;
        }
        
        function updateTournamentTop() {
            let scores = JSON.parse(localStorage.getItem('tournament-global') || '[]');
            document.getElementById('tourTop').innerHTML = scores.slice(0, 20).map((s, i) => 
                `<tr><td class="medal-${i}">${i + 1}</td><td><strong>${s.user}</strong></td><td>${s.score.toLocaleString()}</td></tr>`
            ).join('');
        }
        
        function updateGlobalBests() {
            let snakePro = JSON.parse(localStorage.getItem('snake-pro') || '[]');
            document.getElementById('snakeGlobal').textContent = snakePro[0] ? snakePro[0].score : 0;
        }
        
        // ‚úÖ –§–ò–ö–° 6: –¢–£–†–ù–ò–† (–ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π)
        function toggleTournament() {
            tournamentJoined = !tournamentJoined;
            let btn = document.getElementById('tournamentBtn');
            
            if(tournamentJoined) {
                btn.innerHTML = '‚úÖ –í –¢–£–†–ù–ò–†–ï (x2 –æ—á–∫–∏)';
                btn.style.background = '#00ff88';
                saveScore('tournament-global', 100, 200);
            } else {
                btn.innerHTML = '‚öîÔ∏è –í–°–¢–£–ü–ò–¢–¨ (x2 –æ—á–∫–∏)';
                btn.style.background = '';
            }
            saveTournamentStatus(); // ‚úÖ –°–û–•–†–ê–ù–Ø–ï–ú –í localStorage
            updateUserStatus();
        }
        
        function updateTournamentTimer() {
            let timeLeft = tournamentEndTime - Date.now();
            if(timeLeft <= 0) {
                tournamentEndTime = Date.now() + 24 * 60 * 60 * 1000;
                timeLeft = tournamentEndTime - Date.now();
            }
            let h = Math.floor(timeLeft / 3600000);
            let m = Math.floor((timeLeft % 3600000) / 60000);
            let s = Math.floor((timeLeft % 60000) / 1000);
            document.getElementById('countdown').textList = 
                `${h.toString().padStart(2, '0')}:${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
            setTimeout(updateTournamentTimer, 1000);
        }
        
        // ‚úÖ –§–ò–ö–° 7: –õ–ò–î–ï–†–ë–û–†–î–´ –†–ê–ë–û–¢–ê–Æ–¢
        function showLeaderboards() {
            document.getElementById('gamesPanel').classList.add('hidden');
            document.getElementById('leaderboards').classList.remove('hidden');
            updateAllLeaderboards();
            showTab('tournament'); // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç—É—Ä–Ω–∏—Ä –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
        }
        
        function showGames() {
            document.getElementById('leaderboards').classList.add('hidden');
