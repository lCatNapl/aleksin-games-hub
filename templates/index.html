<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üåå ALEKSIN COSMIC GAMES HUB</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Exo+2:wght@300;400;600;800&display=swap');
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            background: radial-gradient(ellipse at center, #0a0a23 0%, #000428 50%, #000000 100%);
            font-family: 'Exo 2', sans-serif; color: #00ff88; min-height: 100vh;
            overflow-x: hidden; position: relative;
        }
        .stars { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background-image: 
                radial-gradient(2px 2px at 20px 30px, #eee, transparent), 
                radial-gradient(2px 2px at 40px 70px, #fff, transparent),
                radial-gradient(1px 1px at 90px 40px, #00ff88, transparent);
            background-repeat: repeat; background-size: 100px 100px;
            animation: twinkle 4s ease-in-out infinite alternate; z-index: -1;
        }
        @keyframes twinkle { 0%,100%{opacity:0.6} 50%{opacity:1} }
        
        .header-grid { display: grid; grid-template-columns: 1fr auto 1fr; gap: 20px; max-width: 1400px; margin: 0 auto; padding: 20px; }
        .main-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 25px; max-width: 1400px; margin: 0 auto; padding: 20px; }
        
        .panel { background: rgba(0,255,136,0.15); backdrop-filter: blur(15px); 
            border: 2px solid rgba(0,255,136,0.4); border-radius: 25px; padding: 30px;
            box-shadow: 0 20px 40px rgba(0,255,136,0.2); }
        
        .user-info { position: fixed; top: 20px; right: 20px; background: rgba(0,0,0,0.9); 
            border: 2px solid #00ff88; padding: 15px 25px; border-radius: 50px; 
            font-weight: 800; font-size: 18px; z-index: 1000; }
        .user-info.hidden { display: none; }
        
        h1 { font-family: 'Orbitron', monospace; font-size: 2.2em; text-align: center; 
            margin-bottom: 25px; background: linear-gradient(45deg, #00ff88, #0080ff, #ff0080); 
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            animation: glow 2s ease-in-out infinite alternate; }
        @keyframes glow { 0% { filter: drop-shadow(0 0 5px #00ff88); } 100% { filter: drop-shadow(0 0 20px #00ff88); } }
        
        h2 { font-family: 'Orbitron', monospace; font-size: 1.5em; color: #ffaa00; margin: 20px 0 10px 0; }
        
        input, select { width: 100%; padding: 15px; margin: 10px 0; border: 3px solid #00ff88; 
            border-radius: 12px; background: rgba(0,0,0,0.8); color: #00ff88; font-size: 16px; }
        button { width: 100%; padding: 18px; margin: 8px 0; background: linear-gradient(45deg, #00ff88, #0080ff); 
            border: none; border-radius: 15px; color: black; font-weight: 800; font-size: 18px; cursor: pointer; }
        button:hover { transform: translateY(-2px); box-shadow: 0 10px 25px rgba(0,255,136,0.6); }
        
        .game-btn { display: block; padding: 25px; margin: 15px 0; background: linear-gradient(45deg, #ff0080, #00ff88); 
            border-radius: 20px; color: white; text-decoration: none; font-weight: 800; font-size: 20px; text-align: center; }
        .game-btn:hover { transform: scale(1.02); box-shadow: 0 15px 35px rgba(255,0,128,0.7); }
        
        canvas { border: 4px solid #00ff88; border-radius: 20px; background: rgba(0,0,0,0.95); 
            display: block; margin: 15px auto; box-shadow: 0 0 40px rgba(0,255,136,0.6); }
        
        .leaderboard { max-height: 300px; overflow-y: auto; margin-top: 20px; }
        .leaderboard div { padding: 12px 15px; border-bottom: 1px solid rgba(0,255,136,0.3); 
            display: flex; justify-content: space-between; font-weight: 600; 
            background: rgba(255,255,255,0.05); margin: 3px 0; border-radius: 8px; }
        .rank-1 { border-left: 6px solid gold; background: rgba(255,215,0,0.2) !important; }
        .rank-2 { border-left: 6px solid silver; background: rgba(192,192,192,0.2) !important; }
        .rank-3 { border-left: 6px solid #cd7f32; background: rgba(205,127,50,0.2) !important; }
        
        .difficulty-btn { width: 30%; margin: 1.5%; padding: 15px; font-size: 16px; background: linear-gradient(45deg, #ff6600, #ffaa00); }
        .tournament-btn { background: linear-gradient(45deg, #ff0080, #ff6600) !important; font-size: 22px !important; }
        
        .time-left { color: #00ff88; font-size: 24px; font-family: 'Orbitron', monospace; margin: 15px 0; }
        .score-display { text-align: center; font-size: 22px; font-weight: 800; color: #ffaa00; margin: 15px 0; }
        .hidden { display: none !important; }
    </style>
</head>
<body>
    <div class="stars"></div>
    
    <div class="user-info hidden" id="userInfo">
        üëë <span id="userNick"></span> | –û—á–∫–∏: <span id="totalScore">0</span> | <button onclick="logoutUser()" style="padding:8px 15px; font-size:14px;">üö™ –í—ã—Ö–æ–¥</button>
    </div>
    
    <div class="header-grid">
        <!-- –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø -->
        <div class="panel" id="authPanel">
            <h1>üåå COSMIC HUB</h1>
            <input type="text" id="regNick" placeholder="üöÄ –ù–∏–∫ (3+ —Å–∏–º–≤–æ–ª–æ–≤)" maxlength="12">
            <input type="password" id="regPass" placeholder="üîê –ü–∞—Ä–æ–ª—å (4+ —Å–∏–º–≤–æ–ª–æ–≤)">
            <button onclick="createAccount()">‚≠ê –°–æ–∑–¥–∞—Ç—å</button>
            <input type="text" id="loginNick" placeholder="üë§ –ù–∏–∫">
            <input type="password" id="loginPass" placeholder="üîë –ü–∞—Ä–æ–ª—å">
            <button onclick="loginUser()">‚úÖ –í–æ–π—Ç–∏</button>
        </div>
        
        <!-- –¢–û–ü–´ –ó–ú–ï–ô–ö–ò -->
        <div class="panel hidden" id="snakeLeaderboard">
            <h1>üêç –¢–û–ü –ó–ú–ï–ô–ö–ê</h1>
            <div class="leaderboard" id="snakeTop10"></div>
        </div>
        
        <!-- –¢–û–ü–´ –£–ì–ê–î–ê–ô–ö–ò -->
        <div class="panel hidden" id="guessLeaderboard">
            <h1>üéØ –¢–û–ü –£–ì–ê–î–ê–ô–ö–ê</h1>
            <div class="leaderboard" id="guessTop10"></div>
        </div>
    </div>
    
    <div class="main-grid">
        <!-- –ú–ï–ù–Æ –ò–ì–† -->
        <div class="panel hidden" id="gamesPanel">
            <h1>üéÆ –í–´–ë–ï–†–ò –ò–ì–†–£</h1>
            <div style="display:grid; grid-template-columns: 1fr 1fr; gap:15px;">
                <div onclick="showSnakeMenu()" class="game-btn">üêç –ó–ú–ï–ô–ö–ê<br><span style="font-size:14px;">3 —Å–ª–æ–∂–Ω–æ—Å—Ç–∏</span></div>
                <div onclick="showGuessMenu()" class="game-btn">üéØ –£–ì–ê–î–ê–ô–ö–ê<br><span style="font-size:14px;">1-100000</span></div>
            </div>
        </div>
        
        <!-- –ó–ú–ï–ô–ö–ê –ú–ï–ù–Æ -->
        <div class="panel hidden" id="snakeMenu">
            <h1>üêç –ó–ú–ï–ô–ö–ê PRO</h1>
            <div style="text-align:center;">
                <button class="difficulty-btn" onclick="startSnake(1)">–õ–µ–≥–∫–æ</button>
                <button class="difficulty-btn" onclick="startSnake(2)">–°—Ä–µ–¥–Ω–µ</button>
                <button class="difficulty-btn" onclick="startSnake(3)">–°–ª–æ–∂–Ω–æ</button>
                <button class="tournament-btn" onclick="joinSnakeTournament()">‚öîÔ∏è –¢—É—Ä–Ω–∏—Ä –ó–º–µ–π–∫–∞</button>
            </div>
            <div class="score-display">–†–µ–∫–æ—Ä–¥: <span id="snakeRecord">0</span></div>
        </div>
        
        <!-- –£–ì–ê–î–ê–ô–ö–ê –ú–ï–ù–Æ -->
        <div class="panel hidden" id="guessMenu">
            <h1>üéØ –£–ì–ê–î–ê–ô –ß–ò–°–õ–û</h1>
            <div style="text-align:center;">
                <button class="difficulty-btn" onclick="startGuess(1)">1-1000</button>
                <button class="difficulty-btn" onclick="startGuess(2)">1-10000</button>
                <button class="difficulty-btn" onclick="startGuess(3)">1-100000</button>
                <button class="tournament-btn" onclick="joinGuessTournament()">‚öîÔ∏è –¢—É—Ä–Ω–∏—Ä –£–≥–∞–¥–∞–π–∫–∞</button>
            </div>
            <div class="score-display">–†–µ–∫–æ—Ä–¥: <span id="guessRecord">‚àû</span></div>
        </div>
        
        <!-- –¢–£–†–ù–ò–† –ó–ú–ï–ô–ö–ò -->
        <div class="panel hidden" id="snakeTournament">
            <h1>‚öîÔ∏è –¢–£–†–ù–ò–† –ó–ú–ï–ô–ö–ê</h1>
            <div class="time-left" id="snakeTimer">--:--:--</div>
            <div class="leaderboard" id="snakeTournamentBoard"></div>
            <button onclick="backToSnakeMenu()" style="width:100%; margin-top:20px;">üîô –ù–∞–∑–∞–¥</button>
        </div>
        
        <!-- –¢–£–†–ù–ò–† –£–ì–ê–î–ê–ô–ö–ò -->
        <div class="panel hidden" id="guessTournament">
            <h1>‚öîÔ∏è –¢–£–†–ù–ò–† –£–ì–ê–î–ê–ô–ö–ê</h1>
            <div class="time-left" id="guessTimer">--:--:--</div>
            <div class="leaderboard" id="guessTournamentBoard"></div>
            <button onclick="backToGuessMenu()" style="width:100%; margin-top:20px;">üîô –ù–∞–∑–∞–¥</button>
        </div>
        
        <!-- –ò–ì–†–û–í–´–ï –ü–û–õ–Ø -->
        <div class="panel hidden" id="gameCanvasPanel">
            <canvas id="gameCanvas" width="500" height="500"></canvas>
            <div class="score-display" id="gameScore">–û—á–∫–∏: 0</div>
            <div style="text-align:center;">
                <button onclick="backToGameMenu()" class="game-btn" style="width:48%;">üè† –ú–µ–Ω—é</button>
                <button onclick="restartGame()" class="game-btn" style="width:48%; background:linear-gradient(45deg,#00ff88,#ffaa00);">üîÑ –ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
            </div>
        </div>
    </div>

    <script>
        let currentUser = null, userData = {};
        let snakeGame = {level:1, score:0, running:false}, guessGame = {level:1, target:0};
        const storage = {
            get(k) { try { return JSON.parse(localStorage.getItem(k)||'null'); } catch { return null; } },
            set(k,v) { localStorage.setItem(k, JSON.stringify(v)); }
        };

        // –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø
        function createAccount() {
            const nick = document.getElementById('regNick').value.trim(), pass = document.getElementById('regPass').value;
            if (nick.length<3||pass.length<4) return alert('‚ùå –ú–∏–Ω–∏–º—É–º 3/4 —Å–∏–º–≤–æ–ª–∞!');
            const users = storage.get('users') || {};
            if (users[nick]) return alert('‚ùå –ù–∏–∫ –∑–∞–Ω—è—Ç!');
            users[nick] = {pass:btoa(pass),scores:{},tournaments:{}};
            storage.set('users', users); alert('‚úÖ –°–æ–∑–¥–∞–Ω! –í–æ–π–¥–∏.');
        }
        
        function loginUser() {
            const nick = document.getElementById('loginNick').value.trim(), pass = document.getElementById('loginPass').value;
            const users = storage.get('users') || {};
            if (!users[nick]?.pass===btoa(pass)) return alert('‚ùå –ù–µ–≤–µ—Ä–Ω–æ!');
            currentUser = nick; userData = users[nick];
            showMain(); updateLeaderboards();
        }
        
        function showMain() {
            document.getElementById('authPanel').classList.add('hidden');
            document.getElementById('gamesPanel').classList.remove('hidden');
            document.getElementById('snakeLeaderboard').classList.remove('hidden');
            document.getElementById('guessLeaderboard').classList.remove('hidden');
            document.getElementById('userInfo').classList.remove('hidden');
            document.getElementById('userNick').textContent = currentUser;
        }

        // –õ–ò–î–ï–†–ë–û–†–î–´
        function updateLeaderboards() {
            updateSnakeLeaderboard(); updateGuessLeaderboard();
            updateSnakeRecord(); updateGuessRecord();
        }
        
        function updateSnakeLeaderboard() {
            const scores = storage.get('snakeScores') || {};
            const top = Object.entries(scores).sort((a,b)=>b[1]-a[1]).slice(0,10);
            document.getElementById('snakeTop10').innerHTML = top.map(([n,s],i)=>
                `<div class="rank-${i+1}">${i+1}. ${n}<span>${s}</span></div>`).join('') || '<div>–ü—É—Å—Ç–æ</div>';
        }
        
        function updateGuessLeaderboard() {
            const scores = storage.get('guessScores') || {};
            const top = Object.entries(scores).sort((a,b)=>b[1]-a[1]).slice(0,10);
            document.getElementById('guessTop10').innerHTML = top.map(([n,s],i)=>
                `<div class="rank-${i+1}">${i+1}. ${n}<span>${s} –ø–æ–ø—ã—Ç–æ–∫</span></div>`).join('') || '<div>–ü—É—Å—Ç–æ</div>';
        }

        // –ó–ú–ï–ô–ö–ê 3 –°–õ–û–ñ–ù–û–°–¢–ò
        function startSnake(level) {
            snakeGame.level = level; snakeGame.score = 0; snakeGame.running = true;
            document.querySelectorAll('.panel').forEach(p=>p.classList.add('hidden'));
            document.getElementById('gameCanvasPanel').classList.remove('hidden');
            snakeGameLoop();
        }
        
        function snakeGameLoop() {
            if (!snakeGame.running) return;
            const canvas = document.getElementById('gameCanvas'), ctx = canvas.getContext('2d');
            ctx.fillStyle = '#0a0a1a'; ctx.fillRect(0,0,500,500);
            
            // –ò–ì–†–ê –õ–û–ì–ò–ö–ê –ó–î–ï–°–¨ (—É–ø—Ä–æ—â–µ–Ω–æ)
            document.getElementById('gameScore').textContent = `–û—á–∫–∏: ${snakeGame.score} (–°–ª–æ–∂–Ω–æ—Å—Ç—å ${snakeGame.level})`;
            snakeGame.score += snakeGame.level;
            setTimeout(snakeGameLoop, 200-snakeGame.level*50);
        }
        
        // –£–ì–ê–î–ê–ô–ö–ê 3 –°–õ–û–ñ–ù–û–°–¢–ò
        function startGuess(level) {
            guessGame.level = level;
            const ranges = [[1000,1],[10000,1],[100000,1]];
            guessGame.target = Math.floor(Math.random()*ranges[level-1][0])+ranges[level-1][1];
            document.querySelectorAll('.panel').forEach(p=>p.classList.add('hidden'));
            document.getElementById('guessPanel').classList.remove('hidden'); // –î–æ–±–∞–≤—å –ø–∞–Ω–µ–ª—å —É–≥–∞–¥–∞–π–∫–∏
        }

        // –ù–ê–í–ò–ì–ê–¶–ò–Ø
        function showSnakeMenu() { hideAll(); document.getElementById('snakeMenu').classList.remove('hidden'); }
        function showGuessMenu() { hideAll(); document.getElementById('guessMenu').classList.remove('hidden'); }
        function hideAll() { document.querySelectorAll('.panel').forEach(p=>p.classList.add('hidden')); }
        
        window.onload = () => {
            const last = storage.get('lastUser');
            if (last) { currentUser = last; showMain(); }
        };
    </script>
</body>
</html>
