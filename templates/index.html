<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üöÄ ALEKSIN GAMES HUB v2.4 ‚úÖ</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap');
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:'Orbitron',monospace;background:linear-gradient(135deg,#0a0a23 0%,#1a0a3a 50%,#0f0f4f 100%);color:#fff;height:100vh;overflow:hidden}
        .container{max-width:1400px;margin:0 auto;padding:20px;display:grid;grid-template-columns:1fr 400px;gap:30px;height:calc(100vh-40px)}
        .games{overflow-y:auto;padding-right:10px}
        .sidebar{background:linear-gradient(145deg,rgba(255,0,150,0.1),rgba(0,255,255,0.1));backdrop-filter:blur(20px);border-radius:20px;padding:25px;border:1px solid rgba(255,255,255,0.1)}
        h1{font-size:clamp(2rem,5vw,4rem);background:linear-gradient(45deg,#ff00ff,#00ffff,#ffff00);background-size:300% 300%;-webkit-background-clip:text;-webkit-text-fill-color:transparent;animation:gradientShift 3s ease infinite;text-align:center;margin-bottom:30px}
        @keyframes gradientShift{0%,100%{background-position:0% 50%}50%{background-position:100% 50%}}
        .btn{display:block;width:100%;background:linear-gradient(45deg,rgba(255,0,150,0.3),rgba(0,255,255,0.3));border:none;border-radius:15px;padding:15px;font-size:1.2rem;font-weight:700;color:#fff;margin:10px 0;cursor:pointer;transition:all 0.3s ease;box-shadow:0 8px 32px rgba(0,0,0,0.3);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,0.2)}
        .btn:hover{background:linear-gradient(45deg,rgba(255,0,150,0.5),rgba(0,255,255,0.5));transform:translateY(-3px);box-shadow:0 12px 40px rgba(0,0,0,0.4)}
        .game-section{display:none;background:linear-gradient(145deg,rgba(0,255,255,0.1),rgba(255,0,150,0.1));border-radius:20px;padding:25px;margin:20px 0;border:1px solid rgba(255,255,255,0.1);backdrop-filter:blur(15px)}
        .game-section.active{display:block}
        canvas{border:2px solid #00ffff;border-radius:10px;background:#000;box-shadow:0 0 30px rgba(0,255,255,0.5)}
        .leaderboard-title{font-size:1.5rem;color:#00ffff;margin-bottom:15px;text-align:center}
        table{width:100%;border-collapse:collapse;margin:10px 0;background:rgba(0,0,0,0.5);border-radius:10px;overflow:hidden;box-shadow:0 10px 30px rgba(0,0,0,0.5)}
        th,td{padding:12px 8px;text-align:center;font-weight:700;border-bottom:1px solid rgba(255,255,255,0.1)}
        th{background:linear-gradient(90deg,#ff00ff,#00ffff);color:#fff}
        .rank-1{background:linear-gradient(90deg,#ffd700,#ffed4e);color:#000}
        .rank-2{background:linear-gradient(90deg,#c0c0c0,#e5e5e5);color:#000}
        .rank-3{background:linear-gradient(90deg,#cd7f32,#deb887);color:#000}
        #statusBar{position:fixed;top:20px;right:20px;background:rgba(0,255,0,0.3);padding:15px;border-radius:15px;font-weight:700;display:none}
        #loginForm,#registerForm{display:none;background:rgba(0,0,0,0.8);padding:25px;border-radius:20px;margin:20px 0}
        input{width:100%;padding:12px;margin:10px 0;border-radius:10px;border:1px solid #00ffff;background:rgba(255,255,255,0.1);color:#fff;font-family:'Orbitron',monospace}
        #tournamentTimer{font-size:1.8rem;color:#ff00ff;font-weight:900;text-align:center;margin:15px 0}
        .difficulty-btns{display:flex;gap:10px;flex-wrap:wrap;margin:15px 0}
        .difficulty-btns .btn{flex:1;min-width:120px;font-size:1rem;padding:10px}
        @media(max-width:768px){.container{grid-template-columns:1fr;gap:15px}.sidebar{order:2}}
    </style>
</head>
<body>
    <div class="container">
        <div class="games">
            <h1>üöÄ ALEKSIN GAMES HUB v2.4</h1>
            
            <!-- –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø -->
            <div id="authSection">
                <button class="btn" onclick="toggleLogin()">üîê –í–û–ô–¢–ò</button>
                <button class="btn" onclick="toggleRegister()">üìù –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø</button>
            </div>
            
            <div id="loginForm">
                <h3>üîê –í—Ö–æ–¥</h3>
                <input type="text" id="loginUsername" placeholder="–õ–æ–≥–∏–Ω (test)">
                <input type="password" id="loginPassword" placeholder="–ü–∞—Ä–æ–ª—å (123456)">
                <button class="btn" onclick="login()">–í–û–ô–¢–ò</button>
                <button class="btn" onclick="toggleLogin()" style="background:rgba(255,0,0,0.5)">–û–¢–ú–ï–ù–ê</button>
            </div>
            
            <div id="registerForm">
                <h3>üìù –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h3>
                <input type="text" id="registerUsername" placeholder="–õ–æ–≥–∏–Ω">
                <input type="password" id="registerPassword" placeholder="–ü–∞—Ä–æ–ª—å">
                <button class="btn" onclick="register()">–ó–ê–†–ï–ì–ò–°–¢–†–ò–†–û–í–ê–¢–¨–°–Ø</button>
                <button class="btn" onclick="toggleRegister()" style="background:rgba(255,0,0,0.5)">–û–¢–ú–ï–ù–ê</button>
            </div>

            <!-- –û–°–ù–û–í–ù–´–ï –ö–ù–û–ü–ö–ò -->
            <div id="gamesSection" style="display:none">
                <button class="btn" onclick="showGame('snake')">üêç –ò–ì–†–ê–¢–¨ –í –ó–ú–ï–ô–ö–£</button>
                <button class="btn" onclick="showGame('guess')">üéØ –£–ì–ê–î–ê–ô –ß–ò–°–õ–û</button>
                <button class="btn" onclick="showGame('leaderboards')">üèÜ –õ–ò–î–ï–†–ë–û–†–î–´</button>
                <button class="btn" onclick="showGame('tournament')">‚öîÔ∏è –¢–£–†–ù–ò–†</button>
                <button class="btn" style="background:rgba(255,0,0,0.5)" onclick="logout()">üëã –í–´–ô–¢–ò</button>
            </div>
            
            <!-- –ó–ú–ï–ô–ö–ê -->
            <div id="snakeGame" class="game-section">
                <h2>üêç –ó–ú–ï–ô–ö–ê PRO</h2>
                <div class="difficulty-btns">
                    <button class="btn" onclick="startSnake('easy')">–õ—ë–≥–∫–∞—è</button>
                    <button class="btn" onclick="startSnake('normal')">–ù–æ—Ä–º–∞–ª—å–Ω–∞—è</button>
                    <button class="btn" onclick="startSnake('hard')">–°–ª–æ–∂–Ω–∞—è</button>
                </div>
                <canvas id="snakeCanvas" width="400" height="400"></canvas>
                <div style="text-align:center;margin-top:15px">
                    <div id="snakeScore" style="font-size:1.5rem;font-weight:900;color:#00ff00">–°—á—ë—Ç: 0</div>
                    <div id="snakeHighScore" style="color:#ff00ff">–†–µ–∫–æ—Ä–¥: 0</div>
                </div>
            </div>
            
            <!-- –£–ì–ê–î–ê–ô–ö–ê -->
            <div id="guessGame" class="game-section">
                <h2>üéØ –£–ì–ê–î–ê–ô –ß–ò–°–õ–û</h2>
                <div class="difficulty-btns">
                    <button class="btn" onclick="startGuess(1000)">–õ—ë–≥–∫–∞—è (1-1K)</button>
                    <button class="btn" onclick="startGuess(10000)">–°—Ä–µ–¥–Ω—è—è (1-10K)</button>
                    <button class="btn" onclick="startGuess(100000)">–°–ª–æ–∂–Ω–∞—è (1-100K)</button>
                </div>
                <div style="text-align:center;font-size:2rem;margin:20px 0">üéØ –ó–∞–≥–∞–¥–∞–Ω–Ω–æ–µ —á–∏—Å–ª–æ: <span id="guessNumber">-</span></div>
                <input type="number" id="guessInput" placeholder="–¢–≤–æ—ë —á–∏—Å–ª–æ..." style="font-size:1.5rem;padding:15px;width:200px">
                <br><button class="btn" onclick="makeGuess()" style="width:200px;margin-top:15px">–£–ì–ê–î–ê–¢–¨</button>
                <div id="guessFeedback" style="font-size:1.2rem;margin:15px 0;color:#00ff00"></div>
                <div id="guessAttempts" style="font-size:1.5rem;font-weight:900">–ü–æ–ø—ã—Ç–æ–∫: 0</div>
            </div>
        </div>
        
        <!-- –°–ê–ô–î–ë–ê–† -->
        <div class="sidebar" id="sidebar">
            <div id="userStatus" style="text-align:center;font-size:1.2rem;margin-bottom:20px;color:#00ffff">üëã –ì–æ—Å—Ç—å</div>
            
            <div id="tournamentTimer" style="font-size:1.8rem">‚è∞ –ó–∞–≥—Ä—É–∑–∫–∞...</div>
            
            <div id="leaderboardTables" style="display:none">
                <!-- –¢–û–ü–´ –ü–û–Ø–í–Ø–¢–°–Ø –ó–î–ï–°–¨ -->
            </div>
        </div>
    </div>

    <div id="statusBar">
        ‚úÖ <span id="statusText">–ì–æ—Ç–æ–≤!</span>
    </div>

    <script>
        // –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï
        let currentUser = localStorage.getItem('currentUser') || null;
        let leaderboards = JSON.parse(localStorage.getItem('leaderboards')) || {
            snake_easy: [], snake_normal: [], snake_hard: [],
            guess_easy: [], guess_normal: [], guess_hard: []
        };
        let tournamentScores = JSON.parse(localStorage.getItem('tournamentScores')) || {};
        let currentGame = 'snake', currentDifficulty = 'easy';
        
        // –ó–ú–ï–ô–ö–ê
        let snake = [], food = {}, snakeScore = 0, snakeGameRunning = false, snakeInterval, snakeDirection = {x:0, y:-1};
        const gridSize = 20, tileSize = 20;
        
        // –£–ì–ê–î–ê–ô–ö–ê
        let guessNumber = 0, guessAttempts = 0, guessMax = 1000;
        
        // –ì–õ–û–ë–ê–õ–¨–ù–´–ï –°–í–ê–ô–ü–´ –ë–ï–ó –°–ö–†–û–õ–õ–ê
        document.addEventListener('touchmove', e => e.preventDefault(), {passive: false});
        document.addEventListener('touchstart', e => e.preventDefault(), {passive: false});
        
        // –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ‚úÖ –§–ò–ö–° –ö–ù–û–ü–û–ö
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
            if(currentUser) {
                document.getElementById('authSection').style.display = 'none';
                document.getElementById('gamesSection').style.display = 'block';
                document.getElementById('userStatus').textContent = `üëë ${currentUser}`;
                document.getElementById('statusBar').style.display = 'block';
            }
            updateLeaderboards();
            updateTournament();
            setInterval(updateTournament, 1000);
        });
        
        // –°–û–•–†–ê–ù–ï–ù–ò–ï
        function saveData() {
            localStorage.setItem('leaderboards', JSON.stringify(leaderboards));
            localStorage.setItem('tournamentScores', JSON.stringify(tournamentScores));
            localStorage.setItem('currentUser', currentUser);
        }
        
        function loadData() {
            Object.keys(leaderboards).forEach(key => {
                leaderboards[key].sort((a,b) => b.score - a.score);
                leaderboards[key] = leaderboards[key].slice(0,10);
            });
        }
        
        // ‚úÖ –§–ò–ö–°–ò–†–û–í–ê–ù–ù–ê–Ø –ù–ê–í–ò–ì–ê–¶–ò–Ø
        function showGame(game) {
            // –°–ö–†–´–í–ê–ï–ú –í–°–ï –ò–ì–†–û–í–´–ï –°–ï–ö–¶–ò–ò
            document.querySelectorAll('.game-section').forEach(section => {
                section.classList.remove('active');
                section.style.display = 'none';
            });
            document.getElementById('leaderboardTables').style.display = 'none';
            
            // –ü–û–ö–ê–ó–´–í–ê–ï–ú –ù–£–ñ–ù–£–Æ
            if(game === 'leaderboards') {
                document.getElementById('leaderboardTables').style.display = 'block';
                updateLeaderboards();
            } else if(game === 'tournament') {
                updateTournament();
            } else {
                const gameSection = document.getElementById(game + 'Game');
                gameSection.style.display = 'block';
                gameSection.classList.add('active');
            }
            
            currentGame = game;
        }
        
        // –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø
        function toggleLogin() { 
            document.getElementById('loginForm').style.display = 'block';
            document.getElementById('registerForm').style.display = 'none';
        }
        function toggleRegister() { 
            document.getElementById('registerForm').style.display = 'block';
            document.getElementById('loginForm').style.display = 'none';
        }
        
        function login() {
            const username = document.getElementById('loginUsername').value;
            const password = document.getElementById('loginPassword').value;
            if(username === 'test' && password === '123456') {
                currentUser = username;
                document.getElementById('loginForm').style.display = 'none';
                document.getElementById('authSection').style.display = 'none';
                document.getElementById('gamesSection').style.display = 'block';
                document.getElementById('userStatus').textContent = `üëë ${currentUser}`;
                document.getElementById('statusBar').style.display = 'block';
                saveData();
                updateLeaderboards();
            }
        }
        
        function register() {
            const username = document.getElementById('registerUsername').value;
            const password = document.getElementById('registerPassword').value;
            if(username && password && username !== 'test') {
                currentUser = username;
                document.getElementById('registerForm').style.display = 'none';
                document.getElementById('authSection').style.display = 'none';
                document.getElementById('gamesSection').style.display = 'block';
                document.getElementById('userStatus').textContent = `üëë ${currentUser}`;
                document.getElementById('statusBar').style.display = 'block';
                saveData();
                updateLeaderboards();
            }
        }
        
        function logout() {
            currentUser = null;
            document.getElementById('authSection').style.display = 'block';
            document.getElementById('gamesSection').style.display = 'none';
            document.getElementById('statusBar').style.display = 'none';
            saveData();
        }
        
        // –ó–ú–ï–ô–ö–ê ‚úÖ –ì–†–ê–ù–ò–¶–´ + –°–ö–û–†–û–°–¢–ò
        function startSnake(difficulty) {
            currentDifficulty = difficulty;
            snakeScore = 0;
            snakeGameRunning = true;
            snake = [{x:10,y:10, dir: {x:0,y:-1}}];
            snakeDirection = {x:0, y:-1};
            generateFood();
            document.getElementById('snakeScore').textContent = '–°—á—ë—Ç: 0';
            
            if(snakeInterval) clearInterval(snakeInterval);
            const speeds = {easy:200, normal:120, hard:80};
            snakeInterval = setInterval(updateSnake, speeds[difficulty]);
            
            const canvas = document.getElementById('snakeCanvas');
            canvas.focus();
        }
        
        function updateSnake() {
            if(!snakeGameRunning) return;
            
            let head = {...snake[0]};
            head.x += snakeDirection.x;
            head.y += snakeDirection.y;
            
            // ‚úÖ –ì–†–ê–ù–ò–¶–´ –†–ê–ë–û–¢–ê–Æ–¢
            if(head.x < 0 || head.x >= gridSize || head.y < 0 || head.y >= gridSize) {
                gameOver('snake');
                return;
            }
            
            snake.unshift(head);
            
            if(head.x === food.x && head.y === food.y) {
                snakeScore += 10;
                generateFood();
            } else {
                snake.pop();
            }
            
            document.getElementById('snakeScore').textContent = `–°—á—ë—Ç: ${snakeScore}`;
            drawSnake();
        }
        
        function generateFood() {
            food = {
                x: Math.floor(Math.random() * gridSize),
                y: Math.floor(Math.random() * gridSize)
            };
        }
        
        function drawSnake() {
            const canvas = document.getElementById('snakeCanvas');
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0,0,canvas.width,canvas.height);
            
            ctx.fillStyle = '#ff00ff';
            ctx.fillRect(food.x*tileSize, food.y*tileSize, tileSize-2, tileSize-2);
            
            snake.forEach((segment, i) => {
                ctx.fillStyle = i === 0 ? '#00ffff' : '#00ff00';
                ctx.fillRect(segment.x*tileSize, segment.y*tileSize, tileSize-2, tileSize-2);
            });
        }
        
        // –°–¢–ê–†–´–ï –ö–ù–û–ü–ö–ò –ó–ú–ï–ô–ö–ò
        document.addEventListener('keydown', function(e) {
            if(!snakeGameRunning) return;
            
            const head = snake[0];
            switch(e.key) {
                case 'ArrowUp': if(snakeDirection.y !== 1) snakeDirection = {x:0,y:-1}; break;
                case 'ArrowDown': if(snakeDirection.y !== -1) snakeDirection = {x:0,y:1}; break;
                case 'ArrowLeft': if(snakeDirection.x !== 1) snakeDirection = {x:-1,y:0}; break;
                case 'ArrowRight': if(snakeDirection.x !== -1) snakeDirection = {x:1,y:0}; break;
            }
            e.preventDefault();
        });
        
        // –£–ì–ê–î–ê–ô–ö–ê
        function startGuess(max) {
            guessMax = max;
            currentDifficulty = max === 1000 ? 'easy' : max === 10000 ? 'normal' : 'hard';
            guessNumber = Math.floor(Math.random() * max) + 1;
            guessAttempts = 0;
            document.getElementById('guessNumber').textContent = '?';
            document.getElementById('guessFeedback').textContent = '';
            document.getElementById('guessAttempts').textContent = '–ü–æ–ø—ã—Ç–æ–∫: 0';
        }
        
        function makeGuess() {
            const guess = parseInt(document.getElementById('guessInput').value);
            if(!guess) return;
            
            guessAttempts++;
            let feedback = '';
            
            if(guess === guessNumber) {
                feedback = `üéâ –£–ì–ê–î–ê–õ –ó–ê ${guessAttempts} –ü–û–ü–´–¢–û–ö!`;
                const score = Math.max(10000 - attempts * 200, 100);
                gameOver('guess', score);
            } else if(guess < guessNumber) {
                feedback = `üìà –ë–æ–ª—å—à–µ (${Math.abs(guessNumber-guess)} —Ä–∞–∑–Ω–∏—Ü–∞)`;
            } else {
                feedback = `üìâ –ú–µ–Ω—å—à–µ (${Math.abs(guessNumber-guess)} —Ä–∞–∑–Ω–∏—Ü–∞)`;
            }
            
            document.getElementById('guessFeedback').textContent = feedback;
            document.getElementById('guessAttempts').textContent = `–ü–æ–ø—ã—Ç–æ–∫: ${guessAttempts}`;
            document.getElementById('guessInput').value = '';
        }
        
        // ‚úÖ GAME OVER + –¢–£–†–ù–ò–†–ù–´–ï –û–ß–ö–ò
        function gameOver(game, score = snakeScore) {
            if(game === 'snake') {
                snakeGameRunning = false;
                clearInterval(snakeInterval);
            }
            
            if(currentUser) {
                // –û–°–ù–û–í–ù–û–ô –¢–û–ü
                const lbKey = `${game}_${currentDifficulty}`;
                const highScore = leaderboards[lbKey][0]?.score || 0;
                
                if(score > highScore) {
                    leaderboards[lbKey].unshift({
                        user: currentUser,
                        score: score,
                        date: new Date().toLocaleDateString('ru-RU')
                    });
                    leaderboards[lbKey] = leaderboards[lbKey].slice(0,10);
                }
                
                // ‚úÖ –¢–£–†–ù–ò–†–ù–´–ï –û–ß–ö–ò –ù–ê–ö–û–ü–õ–Ø–Æ–¢–°–Ø
                const tourKey = `${game}_${currentDifficulty}`;
                tournamentScores[tourKey] = (tournamentScores[tourKey] || 0) + score;
                
                saveData();
                updateLeaderboards();
                document.getElementById('statusText').textContent = `${currentUser}: +${score} –æ—á–∫–æ–≤!`;
            }
        }
        
        // 6 –û–¢–î–ï–õ–¨–ù–´–• –õ–ò–î–ï–†–ë–û–†–î–û–í
        function updateLeaderboards() {
            let html = '<h3 class="leaderboard-title">üèÜ –¢–û–ü-10 –ü–û –ò–ì–†–ê–ú</h3>';
            
            const games = [
                {key: 'snake_easy', name: 'üêç –ó–º–µ–π–∫–∞ –õ—ë–≥–∫–∞—è'},
                {key: 'snake_normal', name: 'üêç –ó–º–µ–π–∫–∞ –ù–æ—Ä–º–∞–ª—å–Ω–∞—è'},
                {key: 'snake_hard', name: 'üêç –ó–º–µ–π–∫–∞ –°–ª–æ–∂–Ω–∞—è'},
                {key: 'guess_easy', name: 'üéØ –£–≥–∞–¥–∞–π–∫–∞ –õ—ë–≥–∫–∞—è'},
                {key: 'guess_normal', name: 'üéØ –£–≥–∞–¥–∞–π–∫–∞ –°—Ä–µ–¥–Ω—è—è'},
                {key: 'guess_hard', name: 'üéØ –£–≥–∞–¥–∞–π–∫–∞ –°–ª–æ–∂–Ω–∞—è'}
            ];
            
            games.forEach(game => {
                html += `<h4 style="color:#00ffff;margin:15px 0 5px 0">${game.name}</h4><table>`;
                html += '<tr><th>–ú–µ—Å—Ç–æ</th><th>–ò–≥—Ä–æ–∫</th><th>–û—á–∫–∏</th></tr>';
                
                (leaderboards[game.key] || []).forEach((player, i) => {
                    const rankClass = i < 3 ? `rank-${i+1}` : '';
                    html += `<tr class="${rankClass}"><td>${i+1}${i<3 ? ' ü•áü•àü•â'[i] : ''}</td><td>${player.user}</td><td>${player.score}</td></tr>`;
                });
                html += '</table>';
            });
            
            document.getElementById('leaderboardTables').innerHTML = html;
        }
        
        // ‚úÖ –¢–£–†–ù–ò–† 00:00 MSK
        function updateTournament() {
            const now = new Date();
            const mskOffset = 3 * 60;
            const utcHours = now.getUTCHours();
            const mskHours = (utcHours + 3) % 24;
            const secondsSinceMidnight = mskHours * 3600 + now.getUTCMinutes() * 60 + now.getUTCSeconds();
            const secondsLeft = 86400 - secondsSinceMidnight;
            
            const hours = Math.floor(secondsLeft / 3600);
            const minutes = Math.floor((secondsLeft % 3600) / 60);
            document.getElementById('tournamentTimer').textContent = `‚è∞ ${hours}—á ${minutes.toString().padStart(2,'0')}–º`;
        }
        
        window.onbeforeunload = saveData;
    </script>
</body>
</html>
