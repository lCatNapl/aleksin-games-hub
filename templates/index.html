<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üåå ALEKSIN COSMIC GAMES HUB</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            background: radial-gradient(ellipse at center, #0a0a23 0%, #000428 50%, #000000 100%);
            font-family: 'Arial Black', sans-serif; color: #00ff88; min-height: 100vh;
            overflow-x: hidden; position: relative;
        }
        .stars {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-image: radial-gradient(2px 2px at 20px 30px, #fff, transparent),
                              radial-gradient(2px 2px at 40px 70px, #00ff88, transparent),
                              radial-gradient(1px 1px at 90px 40px, #ff0080, transparent);
            background-repeat: repeat; background-size: 100px 100px;
            animation: twinkle 4s ease-in-out infinite alternate; z-index: -1;
        }
        @keyframes twinkle { 0%,100%{opacity:0.7} 50%{opacity:1} }
        
        .container { max-width: 1400px; margin: 0 auto; padding: 20px; }
        .panel { 
            background: rgba(0,0,0,0.85); border: 2px solid #00ff88; 
            border-radius: 25px; padding: 30px; margin: 20px 0; 
            box-shadow: 0 0 40px rgba(0,255,136,0.4);
        }
        .hidden { display: none !important; }
        
        .user-panel { position: fixed; top: 20px; right: 20px; background: rgba(0,0,0,0.95); 
            border: 3px solid #ff0080; padding: 20px 30px; border-radius: 40px; 
            font-size: 20px; font-weight: bold; z-index: 1000; }
        
        h1 { font-size: 2.8em; text-align: center; margin-bottom: 30px;
            background: linear-gradient(45deg, #00ff88, #ff0080, #0080ff, #ffaa00);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            animation: glow 2s ease-in-out infinite alternate; }
        @keyframes glow { 0%{text-shadow:0 0 10px #00ff88} 100%{text-shadow:0 0 30px #00ff88} }
        
        input { width: 100%; padding: 22px; margin: 15px 0; border: 3px solid #00ff88; 
            border-radius: 20px; background: rgba(0,0,0,0.9); color: #00ff88; 
            font-size: 20px; font-weight: bold; }
        button { width: 100%; padding: 22px; margin: 12px 0; background: linear-gradient(45deg, #00ff88, #0080ff); 
            border: none; border-radius: 20px; color: #000; font-size: 22px; font-weight: bold; 
            cursor: pointer; transition: all 0.3s; }
        button:hover { transform: scale(1.05); box-shadow: 0 15px 40px rgba(0,255,136,0.7); }
        
        .game-btn { display: block; padding: 30px; margin: 20px 0; background: linear-gradient(45deg, #ff0080, #00ff88, #0080ff); 
            color: white; text-decoration: none; text-align: center; font-size: 26px; 
            font-weight: bold; border-radius: 25px; }
        .game-btn:hover { transform: scale(1.03); box-shadow: 0 20px 50px rgba(255,0,128,0.8); }
        
        .diff-btn { display: inline-block; width: 30%; margin: 1.5%; padding: 20px; 
            background: linear-gradient(45deg, #ff6600, #ffaa00); font-size: 20px; }
        
        canvas { border: 5px solid #00ff88; border-radius: 25px; background: #000; 
            display: block; margin: 25px auto; box-shadow: 0 0 50px rgba(0,255,136,0.6); }
        
        .leaderboard { max-height: 350px; overflow-y: auto; margin: 20px 0; }
        .leaderboard div { padding: 18px 20px; margin: 8px 0; background: rgba(0,255,136,0.15); 
            border-left: 6px solid #00ff88; border-radius: 15px; display: flex; 
            justify-content: space-between; font-weight: bold; font-size: 18px; }
        .rank1 { border-left-color: #ffd700 !important; background: rgba(255,215,0,0.3) !important; }
        .rank2 { border-left-color: #c0c0c0 !important; background: rgba(192,192,192,0.3) !important; }
        .rank3 { border-left-color: #cd7f32 !important; background: rgba(205,127,50,0.3) !important; }
        
        .timer { font-size: 32px; color: #ffaa00; text-align: center; margin: 25px 0; 
            font-weight: bold; font-family: 'Courier New', monospace; }
        .score { font-size: 28px; text-align: center; color: #ffaa00; margin: 20px 0; font-weight: bold; }
        .feedback { font-size: 24px; text-align: center; margin: 20px 0; min-height: 40px; }
    </style>
</head>
<body>
    <div class="stars"></div>
    
    <div class="user-panel hidden" id="userPanel">
        üëë <span id="currentNick"></span> | 
        <button onclick="logout()" style="width:auto;padding:12px 24px;font-size:18px;">üö™ –í–´–•–û–î</button>
    </div>
    
    <div class="container">
        <!-- –õ–û–ì–ò–ù -->
        <div class="panel" id="loginPanel">
            <h1>üåå ALEKSIN GAMES HUB</h1>
            <input type="text" id="username" placeholder="üë§ –í–≤–µ–¥–∏ –Ω–∏–∫" maxlength="12">
            <input type="password" id="password" placeholder="üîê –ü–∞—Ä–æ–ª—å">
            <button onclick="login()">‚úÖ –í–û–ô–¢–ò</button>
            <button onclick="registerNew()">‚≠ê –°–û–ó–î–ê–¢–¨ –ê–ö–ö–ê–£–ù–¢</button>
        </div>
        
        <!-- –ì–õ–ê–í–ù–û–ï –ú–ï–ù–Æ -->
        <div class="panel hidden" id="mainMenu">
            <h1>üéÆ –í–´–ë–ï–†–ò –ò–ì–†–£</h1>
            <div style="display:grid; grid-template-columns:1fr 1fr; gap:25px; margin:30px 0;">
                <div class="panel">
                    <h1>üêç –ó–ú–ï–ô–ö–ê</h1>
                    <a href="#" class="game-btn" onclick="showSnakeDifficulty();return false;">‚ñ∂Ô∏è –ò–ì–†–ê–¢–¨ (3 —Å–ª–æ–∂–Ω–æ—Å—Ç–∏)</a>
                    <div style="display:grid; grid-template-columns:1fr 1fr; gap:15px; margin-top:20px;">
                        <div class="leaderboard" id="snakeTop10" style="max-height:200px;"></div>
                    </div>
                </div>
                <div class="panel">
                    <h1>üéØ –£–ì–ê–î–ê–ô–ö–ê</h1>
                    <a href="#" class="game-btn" onclick="showGuessDifficulty();return false;">‚ñ∂Ô∏è –ò–ì–†–ê–¢–¨ (1-100000)</a>
                    <div style="display:grid; grid-template-columns:1fr 1fr; gap:15px; margin-top:20px;">
                        <div class="leaderboard" id="guessTop10" style="max-height:200px;"></div>
                    </div>
                </div>
            </div>
            <a href="#" class="game-btn" onclick="showTournaments();return false;" style="background:linear-gradient(45deg,#ff0080,#ff6600); font-size:28px;">‚öîÔ∏è –¢–£–†–ù–ò–†–´</a>
        </div>
        
        <!-- –°–õ–û–ñ–ù–û–°–¢–ò –ó–ú–ï–ô–ö–ò -->
        <div class="panel hidden" id="snakeDifficulty">
            <h1>üêç –í–´–ë–ï–†–ò –°–õ–û–ñ–ù–û–°–¢–¨</h1>
            <button class="diff-btn" onclick="startSnake(1)">üêå –õ–ï–ì–ö–û (–º–µ–¥–ª–µ–Ω–Ω–æ)</button>
            <button class="diff-btn" onclick="startSnake(2)">üêç –ù–û–†–ú–ê–õ–¨–ù–û</button>
            <button class="diff-btn" onclick="startSnake(3)">‚ö° –°–õ–û–ñ–ù–û (–±—ã—Å—Ç—Ä–æ)</button>
            <button class="game-btn" onclick="joinSnakeTournament()" style="margin-top:25px;">‚öîÔ∏è –¢–£–†–ù–ò–† –ó–ú–ï–ô–ö–ê</button>
            <button onclick="backToMain()" style="background:linear-gradient(45deg,#ff6600,#ffaa00);">üîô –ì–õ–ê–í–ù–û–ï –ú–ï–ù–Æ</button>
        </div>
        
        <!-- –°–õ–û–ñ–ù–û–°–¢–ò –£–ì–ê–î–ê–ô–ö–ò -->
        <div class="panel hidden" id="guessDifficulty">
            <h1>üéØ –í–´–ë–ï–†–ò –£–†–û–í–ï–ù–¨</h1>
            <button class="diff-btn" onclick="startGuess(1)">1Ô∏è‚É£ 1-1 000</button>
            <button class="diff-btn" onclick="startGuess(2)">2Ô∏è‚É£ 1-10 000</button>
            <button class="diff-btn" onclick="startGuess(3)">3Ô∏è‚É£ 1-100 000</button>
            <button class="game-btn" onclick="joinGuessTournament()" style="margin-top:25px;">‚öîÔ∏è –¢–£–†–ù–ò–† –£–ì–ê–î–ê–ô–ö–ê</button>
            <button onclick="backToMain()" style="background:linear-gradient(45deg,#ff6600,#ffaa00);">üîô –ì–õ–ê–í–ù–û–ï –ú–ï–ù–Æ</button>
        </div>
        
        <!-- –ó–ú–ï–ô–ö–ê -->
        <div class="panel hidden" id="snakeGame">
            <h1>üêç –ó–ú–ï–ô–ö–ê</h1>
            <canvas id="snakeCanvas" width="600" height="600"></canvas>
            <div class="score">–û—á–∫–∏: <span id="snakeScore">0</span> | –†–µ–∫–æ—Ä–¥: <span id="snakeRecord">0</span> | –°–ª–æ–∂–Ω–æ—Å—Ç—å: <span id="snakeDiff">1</span></div>
            <button onclick="restartSnake()">üîÑ –ù–û–í–ê–Ø –ò–ì–†–ê</button>
            <button onclick="backToMain()" style="background:linear-gradient(45deg,#ff6600,#ffaa00);">üè† –ú–ï–ù–Æ</button>
        </div>
        
        <!-- –£–ì–ê–î–ê–ô–ö–ê -->
        <div class="panel hidden" id="guessGame">
            <h1>üéØ –£–ì–ê–î–ê–ô –ß–ò–°–õ–û</h1>
            <div class="score">–£—Ä–æ–≤–µ–Ω—å: <span id="guessLevel">1</span> (1-<span id="guessMax">1000</span>) | –õ—É—á—à–∏–π: <span id="guessBest">‚àû</span></div>
            <div class="feedback" id="guessFeedback"></div>
            <input type="number" id="guessInput" placeholder="üéØ –í–≤–µ–¥–∏ —á–∏—Å–ª–æ">
            <button onclick="checkGuess()">‚úÖ –ü–†–û–í–ï–†–ò–¢–¨</button>
            <button onclick="nextGuessLevel()">üîÑ –°–õ–ï–î–£–Æ–©–ò–ô –£–†–û–í–ï–ù–¨</button>
            <button onclick="backToMain()" style="background:linear-gradient(45deg,#ff6600,#ffaa00);">üè† –ú–ï–ù–Æ</button>
        </div>
        
        <!-- –¢–£–†–ù–ò–†–´ -->
        <div class="panel hidden" id="tournaments">
            <h1>‚öîÔ∏è –¢–£–†–ù–ò–†–´ (–ø—Ä–∏–∑—ã –¢–û–ü-3!)</h1>
            <div style="display:grid; grid-template-columns:1fr 1fr; gap:30px;">
                <div class="panel">
                    <h1>üêç –ó–ú–ï–ô–ö–ê</h1>
                    <div class="timer" id="snakeTimer">--:--:--</div>
                    <div class="leaderboard" id="snakeTourBoard"></div>
                    <button class="game-btn" onclick="joinSnakeTournament()">‚öîÔ∏è –í–°–¢–£–ü–ò–¢–¨</button>
                </div>
                <div class="panel">
                    <h1>üéØ –£–ì–ê–î–ê–ô–ö–ê</h1>
                    <div class="timer" id="guessTimer">--:--:--</div>
                    <div class="leaderboard" id="guessTourBoard"></div>
                    <button class="game-btn" onclick="joinGuessTournament()">‚öîÔ∏è –í–°–¢–£–ü–ò–¢–¨</button>
                </div>
            </div>
            <button onclick="backToMain()" style="margin-top:30px; font-size:24px;">üè† –ì–õ–ê–í–ù–û–ï –ú–ï–ù–Æ</button>
        </div>
    </div>

    <script>
        let currentUser = '', snake = {}, guess = {}, gameState = {};
        const storage = {
            get(k) { try { return JSON.parse(localStorage.getItem(k)||'null'); } catch { return null; } },
            set(k,v) { localStorage.setItem(k, JSON.stringify(v)); }
        };
        
        // –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø
        function registerNew() {
            const nick = document.getElementById('username').value.trim();
            const pass = document.getElementById('password').value;
            if(nick.length<3||pass.length<3) return alert('‚ùå –ù–∏–∫/–ø–∞—Ä–æ–ª—å –º–∏–Ω–∏–º—É–º 3 —Å–∏–º–≤–æ–ª–∞!');
            let users = storage.get('users') || {};
            if(users[nick]) return alert('‚ùå –ù–∏–∫ –∑–∞–Ω—è—Ç!');
            users[nick] = {pass:btoa(pass), snake:0, guess:999, snakeTour:0, guessTour:999};
            storage.set('users', users); alert('‚úÖ –ê–∫–∫–∞—É–Ω—Ç —Å–æ–∑–¥–∞–Ω!');
        }
        
        function login() {
            const nick = document.getElementById('username').value.trim();
            const pass = document.getElementById('password').value;
            let users = storage.get('users') || {};
            if(users[nick]?.pass === btoa(pass)) {
                currentUser = nick;
                document.getElementById('loginPanel').classList.add('hidden');
                document.getElementById('mainMenu').classList.remove('hidden');
                document.getElementById('userPanel').classList.remove('hidden');
                document.getElementById('currentNick').textContent = nick;
                updateAll();
            } else alert('‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω/–ø–∞—Ä–æ–ª—å!');
        }
        
        function logout() {
            currentUser = ''; document.getElementById('loginPanel').classList.remove('hidden');
            document.querySelectorAll('.panel:not(#loginPanel)').forEach(p=>p.classList.add('hidden'));
        }
        
        function backToMain() {
            document.querySelectorAll('.panel').forEach(p=>p.classList.add('hidden'));
            document.getElementById('mainMenu').classList.remove('hidden');
            updateLeaderboards();
        }
        
        // –ó–ú–ï–ô–ö–ê 3 –°–õ–û–ñ–ù–û–°–¢–ò
        function startSnake(level) {
            snake = {x:300,y:300,dx:20,dy:0,cells:[],maxCells:3,score:0,level:level};
            document.querySelectorAll('.panel').forEach(p=>p.classList.add('hidden'));
            document.getElementById('snakeGame').classList.remove('hidden');
            document.getElementById('snakeDiff').textContent = level;
            snakeLoop();
        }
        
        function snakeLoop() {
            if(!snake.running) return;
            const canvas = document.getElementById('snakeCanvas');
            const ctx = canvas.getContext('2d');
            
            ctx.fillStyle = '#000'; ctx.fillRect(0,0,600,600);
            
            // –î–≤–∏–∂–µ–Ω–∏–µ
            snake.x += snake.dx; snake.y += snake.dy;
            snake.cells.unshift({x:snake.x,y:snake.y});
            if(snake.cells.length>snake.maxCells) snake.cells.pop();
            
            // –ö—Ä–∞—Å–∏–≤–∞—è –∑–º–µ–π–∫–∞
            snake.cells.forEach((cell,i)=>{
                const gradient = ctx.createRadialGradient(cell.x,cell.y,0,cell.x,cell.y,15);
                gradient.addColorStop(0, i===0 ? '#ff0080' : '#00ff88');
                gradient.addColorStop(1, 'transparent');
                ctx.fillStyle = gradient;
                ctx.beginPath(); ctx.arc(cell.x,cell.y, i===0?15:10,0,Math.PI*2); ctx.fill();
            });
            
            // –ö–†–ê–°–ò–í–´–ï –Ø–ë–õ–û–ö–ò
            if(!snake.food) {
                snake.food = {x:Math.floor(Math.random()*28)*20+50, y:Math.floor(Math.random()*28)*20+50};
            }
            const appleGradient = ctx.createRadialGradient(snake.food.x,snake.food.y,0,snake.food.x,snake.food.y,12);
            appleGradient.addColorStop(0,'#ff4444'); appleGradient.addColorStop(0.7,'#ffaa00'); appleGradient.addColorStop(1,'#cc0000');
            ctx.fillStyle = appleGradient; ctx.beginPath(); ctx.arc(snake.food.x,snake.food.y,12,0,Math.PI*2); ctx.fill();
            ctx.fillStyle = '#fff'; ctx.beginPath(); ctx.arc(snake.food.x-4,snake.food.y-4,2,0,Math.PI*2); ctx.arc(snake.food.x+4,snake.food.y-3,2,0,Math.PI*2); ctx.fill();
            
            // –°—ä–µ–¥–∞–Ω–∏–µ
            if(Math.abs(snake.x-snake.food.x)<15 && Math.abs(snake.y-snake.food.y)<15) {
                snake.score += snake.level*10; snake.maxCells += 2; delete snake.food;
            }
            
            document.getElementById('snakeScore').textContent = snake.score;
            
            // –ö–æ–ª–ª–∏–∑–∏—è
            if(snake.cells.slice(2).some(cell=>Math.abs(cell.x-snake.x)<20 && Math.abs(cell.y-snake.y)<20) || 
               snake.x<10 || snake.x>590 || snake.y<10 || snake.y>590) {
                endSnake();
                return;
            }
            
            setTimeout(snakeLoop, 200-snake.level*60);
        }
        
        // –£–ì–ê–î–ê–ô–ö–ê –° –ü–û–î–°–ö–ê–ó–ö–ê–ú–ò
        function startGuess(level) {
            const levels = [[1000,1],[10000,1],[100000,1]];
            guess = {level:level, target:Math.floor(Math.random()*levels[level-1[0]])+1, attempts:0, min:1, max:levels[level-1[0]]};
            document.querySelectorAll('.panel').forEach(p=>p.classList.add('hidden'));
            document.getElementById('guessGame').classList.remove('hidden');
            document.getElementById('guessLevel').textContent = level;
            document.getElementById('guessMax').textContent = guess.max.toLocaleString();
            document.getElementById('guessFeedback').textContent = `üéØ –ó–∞–≥–∞–¥–∞–ª —á–∏—Å–ª–æ –æ—Ç 1 –¥–æ ${guess.max.toLocaleString()}`;
        }
        
        function checkGuess() {
            const input = parseInt(document.getElementById('guessInput').value);
            if(!input || input<guess.min || input>guess.max) {
                document.getElementById('guessFeedback').textContent = `‚ùå –í–≤–µ–¥–∏ —á–∏—Å–ª–æ –æ—Ç ${guess.min} –¥–æ ${guess.max}!`;
                return;
            }
            
            guess.attempts++;
            
            if(input === guess.target) {
                const score = Math.max(1, 1000/guess.attempts);
                document.getElementById('guessFeedback').innerHTML = `üéâ –£–†–ê! –£–≥–∞–¥–∞–ª –∑–∞ <strong>${guess.attempts}</strong> –ø–æ–ø—ã—Ç–æ–∫! (+${Math.round(score)} –æ—á–∫–æ–≤)`;
                endGuess();
            } else if(input < guess.target) {
                guess.min = input + 1;
                const range = guess.max - guess.min + 1;
                const hint = range > 100 ? Math.floor(guess.min + range/4) : guess.min + 1;
                document.getElementById('guessFeedback').innerHTML = `üìà –ë–æ–ª—å—à–µ —á–µ–º ${input}<br>–î–∏–∞–ø–∞–∑–æ–Ω: ${guess.min}-${guess.max} (${range} —á–∏—Å–µ–ª)<br>–ü–æ–¥—Å–∫–∞–∑–∫–∞: –ø–æ–ø—Ä–æ–±—É–π –æ–∫–æ–ª–æ ${hint}`;
            } else {
                guess.max = input - 1;
                const range = guess.max - guess.min + 1;
                const hint = range > 100 ? Math.floor(guess.max - range/4) : guess.max - 1;
                document.getElementById('guessFeedback').innerHTML = `üìâ –ú–µ–Ω—å—à–µ —á–µ–º ${input}<br>–î–∏–∞–ø–∞–∑–æ–Ω: ${guess.min}-${guess.max} (${range} —á–∏—Å–µ–ª)<br>–ü–æ–¥—Å–∫–∞–∑–∫–∞: –ø–æ–ø—Ä–æ–±—É–π –æ–∫–æ–ª–æ ${hint}`;
            }
        }
        
        function nextGuessLevel() { startGuess(guess.level % 3 + 1); }
        
        // –õ–ò–î–ï–†–ë–û–†–î–´ –ò –¢–£–†–ù–ò–†–´ (—É–ø—Ä–æ—â–µ–Ω–æ)
        function updateAll() {
            updateLeaderboards();
            updateTournamentTimers();
        }
        
        function updateLeaderboards() {
            let users = storage.get('users') || {};
            // –¢–æ–ø –∑–º–µ–π–∫–∞
            const snakeTop = Object.entries(users).sort((a,b)=>b[1].snake-a[1].snake).slice(0,5);
            document.getElementById('snakeTop10').innerHTML = snakeTop.map(([n,d],i)=>
                `<div class="rank${i+1}">${i+1}. ${n}<span>${d.snake||0}</span></div>`).join('');
            // –¢–æ–ø —É–≥–∞–¥–∞–π–∫–∞  
            const guessTop = Object.entries(users).sort((a,b)=>a[1].guess-b[1].guess).slice(0,5);
            document.getElementById('guessTop10').innerHTML = guessTop.map(([n,d],i)=>
                `<div class="rank${i+1}">${i+1}. ${n}<span>${d.guess||'‚àû'} –ø–æ–ø—ã—Ç–æ–∫</span></div>`).join('');
        }
        
        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
        document.addEventListener('keydown', e => {
            if(!snake.running) return;
            switch(e.key) {
                case 'ArrowUp': snake.dy=-20; snake.dx=0; break;
                case 'ArrowDown': snake.dy=20; snake.dx=0; break;
                case 'ArrowLeft': snake.dx=-20; snake.dy=0; break;
                case 'ArrowRight': snake.dx=20; snake.dy=0; break;
            }
        });
        
        // –¢–∞–π–º–µ—Ä—ã
        function updateTournamentTimers() {
            setInterval(()=>{
                const now = new Date();
                const next = new Date(now); next.setHours(24,0,0,0);
                const diff = next - now;
                const h = Math.floor(diff/3600000), m = Math.floor((diff%3600000)/60000), s = Math.floor((diff%60000)/1000);
                document.getElementById('snakeTimer').textContent = 
                document.getElementById('guessTimer').textContent = `${h}:${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
            },1000);
        }
    </script>
</body>
</html>
