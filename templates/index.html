<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üåå ALEKSIN COSMIC HUB</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Exo+2:wght@300;400;600;800&display=swap');
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            background: radial-gradient(ellipse at center, #0a0a23 0%, #000428 50%, #000000 100%);
            font-family: 'Exo 2', sans-serif;
            min-height: 100vh;
            color: #00ff88;
            overflow-x: hidden;
            position: relative;
        }
        
        /* –ó–≤—ë–∑–¥–Ω–æ–µ –Ω–µ–±–æ */
        .stars {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="10" cy="10" r="1" fill="white" opacity="0.8"/><circle cx="90" cy="20" r="0.5" fill="#00ff88" opacity="0.6"/><circle cx="30" cy="80" r="1.5" fill="white" opacity="0.9"/></svg>') repeat;
            animation: twinkle 3s infinite;
            z-index: -1;
        }
        
        @keyframes twinkle { 0%,100%{opacity:0.5} 50%{opacity:1} }
        
        .container {
            max-width: 1200px; margin: 0 auto; padding: 20px;
            display: flex; gap: 20px; flex-wrap: wrap;
        }
        
        .panel {
            background: rgba(0,255,136,0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0,255,136,0.3);
            border-radius: 20px;
            padding: 25px;
            flex: 1; min-width: 300px;
        }
        
        .user-info {
            position: fixed; top: 20px; right: 20px;
            background: rgba(0,0,0,0.8); border: 2px solid #00ff88;
            padding: 15px 25px; border-radius: 50px; font-weight: 600;
            box-shadow: 0 0 30px rgba(0,255,136,0.5);
        }
        
        .user-info.hidden { display: none; }
        
        .logout-btn {
            background: linear-gradient(45deg, #ff0080, #00ff88);
            border: none; color: black; padding: 8px 16px;
            border-radius: 20px; cursor: pointer; font-weight: bold;
            margin-left: 10px; transition: all 0.3s;
        }
        
        .logout-btn:hover { transform: scale(1.1); box-shadow: 0 0 20px #ff0080; }
        
        h1 { font-family: 'Orbitron', monospace; font-size: 2.5em; text-align: center; margin-bottom: 20px; background: linear-gradient(45deg, #00ff88, #0080ff); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        
        .auth-form { text-align: center; }
        input { width: 100%; padding: 15px; margin: 10px 0; border: 2px solid #00ff88; border-radius: 10px; background: rgba(0,0,0,0.7); color: #00ff88; font-size: 16px; }
        input:focus { outline: none; box-shadow: 0 0 20px rgba(0,255,136,0.5); }
        button { width: 100%; padding: 15px; margin: 10px 0; background: linear-gradient(45deg, #00ff88, #0080ff); border: none; border-radius: 10px; color: black; font-weight: bold; font-size: 18px; cursor: pointer; transition: all 0.3s; }
        button:hover { transform: translateY(-2px); box-shadow: 0 10px 30px rgba(0,255,136,0.6); }
        
        .game-btn { display: inline-block; padding: 20px 40px; margin: 10px; background: linear-gradient(45deg, #ff0080, #00ff88); border-radius: 15px; color: white; text-decoration: none; font-weight: bold; transition: all 0.3s; }
        .game-btn:hover { transform: scale(1.05); box-shadow: 0 0 30px rgba(255,0,128,0.8); }
        
        canvas { border: 3px solid #00ff88; border-radius: 15px; background: rgba(0,0,0,0.9); display: block; margin: 10px auto; box-shadow: 0 0 30px rgba(0,255,136,0.5); }
        
        .tournament-info { text-align: center; font-size: 18px; color: #ff0080; font-weight: bold; }
        .time-left { color: #00ff88; font-size: 24px; font-family: 'Orbitron', monospace; }
        
        .leaderboard { max-height: 200px; overflow-y: auto; }
        .leaderboard div { padding: 8px; border-bottom: 1px solid rgba(0,255,136,0.3); display: flex; justify-content: space-between; }
        
        .hidden { display: none !important; }
        
        @media (max-width: 768px) {
            .container { flex-direction: column; }
            .user-info { position: static; margin: 20px 0; text-align: center; }
        }
    </style>
</head>
<body>
    <div class="stars"></div>
    
    <div class="user-info hidden" id="userInfo">
        üë§ <span id="userNick"></span> | <button class="logout-btn" onclick="logout()">üö™ –í—ã—Ö–æ–¥</button>
    </div>
    
    <div class="container">
        <!-- –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø -->
        <div class="panel" id="authPanel">
            <h1>üåå –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</h1>
            <div class="auth-form">
                <input type="text" id="regNick" placeholder="üìù –¢–≤–æ–π –Ω–∏–∫" maxlength="15">
                <input type="password" id="regPass" placeholder="üîê –ü–∞—Ä–æ–ª—å (–º–∏–Ω–∏–º—É–º 4 —Å–∏–º–≤–æ–ª–∞)">
                <button onclick="register()">üöÄ –°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç</button>
                <input type="text" id="loginNick" placeholder="üë§ –ù–∏–∫">
                <input type="password" id="loginPass" placeholder="üîë –ü–∞—Ä–æ–ª—å">
                <button onclick="login()">‚úÖ –í–æ–π—Ç–∏</button>
            </div>
        </div>
        
        <!-- –ì–õ–ê–í–ù–ê–Ø –ü–ê–ù–ï–õ–¨ (—Å–∫—Ä—ã—Ç–∞ –¥–æ –≤—Ö–æ–¥–∞) -->
        <div class="panel hidden" id="mainPanel">
            <h1>üéÆ –ò–ì–†–´</h1>
            <a href="#snake" class="game-btn" onclick="startSnake()">üêç –ó–º–µ–π–∫–∞ Pro</a>
            <a href="#guess" class="game-btn" onclick="startGuess()">üéØ –£–≥–∞–¥–∞–π —á–∏—Å–ª–æ</a>
        </div>
        
        <!-- –¢–£–†–ù–ò–† -->
        <div class="panel hidden" id="tournamentPanel">
            <h1>‚öîÔ∏è –¢–£–†–ù–ò–†</h1>
            <div class="tournament-info">
                <div>–¢–æ–ø-100 –∏–≥—Ä–æ–∫–æ–≤ ‚Ä¢ –ü—Ä–∏–∑—ã —Ç–æ–ø-5!</div>
                <div class="time-left" id="timeLeft">‚è∞ –î–æ —Å–±—Ä–æ—Å–∞: --:--:--</div>
                <button class="game-btn" onclick="joinTournament()" style="width:100%">‚öîÔ∏è –í—Å—Ç—É–ø–∏—Ç—å –≤ —Ç—É—Ä–Ω–∏—Ä</button>
            </div>
            <div class="leaderboard" id="tournamentBoard"></div>
        </div>
        
        <!-- –ó–ú–ï–ô–ö–ê -->
        <div class="panel hidden" id="snakePanel">
            <h1>üêç –ó–º–µ–π–∫–∞ Pro</h1>
            <canvas id="snakeCanvas" width="400" height="400"></canvas>
            <div style="text-align:center; margin-top:10px;">
                <button onclick="startSnake()" class="game-btn">üîÑ –ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
                <div>–û—á–∫–∏: <span id="snakeScore">0</span> | –†–µ–∫–æ—Ä–¥: <span id="snakeHigh">0</span></div>
            </div>
        </div>
        
        <!-- –£–ì–ê–î–ê–ô–ö–ê -->
        <div class="panel hidden" id="guessPanel">
            <h1>üéØ –£–≥–∞–¥–∞–π —á–∏—Å–ª–æ</h1>
            <div style="text-align:center;">
                <div>–£—Ä–æ–≤–µ–Ω—å: <span id="guessLevel">1</span> (1-<span id="guessMax">1000</span>)</div>
                <input type="number" id="guessInput" placeholder="–¢–≤–æ—ë —á–∏—Å–ª–æ" min="1">
                <button onclick="makeGuess()" class="game-btn" style="width:100%; margin-top:10px;">üéØ –£–≥–∞–¥–∞—Ç—å</button>
                <div id="guessFeedback"></div>
                <div>–ü–æ–ø—ã—Ç–æ–∫: <span id="guessAttempts">0</span> | –õ—É—á—à–∏–π: <span id="guessHigh">‚àû</span></div>
            </div>
        </div>
    </div>

    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let currentUser = null;
        let tournamentActive = false;
        
        // –°–û–•–†–ê–ù–ï–ù–ò–ï –î–ê–ù–ù–´–•
        const storage = {
            get(key) { return JSON.parse(localStorage.getItem(key) || 'null'); },
            set(key, value) { localStorage.setItem(key, JSON.stringify(value)); }
        };
        
        // –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø
        function register() {
            const nick = document.getElementById('regNick').value.trim();
            const pass = document.getElementById('regPass').value;
            
            if (!nick || nick.length < 3) return alert('‚ùå –ù–∏–∫ –æ—Ç 3 —Å–∏–º–≤–æ–ª–æ–≤!');
            if (!pass || pass.length < 4) return alert('‚ùå –ü–∞—Ä–æ–ª—å –æ—Ç 4 —Å–∏–º–≤–æ–ª–æ–≤!');
            
            const users = storage.get('users') || {};
            if (users[nick]) return alert('‚ùå –ù–∏–∫ –∑–∞–Ω—è—Ç!');
            
            users[nick] = { pass: btoa(pass), joined: Date.now(), tournament: false };
            storage.set('users', users);
            
            alert('‚úÖ –ê–∫–∫–∞—É–Ω—Ç —Å–æ–∑–¥–∞–Ω! –ú–æ–∂–µ—à—å –≤–æ–π—Ç–∏.');
            document.getElementById('regNick').value = '';
            document.getElementById('regPass').value = '';
        }
        
        function login() {
            const nick = document.getElementById('loginNick').value.trim();
            const pass = document.getElementById('loginPass').value;
            
            const users = storage.get('users') || {};
            if (!users[nick] || users[nick].pass !== btoa(pass)) {
                return alert('‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω/–ø–∞—Ä–æ–ª—å!');
            }
            
            currentUser = nick;
            showMain();
            updateUserInfo();
        }
        
        function logout() {
            currentUser = null;
            document.getElementById('userInfo').classList.add('hidden');
            document.getElementById('mainPanel').classList.add('hidden');
            document.getElementById('tournamentPanel').classList.add('hidden');
            document.getElementById('snakePanel').classList.add('hidden');
            document.getElementById('guessPanel').classList.add('hidden');
            document.getElementById('authPanel').classList.remove('hidden');
            alert('üëã –î–æ —Å–≤–∏–¥–∞–Ω–∏—è!');
        }
        
        function updateUserInfo() {
            document.getElementById('userNick').textContent = currentUser;
            document.getElementById('userInfo').classList.remove('hidden');
        }
        
        function showMain() {
            document.getElementById('authPanel').classList.add('hidden');
            document.getElementById('mainPanel').classList.remove('hidden');
            document.getElementById('tournamentPanel').classList.remove('hidden');
            updateTournamentTimer();
            updateTournamentBoard();
        }
        
        // –¢–£–†–ù–ò–†
        function updateTournamentTimer() {
            const now = new Date();
            const tomorrow = new Date(now);
            tomorrow.setHours(24,0,0,0);
            const diff = tomorrow - now;
            
            const hours = Math.floor(diff / 3600000);
            const mins = Math.floor((diff % 3600000) / 60000);
            const secs = Math.floor((diff % 60000) / 1000);
            
            document.getElementById('timeLeft').textContent = `‚è∞ –î–æ —Å–±—Ä–æ—Å–∞: ${hours}:${mins.toString().padStart(2,'0')}:${secs.toString().padStart(2,'0')}`;
            
            setTimeout(updateTournamentTimer, 1000);
        }
        
        function joinTournament() {
            if (!currentUser) return alert('üë§ –°–Ω–∞—á–∞–ª–∞ –≤–æ–π–¥–∏!');
            const users = storage.get('users') || {};
            users[currentUser].tournament = true;
            storage.set('users', users);
            tournamentActive = true;
            alert('‚öîÔ∏è –¢—ã –≤ —Ç—É—Ä–Ω–∏—Ä–µ! –û—á–∫–∏ —Ö2!');
        }
        
        function updateTournamentBoard() {
            const scores = storage.get('tournamentScores') || {};
            const sorted = Object.entries(scores).sort((a,b) => b[1] - a[1]).slice(0,10);
            
            const board = document.getElementById('tournamentBoard');
            board.innerHTML = sorted.map(([nick, score], i) => 
                `<div>${i+1}. ${nick} - ${score} –æ—á–∫–æ–≤</div>`
            ).join('');
        }
        
        // –ó–ú–ï–ô–ö–ê
        let snakeGame = { running: false, score: 0, high: 0, canvas: null, ctx: null, snake: [], food: {}, dx: 0, dy: 0 };
        
        function startSnake() {
            const canvas = document.getElementById('snakeCanvas');
            snakeGame.canvas = canvas;
            snakeGame.ctx = canvas.getContext('2d');
            snakeGame.snake = [{x:10,y:10}];
            snakeGame.dx = 1; snakeGame.dy = 0;
            snakeGame.score = 0; snakeGame.running = true;
            spawnFood();
            document.getElementById('snakePanel').scrollIntoView();
            snakeLoop();
        }
        
        function spawnFood() {
            snakeGame.food = {
                x: Math.floor(Math.random()*39),
                y: Math.floor(Math.random()*39)
            };
        }
        
        function snakeLoop() {
            if (!snakeGame.running) return;
            
            // –û—á–∏—Å—Ç–∫–∞
            snakeGame.ctx.fillStyle = 'rgba(0,0,0,0.9)';
            snakeGame.ctx.fillRect(0,0,400,400);
            
            // –î–≤–∏–∂–µ–Ω–∏–µ –∑–º–µ–π–∫–∏
            const head = {x: snakeGame.snake[0].x + snakeGame.dx, y: snakeGame.snake[0].y + snakeGame.dy};
            snakeGame.snake.unshift(head);
            
            // –ï–¥–∞
            if (head.x === snakeGame.food.x && head.y === snakeGame.food.y) {
                snakeGame.score += tournamentActive ? 20 : 10;
                spawnFood();
            } else {
                snakeGame.snake.pop();
            }
            
            // –û—Ç—Ä–∏—Å–æ–≤–∫–∞
            snakeGame.ctx.strokeStyle = '#00ff88';
            snakeGame.ctx.lineWidth = 3;
            snakeGame.snake.forEach((part, i) => {
                snakeGame.ctx.fillStyle = i === 0 ? '#ff0080' : '#00ff88';
                snakeGame.ctx.fillRect(part.x*10+2, part.y*10+2, 6, 6);
            });
            
            snakeGame.ctx.fillStyle = '#ffaa00';
            snakeGame.ctx.fillRect(snakeGame.food.x*10+3, snakeGame.food.y*10+3, 4, 4);
            
            document.getElementById('snakeScore').textContent = snakeGame.score;
            
            // –°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è
            const headRect = snakeGame.snake[0];
            if (headRect.x < 0 || headRect.x >= 40 || headRect.y < 0 || headRect.y >= 40 ||
                snakeGame.snake.slice(1).some(p => p.x === headRect.x && p.y === headRect.y)) {
                endSnake();
                return;
            }
            
            setTimeout(snakeLoop, 150 - Math.min(snakeGame.score, 100));
        }
        
        function endSnake() {
            snakeGame.running = false;
            const high = storage.get('snakeHigh') || 0;
            if (snakeGame.score > high) {
                storage.set('snakeHigh', snakeGame.score);
                document.getElementById('snakeHigh').textContent = snakeGame.score;
            }
            
            // –¢—É—Ä–Ω–∏—Ä
            if (tournamentActive && currentUser) {
                const scores = storage.get('tournamentScores') || {};
                scores[currentUser] = (scores[currentUser] || 0) + snakeGame.score;
                storage.set('tournamentScores', scores);
                updateTournamentBoard();
            }
            
            alert(`üêç –ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞! –û—á–∫–∏: ${snakeGame.score}`);
        }
        
        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–º–µ–π–∫–æ–π
        document.addEventListener('keydown', e => {
            if (!snakeGame.running) return;
            if (e.key === 'ArrowUp' && snakeGame.dy === 0) { snakeGame.dx = 0; snakeGame.dy = -1; }
            if (e.key === 'ArrowDown' && snakeGame.dy === 0) { snakeGame.dx = 0; snakeGame.dy = 1; }
            if (e.key === 'ArrowLeft' && snakeGame.dx === 0) { snakeGame.dx = -1; snakeGame.dy = 0; }
            if (e.key === 'ArrowRight' && snakeGame.dx === 0) { snakeGame.dx = 1; snakeGame.dy = 0; }
        });
        
        // –£–ì–ê–î–ê–ô–ö–ê
        let guessGame = { target: 0, level: 1, attempts: 0, min: 1, max: 1000 };
        
        function startGuess() {
            guessGame.level = 1;
            guessGame.attempts = 0;
            nextGuessLevel();
            document.getElementById('guessPanel').scrollIntoView();
        }
        
        function nextGuessLevel() {
            const levels = [[1,1000], [1,10000], [1,100000]];
            guessGame.target = Math.floor(Math.random() * levels[guessGame.level-1][1]) + 1;
            guessGame.attempts = 0;
            guessGame.min = levels[guessGame.level-1][0];
            guessGame.max = levels[guessGame.level-1][1];
            
            document.getElementById('guessLevel').textContent = guessGame.level;
            document.getElementById('guessMax').textContent = guessGame.max.toLocaleString();
            document.getElementById('guessAttempts').textContent = 0;
            document.getElementById('guessFeedback').textContent = '';
            document.getElementById('guessInput').value = '';
        }
        
        function makeGuess() {
            const guess = parseInt(document.getElementById('guessInput').value);
            if (!guess || guess < guessGame.min || guess > guessGame.max) {
                return document.getElementById('guessFeedback').textContent = '‚ùå –ß–∏—Å–ª–æ –≤–Ω–µ –¥–∏–∞–ø–∞–∑–æ–Ω–∞!';
            }
            
            guessGame.attempts++;
            document.getElementById('guessAttempts').textContent = guessGame.attempts;
            
            if (guess === guessGame.target) {
                const score = 1000 / guessGame.attempts;
                document.getElementById('guessFeedback').innerHTML = `üéâ –£–≥–∞–¥–∞–ª –∑–∞ ${guessGame.attempts} –ø–æ–ø—ã—Ç–æ–∫! +${Math.round(score)} –æ—á–∫–æ–≤`;
                
                // –†–µ–∫–æ—Ä–¥
                const high = storage.get(`guessHigh${guessGame.level}`) || Infinity;
                if (guessGame.attempts < high) {
                    storage.set(`guessHigh${guessGame.level}`, guessGame.attempts);
                    document.getElementById('guessHigh').textContent = guessGame.attempts;
                }
                
                // –¢—É—Ä–Ω–∏—Ä
                if (tournamentActive && currentUser) {
                    const scores = storage.get('tournamentScores') || {};
                    scores[currentUser] = (scores[currentUser] || 0) + Math.round(score);
                    storage.set('tournamentScores', scores);
                    updateTournamentBoard();
                }
                
                guessGame.level = Math.min(3, guessGame.level + 1);
                setTimeout(nextGuessLevel, 2000);
            } else if (guess < guessGame.target) {
                document.getElementById('guessFeedback').textContent = `üìà –ë–æ–ª—å—à–µ! (${guess})`;
                guessGame.min = guess + 1;
            } else {
                document.getElementById('guessFeedback').textContent = `üìâ –ú–µ–Ω—å—à–µ! (${guess})`;
                guessGame.max = guess - 1;
            }
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        if (storage.get('users')) {
            const savedUser = storage.get('currentUser');
            if (savedUser) {
                currentUser = savedUser;
                showMain();
                updateUserInfo();
            }
        }
        
        console.log('üåå ALEKSIN COSMIC GAMES HUB - –ü–æ–ª–Ω–∞—è –≤–µ—Ä—Å–∏—è –∑–∞–≥—Ä—É–∂–µ–Ω–∞!');
    </script>
</body>
</html>
