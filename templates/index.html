<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéÆ ALEKSIN GAMES HUB</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap');
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Orbitron', monospace;
            background: linear-gradient(-45deg, #0f0f23, #1a1a2e, #16213e, #0f3460);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
            height: 100vh; overflow: hidden;
            position: relative;
        }
        
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .stars {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="10" cy="10" r="1" fill="%23ffffff" opacity="0.8"/><circle cx="90" cy="20" r="0.5" fill="%23ffffff" opacity="0.6"/><circle cx="30" cy="80" r="1.5" fill="%23ffffff" opacity="0.9"/></svg>') repeat;
            animation: twinkle 3s linear infinite;
            pointer-events: none;
        }
        
        @keyframes twinkle { 0%, 100% { opacity: 0.5; } 50% { opacity: 1; } }
        
        .container {
            max-width: 1200px; margin: 0 auto; padding: 20px;
            display: flex; flex-direction: column; height: 100vh;
        }
        
        .header {
            text-align: center; color: #44ff44; text-shadow: 0 0 20px #44ff44;
            margin-bottom: 30px; animation: glow 2s ease-in-out infinite alternate;
        }
        
        @keyframes glow { from { text-shadow: 0 0 20px #44ff44; } to { text-shadow: 0 0 30px #44ff44, 0 0 40px #44ff44; } }
        
        h1 { font-size: clamp(2rem, 5vw, 4rem); font-weight: 900; margin-bottom: 10px; }
        
        #status {
            font-size: 1.5rem; padding: 15px 30px; border-radius: 50px;
            background: linear-gradient(45deg, rgba(68,255,68,0.2), rgba(0,255,0,0.1));
            border: 2px solid #44ff44; backdrop-filter: blur(10px);
            display: inline-block; transition: all 0.3s ease;
        }
        
        #status.logged { background: linear-gradient(45deg, rgba(0,255,0,0.3), rgba(68,255,68,0.4)); }
        
        .auth-buttons, .logout-btn {
            display: inline-flex; gap: 15px; margin: 20px 0;
        }
        
        .btn {
            padding: 15px 30px; border: none; border-radius: 50px; font-family: 'Orbitron', sans-serif;
            font-weight: 700; font-size: 1.1rem; cursor: pointer; transition: all 0.3s ease;
            background: linear-gradient(45deg, #44ff44, #00ff88); color: #000;
            box-shadow: 0 10px 30px rgba(68,255,68,0.4);
        }
        
        .btn:hover {
            transform: translateY(-3px) scale(1.05); box-shadow: 0 20px 40px rgba(68,255,68,0.6);
        }
        
        .logout-btn { background: linear-gradient(45deg, #ff4444, #ff8888); color: #fff; }
        
        #welcomeScreen, #gamesMenu, #dashboard {
            display: none; background: rgba(0,0,0,0.7); backdrop-filter: blur(20px);
            border-radius: 30px; padding: 40px; margin: 20px 0; border: 2px solid #44ff44;
        }
        
        #welcomeScreen { display: block; text-align: center; }
        
        .games-grid, .dashboard-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px; margin-top: 30px;
        }
        
        .game-card {
            background: linear-gradient(145deg, rgba(26,26,42,0.95), rgba(42,42,68,0.95));
            border: 3px solid rgba(68,255,68,0.5); border-radius: 30px; padding: 45px;
            text-align: center; cursor: pointer; transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            backdrop-filter: blur(20px); position: relative; overflow: hidden;
        }
        
        .game-card::before {
            content: ''; position: absolute; top: 0; left: -100%; width: 100%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(68,255,68,0.3), transparent);
            transition: left 0.6s;
        }
        
        .game-card:hover::before { left: 100%; }
        .game-card:hover {
            transform: translateY(-20px) scale(1.03); border-color: #44ff44;
            box-shadow: 0 30px 80px rgba(68,255,68,0.5);
        }
        
        .game-title { color: #44ff44; font-size: 1.8rem; font-weight: 700; margin-bottom: 15px; }
        .game-desc { color: #88ff88; line-height: 1.6; }
        
        .leaderboard, .tournament {
            background: linear-gradient(145deg, rgba(20,20,40,0.95), rgba(40,40,80,0.95));
            border-radius: 25px; padding: 30px; margin: 20px 0;
        }
        
        .list-item {
            display: flex; justify-content: space-between; padding: 15px;
            background: rgba(68,255,68,0.1); margin: 10px 0; border-radius: 15px;
            border-left: 4px solid #44ff44;
        }
        
        .modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8); backdrop-filter: blur(10px); z-index: 1000;
        }
        
        .modal-content {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            background: linear-gradient(145deg, #1a1a2e, #16213e); border-radius: 30px;
            padding: 50px; border: 3px solid #44ff44; width: 90%; max-width: 500px;
            box-shadow: 0 30px 100px rgba(68,255,68,0.5);
        }
        
        .input-field {
            width: 100%; padding: 20px; margin: 20px 0; border: 2px solid #44ff44;
            border-radius: 25px; background: rgba(0,0,0,0.5); color: #fff;
            font-family: 'Orbitron', sans-serif; font-size: 1.2rem; backdrop-filter: blur(10px);
        }
        
        .modal-buttons { display: flex; gap: 20px; justify-content: center; margin-top: 30px; }
        .btn-primary { background: linear-gradient(45deg, #44ff44, #00ff88); }
        .btn-secondary { background: linear-gradient(45deg, #666, #999); color: #fff; }
        
        canvas { border: 3px solid #44ff44; border-radius: 20px; background: #000; display: block; margin: 20px auto; }
        
        @media (max-width: 768px) {
            .games-grid, .dashboard-grid { grid-template-columns: 1fr; }
            .modal-content { padding: 30px; margin: 20px; }
        }
    </style>
</head>
<body class="stars">
    <div class="container">
        <div class="header">
            <h1>üéÆ ALEKSIN GAMES HUB</h1>
            <div id="status">üîí –ì–æ—Å—Ç—å üò¥</div>
            <div class="auth-buttons">
                <button class="btn" onclick="showModal('login')">üîë –í—Ö–æ–¥</button>
                <button class="btn" onclick="showModal('register')">üìù –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
            </div>
            <button id="logout" class="btn logout-btn" style="display:none;" onclick="logoutUser()">üö™ –í—ã—Ö–æ–¥</button>
        </div>

        <div id="welcomeScreen">
            <h2>üîí –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Å—è –∏–ª–∏ –≤–æ–π–¥–∏, —á—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å:</h2>
            <div class="games-grid">
                <div class="game-card">
                    <div class="game-title">üêç –ó–º–µ–π–∫–∞ –ü—Ä–æ</div>
                    <div class="game-desc">–°–≤–∞–π–ø—ã üì± ‚Ä¢ WASD ‚Ä¢ –ì—Ä–∞–¥–∏–µ–Ω—Ç ‚Ä¢ –¢–µ–ª–µ–ø–æ—Ä—Ç</div>
                </div>
                <div class="game-card">
                    <div class="game-title">üéØ –£–≥–∞–¥–∞–π 1-10000</div>
                    <div class="game-desc">üî• –û—á–µ–Ω—å –±–ª–∏–∑–∫–æ! ‚Ä¢ –ë–µ–∑–ª–∏–º–∏—Ç ‚Ä¢ –¢–æ–ø –æ—á–∫–æ–≤</div>
                </div>
            </div>
        </div>

        <div id="gamesMenu" class="games-grid">
            <div class="game-card" onclick="loadSnakeGame()">
                <div class="game-title">üêç –ó–º–µ–π–∫–∞ –ü—Ä–æ</div>
                <div class="game-desc">–°–≤–∞–π–ø—ã üì± ‚Ä¢ WASD ‚Ä¢ –ì—Ä–∞–¥–∏–µ–Ω—Ç ‚Ä¢ –¢–µ–ª–µ–ø–æ—Ä—Ç</div>
            </div>
            <div class="game-card" onclick="loadGuessGame()">
                <div class="game-title">üéØ –£–≥–∞–¥–∞–π 1-10000</div>
                <div class="game-desc">üî• –û—á–µ–Ω—å –±–ª–∏–∑–∫–æ! ‚Ä¢ –ë–µ–∑–ª–∏–º–∏—Ç ‚Ä¢ –¢–æ–ø –æ—á–∫–æ–≤</div>
            </div>
        </div>

        <div id="dashboard" style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
            <div class="leaderboard">
                <h3 style="color: #44ff44; margin-bottom: 20px;">üèÜ –¢–æ–ø-10 –∏–≥—Ä–æ–∫–æ–≤</h3>
                <div id="leaderboard-list">üîÑ –ó–∞–≥—Ä—É–∑–∫–∞...</div>
            </div>
            <div class="tournament">
                <h3 style="color: #ffaa00; margin-bottom: 20px;">‚öîÔ∏è –¢—É—Ä–Ω–∏—Ä (24—á)</h3>
                <div id="tournament-list">üîÑ –ó–∞–≥—Ä—É–∑–∫–∞...</div>
            </div>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–ö–ò –ê–í–¢–û–†–ò–ó–ê–¶–ò–ò -->
    <div id="authModal" class="modal">
        <div class="modal-content">
            <h2 id="modalTitle">üîë –í—Ö–æ–¥</h2>
            <input type="text" class="input-field" id="username" placeholder="üë§ –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
            <input type="password" class="input-field" id="password" placeholder="üîí –ü–∞—Ä–æ–ª—å">
            <div class="modal-buttons">
                <button class="btn btn-primary" id="submit-btn">üöÄ –í–æ–π—Ç–∏</button>
                <button class="btn btn-secondary" onclick="closeAuth()">‚ùå –û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>

    <script>
        let currentGame = ''; let isLoggedIn = false;
        let gameInterval = null; let snake = {x:20,y:20,dx:1,dy:0,cells:[],maxCells:4};
        let food = {x:15,y:15}; let secretNumber = 0; let attempts = 0;
        let statusInterval, leaderboardInterval;

        // üî• –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ü–†–ò –ó–ê–ì–†–£–ó–ö–ï
        window.addEventListener('load', () => {
            console.log('üéÆ –ó–ê–ü–£–°–ö ALEKSIN GAMES HUB');
            setTimeout(checkUserStatus, 500);
            statusInterval = setInterval(checkUserStatus, 2000);
            initButtons();
            setInterval(initButtons, 1000); // üî• –ù–ï–£–ù–ò–ß–¢–û–ñ–ò–ú–´–ï –ö–ù–û–ü–ö–ò
        });

        // üî• –ü–†–û–í–ï–†–ö–ê –°–¢–ê–¢–£–°–ê (–∫–∞–∂–¥—ã–µ 2 —Å–µ–∫)
        async function checkUserStatus() {
            try {
                const res = await fetch('/status', {credentials: 'include'});
                const data = await res.json();
                console.log('‚úÖ –°–¢–ê–¢–£–°:', data);
                
                if (data.logged_in && data.username) {
                    document.getElementById('status').innerHTML = `üëã ${data.username} ‚úì`;
                    document.getElementById('status').className = 'logged';
                    document.getElementById('logout').style.display = 'inline-block';
                    document.getElementById('welcomeScreen').style.display = 'none';
                    document.getElementById('gamesMenu').style.display = 'grid';
                    document.getElementById('dashboard').style.display = 'grid';
                    if (!leaderboardInterval) {
                        leaderboardInterval = setInterval(() => { loadLeaderboard(); loadTournament(); }, 30000);
                        loadLeaderboard(); loadTournament();
                    }
                } else {
                    document.getElementById('status').innerHTML = 'üîí –ì–æ—Å—Ç—å üò¥';
                    document.getElementById('status').className = '';
                    document.getElementById('logout').style.display = 'none';
                    document.getElementById('welcomeScreen').style.display = 'block';
                    document.getElementById('gamesMenu').style.display = 'none';
                    document.getElementById('dashboard').style.display = 'none';
                }
            } catch(err) {
                console.error('–°—Ç–∞—Ç—É—Å:', err);
            }
        }

        // üî• 5x –ù–ï–£–ù–ò–ß–¢–û–ñ–ò–ú–´–ï –ö–ù–û–ü–ö–ò
        function initButtons() {
            const btn = document.getElementById('submit-btn');
            if (btn && !btn.dataset.fixed) {
                btn.dataset.fixed = 'true';
                btn.onclick = submitAuth;
                btn.onmousedown = submitAuth;
                btn.ontouchstart = submitAuth;
                btn.addEventListener('click', submitAuth);
                btn.addEventListener('pointerdown', submitAuth);
            }
            
            const logoutBtn = document.getElementById('logout');
            if (logoutBtn) {
                logoutBtn.onclick = logoutUser;
                logoutBtn.onmousedown = logoutUser;
                logoutBtn.ontouchstart = logoutUser;
                logoutBtn.addEventListener('click', logoutUser);
                logoutBtn.addEventListener('pointerdown', logoutUser);
            }
        }

        function showModal(type) {
            document.getElementById('authModal').style.display = 'block';
            document.getElementById('modalTitle').textContent = type === 'login' ? 'üîë –í—Ö–æ–¥' : 'üìù –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è';
            document.getElementById('username').focus();
        }

        function closeAuth() {
            document.getElementById('authModal').style.display = 'none';
            document.getElementById('username').value = '';
            document.getElementById('password').value = '';
        }

        async function submitAuth() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            if (!username || !password) return alert('üë§ –ò–º—è –∏ üîí –ø–∞—Ä–æ–ª—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã!');
            
            const endpoint = document.getElementById('modalTitle').textContent.includes('–í—Ö–æ–¥') ? '/login' : '/register';
            
            try {
                const res = await fetch(endpoint, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    credentials: 'include',
                    body: JSON.stringify({username, password})
                });
                const data = await res.json();
                
                if (data.success) {
                    closeAuth();
                    checkUserStatus();
                } else {
                    alert(data.error || '‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞');
                }
            } catch(err) {
                alert('‚ùå –ù–µ—Ç —Å–≤—è–∑–∏ —Å —Å–µ—Ä–≤–µ—Ä–æ–º');
            }
        }

        // üî• –ì–ê–†–ê–ù–¢–ò–†–û–í–ê–ù–ù–´–ô –í–´–•–û–î
        async function logoutUser() {
            console.log('üö™ –í–´–•–û–î...');
            try {
                const res = await fetch('/logout', {method: 'POST', credentials: 'include'});
                const data = await res.json();
                if (data.success) {
                    document.getElementById('status').innerHTML = 'üîí –ì–æ—Å—Ç—å üò¥';
                    document.getElementById('status').className = '';
                    document.getElementById('logout').style.display = 'none';
                    document.getElementById('welcomeScreen').style.display = 'block';
                    document.getElementById('gamesMenu').style.display = 'none';
                    document.getElementById('dashboard').style.display = 'none';
                    if (leaderboardInterval) {
                        clearInterval(leaderboardInterval);
                        leaderboardInterval = null;
                    }
                    if (gameInterval) {
                        clearInterval(gameInterval);
                        gameInterval = null;
                    }
                    console.log('‚úÖ –í–´–®–ï–õ ‚Äî –ì–æ—Å—Ç—å');
                }
            } catch(err) {
                console.error('–í—ã—Ö–æ–¥:', err);
                location.reload();
            }
        }

        // üèÜ –¢–û–ü-10
        async function loadLeaderboard() {
            try {
                const res = await fetch('/leaderboard');
                const top = await res.json();
                const list = document.getElementById('leaderboard-list');
                list.innerHTML = top.length ? 
                    top.map((p, i) => `<div class="list-item"><span>#${i+1} ${p.username}</span><span>${p.score}</span></div>`).join('') :
                    '<div class="list-item">–ü—É—Å—Ç–æ üò¥</div>';
            } catch(err) {
                document.getElementById('leaderboard-list').innerHTML = '‚ùå –û—à–∏–±–∫–∞';
            }
        }

        // ‚öîÔ∏è –¢–£–†–ù–ò–† 24—á
        async function loadTournament() {
            try {
                const res = await fetch('/tournament');
                const top = await res.json();
                const list = document.getElementById('tournament-list');
                list.innerHTML = top.length ? 
                    top.map((p, i) => `<div class="list-item"><span>#${i+1} ${p.username}</span><span>${p.score}</span></div>`).join('') :
                    '<div class="list-item">–ù–∏–∫—Ç–æ –Ω–µ –∏–≥—Ä–∞–ª</div>';
            } catch(err) {
                document.getElementById('tournament-list').innerHTML = '‚ùå –û—à–∏–±–∫–∞';
            }
        }

        // üêç –ó–ú–ï–ô–ö–ê –ü–†–û
        function loadSnakeGame() {
            currentGame = 'snake';
            const html = `
                <canvas id="gameCanvas" width="400" height="400"></canvas>
                <div style="text-align:center;color:#44ff44;font-size:1.5rem;margin:20px 0;">
                    –û—á–∫–∏: <span id="snakeScore">0</span> | –°—á—ë—Ç: <span id="highScoreSnake">0</span>
                    <br><small>üì± –°–≤–∞–π–ø—ã | ‚Üë‚Üê‚Üì‚Üí WASD</small>
                </div>
                <button class="btn" onclick="saveSnakeScore()" style="margin:20px">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ —Ç–æ–ø</button>
            `;
            document.querySelector('#gamesMenu').innerHTML = html;
            initSnakeGame();
        }

        function initSnakeGame() {
            const canvas = document.getElementById('gameCanvas');
            const ctx = canvas.getContext('2d');
            let score = 0; let highScore = localStorage.getItem('snakeHigh') || 0;
            document.getElementById('highScoreSnake').textContent = highScore;

            function createFood() {
                food.x = Math.floor(Math.random() * 38) + 1;
                food.y = Math.floor(Math.random() * 38) + 1;
                for (let cell of snake.cells) {
                    if (cell.x === food.x && cell.y === food.y) createFood();
                }
            }

            function update() {
                ctx.fillStyle = 'rgb(0,0,0)';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                ctx.save();
                const gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
                gradient.addColorStop(0, '#00ff88');
                gradient.addColorStop(1, '#44ff44');
                ctx.fillStyle = gradient;
                ctx.fillRect(10 + food.x * 10, 10 + food.y * 10, 8, 8);
                ctx.restore();

                snake.x += snake.dx;
                snake.y += snake.dy;

                if (snake.x < 0) snake.x = 39;
                if (snake.x > 39) snake.x = 0;
                if (snake.y < 0) snake.y = 39;
                if (snake.y > 39) snake.y = 0;

                snake.cells.unshift({x: snake.x, y: snake.y});
                if (snake.cells.length > snake.maxCells) snake.cells.pop();

                if (snake.x === food.x && snake.y === food.y) {
                    snake.maxCells++;
                    score += 10;
                    document.getElementById('snakeScore').textContent = score;
                    createFood();
                }

                for (let cell of snake.cells) {
                    ctx.fillStyle = 'lime';
                    ctx.fillRect(10 + cell.x * 10, 10 + cell.y * 10, 8, 8);
                }

                if (score > highScore) {
                    highScore = score;
                    localStorage.setItem('snakeHigh', highScore);
                    document.getElementById('highScoreSnake').textContent = highScore;
                }
            }

            gameInterval = setInterval(update, 150);

            let touchStartX, touchStartY;
            canvas.addEventListener('touchstart', (e) => {
                e.preventDefault();
                touchStartX = e.touches[0].clientX;
                touchStartY = e.touches[0].clientY;
            }, {passive: false});

            canvas.addEventListener('touchend', (e) => {
                e.preventDefault();
                const diffX = touchStartX - e.changedTouches[0].clientX;
                const diffY = touchStartY - e.changedTouches[0].clientY;
                if (Math.abs(diffX) > Math.abs(diffY) && Math.abs(diffX) > 30) {
                    if (diffX > 0 && snake.dx !== 1) { snake.dx = -1; snake.dy = 0; }
                    else if (diffX < 0 && snake.dx !== -1) { snake.dx = 1; snake.dy = 0; }
                } else if (Math.abs(diffY) > 30) {
                    if (diffY > 0 && snake.dy !== 1) { snake.dx = 0; snake.dy = -1; }
                    else if (diffY < 0 && snake.dy !== -1) { snake.dx = 0; snake.dy = 1; }
                }
            }, {passive: false});

            document.addEventListener('keydown', (e) => {
                if (currentGame !== 'snake') return;
                switch(e.key.toLowerCase()) {
                    case 'arrowleft':  if (snake.dx !== 1) { snake.dx = -1; snake.dy = 0; } break;
                    case 'arrowup':    if (snake.dy !== 1) { snake.dx = 0; snake.dy = -1; } break;
                    case 'arrowright': if (snake.dx !== -1) { snake.dx = 1; snake.dy = 0; } break;
                    case 'arrowdown':  if (snake.dy !== -1) { snake.dx = 0; snake.dy = 1; } break;
                    case 'a': if (snake.dx !== 1) { snake.dx = -1; snake.dy = 0; } break;
                    case 'w': if (snake.dy !== 1) { snake.dx = 0; snake.dy = -1; } break;
                    case 'd': if (snake.dx !== -1) { snake.dx = 1; snake.dy = 0; } break;
                    case 's': if (snake.dy !== -1) { snake.dx = 0; snake.dy = 1; } break;
                }
            });
        }

        function saveSnakeScore() {
            const score = parseInt(document.getElementById('snakeScore').textContent) || 0;
            fetch('/save_score', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                credentials: 'include',
                body: JSON.stringify({game: 'snake', score})
            }).then(res => res.json()).then(data => {
                if (data.success) {
                    alert(`‚úÖ ${score} –æ—á–∫–æ–≤ –≤ —Ç–æ–ø!`);
                    loadSnakeGame();
                }
            });
        }

        // üéØ –£–ì–ê–î–ê–ô–ö–ê 1-10000
        function loadGuessGame() {
            currentGame = 'guess';
            secretNumber = Math.floor(Math.random() * 10000) + 1;
            attempts = 0;
            const html = `
                <h2 style="color:#44ff44;text-align:center;">üéØ –£–≥–∞–¥–∞–π —á–∏—Å–ª–æ –æ—Ç 1 –¥–æ 10000</h2>
                <canvas id="guessCanvas" width="400" height="200" style="margin:20px auto;display:block;"></canvas>
                <div style="text-align:center;">
                    <input type="number" id="guessInput" min="1" max="10000" 
                           style="padding:15px;width:200px;font-size:1.5rem;border:2px solid #44ff44;border-radius:20px;background:rgba(0,0,0,0.7);color:#44ff44;font-family:'Orbitron';">
                    <br><button class="btn" onclick="checkGuess()" style="margin:20px;font-size:1.2rem;">üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
                    <div id="guessFeedback" style="font-size:2rem;color:#44ff44;margin:20px;font-weight:700;"></div>
                    <div>–•–æ–¥–æ–≤: <span id="attempts">0</span> | –û—á–∫–∏: <span id="guessScore">10000</span></div>
                    <button class="btn" onclick="newGame()">üîÑ –ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
                    <br><button class="btn" onclick="saveGuessScore()" style="margin-top:20px;">üíæ –í —Ç–æ–ø</button>
                </div>
            `;
            document.querySelector('#gamesMenu').innerHTML = html;
            document.getElementById('guessInput').focus();
        }

        function checkGuess() {
            const guess = parseInt(document.getElementById('guessInput').value);
            attempts++;
            document.getElementById('attempts').textContent = attempts;
            
            const score = Math.max(0, 10000 - attempts * 5);
            document.getElementById('guessScore').textContent = score;

            const diff = Math.abs(guess - secretNumber);
            let feedback = '';

            if (diff === 0) {
                feedback = `üéâ –£–ì–ê–î–ê–õ! ${secretNumber} –∑–∞ ${attempts} —Ö–æ–¥–æ–≤! üî•`;
                document.getElementById('guessFeedback').style.color = '#ffd700';
            } else if (diff <= 50) {
                feedback = 'üî• –û–ß–ï–ù–¨ –ë–õ–ò–ó–ö–û!';
                document.getElementById('guessFeedback').style.color = '#ffaa00';
            } else if (diff <= 200) {
                feedback = guess < secretNumber ? '‚ûï –ë–æ–ª—å—à–µ!' : '‚ûñ –ú–µ–Ω—å—à–µ!';
                document.getElementById('guessFeedback').style.color = '#44ff44';
            } else {
                feedback = guess < secretNumber ? 'üìà –ù–∞–º–Ω–æ–≥–æ –±–æ–ª—å—à–µ!' : 'üìâ –ù–∞–º–Ω–æ–≥–æ –º–µ–Ω—å—à–µ!';
                document.getElementById('guessFeedback').style.color = '#8888ff';
            }

            document.getElementById('guessFeedback').textContent = feedback;
            document.getElementById('guessInput').value = '';
            document.getElementById('guessInput').focus();
        }

        function newGame() {
            secretNumber = Math.floor(Math.random() * 10000) + 1;
            attempts = 0;
            document.getElementById('attempts').textContent = 0;
            document.getElementById('guessScore').textContent = 10000;
            document.getElementById('guessFeedback').textContent = '';
            document.getElementById('guessInput').focus();
        }

        function saveGuessScore() {
            const score = parseInt(document.getElementById('guessScore').textContent) || 0;
            fetch('/save_score', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                credentials: 'include',
                body: JSON.stringify({game: 'guess', score})
            }).then(res => res.json()).then(data => {
                if (data.success) {
                    alert(`‚úÖ ${score} –æ—á–∫–æ–≤ –≤ —Ç–æ–ø!`);
                    loadGuessGame();
                }
            });
        }

        // Enter –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞
        document.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && currentGame === 'guess') checkGuess();
        });
    </script>
</body>
</html>
