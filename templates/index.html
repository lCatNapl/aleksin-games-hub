<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üåå ALEKSIN GAMES ARENA</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap');
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:'Orbitron',monospace;background:linear-gradient(135deg,#0a0a23 0%,#1a0a3a 50%,#000 100%);color:#00ffcc;min-height:100vh;overflow-x:hidden;position:relative}
        .stars{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:1}
        .star{position:absolute;background:#fff;border-radius:50%;animation:twinkle 2s infinite}
        @keyframes twinkle{0%,100%{opacity:0.4}50%{opacity:1}}
        .container{max-width:1200px;margin:0 auto;padding:15px;position:relative;z-index:10}
        .title{font-size:clamp(2rem,7vw,4rem);text-align:center;margin:20px 0;background:linear-gradient(45deg,#ff00ff,#00ffcc,#ffff00);-webkit-background-clip:text;-webkit-text-fill-color:transparent;text-shadow:0 0 30px #00ffcc}
        .glass{background:rgba(255,255,255,0.08);backdrop-filter:blur(15px);border:1px solid rgba(0,255,204,0.3);border-radius:20px;padding:25px;margin:15px 0;box-shadow:0 15px 40px rgba(0,0,0,0.6)}
        input,select,button{font-family:'Orbitron',sans-serif;padding:12px 20px;font-size:1rem;border:2px solid rgba(0,255,204,0.5);border-radius:12px;background:rgba(0,0,0,0.5);color:#00ffcc;transition:all 0.3s}
        input:focus,select:focus{outline:none;border-color:#00ffcc;box-shadow:0 0 20px rgba(0,255,204,0.5)}
        button{cursor:pointer;font-weight:700;text-transform:uppercase;letter-spacing:1px}
        button:hover{transform:translateY(-2px);box-shadow:0 10px 25px rgba(0,255,204,0.4)}
        .btn-danger{background:linear-gradient(45deg,#ff416c,#ff4b2b);color:#fff;border-color:#ff416c}
        .games-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(320px,1fr));gap:20px}
        .game-card{text-align:center}
        .game-title{font-size:1.6rem;margin-bottom:15px;background:linear-gradient(45deg,#00ffcc,#ff00ff);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
        canvas{border:3px solid rgba(0,255,204,0.6);border-radius:15px;background:rgba(0,10,30,0.95);box-shadow:0 0 30px rgba(0,255,204,0.3);display:block;margin:15px auto}
        .stats{display:flex;justify-content:space-around;margin:15px 0;font-weight:700}
        .tabs{display:flex;flex-wrap:wrap;gap:10px;margin-bottom:20px}
        .tab-btn{padding:12px 25px;background:rgba(0,255,204,0.1);border:2px solid rgba(0,255,204,0.3)}
        .tab-btn.active{background:linear-gradient(45deg,#00ffcc,#00aaff);color:#000;border-color:#00ffcc}
        table{width:100%;border-collapse:collapse;font-size:0.95rem}
        th{padding:12px;background:rgba(0,255,204,0.1);border-bottom:2px solid rgba(0,255,204,0.3);text-align:left}
        td{padding:10px;border-bottom:1px solid rgba(0,255,204,0.1)}
        .medal-0::before{content:"ü•á";font-size:1.3rem}
        .medal-1::before{content:"ü•à";font-size:1.3rem}
        .medal-2::before{content:"ü•â";font-size:1.3rem}
        .hidden{display:none!important}
        @media(max-width:768px){.container{padding:10px}.games-grid{grid-template-columns:1fr}}
    </style>
</head>
<body>
    <div class="stars" id="stars"></div>
    <div class="container">
        <h1 class="title">üåå ALEKSIN GAMES ARENA</h1>
        
        <!-- –õ–æ–≥–∏–Ω -->
        <div id="login" class="glass">
            <input id="user" placeholder="üë§ –ù–∏–∫–Ω–µ–π–º" value="alexin">
            <input id="pass" type="password" placeholder="üîë –ü–∞—Ä–æ–ª—å" value="123">
            <button onclick="login()">üöÄ –í–û–ô–¢–ò</button>
        </div>
        
        <!-- –ò–≥—Ä—ã -->
        <div id="games" class="hidden">
            <div class="games-grid">
                <div class="game-card">
                    <h3 class="game-title">üêç –ó–ú–ï–ô–ö–ê PRO</h3>
                    <select id="snakeDiff">
                        <option value="snake-easy">–õ–µ–≥–∫–æ (250–º—Å)</option>
                        <option value="snake-normal" selected>–ù–æ—Ä–º–∞–ª—å–Ω–æ (180–º—Å)</option>
                        <option value="snake-hard">–•–∞—Ä–¥–∫–æ—Ä (120–º—Å)</option>
                    </select>
                    <button onclick="startSnake()">üéÆ –ò–ì–†–ê–¢–¨</button>
                    <canvas id="snakeCanvas" width="400" height="400"></canvas>
                    <div class="stats">
                        <span>–°—á—ë—Ç: <span id="snakeScore">0</span></span>
                        <span>–†–µ–∫–æ—Ä–¥: <span id="snakeBest">0</span></span>
                    </div>
                </div>
                
                <div class="game-card">
                    <h3 class="game-title">üî¢ –£–ì–ê–î–ê–ô–ö–ê MASTER</h3>
                    <select id="guessDiff">
                        <option value="guess-easy">–õ–µ–≥–∫–æ (1-100)</option>
                        <option value="guess-normal" selected>–ù–æ—Ä–º–∞–ª—å–Ω–æ (1-1000)</option>
                        <option value="guess-hard">–•–∞—Ä–¥ (1-10000)</option>
                    </select>
                    <input id="guessNum" placeholder="üéØ –ß–∏—Å–ª–æ" style="width:200px;margin:10px 0">
                    <div>
                        <button onclick="makeGuess()">üîç –£–ì–ê–î–ê–¢–¨</button>
                        <button onclick="newGuess()" style="margin-left:10px">üîÑ –ù–û–í–ê–Ø</button>
                    </div>
                    <div class="stats">
                        <span>–ü–æ–ø—ã—Ç–∫–∏: <span id="guessCnt">0</span></span>
                        <span id="guessRange">1-1000</span>
                    </div>
                    <div id="guessHint" style="margin-top:15px;font-size:1.1rem"></div>
                </div>
            </div>
            <div style="text-align:center">
                <button class="btn-danger" onclick="logout()">üö™ –í–´–•–û–î</button>
                <button onclick="showLeaderboard()">üèÜ –õ–ò–î–ï–†–ë–û–†–î–´</button>
            </div>
        </div>
        
        <!-- –õ–∏–¥–µ—Ä–±–æ—Ä–¥—ã -->
        <div id="leaderboard" class="hidden">
            <div class="tabs">
                <button class="tab-btn active" onclick="showTab('all')">üåü –ì–ª–æ–±–∞–ª—å–Ω—ã–π</button>
                <button class="tab-btn" onclick="showTab('snake')">üêç –ó–º–µ–π–∫–∞</button>
                <button class="tab-btn" onclick="showTab('guess')">üî¢ –£–≥–∞–¥–∞–π–∫–∞</button>
                <button class="tab-btn" onclick="showTab('tournament')">‚öîÔ∏è –¢—É—Ä–Ω–∏—Ä</button>
            </div>
            
            <div id="allTab" class="glass">
                <h3>üèÜ –ì–õ–û–ë–ê–õ–¨–ù–´–ô –¢–û–ü-10 (–í–°–ï –ò–ì–†–´)</h3>
                <table><thead><tr><th>–ú–µ—Å—Ç–æ</th><th>–ò–≥—Ä–æ–∫</th><th>–û—á–∫–∏</th><th>–ò–≥—Ä–∞+–°–ª–æ–∂–Ω–æ—Å—Ç—å</th></tr></thead><tbody id="allTop"></tbody></table>
            </div>
            
            <div id="snakeTab" class="glass hidden">
                <h3>üêç –¢–û–ü–´ –ó–ú–ï–ô–ö–ò –ü–û –°–õ–û–ñ–ù–û–°–¢–Ø–ú</h3>
                <table><thead><tr><th>–°–ª–æ–∂–Ω–æ—Å—Ç—å</th><th>1-–µ</th><th>2-–µ</th><th>3-–µ</th></tr></thead><tbody id="snakeTops"></tbody></table>
            </div>
            
            <div id="guessTab" class="glass hidden">
                <h3>üî¢ –¢–û–ü–´ –£–ì–ê–ô–î–ö–ò –ü–û –°–õ–û–ñ–ù–û–°–¢–Ø–ú</h3>
                <table><thead><tr><th>–°–ª–æ–∂–Ω–æ—Å—Ç—å</th><th>1-–µ (–ø–æ–ø—ã—Ç–∫–∏)</th><th>2-–µ</th><th>3-–µ</th></tr></thead><tbody id="guessTops"></tbody></table>
            </div>
            
            <div id="tournamentTab" class="glass hidden">
                <h3>‚öîÔ∏è –ê–ö–¢–ò–í–ù–´–ô –¢–£–†–ù–ò–† (24—á)</h3>
                <button id="joinBtn" onclick="joinTournament()">‚öîÔ∏è –ü–†–ò–°–û–ï–î–ò–ù–ò–¢–¨–°–Ø</button>
                <table><thead><tr><th>–ú–µ—Å—Ç–æ</th><th>–ò–≥—Ä–æ–∫</th><th>–¢—É—Ä–Ω–∏—Ä–Ω—ã–µ –æ—á–∫–∏</th></tr></thead><tbody id="tourTop"></tbody></table>
            </div>
            
            <div style="text-align:center;margin-top:20px">
                <button onclick="showGames()">üéÆ –ò–ì–†–´</button>
            </div>
        </div>
    </div>

    <script>
        let user='',snakeInt=null,guessNum=0,guessMax=1000,guessCnt=0;
        let tournamentPlayers=new Set(),tournamentScores={};
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        function init(){for(let i=0;i<120;i++){let s=document.createElement('div');s.className='star';s.style.left=Math.random()*100+'%';s.style.top=Math.random()*100+'%';s.style.width=s.style.height=(Math.random()*2.5+0.8)+'px';document.getElementById('stars').appendChild(s)}}
        
        // –õ–æ–≥–∏–Ω
        function login(){user=document.getElementById('user').value;localStorage.user=user;document.getElementById('login').classList.add('hidden');document.getElementById('games').classList.remove('hidden');loadBest();updateAllTops()}
        function logout(){if(snakeInt)clearInterval(snakeInt);document.getElementById('games').classList.add('hidden');document.getElementById('login').classList.remove('hidden')}
        
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ –∏–≥—Ä–∞–º+—Å–ª–æ–∂–Ω–æ—Å—Ç—è–º
        function saveScore(category,score){
            let scores=JSON.parse(localStorage.getItem(category)||'[]');
            scores.push({user,score,date:Date.now()});
            scores.sort((a,b)=>b.score-a.score);
            // –£–ë–ò–†–ê–ï–ú –î–£–ë–õ–ò –ù–ò–ö–û–í - —Ç–æ–ª—å–∫–æ –ª—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            let uniqueScores=[],seenUsers=new Set();
            for(let s of scores.slice(0,10)){
                if(!seenUsers.has(s.user)){uniqueScores.push(s);seenUsers.add(s.user)}
            }
            localStorage.setItem(category,JSON.stringify(uniqueScores));
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –ª–∏—á–Ω—ã—Ö —Ä–µ–∫–æ—Ä–¥–æ–≤
        function loadBest(){
            let best=0;
            ['snake-easy','snake-normal','snake-hard'].forEach(cat=>{
                let scores=JSON.parse(localStorage.getItem(cat)||'[]');
                let myScore=scores.find(s=>s.user===user);
                if(myScore&&myScore.score>best)best=myScore.score;
            });
            document.getElementById('snakeBest').textContent=best;
        }
        
        // –ó–º–µ–π–∫–∞
        function startSnake(){
            let c=document.getElementById('snakeCanvas'),x=c.getContext('2d');
            c.classList.remove('hidden');
            let grid=20,cols=20,rows=20,snake=[{x:10,y:10}],dx=1,dy=0,food={x:15,y:15},score=0;
            let diff=document.getElementById('snakeDiff').value,speed=diff==='snake-easy'?250:diff==='snake-normal'?180:120;
            
            snakeInt=setInterval(()=>{
                x.fillStyle='#0a1428';x.fillRect(0,0,400,400);
                let head={x:snake[0].x+dx,y:snake[0].y+dy};
                if(head.x<0||head.x>=cols||head.y<0||head.y>=rows||snake.some(p=>p.x===head.x&&p.y===head.y)){
                    clearInterval(snakeInt);saveScore(diff,score);alert(`–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞!\n${score} –æ—á–∫–æ–≤`);c.classList.add('hidden');loadBest();updateAllTops();return;
                }
                snake.unshift(head);
                if(head.x===food.x&&head.y===food.y){score++;food={x:Math.floor(Math.random()*cols),y:Math.floor(Math.random()*rows)}}else snake.pop();
                document.getElementById('snakeScore').textContent=score;
                
                x.fillStyle='#ff00ff';x.beginPath();x.arc(food.x*grid+10,food.y*grid+10,8,0,Math.PI*2);x.fill();
                snake.forEach((p,i)=>{x.fillStyle=i===0?'#00ff88':'#44aa88';x.fillRect(p.x*grid+2,p.y*grid+2,16,16)});
            },speed);
            
            document.onkeydown=e=>{
                if(e.key==='ArrowUp'&&dy!==1){dx=0;dy=-1}
                if(e.key==='ArrowDown'&&dy!==-1){dx=0;dy=1}
                if(e.key==='ArrowLeft'&&dx!==1){dx=-1;dy=0}
                if(e.key==='ArrowRight'&&dx!==-1){dx=1;dy=0}
            }
        }
        
        // –£–≥–∞–¥–∞–π–∫–∞
        function newGuess(){
            guessMax=document.getElementById('guessDiff').value==='guess-easy'?100:document.getElementById('guessDiff').value==='guess-normal'?1000:10000;
            guessNum=Math.floor(Math.random()*guessMax)+1;guessCnt=0;
            document.getElementById('guessCnt').textContent='0';
            document.getElementById('guessRange').textContent=`1-${guessMax}`;
            document.getElementById('guessHint').textContent='üéØ –ù–∞—á–Ω–∏ —É–≥–∞–¥—ã–≤–∞—Ç—å!';
        }
        function makeGuess(){
            let n=parseInt(document.getElementById('guessNum').value),diff=document.getElementById('guessDiff').value;
            if(!n||n<1||n>guessMax){document.getElementById('guessHint').textContent='‚ùå 1-'+guessMax;return}
            guessCnt++;document.getElementById('guessCnt').textContent=guessCnt;
            let delta=Math.abs(guessNum-n);
            if(n===guessNum){
                let score=Math.max(0,1000-guessCnt*10);saveScore(diff,score);
                document.getElementById('guessHint').innerHTML=`üéâ –£–ì–ê–î–ê–õ –∑–∞ <strong>${guessCnt}</strong> –ø–æ–ø—ã—Ç–æ–∫!`;
                setTimeout(newGuess,2000);
            }else if(delta<=3)document.getElementById('guessHint').innerHTML=n<guessNum?'üî• –û–ß–ï–ù–¨ –±–ª–∏–∑–∫–æ! ‚ûï':'üî• –û–ß–ï–ù–¨ –±–ª–∏–∑–∫–æ! ‚ûñ';
            else if(delta<=15)document.getElementById('guessHint').innerHTML=n<guessNum?'üå°Ô∏è –ë–ª–∏–∑–∫–æ! ‚ûï':'üå°Ô∏è –ë–ª–∏–∑–∫–æ! ‚ûñ';
            else document.getElementById('guessHint').innerHTML=n<guessNum?'‚ûï –ë–æ–ª—å—à–µ':'‚ûñ –ú–µ–Ω—å—à–µ';
            document.getElementById('guessNum').value='';
        }
        
        // –õ–∏–¥–µ—Ä–±–æ—Ä–¥—ã
        function updateAllTops(){
            // –ì–ª–æ–±–∞–ª—å–Ω—ã–π —Ç–æ–ø
            let all=[],cats=Object.keys(localStorage).filter(k=>k.match(/^snake-|guess-/));
            cats.forEach(cat=>{
                JSON.parse(localStorage.getItem(cat)||'[]').slice(0,3).forEach(s=>{
                    all.push({...s,cat:cat.replace(/snake-|guess-/,'').replace(/-/,' ').toUpperCase()});
                })
            });
            all.sort((a,b)=>b.score-a.score);
            let uniqueAll=[],seen=new Set();
            all.forEach(s=>{if(!seen.has(s.user)){uniqueAll.push(s);seen.add(s.user)}});
            document.getElementById('allTop').innerHTML=uniqueAll.slice(0,10).map((s,i)=`<tr><td class="medal-${i}">${i+1}</td><td>${s.user}</td><td>${s.score}</td><td>${s.cat}</td></tr>`).join('');
            
            // –ó–º–µ–π–∫–∞ –ø–æ —Å–ª–æ–∂–Ω–æ—Å—Ç—è–º
            let snakeTops='<tr><td>–õ–µ–≥–∫–æ</td><td>'+getTop('snake-easy')+'</td><td>'+getTop('snake-easy',1)+'</td><td>'+getTop('snake-easy',2)+'</td></tr>'+
                          '<tr><td>–ù–æ—Ä–º–∞–ª—å–Ω–æ</td><td>'+getTop('snake-normal')+'</td><td>'+getTop('snake-normal',1)+'</td><td>'+getTop('snake-normal',2)+'</td></tr>'+
                          '<tr><td>–•–∞—Ä–¥–∫–æ—Ä</td><td>'+getTop('snake-hard')+'</td><td>'+getTop('snake-hard',1)+'</td><td>'+getTop('snake-hard',2)+'</td></tr>';
            document.getElementById('snakeTops').innerHTML=snakeTops;
            
            // –£–≥–∞–¥–∞–π–∫–∞ –ø–æ —Å–ª–æ–∂–Ω–æ—Å—Ç—è–º
            let guessTops='<tr><td>–õ–µ–≥–∫–æ</td><td>'+getTop('guess-easy')+'</td><td>'+getTop('guess-easy',1)+'</td><td>'+getTop('guess-easy',2)+'</td></tr>'+
                          '<tr><td>–ù–æ—Ä–º–∞–ª—å–Ω–æ</td><td>'+getTop('guess-normal')+'</td><td>'+getTop('guess-normal',1)+'</td><td>'+getTop('guess-normal',2)+'</td></tr>'+
                          '<tr><td>–•–∞—Ä–¥</td><td>'+getTop('guess-hard')+'</td><td>'+getTop('guess-hard',1)+'</td><td>'+getTop('guess-hard',2)+'</td></tr>';
            document.getElementById('guessTops').innerHTML=guessTops;
            
            // –¢—É—Ä–Ω–∏—Ä (—É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∏–≥—Ä–æ–∫–∏)
            let tourPlayers=Array.from(tournamentPlayers).sort((a,b)=>tournamentScores[b]||0-(tournamentScores[a]||0));
            document.getElementById('tourTop').innerHTML=tourPlayers.slice(0,10).map((u,i)=`<tr><td class="medal-${i}">${i+1}</td><td>${u}</td><td>${tournamentScores[u]||0}</td></tr>`).join('');
        }
        function getTop(cat,pos=0){
            let scores=JSON.parse(localStorage.getItem(cat)||'[]');
            return pos<scores.length?scores[pos].user+' ('+scores[pos].score+')':'-';
        }
        
        // –¢—É—Ä–Ω–∏—Ä
        function joinTournament(){
            tournamentPlayers.add(user);tournamentScores[user]=(tournamentScores[user]||0)+100;
            document.getElementById('joinBtn').innerHTML='‚úÖ –í –¢–£–†–ù–ò–†–ï';document.getElementById('joinBtn').disabled=true;
            updateAllTops();
        }
        
        // –í–∫–ª–∞–¥–∫–∏
        function showTab(tab){
            document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('active'));
            event.target.classList.add('active');
            document.querySelectorAll('[id$="Tab"]').forEach(t=>t.classList.add('hidden'));
            document.getElementById(tab+'Tab').classList.remove('hidden');
        }
        function showLeaderboard(){document.getElementById('games').classList.add('hidden');document.getElementById('leaderboard').classList.remove('hidden');document.querySelector('.tab-btn.active').click();updateAllTops()}
        function showGames(){document.getElementById('leaderboard').classList.add('hidden');document.getElementById('games').classList.remove('hidden')}
        
        // –°—Ç–∞—Ä—Ç
        window.onload=()=>{
            init();
            if(localStorage.user){document.getElementById('user').value=localStorage.user;login()}
            newGuess();
            setInterval(updateAllTops,15000);
        }
    </script>
</body>
</html>
