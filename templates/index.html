<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéÆ ALEKSIN GAMES HUB 2026 ‚ú®</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Exo+2:wght@300;400;600;800&display=swap');
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Exo 2', sans-serif;
            background: linear-gradient(-45deg, #0f0f23, #1a0033, #2d004f, #0f0f23);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
            color: #fff;
            min-height: 100vh;
            overflow-x: hidden;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .title {
            font-family: 'Orbitron', monospace;
            font-size: clamp(2.5rem, 8vw, 5rem);
            background: linear-gradient(45deg, #00ff88, #00bfff, #ff00ff, #ffff00);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 0 30px rgba(0, 255, 136, 0.5);
            animation: neonGlow 2s ease-in-out infinite alternate;
            margin-bottom: 20px;
        }

        @keyframes neonGlow {
            from { filter: drop-shadow(0 0 10px #00ff88); }
            to { filter: drop-shadow(0 0 20px #00ff88); }
        }

        .subtitle {
            font-size: 1.5rem;
            color: #00ff88;
            text-shadow: 0 0 15px rgba(0, 255, 136, 0.3);
        }

        /* üîê –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø */
        #authSection {
            display: block;
            max-width: 500px;
            margin: 0 auto;
            padding: 50px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5);
        }

        #loginPrompt {
            text-align: center;
            font-size: 1.8rem;
            color: #00ff88;
            margin-bottom: 30px;
        }

        .auth-input {
            width: 100%;
            padding: 20px;
            margin: 15px 0;
            border: none;
            border-radius: 15px;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            color: #fff;
            font-size: 1.2rem;
            font-family: 'Exo 2', sans-serif;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .auth-input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        .auth-input:focus {
            outline: none;
            border-color: #00ff88;
            box-shadow: 0 0 20px rgba(0, 255, 136, 0.4);
        }

        .btn {
            width: 100%;
            padding: 20px;
            margin: 10px 0;
            border: none;
            border-radius: 15px;
            font-size: 1.3rem;
            font-weight: 600;
            font-family: 'Exo 2', sans-serif;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn-primary {
            background: linear-gradient(45deg, #00ff88, #00bfff);
            color: #000;
            box-shadow: 0 10px 30px rgba(0, 255, 136, 0.4);
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(0, 255, 136, 0.6);
        }

        .btn-secondary {
            background: linear-gradient(45deg, #ff4757, #ff6b7a);
            color: #fff;
        }

        .btn-secondary:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(255, 71, 87, 0.6);
        }

        /* üéÆ –û–°–ù–û–í–ù–û–ô –ö–û–ù–¢–ï–ù–¢ */
        #gamesSection, #userInfo {
            display: none;
        }

        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            margin-bottom: 50px;
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            padding: 30px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.4s ease;
            position: relative;
            overflow: hidden;
        }

        .glass-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.6s;
        }

        .glass-card:hover::before {
            left: 100%;
        }

        .glass-card:hover {
            transform: translateY(-15px);
            box-shadow: 0 30px 60px rgba(0, 0, 0, 0.6);
        }

        .game-icon {
            font-size: 4rem;
            margin-bottom: 20px;
            text-shadow: 0 0 20px currentColor;
        }

        .game-title {
            font-family: 'Orbitron', monospace;
            font-size: 2rem;
            margin-bottom: 15px;
            color: #00ff88;
        }

        .features {
            margin-bottom: 25px;
        }

        .feature {
            display: inline-block;
            background: rgba(0, 255, 136, 0.2);
            padding: 8px 15px;
            margin: 5px;
            border-radius: 20px;
            font-size: 0.9rem;
            color: #00ff88;
        }

        /* üèÜ –õ–ò–î–ï–†–ë–û–†–î–´ */
        .leaderboards {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 50px;
        }

        .leaderboard-card {
            background: rgba(0, 255, 136, 0.1);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            padding: 30px;
            border: 1px solid rgba(0, 255, 136, 0.3);
        }

        .lb-title {
            font-family: 'Orbitron', monospace;
            font-size: 1.8rem;
            text-align: center;
            margin-bottom: 25px;
            color: #ffd700;
            text-shadow: 0 0 15px rgba(255, 215, 0, 0.5);
        }

        .lb-list {
            list-style: none;
            max-height: 400px;
            overflow-y: auto;
        }

        .lb-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            margin: 10px 0;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            transition: all 0.3s ease;
        }

        .lb-item:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateX(10px);
        }

        .rank {
            font-weight: bold;
            font-size: 1.3rem;
            color: #ffd700;
        }

        .top-3 .rank {
            color: #ffd700;
            text-shadow: 0 0 10px #ffd700;
        }

        /* üéØ –ò–ì–†–û–í–´–ï –≠–ö–†–ê–ù–´ */
        .game-screen {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .game-container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            padding: 40px;
            max-width: 90%;
            max-height: 90%;
            overflow-y: auto;
        }

        canvas {
            border: 3px solid #00ff88;
            border-radius: 15px;
            box-shadow: 0 0 30px rgba(0, 255, 136, 0.5);
            background: #000;
        }

        /* üì± –ú–û–ë–ê–ô–õ */
        @media (max-width: 768px) {
            .games-grid {
                grid-template-columns: 1fr;
            }
            .leaderboards {
                grid-template-columns: 1fr;
            }
            .container {
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- üîê –ë–õ–û–ö –ê–í–¢–û–†–ò–ó–ê–¶–ò–ò -->
        <div id="authSection">
            <div id="loginPrompt">üîê –í–û–ô–î–ò –ò –°–¢–ê–ù–¨ –õ–ï–ì–ï–ù–î–û–ô –ê–õ–ï–ö–°–ò–ù–ê!</div>
            
            <div id="loginForm">
                <input type="text" id="usernameInput" class="auth-input" placeholder="üëë –ù–∏–∫–Ω–µ–π–º" maxlength="20">
                <input type="password" id="passwordInput" class="auth-input" placeholder="üîë –ü–∞—Ä–æ–ª—å (–º–∏–Ω–∏–º—É–º 4 —Å–∏–º–≤–æ–ª–∞)">
                <button class="btn btn-primary" onclick="login()">üöÄ –í–û–ô–¢–ò</button>
                <button class="btn btn-secondary" onclick="register()">‚ûï –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø</button>
            </div>

            <div id="statusMessage" style="text-align: center; margin-top: 20px; font-size: 1.2rem;"></div>
        </div>

        <!-- üë§ –ò–ù–§–û –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø -->
        <div id="userInfo" class="header">
            <div style="font-size: 1.5rem; color: #00ff88;">
                üëë <span id="currentUser"></span> ‚Äî –õ–ï–ì–ï–ù–î–ê –ê–õ–ï–ö–°–ò–ù–ê!
            </div>
            <button class="btn btn-secondary" onclick="logout()" style="width: auto; padding: 10px 25px; display: inline-block;">üö™ –í–´–•–û–î</button>
        </div>

        <!-- üéÆ –û–°–ù–û–í–ù–û–ô –ö–û–ù–¢–ï–ù–¢ -->
        <div id="gamesSection">
            <div class="header">
                <h1 class="title">ALEKSIN GAMES HUB 2026</h1>
                <p class="subtitle">‚öîÔ∏è –¢–£–†–ù–ò–†–´ | üêç –ó–ú–ï–ô–ö–ê PRO | üéØ –£–ì–ê–î–ê–ô –ß–ò–°–õ–û | üèÜ –¢–û–ü-100</p>
            </div>

            <div class="games-grid">
                <!-- üêç –ó–ú–ï–ô–ö–ê -->
                <div class="glass-card game-card" id="snakeGame">
                    <div class="game-icon" style="color: #00ff88;">üêç</div>
                    <div class="game-title">–ó–º–µ–π–∫–∞ Pro 3.0</div>
                    <div class="features">
                        <span class="feature">üß± –°—Ç–µ–Ω—ã + 3 —Å–ª–æ–∂–Ω–æ—Å—Ç–∏</span>
                        <span class="feature">üåà –ù–µ–æ–Ω-–≥—Ä–∞–¥–∏–µ–Ω—Ç</span>
                        <span class="feature">üì± –°–≤–∞–π–ø—ã + —Å—Ç—Ä–µ–ª–∫–∏</span>
                    </div>
                    <select id="wallDifficulty">
                        <option value="0">üòå –õ–µ–≥–∫–æ (150–º—Å)</option>
                        <option value="1">üß± –°—Ä–µ–¥–Ω–µ (120–º—Å)</option>
                        <option value="2">üíÄ –•–∞—Ä–¥–∫–æ—Ä (90–º—Å)</option>
                    </select>
                    <button class="btn btn-primary" onclick="startSnakeGame()">üéÆ –ò–ì–†–ê–¢–¨</button>
                </div>

                <!-- üéØ –£–ì–ê–î–ê–ô –ß–ò–°–õ–û -->
                <div class="glass-card game-card" id="guessGame">
                    <div class="game-icon" style="color: #ff6b9d;">üéØ</div>
                    <div class="game-title">–£–≥–∞–¥–∞–π —á–∏—Å–ª–æ 1-1000</div>
                    <div class="features">
                        <span class="feature">üîç –ö–Ω–æ–ø–∫–∞ + Enter</span>
                        <span class="feature">üìä –ë–æ–ª—å—à–µ/–º–µ–Ω—å—à–µ X</span>
                        <span class="feature">‚ö° –°—á–µ—Ç—á–∏–∫ –ø–æ–ø—ã—Ç–æ–∫</span>
                    </div>
                    <button class="btn btn-primary" onclick="startGuessGame()">üéØ –ù–û–í–ê–Ø –ò–ì–†–ê</button>
                </div>

                <!-- ‚öîÔ∏è –¢–£–†–ù–ò–† -->
                <div class="glass-card game-card" id="tournamentGame">
                    <div class="game-icon" style="color: #ffd700;">‚öîÔ∏è</div>
                    <div class="game-title">–¢–£–†–ù–ò–† –¢–û–ü-100</div>
                    <div class="features">
                        <span class="feature">ü•áü•àü•â –ü—Ä–∏–∑—ã —Ç–æ–ø-5</span>
                        <span class="feature">24—á –∞–≤—Ç–æ-—Ä–µ—Å—Ç–∞—Ä—Ç</span>
                        <span class="feature">üêç —Ö2 –æ—á–∫–æ–≤ | üéØ —Ö1.5</span>
                    </div>
                    <div id="tournamentStatus">‚öîÔ∏è –ê–ö–¢–ò–í–ï–ù! <span id="tournamentTimer">24—á</span></div>
                    <button class="btn btn-primary" id="tournamentJoinBtn" onclick="joinTournament()">‚öîÔ∏è –£–ß–ê–°–¢–í–û–í–ê–¢–¨</button>
                    <button class="btn btn-secondary" onclick="showTournamentTop()">üèÜ –¢–û–ü-100</button>
                </div>
            </div>

            <!-- üèÜ –õ–ò–î–ï–†–ë–û–†–î–´ -->
            <div class="leaderboards">
                <div class="glass-card leaderboard-card">
                    <div class="lb-title">üëë –¢–û–ü-10 –†–ï–ö–û–†–î–´</div>
                    <ul class="lb-list" id="top10List"></ul>
                    <button class="btn btn-primary" onclick="updateTop10()" style="width: 100%; margin-top: 15px;">üîÑ –û–ë–ù–û–í–ò–¢–¨</button>
                </div>

                <div class="glass-card leaderboard-card">
                    <div class="lb-title">‚öîÔ∏è –¢–£–†–ù–ò–† –¢–û–ü-100</div>
                    <ul class="lb-list" id="tournamentList" style="max-height: 500px;"></ul>
                </div>
            </div>
        </div>
    </div>

    <!-- üêç –≠–ö–†–ê–ù –ó–ú–ï–ô–ö–ò -->
    <div class="game-screen" id="snakeScreen">
        <div class="game-container">
            <div style="text-align: center; margin-bottom: 30px;">
                <div style="font-size: 2rem; color: #00ff88; margin-bottom: 10px;">üêç –û–ß–ö–ò: <span id="snakeScore">0</span></div>
                <div id="snakeInstructions" style="color: #fff; font-size: 1.1rem;">
                    –°—Ç—Ä–µ–ª–∫–∏ / –°–≤–∞–π–ø—ã | –ï–¥–∞ = +10 | –°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ = GAME OVER
                </div>
            </div>
            <canvas id="snakeCanvas" width="400" height="400"></canvas>
            <div style="margin-top: 25px;">
                <button class="btn btn-primary" onclick="saveSnakeScore()">üíæ –°–û–•–†–ê–ù–ò–¢–¨ –†–ï–ö–û–†–î</button>
                <button class="btn btn-secondary" onclick="closeSnakeGame()">‚ùå –í–´–ô–¢–ò</button>
            </div>
        </div>
    </div>

    <!-- üéØ –≠–ö–†–ê–ù –£–ì–ê–î–ê–ô–ö–ò -->
    <div class="game-screen" id="guessScreen">
        <div class="game-container">
            <div style="text-align: center;">
                <div style="font-size: 2rem; color: #ff6b9d; margin-bottom: 20px;">
                    üéØ –£–ì–ê–î–ê–ô –ß–ò–°–õ–û <span id="rangeDisplay">1 - 1000</span>
                </div>
                <div style="font-size: 1.5rem; color: #00ff88; margin-bottom: 20px;">
                    –ü–æ–ø—ã—Ç–æ–∫: <span id="guessAttempts">0</span>
                </div>
                <input type="number" id="guessInput" class="auth-input" placeholder="–í–≤–µ–¥–∏ —á–∏—Å–ª–æ..." min="1" max="1000">
                <div style="margin: 20px 0;">
                    <button class="btn btn-primary" onclick="checkGuess()">üîç –ü–†–û–í–ï–†–ò–¢–¨</button>
                    <button class="btn btn-secondary" onclick="newGuessGame()">üîÑ –ù–û–í–ê–Ø –ò–ì–†–ê</button>
                </div>
                <div id="guessFeedback" style="font-size: 1.3rem; min-height: 40px;"></div>
            </div>
        </div>
    </div>

    <script>
        // üéÆ –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï
        let currentUser = '';
        let userToken = '';
        let tournamentActive = true;
        let tournamentEndTime = 0;
        let inTournament = false;

        // üêç –ó–ú–ï–ô–ö–ê
        let snake = [{x: 10, y: 10}];
        let dx = 1, dy = 0;
        let food = {};
        let snakeScore = 0;
        let gameCanvas, ctx;
        let lastSnakeUpdate = 0;
        const SNAKE_SPEED = {0: 150, 1: 120, 2: 90};
        let wallDifficulty = 0;
        let walls = [];

        // üéØ –£–ì–ê–î–ê–ô–ö–ê
        let currentSecret = 0;
        let minRange = 1, maxRange = 1000;
        let guessAttempts = 0;

        // –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø
        window.onload = () => {
            checkAuth();
            updateTournament();
            setInterval(updateTournament, 60000); // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
        };

        // üîê –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø
        function checkAuth() {
            userToken = localStorage.getItem('userToken');
            currentUser = localStorage.getItem('userName');
            
            if (userToken && currentUser) {
                document.getElementById('authSection').style.display = 'none';
                document.getElementById('gamesSection').style.display = 'block';
                document.getElementById('userInfo').style.display = 'flex';
                document.getElementById('currentUser').textContent = currentUser;
                updateTop10();
            } else {
                document.getElementById('loginForm').style.display = 'block';
            }
        }

        function login() {
            const username = document.getElementById('usernameInput').value.trim();
            const password = document.getElementById('passwordInput').value;
            
            if (!username || password.length < 4) {
                showStatus('‚ùå –ù–∏–∫ –∏ –ø–∞—Ä–æ–ª—å (–º–∏–Ω–∏–º—É–º 4 —Å–∏–º–≤–æ–ª–∞) –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã!', 'error');
                return;
            }

            const savedPassword = localStorage.getItem(`user_${username}_pass`);
            if (savedPassword === btoa(password)) {
                userToken = btoa(username + Date.now());
                localStorage.setItem('userToken', userToken);
                localStorage.setItem('userName', username);
                currentUser = username;
                showStatus('‚úÖ –í–û–®–Å–õ –£–°–ü–ï–®–ù–û! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, –ª–µ–≥–µ–Ω–¥–∞!', 'success');
                setTimeout(() => {
                    document.getElementById('authSection').style.display = 'none';
                    document.getElementById('gamesSection').style.display = 'block';
                    document.getElementById('userInfo').style.display = 'flex';
                    document.getElementById('currentUser').textContent = currentUser;
                    updateTop10();
                }, 1500);
            } else {
                showStatus('‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å!', 'error');
            }
        }

        function register() {
            const username = document.getElementById('usernameInput').value.trim();
            const password = document.getElementById('passwordInput').value;
            
            if (!username || password.length < 4) {
                showStatus('‚ùå –ù–∏–∫ –∏ –ø–∞—Ä–æ–ª—å (–º–∏–Ω–∏–º—É–º 4 —Å–∏–º–≤–æ–ª–∞) –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã!', 'error');
                return;
            }

            if (localStorage.getItem(`user_${username}_pass`)) {
                showStatus('‚ùå –≠—Ç–æ—Ç –Ω–∏–∫ —É–∂–µ –∑–∞–Ω—è—Ç!', 'error');
                return;
            }

            localStorage.setItem(`user_${username}_pass`, btoa(password));
            showStatus('‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞! –¢–µ–ø–µ—Ä—å –≤–æ–π–¥–∏.', 'success');
        }

        function logout() {
            if (confirm('üö™ –í—ã–π—Ç–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞?')) {
                localStorage.removeItem('userToken');
                localStorage.removeItem('userName');
                document.getElementById('authSection').style.display = 'block';
                document.getElementById('gamesSection').style.display = 'none';
                document.getElementById('userInfo').style.display = 'none';
                document.getElementById('loginForm').style.display = 'block';
                document.getElementById('usernameInput').value = '';
                document.getElementById('passwordInput').value = '';
            }
        }

        function showStatus(message, type) {
            const statusEl = document.getElementById('statusMessage');
            statusEl.textContent = message;
            statusEl.style.color = type === 'success' ? '#00ff88' : '#ff4757';
        }

        // üêç –ó–ú–ï–ô–ö–ê
        function startSnakeGame() {
            const token = localStorage.getItem('userToken');
            if (!token) { 
                alert('üîê –í–æ–π–¥–∏ –¥–ª—è –∏–≥—Ä—ã!'); 
                showLogin(); 
                return; 
            }

            wallDifficulty = parseInt(document.getElementById('wallDifficulty').value);
            setupWalls();
            snakeScore = 0;
            snake = [{x: 10, y: 10}];
            dx = 1; dy = 0;
            spawnFood();
            lastSnakeUpdate = 0;
            document.getElementById('snakeScore').textContent = '0';
            document.getElementById('snakeScreen').style.display = 'flex';
            gameCanvas = document.getElementById('snakeCanvas');
            ctx = gameCanvas.getContext('2d');
            gameLoop(0);
        }

        function setupWalls() {
            walls = [];
            const wallCount = [5, 10, 15][wallDifficulty];
            for (let i = 0; i < wallCount; i++) {
                walls.push({
                    x: Math.floor(Math.random() * 38) + 1,
                    y: Math.floor(Math.random() * 38) + 1
                });
            }
        }

        function spawnFood() {
            do {
                food = {
                    x: Math.floor(Math.random() * 38) + 1,
                    y: Math.floor(Math.random() * 38) + 1
                };
            } while (walls.some(wall => wall.x === food.x && wall.y === food.y));
        }

        function gameLoop(currentTime) {
            const speed = SNAKE_SPEED[wallDifficulty];
            if (currentTime - lastSnakeUpdate < speed) {
                requestAnimationFrame(gameLoop);
                return;
            }
            lastSnakeUpdate = currentTime;

            ctx.clearRect(0, 0, 400, 400);
            
            // –°—Ç–µ–Ω—ã
            ctx.fillStyle = '#666';
            walls.forEach(wall => {
                ctx.fillRect(wall.x * 10 + 1, wall.y * 10 + 1, 8, 8);
            });

            // –ï–¥–∞
            const gradient = ctx.createRadialGradient(food.x * 10 + 5, food.y * 10 + 5, 0, food.x * 10 + 5, food.y * 10 + 5, 6);
            gradient.addColorStop(0, '#ff6b9d');
            gradient.addColorStop(1, '#ff4757');
            ctx.fillStyle = gradient;
            ctx.beginPath();
            ctx.arc(food.x * 10 + 5, food.y * 10 + 5, 6, 0, Math.PI * 2);
            ctx.fill();

            // –î–≤–∏–∂–µ–Ω–∏–µ –∑–º–µ–π–∫–∏
            const head = {x: snake[0].x + dx, y: snake[0].y + dy};
            
            // –°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è
            if (head.x < 1 || head.x > 39 || head.y < 1 || head.y > 39 || 
                walls.some(wall => wall.x === head.x && wall.y === head.y) ||
                snake.some(segment => segment.x === head.x && segment.y === head.y)) {
                gameOver();
                return;
            }

            snake.unshift(head);

            // –ï–¥–∞
            if (head.x === food.x && head.y === food.y) {
                snakeScore += 10;
                document.getElementById('snakeScore').textContent = snakeScore;
                spawnFood();
            } else {
                snake.pop();
            }

            // –ó–º–µ–π–∫–∞ –≥—Ä–∞–¥–∏–µ–Ω—Ç
            for (let i = 0; i < snake.length; i++) {
                const gradient = ctx.createLinearGradient(
                    snake[i].x * 10, snake[i].y * 10,
                    (snake[i].x + (i === 0 ? dx : 0)) * 10, 
                    (snake[i].y + (i === 0 ? dy : 0)) * 10
                );
                gradient.addColorStop(0, i === 0 ? '#00ff88' : '#00bfff');
                gradient.addColorStop(1, '#1a0033');
                ctx.fillStyle = gradient;
                ctx.shadowColor = '#00ff88';
                ctx.shadowBlur = 15;
                ctx.fillRect(snake[i].x * 10 + 1, snake[i].y * 10 + 1, 8, 8);
                ctx.shadowBlur = 0;
            }

            requestAnimationFrame(gameLoop);
        }

        function gameOver() {
            alert(`üêç GAME OVER! –û—á–∫–∏: ${snakeScore}`);
            closeSnakeGame();
        }

        // üéØ –£–ì–ê–î–ê–ô–ö–ê
        function startGuessGame() {
            const token = localStorage.getItem('userToken');
            if (!token) { 
                alert('üîê –í–æ–π–¥–∏ –¥–ª—è –∏–≥—Ä—ã!'); 
                return; 
            }
            currentSecret = Math.floor(Math.random() * 1000) + 1;
            minRange = 1;
            maxRange = 1000;
            guessAttempts = 0;
            document.getElementById('guessAttempts').textContent = '0';
            document.getElementById('rangeDisplay').textContent = '1 - 1000';
            document.getElementById('guessInput').value = '';
            document.getElementById('guessFeedback').textContent = '';
            document.getElementById('guessScreen').style.display = 'flex';
            document.getElementById('guessInput').focus();
        }

        function checkGuess() {
            const guess = parseInt(document.getElementById('guessInput').value);
            guessAttempts++;
            document.getElementById('guessAttempts').textContent = guessAttempts;

            if (isNaN(guess) || guess < 1 || guess > 1000) {
                document.getElementById('guessFeedback').textContent = '‚ùå –ß–∏—Å–ª–æ –æ—Ç 1 –¥–æ 1000!';
                return;
            }

            if (guess === currentSecret) {
                const score = Math.max(0, 10000 - (guessAttempts * 10));
                document.getElementById('guessFeedback').innerHTML = 
                    `üéâ –£–ì–ê–î–ê–õ! –ó–∞–≥–∞–¥–∞–Ω–Ω–æ–µ: ${currentSecret}<br>–û—á–∫–∏: ${score} (–ø–æ–ø—ã—Ç–æ–∫: ${guessAttempts})`;
                saveScore(score, 'guess');
                if (inTournament) saveTournamentScore(score * 1.5);
            } else if (guess < currentSecret) {
                minRange = guess + 1;
                document.getElementById('guessFeedback').textContent = `üìà –ë–æ–ª—å—à–µ ${guess}! –î–∏–∞–ø–∞–∑–æ–Ω: ${minRange}-${maxRange}`;
            } else {
                maxRange = guess - 1;
                document.getElementById('guessFeedback').textContent = `üìâ –ú–µ–Ω—å—à–µ ${guess}! –î–∏–∞–ø–∞–∑–æ–Ω: ${minRange}-${maxRange}`;
            }
            document.getElementById('rangeDisplay').textContent = `${minRange} - ${maxRange}`;
            document.getElementById('guessInput').value = '';
            document.getElementById('guessInput').focus();
        }

        // üèÜ –õ–ò–î–ï–†–ë–û–†–î–´
        function updateTop10() {
            const scores = JSON.parse(localStorage.getItem('gameScores') || '[]');
            const top10 = scores.sort((a, b) => b.score - a.score).slice(0, 10);
            
            const list = document.getElementById('top10List');
            list.innerHTML = top10.length ? 
                top10.map((player, i) => 
                    `<li class="lb-item ${i < 3 ? 'top-3' : ''}">
                        <span class="rank">${i+1}.</span>
                        <strong>${player.name}</strong> 
                        <span style="color: #00ff88;">${player.score}üî•</span>
                    </li>`
                ).join('') : '<li style="text-align:center;color:#888;">üëë –ë–£–î–¨ –ü–ï–†–í–´–ú!</li>';
        }

        function showTournamentTop() {
            const scores = JSON.parse(localStorage.getItem('tournamentScores') || '[]');
            const top100 = scores.sort((a, b) => b.score - a.score).slice(0, 100);
            const medals = ['ü•á', 'ü•à', 'ü•â', 'üéÅ', 'üéÅ'];
            
            const list = document.getElementById('tournamentList');
            list.innerHTML = top100.map((player, i) => {
                const medal = i < 5 ? medals[i] : `${i+1}`;
                return `<li class="lb-item">
                    <span class="rank">${medal}</span>
                    <strong>${player.name}</strong> 
                    <span style="color: #ffd700;">${Math.floor(player.score)}üî•</span>
                </li>`;
            }).join('') || '<li style="text-align:center;color:#888;">‚öîÔ∏è –ü–ï–†–í–´–ô –¢–£–†–ù–ò–† –ê–õ–ï–ö–°–ò–ù–ê!</li>';
        }

        // ‚öîÔ∏è –¢–£–†–ù–ò–†
        function updateTournament() {
            const now = Date.now();
            tournamentEndTime = parseInt(localStorage.getItem('tournamentEnd') || '0');
            
            if (!tournamentEndTime || now > tournamentEndTime) {
                tournamentEndTime = now + 24 * 60 * 60 * 1000; // 24 —á–∞—Å–∞
                localStorage.setItem('tournamentEnd', tournamentEndTime);
                localStorage.setItem('tournamentScores', '[]');
                tournamentActive = true;
            }

            const leftHours = Math.floor((tournamentEndTime - now) / (1000 * 60 * 60));
            document.getElementById('tournamentTimer').textContent = `${leftHours}—á –æ—Å—Ç–∞–ª–æ—Å—å`;
            
            if (now > tournamentEndTime) {
                document.getElementById('tournamentStatus').innerHTML = 'üèÜ –¢–£–†–ù–ò–† –û–ö–û–ù–ß–ï–ù! –ù–æ–≤—ã–π —á–µ—Ä–µ–∑ 5 —Å–µ–∫...';
                setTimeout(() => location.reload(), 5000);
            }
        }

        function joinTournament() {
            inTournament = true;
            alert('‚öîÔ∏è –¢—ã –≤ —Ç—É—Ä–Ω–∏—Ä–µ! –ó–º–µ–π–∫–∞ —Ö2 –æ—á–∫–æ–≤, –£–≥–∞–¥–∞–π–∫–∞ —Ö1.5!');
            document.getElementById('tournamentJoinBtn').textContent = '‚úÖ –í –¢–£–†–ù–ò–†–ï!';
            document.getElementById('tournamentJoinBtn').style.background = '#ffd700';
        }

        // üíæ –°–û–•–†–ê–ù–ï–ù–ò–ï –û–ß–ö–û–í
        function saveSnakeScore() {
            if (!currentUser) return;
            saveScore(snakeScore * (inTournament ? 2 : 1), 'snake');
            if (inTournament) saveTournamentScore(snakeScore * 2);
            closeSnakeGame();
        }

        function saveScore(score, gameType) {
            const scores = JSON.parse(localStorage.getItem('gameScores') || '[]');
            scores.push({name: currentUser, score, game: gameType, date: Date.now()});
            localStorage.setItem('gameScores', JSON.stringify(scores.slice(-100))); // –ü–æ—Å–ª–µ–¥–Ω–∏–µ 100
            updateTop10();
            alert(`‚úÖ –†–µ–∫–æ—Ä–¥ ${score} –æ—á–∫–æ–≤ —Å–æ—Ö—Ä–∞–Ω–µ–Ω!`);
        }

        function saveTournamentScore(score) {
            const scores = JSON.parse(localStorage.getItem('tournamentScores') || '[]');
            const existing = scores.find(s => s.name === currentUser);
            if (existing) existing.score = Math.max(existing.score, score);
            else scores.push({name: currentUser, score});
            localStorage.setItem('tournamentScores', JSON.stringify(scores));
            showTournamentTop();
        }

        // –ó–ê–ö–†–´–¢–ò–ï –ò–ì–†
        function closeSnakeGame() {
            document.getElementById('snakeScreen').style.display = 'none';
        }

        function closeGuessGame() {
            document.getElementById('guessScreen').style.display = 'none';
        }

        function newGuessGame() {
            startGuessGame();
        }

        // üì± –°–í–ê–ô–ü–´ –î–õ–Ø –ú–û–ë–ê–ô–õ–ê
        let touchStartX = 0, touchStartY = 0;
        document.addEventListener('touchstart', e => {
            touchStartX = e.touches[0].clientX;
            touchStartY = e.touches[0].clientY;
        });

        document.addEventListener('touchend', e => {
            if (!gameCanvas) return;
            const touchEndX = e.changedTouches[0].clientX;
            const touchEndY = e.changedTouches[0].clientY;
            const diffX = touchStartX - touchEndX;
            const diffY = touchStartY - touchEndY;

            if (Math.abs(diffX) > Math.abs(diffY)) {
                if (diffX > 50) changeDirection(-1, 0); // Left
                else if (diffX < -50) changeDirection(1, 0); // Right
            } else {
                if (diffY > 50) changeDirection(0, -1); // Up
                else if (diffY < -50) changeDirection(0, 1); // Down
            }
        });

        document.addEventListener('keydown', e => {
            if (e.key === 'Enter' && document.getElementById('guessScreen').style.display === 'flex') {
                checkGuess();
            }
        });

        // üêç –£–ü–†–ê–í–õ–ï–ù–ò–ï –ó–ú–ï–ô–ö–û–ô
        document.addEventListener('keydown', e => {
            if (document.getElementById('snakeScreen').style.display !== 'flex') return;
            switch(e.key) {
                case 'ArrowUp': changeDirection(0, -1); break;
                case 'ArrowDown': changeDirection(0, 1); break;
                case 'ArrowLeft': changeDirection(-1, 0); break;
                case 'ArrowRight': changeDirection(1, 0); break;
            }
        });

        function changeDirection(newDx, newDy) {
            if (newDx * dx + newDy * dy === 0) { // –ù–µ –ø–æ–≤–æ—Ä–æ—Ç –Ω–∞ 180¬∞
                dx = newDx;
                dy = newDy;
            }
        }

        function showLogin() {
            document.getElementById('authSection').style.display = 'block';
            document.getElementById('gamesSection').style.display = 'none';
        }
    </script>
</body>
</html>
