<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üåå ALEKSIN COSMIC GAMES HUB</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            background: radial-gradient(ellipse at center, #0a0a23 0%, #000428 50%, #000000 100%);
            font-family: Arial, sans-serif; color: #00ff88; min-height: 100vh;
            overflow-x: hidden;
        }
        .stars {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-image: 
                radial-gradient(2px 2px at 20px 30px, #eee, transparent),
                radial-gradient(2px 2px at 40px 70px, #fff, transparent),
                radial-gradient(1px 1px at 90px 40px, #00ff88, transparent);
            background-repeat: repeat; background-size: 100px 100px;
            animation: twinkle 4s ease-in-out infinite; z-index: -1;
        }
        @keyframes twinkle { 0%,100%{opacity:0.6} 50%{opacity:1} }
        
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        .panel { 
            background: rgba(0,0,0,0.9); border: 2px solid #00ff88; 
            border-radius: 20px; padding: 30px; margin: 20px 0; 
            box-shadow: 0 0 30px rgba(0,255,136,0.4);
        }
        .hidden { display: none !important; }
        
        .user-panel {
            position: fixed; top: 20px; right: 20px;
            background: rgba(0,0,0,0.95); border: 3px solid #ff0080;
            padding: 15px 25px; border-radius: 30px;
            font-size: 18px; font-weight: bold; z-index: 1000;
        }
        
        h1 { font-size: 2.5em; text-align: center; margin-bottom: 25px;
            background: linear-gradient(45deg, #00ff88 0%, #ff0080 50%, #0080ff 100%);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            animation: glow 2s ease-in-out infinite alternate;
        }
        @keyframes glow { 0%{filter: drop-shadow(0 0 10px #00ff88)} 100%{filter: drop-shadow(0 0 25px #00ff88)} }
        
        input { 
            width: 100%; padding: 20px; margin: 15px 0; border: 3px solid #00ff88; 
            border-radius: 15px; background: rgba(0,0,0,1); color: #00ff88;
            font-size: 18px; font-weight: bold;
        }
        button { 
            width: 100%; padding: 20px; margin: 10px 0; background: linear-gradient(45deg, #00ff88, #0080ff); 
            border: none; border-radius: 15px; color: #000; font-size: 20px; font-weight: bold;
            cursor: pointer; transition: all 0.3s;
        }
        button:hover { transform: scale(1.03); box-shadow: 0 10px 30px rgba(0,255,136,0.6); }
        button.tournament { background: linear-gradient(45deg, #ff0080, #ff6600) !important; font-size: 22px !important; }
        
        .game-btn {
            display: block; padding: 25px; margin: 15px 0;
            background: linear-gradient(45deg, #ff0080, #00ff88); color: white;
            text-decoration: none; text-align: center; font-size: 22px; font-weight: bold;
            border-radius: 20px;
        }
        
        canvas { border: 4px solid #00ff88; border-radius: 20px; background: #000; 
            display: block; margin: 20px auto; box-shadow: 0 0 40px rgba(0,255,136,0.5); }
        
        .leaderboard { max-height: 250px; overflow-y: auto; margin: 20px 0; }
        .leaderboard div { 
            padding: 15px; margin: 8px 0; background: rgba(0,255,136,0.2);
            border-left: 5px solid #00ff88; border-radius: 10px;
            display: flex; justify-content: space-between; font-weight: bold;
        }
        .rank1 { border-left-color: gold !important; background: rgba(255,215,0,0.3) !important; }
        .rank2 { border-left-color: silver !important; background: rgba(192,192,192,0.3) !important; }
        .rank3 { border-left-color: #cd7f32 !important; background: rgba(205,127,50,0.3) !important; }
        
        .timer { font-size: 26px; color: #ffaa00; text-align: center; margin: 20px 0; font-weight: bold; }
        .score { font-size: 24px; text-align: center; color: #ffaa00; margin: 15px 0; font-weight: bold; }
        .feedback { font-size: 22px; text-align: center; margin: 20px 0; min-height: 40px; color: #ffaa00; }
    </style>
</head>
<body>
    <div class="stars"></div>
    
    <div class="user-panel hidden" id="userPanel">
        üëë <span id="currentNick"></span> | 
        <button onclick="logout()" style="width:auto; padding:10px 20px; font-size:16px; margin-left:10px;">üö™ –í–´–•–û–î</button>
    </div>
    
    <div class="container">
        <!-- –õ–û–ì–ò–ù -->
        <div class="panel" id="loginPanel">
            <h1>üåå ALEKSIN GAMES HUB</h1>
            <input type="text" id="username" placeholder="üë§ –¢–≤–æ–π –Ω–∏–∫" maxlength="12">
            <input type="password" id="password" placeholder="üîê –ü–∞—Ä–æ–ª—å">
            <button onclick="login()">‚úÖ –í–û–ô–¢–ò</button>
            <button onclick="registerUser()">‚≠ê –°–û–ó–î–ê–¢–¨ –ê–ö–ö–ê–£–ù–¢</button>
        </div>
        
        <!-- –ì–õ–ê–í–ù–û–ï –ú–ï–ù–Æ -->
        <div class="panel hidden" id="mainMenu">
            <h1>üéÆ –ì–õ–ê–í–ù–û–ï –ú–ï–ù–Æ</h1>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 25px; margin: 30px 0;">
                <div>
                    <a href="#" class="game-btn" onclick="showSnakeMenu(); return false;">üêç –ó–ú–ï–ô–ö–ê PRO</a>
                    <div class="leaderboard" id="snakeLeaderboard" style="max-height: 200px;"></div>
                </div>
                <div>
                    <a href="#" class="game-btn" onclick="showGuessMenu(); return false;">üéØ –£–ì–ê–î–ê–ô –ß–ò–°–õ–û</a>
                    <div class="leaderboard" id="guessLeaderboard" style="max-height: 200px;"></div>
                </div>
            </div>
            <button class="tournament" onclick="showTournaments()">‚öîÔ∏è –¢–£–†–ù–ò–†–´</button>
        </div>
        
        <!-- –ú–ï–ù–Æ –ó–ú–ï–ô–ö–ò -->
        <div class="panel hidden" id="snakeMenu">
            <h1>üêç –ó–ú–ï–ô–ö–ê - –í–´–ë–ï–†–ò –°–õ–û–ñ–ù–û–°–¢–¨</h1>
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin: 30px 0;">
                <button onclick="startSnakeGame(1)">üêå –õ–ï–ì–ö–ê–Ø</button>
                <button onclick="startSnakeGame(2)">üêç –ù–û–†–ú–ê–õ–¨–ù–ê–Ø</button>
                <button onclick="startSnakeGame(3)">‚ö° –°–õ–û–ñ–ù–ê–Ø</button>
                <button class="tournament" onclick="joinSnakeTournament()">‚öîÔ∏è –¢–£–†–ù–ò–† –ó–ú–ï–ô–ö–ê</button>
            </div>
            <button onclick="backToMainMenu()">üè† –ì–õ–ê–í–ù–û–ï –ú–ï–ù–Æ</button>
        </div>
        
        <!-- –ú–ï–ù–Æ –£–ì–ê–î–ê–ô–ö–ò -->
        <div class="panel hidden" id="guessMenu">
            <h1>üéØ –£–ì–ê–î–ê–ô –ß–ò–°–õ–û - –í–´–ë–ï–†–ò –£–†–û–í–ï–ù–¨</h1>
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin: 30px 0;">
                <button onclick="startGuessGame(1)">1Ô∏è‚É£ 1-1,000</button>
                <button onclick="startGuessGame(2)">2Ô∏è‚É£ 1-10,000</button>
                <button onclick="startGuessGame(3)">3Ô∏è‚É£ 1-100,000</button>
                <button class="tournament" onclick="joinGuessTournament()">‚öîÔ∏è –¢–£–†–ù–ò–† –£–ì–ê–î–ê–ô–ö–ê</button>
            </div>
            <button onclick="backToMainMenu()">üè† –ì–õ–ê–í–ù–û–ï –ú–ï–ù–Æ</button>
        </div>
        
        <!-- –¢–£–†–ù–ò–†–´ -->
        <div class="panel hidden" id="tournamentsPanel">
            <h1>‚öîÔ∏è –¢–£–†–ù–ò–†–´ (—Å–±—Ä–æ—Å –≤ 00:00 –ú–°–ö)</h1>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin: 30px 0;">
                <div class="panel">
                    <h2>üêç –¢–£–†–ù–ò–† –ó–ú–ï–ô–ö–ê</h2>
                    <div class="timer" id="snakeTournamentTimer">--:--:--</div>
                    <div class="leaderboard" id="snakeTournamentBoard"></div>
                    <button class="tournament" onclick="joinSnakeTournament()">‚öîÔ∏è –í–°–¢–£–ü–ò–¢–¨ –í –¢–£–†–ù–ò–†</button>
                </div>
                <div class="panel">
                    <h2>üéØ –¢–£–†–ù–ò–† –£–ì–ê–î–ê–ô–ö–ê</h2>
                    <div class="timer" id="guessTournamentTimer">--:--:--</div>
                    <div class="leaderboard" id="guessTournamentBoard"></div>
                    <button class="tournament" onclick="joinGuessTournament()">‚öîÔ∏è –í–°–¢–£–ü–ò–¢–¨ –í –¢–£–†–ù–ò–†</button>
                </div>
            </div>
            <button onclick="backToMainMenu()" style="font-size: 24px;">üè† –ì–õ–ê–í–ù–û–ï –ú–ï–ù–Æ</button>
        </div>
        
        <!-- –ò–ì–†–ê –ó–ú–ï–ô–ö–ê -->
        <div class="panel hidden" id="snakeGamePanel">
            <h1>üêç –ó–ú–ï–ô–ö–ê</h1>
            <canvas id="snakeCanvas" width="500" height="500"></canvas>
            <div class="score">
                –û—á–∫–∏: <span id="snakeScore">0</span> | 
                –†–µ–∫–æ—Ä–¥: <span id="snakeRecord">0</span> | 
                –°–ª–æ–∂–Ω–æ—Å—Ç—å: <span id="currentDifficulty">1</span>
            </div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                <button onclick="restartSnakeGame()">üîÑ –ù–û–í–ê–Ø –ò–ì–†–ê</button>
                <button onclick="backToMainMenu()">üè† –ú–ï–ù–Æ</button>
            </div>
        </div>
        
        <!-- –ò–ì–†–ê –£–ì–ê–î–ê–ô–ö–ê -->
        <div class="panel hidden" id="guessGamePanel">
            <h1>üéØ –£–ì–ê–î–ê–ô –ß–ò–°–õ–û</h1>
            <div class="score">
                –£—Ä–æ–≤–µ–Ω—å: <span id="guessLevel">1</span> | 
                –î–∏–∞–ø–∞–∑–æ–Ω: 1-<span id="guessRange">1000</span> | 
                –ü–æ–ø—ã—Ç–æ–∫: <span id="guessAttempts">0</span>
            </div>
            <div class="feedback" id="guessFeedback">–ù–∞–∂–º–∏ "–ù–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å" –¥–ª—è –Ω–∞—á–∞–ª–∞</div>
            <input type="number" id="guessInput" placeholder="–í–≤–µ–¥–∏ —á–∏—Å–ª–æ">
            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin: 20px 0;">
                <button onclick="makeGuess()">‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
                <button onclick="newGuessLevel()">üîÑ –ù–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å</button>
                <button onclick="backToMainMenu()">üè† –ú–µ–Ω—é</button>
            </div>
        </div>
    </div>

    <script>
        let currentUser = '';
        let snakeGame = {running: false, score: 0, level: 1};
        let guessGame = {level: 1, target: 0, attempts: 0, min: 1, max: 1000};
        
        // –•—Ä–∞–Ω–∏–ª–∏—â–µ
        const storage = {
            get(key) { 
                try { return JSON.parse(localStorage.getItem(key) || '{}'); } 
                catch { return {}; }
            },
            set(key, value) { 
                localStorage.setItem(key, JSON.stringify(value)); 
            }
        };
        
        // –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø
        function registerUser() {
            const nick = document.getElementById('username').value.trim();
            const pass = document.getElementById('password').value;
            if (nick.length < 3 || pass.length < 3) {
                return alert('‚ùå –ù–∏–∫ –∏ –ø–∞—Ä–æ–ª—å –º–∏–Ω–∏–º—É–º 3 —Å–∏–º–≤–æ–ª–∞!');
            }
            let users = storage.get('users');
            if (users[nick]) {
                return alert('‚ùå –ù–∏–∫ —É–∂–µ –∑–∞–Ω—è—Ç!');
            }
            users[nick] = {
                pass: btoa(pass),
                snakeRecord: 0,
                guessRecord: 999,
                snakeTournament: 0,
                guessTournament: 999
            };
            storage.set('users', users);
            alert('‚úÖ –ê–∫–∫–∞—É–Ω—Ç —Å–æ–∑–¥–∞–Ω! –¢–µ–ø–µ—Ä—å –≤–æ–π–¥–∏.');
        }
        
        function login() {
            const nick = document.getElementById('username').value.trim();
            const pass = document.getElementById('password').value;
            let users = storage.get('users');
            
            if (users[nick] && users[nick].pass === btoa(pass)) {
                currentUser = nick;
                document.getElementById('currentNick').textContent = nick;
                document.getElementById('loginPanel').classList.add('hidden');
                document.getElementById('mainMenu').classList.remove('hidden');
                document.getElementById('userPanel').classList.remove('hidden');
                updateLeaderboards();
                updateTournamentTimers();
            } else {
                alert('‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å!');
            }
        }
        
        function logout() {
            currentUser = '';
            document.querySelectorAll('.panel:not(#loginPanel)').forEach(p => p.classList.add('hidden'));
            document.getElementById('loginPanel').classList.remove('hidden');
            document.getElementById('userPanel').classList.add('hidden');
            document.getElementById('username').value = '';
            document.getElementById('password').value = '';
        }
        
        function backToMainMenu() {
            document.querySelectorAll('.panel').forEach(p => p.classList.add('hidden'));
            document.getElementById('mainMenu').classList.remove('hidden');
            updateLeaderboards();
        }
        
        function showSnakeMenu() {
            document.querySelectorAll('.panel').forEach(p => p.classList.add('hidden'));
            document.getElementById('snakeMenu').classList.remove('hidden');
        }
        
        function showGuessMenu() {
            document.querySelectorAll('.panel').forEach(p => p.classList.add('hidden'));
            document.getElementById('guessMenu').classList.remove('hidden');
        }
        
        function showTournaments() {
            document.querySelectorAll('.panel').forEach(p => p.classList.add('hidden'));
            document.getElementById('tournamentsPanel').classList.remove('hidden');
            updateTournamentLeaderboards();
        }
        
        // –ó–ú–ï–ô–ö–ê
        function startSnakeGame(level) {
            snakeGame = {running: true, score: 0, level: level, x: 250, y: 250, dx: 20, dy: 0, cells: [], maxCells: 4};
            document.querySelectorAll('.panel').forEach(p => p.classList.add('hidden'));
            document.getElementById('snakeGamePanel').classList.remove('hidden');
            document.getElementById('currentDifficulty').textContent = level;
            document.getElementById('snakeScore').textContent = 0;
            snakeGameLoop();
        }
        
        function snakeGameLoop() {
            if (!snakeGame.running) return;
            
            const canvas = document.getElementById('snakeCanvas');
            const ctx = canvas.getContext('2d');
            
            ctx.fillStyle = '#000';
            ctx.fillRect(0, 0, 500, 500);
            
            snakeGame.x += snakeGame.dx;
            snakeGame.y += snakeGame.dy;
            
            snakeGame.cells.unshift({x: snakeGame.x, y: snakeGame.y});
            if (snakeGame.cells.length > snakeGame.maxCells) {
                snakeGame.cells.pop();
            }
            
            // –ó–º–µ–π–∫–∞
            ctx.strokeStyle = '#00ff88';
            ctx.lineWidth = 3;
            snakeGame.cells.forEach((cell, i) => {
                ctx.beginPath();
                ctx.arc(cell.x, cell.y, i === 0 ? 12 : 8, 0, Math.PI * 2);
                ctx.fillStyle = i === 0 ? '#ff0080' : '#00ff88';
                ctx.fill();
                ctx.stroke();
            });
            
            // –ï–¥–∞ (–∫—Ä–∞—Å–∏–≤–æ–µ —è–±–ª–æ–∫–æ)
            if (!snakeGame.food) {
                snakeGame.food = {
                    x: Math.floor(Math.random() * 22) * 20 + 30,
                    y: Math.floor(Math.random() * 22) * 20 + 30
                };
            }
            
            // –†–∏—Å—É–µ–º —è–±–ª–æ–∫–æ
            const appleX = snakeGame.food.x;
            const appleY = snakeGame.food.y;
            const gradient = ctx.createRadialGradient(appleX, appleY, 0, appleX, appleY, 12);
            gradient.addColorStop(0, '#ff4444');
            gradient.addColorStop(0.7, '#ffaa00');
            gradient.addColorStop(1, '#cc0000');
            ctx.fillStyle = gradient;
            ctx.beginPath();
            ctx.arc(appleX, appleY, 12, 0, Math.PI * 2);
            ctx.fill();
            
            // –ë–ª–∏–∫–∏ –Ω–∞ —è–±–ª–æ–∫–µ
            ctx.fillStyle = 'rgba(255,255,255,0.8)';
            ctx.beginPath();
            ctx.arc(appleX - 4, appleY - 4, 3, 0, Math.PI * 2);
            ctx.arc(appleX + 4, appleY - 3, 2, 0, Math.PI * 2);
            ctx.fill();
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—ä–µ–¥–µ–Ω–∏—è
            if (Math.abs(snakeGame.x - appleX) < 15 && Math.abs(snakeGame.y - appleY) < 15) {
                snakeGame.score += snakeGame.level * 10;
                snakeGame.maxCells += 1;
                delete snakeGame.food;
            }
            
            document.getElementById('snakeScore').textContent = snakeGame.score;
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è
            if (snakeGame.cells.length > 5 && 
                snakeGame.cells.slice(2).some(cell => 
                    Math.abs(cell.x - snakeGame.x) < 20 && Math.abs(cell.y - snakeGame.y) < 20)) {
                endSnakeGame();
                return;
            }
            
            setTimeout(snakeGameLoop, 200 - snakeGame.level * 60);
        }
        
        function endSnakeGame() {
            snakeGame.running = false;
            let users = storage.get('users');
            if (users[currentUser].snakeRecord < snakeGame.score) {
                users[currentUser].snakeRecord = snakeGame.score;
            }
            storage.set('users', users);
            updateLeaderboards();
            alert(`üêç –ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞! ${snakeGame.score} –æ—á–∫–æ–≤`);
        }
        
        function restartSnakeGame() {
            startSnakeGame(snakeGame.level);
        }
        
        // –£–ì–ê–î–ê–ô–ö–ê
        function startGuessGame(level) {
            const levels = [[1000, 1], [10000, 1], [100000, 1]];
            guessGame = {
                level: level,
                target: Math.floor(Math.random() * levels[level-1][0]) + levels[level-1][1],
                attempts: 0,
                min: levels[level-1][1],
                max: levels[level-1][0]
            };
            document.querySelectorAll('.panel').forEach(p => p.classList.add('hidden'));
            document.getElementById('guessGamePanel').classList.remove('hidden');
            document.getElementById('guessLevel').textContent = level;
            document.getElementById('guessRange').textContent = guessGame.max.toLocaleString();
            document.getElementById('guessAttempts').textContent = 0;
            document.getElementById('guessFeedback').textContent = `üéØ –ó–∞–≥–∞–¥–∞–ª —á–∏—Å–ª–æ –æ—Ç 1 –¥–æ ${guessGame.max.toLocaleString()}`;
        }
        
        function makeGuess() {
            const input = parseInt(document.getElementById('guessInput').value);
            if (!input || input < guessGame.min || input > guessGame.max) {
                document.getElementById('guessFeedback').textContent = `‚ùå –ß–∏—Å–ª–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—Ç ${guessGame.min} –¥–æ ${guessGame.max}!`;
                return;
            }
            
            guessGame.attempts++;
            document.getElementById('guessAttempts').textContent = guessGame.attempts;
            
            if (input === guessGame.target) {
                document.getElementById('guessFeedback').innerHTML = 
                    `üéâ –£–†–ê! –£–≥–∞–¥–∞–ª –∑–∞ <strong>${guessGame.attempts}</strong> –ø–æ–ø—ã—Ç–æ–∫!<br>–ß–∏—Å–ª–æ –±—ã–ª–æ: ${guessGame.target}`;
                let users = storage.get('users');
                if (users[currentUser].guessRecord > guessGame.attempts || !users[currentUser].guessRecord) {
                    users[currentUser].guessRecord = guessGame.attempts;
                }
                storage.set('users', users);
                updateLeaderboards();
            } else if (input < guessGame.target) {
                guessGame.min = input + 1;
                const range = guessGame.max - guessGame.min + 1;
                const hint = Math.floor(guessGame.min + range / 3);
                document.getElementById('guessFeedback').innerHTML = 
                    `üìà –ë–æ–ª—å—à–µ —á–µ–º ${input}<br>–û—Å—Ç–∞–ª–æ—Å—å —á–∏—Å–µ–ª: ${range}<br>üí° –ü–æ–ø—Ä–æ–±—É–π –æ–∫–æ–ª–æ ${hint}`;
            } else {
                guessGame.max = input - 1;
                const range = guessGame.max - guessGame.min + 1;
                const hint = Math.floor(guessGame.max - range / 3);
                document.getElementById('guessFeedback').innerHTML = 
                    `üìâ –ú–µ–Ω—å—à–µ —á–µ–º ${input}<br>–û—Å—Ç–∞–ª–æ—Å—å —á–∏—Å–µ–ª: ${range}<br>üí° –ü–æ–ø—Ä–æ–±—É–π –æ–∫–æ–ª–æ ${hint}`;
            }
            document.getElementById('guessInput').value = '';
        }
        
        function newGuessLevel() {
            startGuessGame(guessGame.level % 3 + 1);
        }
        
        // –õ–ò–î–ï–†–ë–û–†–î–´
        function updateLeaderboards() {
            let users = storage.get('users');
            
            // –¢–æ–ø –∑–º–µ–π–∫–∞
            const snakeTop = Object.entries(users)
                .sort(([,a], [,b]) => b.snakeRecord - a.snakeRecord)
                .slice(0, 5)
                .map(([nick, data], i) => 
                    `<div class="rank${i+1}">${i+1}. ${nick}<span>${data.snakeRecord || 0}</span></div>`
                ).join('');
            document.getElementById('snakeLeaderboard').innerHTML = snakeTop || '<div>–ü—É—Å—Ç–æ</div>';
            
            // –¢–æ–ø —É–≥–∞–¥–∞–π–∫–∞
            const guessTop = Object.entries(users)
                .sort(([,a], [,b]) => (a.guessRecord || 999) - (b.guessRecord || 999))
                .slice(0, 5)
                .map(([nick, data], i) => 
                    `<div class="rank${i+1}">${i+1}. ${nick}<span>${data.guessRecord || '‚àû'}</span></div>`
                ).join('');
            document.getElementById('guessLeaderboard').innerHTML = guessTop || '<div>–ü—É—Å—Ç–æ</div>';
        }
        
        function updateTournamentLeaderboards() {
            // –ü—Ä–æ—Å—Ç—ã–µ —Ç—É—Ä–Ω–∏—Ä–Ω—ã–µ –ª–∏–¥–µ—Ä–±–æ—Ä–¥—ã
            let users = storage.get('users');
            const snakeTour = Object.entries(users)
                .sort(([,a], [,b]) => b.snakeTournament - a.snakeTournament)
                .slice(0, 5)
                .map(([nick], i) => `<div>${i+1}. ${nick} <span>${users[nick].snakeTournament || 0}</span></div>`)
                .join('');
            document.getElementById('snakeTournamentBoard').innerHTML = snakeTour || '<div>–ù–∏–∫—Ç–æ –Ω–µ —É—á–∞—Å—Ç–≤—É–µ—Ç</div>';
            
            const guessTour = Object.entries(users)
                .sort(([,a], [,b]) => (a.guessTournament || 999) - (b.guessTournament || 999))
                .slice(0, 5)
                .map(([nick], i) => `<div>${i+1}. ${nick} <span>${users[nick].guessTournament || '‚àû'}</span></div>`)
                .join('');
            document.getElementById('guessTournamentBoard').innerHTML = guessTour || '<div>–ù–∏–∫—Ç–æ –Ω–µ —É—á–∞—Å—Ç–≤—É–µ—Ç</div>';
        }
        
        function joinSnakeTournament() {
            alert('‚öîÔ∏è –¢—ã –≤—Å—Ç—É–ø–∏–ª –≤ —Ç—É—Ä–Ω–∏—Ä –ó–º–µ–π–∫–∞! –¢–≤–æ–∏ –æ—á–∫–∏ –±—É–¥—É—Ç –∑–∞—Å—á–∏—Ç–∞–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!');
        }
        
        function joinGuessTournament() {
            alert('‚öîÔ∏è –¢—ã –≤—Å—Ç—É–ø–∏–ª –≤ —Ç—É—Ä–Ω–∏—Ä –£–≥–∞–¥–∞–π–∫–∞! –ú–µ–Ω—å—à–µ –ø–æ–ø—ã—Ç–æ–∫ = –≤—ã—à–µ –º–µ—Å—Ç–æ!');
        }
        
        function updateTournamentTimers() {
            setInterval(() => {
                const now = new Date();
                const tomorrow = new Date(now);
                tomorrow.setHours(24, 0, 0, 0);
                const diff = tomorrow - now;
                const h = Math.floor(diff / 3600000);
                const m = Math.floor((diff % 3600000) / 60000);
                const s = Math.floor((diff % 60000) / 1000);
                document.getElementById('snakeTournamentTimer').textContent = 
                document.getElementById('guessTournamentTimer').textContent = 
                    `${h.toString().padStart(2, '0')}:${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
            }, 1000);
        }
        
        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–º–µ–π–∫–æ–π –∫–ª–∞–≤–∏—à–∞–º–∏
        document.addEventListener('keydown', (e) => {
            if (!snakeGame.running) return;
            switch(e.key) {
                case 'ArrowUp': snakeGame.dy = -20; snakeGame.dx = 0; break;
                case 'ArrowDown': snakeGame.dy = 20; snakeGame.dx = 0; break;
                case 'ArrowLeft': snakeGame.dx = -20; snakeGame.dy = 0; break;
                case 'ArrowRight': snakeGame.dx = 20; snakeGame.dy = 0; break;
            }
        });
        
        // –ó–∞–ø—É—Å–∫ —Ç–∞–π–º–µ—Ä–æ–≤ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.onload = updateTournamentTimers;
    </script>
</body>
</html>
