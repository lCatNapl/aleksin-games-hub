<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üöÄ ALEKSIN GAMES HUB v3.0 ‚úÖ 13/13</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap');
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:'Orbitron',monospace;background:linear-gradient(135deg,#0a0a23 0%,#1a0a3a 50%,#0f0f4f 100%);color:#fff;min-height:100vh;overflow-y:auto}
        .container{max-width:1200px;margin:0 auto;padding:20px}
        h1{font-size:clamp(2rem,5vw,4rem);text-align:center;background:linear-gradient(45deg,#ff00ff,#00ffff,#ffff00);background-size:300% 300%;-webkit-background-clip:text;-webkit-text-fill-color:transparent;animation:gradient 3s ease infinite}
        @keyframes gradient{0%,100%{background-position:0% 50%}50%{background-position:100% 50%}}
        .btn{display:inline-block;padding:15px 30px;background:linear-gradient(45deg,rgba(255,0,255,0.3),rgba(0,255,255,0.3));border:2px solid rgba(255,255,255,0.3);border-radius:20px;font-size:1.2rem;font-weight:700;cursor:pointer;transition:all 0.3s ease;margin:10px;box-shadow:0 10px 30px rgba(0,0,0,0.5)}
        .btn:hover{background:linear-gradient(45deg,rgba(255,0,255,0.6),rgba(0,255,255,0.6));transform:translateY(-5px);box-shadow:0 15px 40px rgba(255,0,255,0.4)}
        .section{display:none;text-align:center}
        .section.active{display:block;animation:fadeIn 0.5s ease}
        @keyframes fadeIn{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
        .game-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:20px;margin:20px 0}
        canvas{border:3px solid rgba(255,255,255,0.3);border-radius:15px;background:#000;box-shadow:0 0 30px rgba(0,255,255,0.5)}
        table{width:100%;max-width:400px;margin:15px auto;border-collapse:collapse;background:rgba(255,255,255,0.1);border-radius:15px;overflow:hidden;box-shadow:0 10px 30px rgba(0,0,0,0.5)}
        th,td{padding:12px;text-align:center;border-bottom:1px solid rgba(255,255,255,0.2)}
        th{background:linear-gradient(45deg,rgba(255,0,255,0.4),rgba(0,255,255,0.4));font-weight:700}
        .tour-table{background:rgba(0,255,0,0.2);margin:15px 0}
        .tour-table h4{color:#00ff00;text-shadow:0 0 10px #00ff00}
        #statusBar{position:fixed;top:10px;right:10px;background:rgba(0,255,0,0.3);padding:10px;border-radius:10px;font-weight:700;z-index:1000}
        #authSection{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(0,0,0,0.9);padding:30px;border-radius:20px;box-shadow:0 0 50px rgba(255,0,255,0.5);min-width:300px;z-index:1000}
        input{padding:12px;margin:10px;border:2px solid rgba(255,255,255,0.3);border-radius:10px;background:rgba(255,255,255,0.1);color:#fff;font-family:inherit;width:calc(100% - 24px)}
        #tourTimer{font-size:2.5rem;color:#00ff00;text-shadow:0 0 20px #00ff00;animation:pulse 1s infinite}
        @keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}
        @media (max-width:768px){.container{padding:10px}.btn{padding:12px 20px;font-size:1rem}}
    </style>
</head>
<body>
    <div id="statusBar">üëã –ì–æ—Å—Ç—å</div>
    
    <div id="authSection" class="section active">
        <h2>üîê –í—Ö–æ–¥ / –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
        <input type="text" id="usernameInput" placeholder="test" value="test">
        <input type="password" id="passwordInput" placeholder="123456" value="123456">
        <button class="btn" onclick="login()">üöÄ –í–û–ô–¢–ò</button>
        <button class="btn" id="logoutBtn" onclick="logout()" style="display:none">üëã –í–´–ô–¢–ò</button>
    </div>

    <div class="container">
        <h1>üöÄ ALEKSIN GAMES HUB v3.0</h1>
        
        <div class="game-grid">
            <button class="btn" onclick="showGame('leaderboards')">üèÜ –õ–ò–î–ï–†–ë–û–†–î–´</button>
            <button class="btn" onclick="showGame('tournament')">‚öîÔ∏è –¢–£–†–ù–ò–†</button>
            <button class="btn" onclick="showGame('guess')">üéØ –£–ì–ê–î–ê–ô –ß–ò–°–õ–û</button>
            <button class="btn" onclick="showGame('snake')">üêç –ó–ú–ï–ô–ö–ê PRO</button>
        </div>

        <!-- –¢—É—Ä–Ω–∏—Ä -->
        <div id="tournamentSection" class="section">
            <h2>‚öîÔ∏è –¢–£–†–ù–ò–† 24—á (00:00 –ú–°–ö)</h2>
            <div>‚è∞ –î–æ –∫–æ–Ω—Ü–∞: <span id="tourTimer">00:00:00</span></div>
            <div id="tournamentTables" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:20px"></div>
        </div>

        <!-- –õ–∏–¥–µ—Ä–±–æ—Ä–¥—ã -->
        <div id="leaderboardTables" class="section"></div>

        <!-- –£–≥–∞–¥–∞–π–∫–∞ -->
        <div id="guessSection" class="section">
            <h2>üéØ –£–ì–ê–î–ê–ô –ß–ò–°–õ–û</h2>
            <div class="game-grid">
                <button class="btn" onclick="setDifficulty('guess','easy')">–õ—ë–≥–∫–∞—è (1-1K)</button>
                <button class="btn" onclick="setDifficulty('guess','normal')">–°—Ä–µ–¥–Ω—è—è (1-10K)</button>
                <button class="btn" onclick="setDifficulty('guess','hard')">–°–ª–æ–∂–Ω–∞—è (1-100K)</button>
            </div>
            <div style="font-size:2rem;margin:20px">–ß–∏—Å–ª–æ –æ—Ç <span id="rangeMin">1</span> –¥–æ <span id="rangeMax">1000</span></div>
            <input type="number" id="guessInput" placeholder="–¢–≤–æ—ë —á–∏—Å–ª–æ" style="font-size:1.5rem;padding:20px;width:200px">
            <button class="btn" onclick="makeGuess()" style="font-size:1.5rem;padding:20px 40px">–£–ì–ê–î–ê–¢–¨</button>
            <div id="guessResult"></div>
            <div id="guessAttempts">–ü–æ–ø—ã—Ç–æ–∫: 0</div>
        </div>

        <!-- –ó–º–µ–π–∫–∞ -->
        <div id="snakeSection" class="section">
            <h2>üêç –ó–ú–ï–ô–ö–ê PRO</h2>
            <div class="game-grid">
                <button class="btn" onclick="startSnake('easy')">–õ—ë–≥–∫–∞—è</button>
                <button class="btn" onclick="startSnake('normal')">–°—Ä–µ–¥–Ω—è—è</button>
                <button class="btn" onclick="startSnake('hard')">–°–ª–æ–∂–Ω–∞—è</button>
            </div>
            <div style="position:relative;display:inline-block">
                <canvas id="gameCanvas" width="400" height="400"></canvas>
                <div id="snakeScore" style="position:absolute;top:10px;left:10px;font-size:1.5rem;font-weight:700;color:#00ff00">–°—á—ë—Ç: 0</div>
            </div>
        </div>
    </div>

    <script>
        // –î–∞–Ω–Ω—ã–µ
        let currentUser = localStorage.getItem('aleksinUser') || null;
        let leaderboards = JSON.parse(localStorage.getItem('aleksinLeaderboards')) || {};
        let tournamentScores = JSON.parse(localStorage.getItem('aleksinTournaments')) || {};
        let currentGameType = '', currentDifficulty = '';
        let secretNumber, guessCount = 0;
        let snake = [], snakeDirection = {x:1,y:0}, snakeScore = 0, gameRunning = false;
        let food = {}, snakeInterval = null;

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        if (currentUser) {
            document.getElementById('statusBar').textContent = `üëã ${currentUser}`;
            document.getElementById('logoutBtn').style.display = 'inline-block';
            document.getElementById('authSection').classList.remove('active');
        }
        setInterval(updateTournament, 1000);
        window.onbeforeunload = saveAllData;

        function saveAllData() {
            localStorage.setItem('aleksinUser', currentUser);
            localStorage.setItem('aleksinLeaderboards', JSON.stringify(leaderboards));
            localStorage.setItem('aleksinTournaments', JSON.stringify(tournamentScores));
        }

        function login() {
            const username = document.getElementById('usernameInput').value.trim();
            const password = document.getElementById('passwordInput').value;
            if (username && password) {
                currentUser = username;
                document.getElementById('statusBar').textContent = `üëã ${currentUser}`;
                document.getElementById('logoutBtn').style.display = 'inline-block';
                document.getElementById('authSection').classList.remove('active');
                saveAllData();
            }
        }

        // ‚úÖ –§–ò–ö–° 12: –†–∞–±–æ—á–∏–π –≤—ã—Ö–æ–¥
        function logout() {
            currentUser = null;
            document.getElementById('statusBar').textContent = 'üëã –ì–æ—Å—Ç—å';
            document.getElementById('logoutBtn').style.display = 'none';
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.getElementById('authSection').classList.add('active');
            saveAllData();
        }

        function showGame(game) {
            if (!currentUser) {
                document.getElementById('authSection').classList.add('active');
                return;
            }
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            
            if (game === 'leaderboards') {
                document.getElementById('leaderboardTables').classList.add('active');
                updateLeaderboards();
            } else if (game === 'tournament') {
                document.getElementById('tournamentSection').classList.add('active');
                updateTournament();
            } else {
                document.getElementById(game + 'Section').classList.add('active');
            }
        }

        function addScore(game, difficulty, score) {
            if (!currentUser) return;
            
            const key = `${game}_${difficulty}`;
            
            // –õ–∏–¥–µ—Ä–±–æ—Ä–¥—ã (–ª—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç)
            leaderboards[key] = leaderboards[key] || {};
            leaderboards[key][currentUser] = Math.max(leaderboards[key][currentUser] || 0, score);
            
            // –¢—É—Ä–Ω–∏—Ä (–Ω–∞–∫–æ–ø–ª–µ–Ω–∏–µ –æ—á–∫–æ–≤)
            tournamentScores[key] = tournamentScores[key] || {};
            tournamentScores[key][currentUser] = (tournamentScores[key][currentUser] || 0) + score;
            
            saveAllData();
        }

        function updateLeaderboards() {
            let html = '<h2>üèÜ –¢–û–ü-10 –õ–ò–î–ï–†–ë–û–†–î–´</h2><div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:20px">';
            const games = ['snake', 'guess'];
            const diffs = ['easy', 'normal', 'hard'];
            
            games.forEach(game => {
                diffs.forEach(diff => {
                    const key = `${game}_${diff}`;
                    const top = Object.entries(leaderboards[key] || {})
                        .sort((a,b) => b[1] - a[1])
                        .slice(0,10)
                        .map(([user, score], i) => `<tr><td>${i+1}.</td><td>${user}</td><td>${score}</td></tr>`)
                        .join('') || '<tr><td colspan="3">–ü–æ–∫–∞ –ø—É—Å—Ç–æ</td></tr>';
                    html += `<div><h3>${game.toUpperCase()} ${diff}</h3><table><tr><th>‚Ññ</th><th>–ò–≥—Ä–æ–∫</th><th>–û—á–∫–∏</th></tr>${top}</table></div>`;
                });
            });
            html += '</div>';
            document.getElementById('leaderboardTables').innerHTML = html;
        }

        function updateTournament() {
            // –¢–∞–π–º–µ—Ä 00:00 MSK
            const now = new Date();
            const mskOffset = 3 * 60 * 60 * 1000;
            const mskNow = new Date(now.getTime() + mskOffset);
            const nextMidnight = new Date(mskNow.getFullYear(), mskNow.getMonth(), mskNow.getDate() + 1, 0, 0, 0);
            const timeLeft = nextMidnight - mskNow;
            
            const hours = Math.floor(timeLeft / (1000*60*60)).toString().padStart(2,'0');
            const minutes = Math.floor((timeLeft % (1000*60*60)) / (1000*60)).toString().padStart(2,'0');
            const seconds = Math.floor((timeLeft % (1000*60)) / 1000).toString().padStart(2,'0');
            document.getElementById('tourTimer').textContent = `${hours}:${minutes}:${seconds}`;

            // 6 —Ç—É—Ä–Ω–∏—Ä–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü
            let html = '';
            const games = ['snake', 'guess'];
            const diffs = ['easy', 'normal', 'hard'];
            
            games.forEach(game => {
                diffs.forEach(diff => {
                    const key = `${game}_${diff}`;
                    const top = Object.entries(tournamentScores[key] || {})
                        .sort((a,b) => b[1] - a[1])
                        .slice(0,10)
                        .map(([user, score], i) => `<tr><td>${i+1}.</td><td>${user}</td><td>${score}</td></tr>`)
                        .join('') || '<tr><td colspan="3">–ü–æ–∫–∞ –ø—É—Å—Ç–æ</td></tr>';
                    html += `
                        <div class="tour-table">
                            <h4>${game.toUpperCase()} ${diff}</h4>
                            <table><tr><th>‚Ññ</th><th>–ò–≥—Ä–æ–∫</th><th>–û—á–∫–∏</th></tr>${top}</table>
                        </div>
                    `;
                });
            });
            document.getElementById('tournamentTables').innerHTML = html;
        }

        // –£–≥–∞–¥–∞–π–∫–∞
        function setDifficulty(game, diff) {
            currentGameType = game;
            currentDifficulty = diff;
            if (game === 'guess') {
                const ranges = {easy:1000, normal:10000, hard:100000};
                document.getElementById('rangeMin').textContent = '1';
                document.getElementById('rangeMax').textContent = ranges[diff];
                secretNumber = Math.floor(Math.random() * ranges[diff]) + 1;
                guessCount = 0;
                document.getElementById('guessResult').textContent = '';
                document.getElementById('guessAttempts').textContent = '–ü–æ–ø—ã—Ç–æ–∫: 0';
            }
        }

        function makeGuess() {
            const guess = parseInt(document.getElementById('guessInput').value);
            guessCount++;
            document.getElementById('guessAttempts').textContent = `–ü–æ–ø—ã—Ç–æ–∫: ${guessCount}`;
            
            if (guess === secretNumber) {
                const score = Math.max(10000 - guessCount * 50, 100);
                document.getElementById('guessResult').innerHTML = `üéâ –£–ì–ê–î–ê–õ! +${score} –æ—á–∫–æ–≤`;
                addScore('guess', currentDifficulty, score);
                setTimeout(() => setDifficulty('guess', currentDifficulty), 2000);
            } else if (guess < secretNumber) {
                document.getElementById('guessResult').textContent = 'üìà –ë–æ–ª—å—à–µ!';
            } else {
                document.getElementById('guessResult').textContent = 'üìâ –ú–µ–Ω—å—à–µ!';
            }
        }

        // ‚úÖ –§–ò–ö–° 5: –ó–º–µ–π–∫–∞ —Å –ö–†–ê–°–ù–û–ô –ï–î–û–ô
        function startSnake(difficulty) {
            currentGameType = 'snake';
            currentDifficulty = difficulty;
            const canvas = document.getElementById('gameCanvas');
            const ctx = canvas.getContext('2d');
            const gridSize = 20;
            const tileCount = canvas.width / gridSize;
            
            // ‚úÖ –ù–æ–≤–∞—è –µ–¥–∞
            food = {x: Math.floor(Math.random() * tileCount), y: Math.floor(Math.random() * tileCount)};
            
            snake = [{x:10,y:10}];
            snakeDirection = {x:1,y:0};
            snakeScore = 0;
            gameRunning = true;
            if (snakeInterval) clearInterval(snakeInterval);
            
            // –°–≤–∞–π–ø—ã —Ç–æ–ª—å–∫–æ –¥–ª—è canvas
            let touchStartX, touchStartY;
            canvas.addEventListener('touchstart', e => {
                touchStartX = e.touches[0].clientX;
                touchStartY = e.touches[0].clientY;
            });
            canvas.addEventListener('touchmove', e => {
                e.preventDefault();
                const deltaX = e.touches[0].clientX - touchStartX;
                const deltaY = e.touches[0].clientY - touchStartY;
                if (Math.abs(deltaX) > Math.abs(deltaY) && Math.abs(deltaX) > 30) {
                    snakeDirection = deltaX > 0 ? {x:1,y:0} : {x:-1,y:0};
                } else if (Math.abs(deltaY) > 30) {
                    snakeDirection = deltaY > 0 ? {x:0,y:1} : {x:0,y:-1};
                }
            });
            
            // –°—Ç—Ä–µ–ª–∫–∏
            document.addEventListener('keydown', e => {
                if (!gameRunning || document.querySelector('.section.active') !== document.getElementById('snakeSection')) return;
                if (e.key === 'ArrowUp' && snakeDirection.y === 0) snakeDirection = {x:0,y:-1};
                if (e.key === 'ArrowDown' && snakeDirection.y === 0) snakeDirection = {x:0,y:1};
                if (e.key === 'ArrowLeft' && snakeDirection.x === 0) snakeDirection = {x:-1,y:0};
                if (e.key === 'ArrowRight' && snakeDirection.x === 0) snakeDirection = {x:1,y:0};
            });
            
            const speeds = {easy:200, normal:150, hard:100};
            
            function gameLoop() {
                if (!gameRunning) return;
                
                const head = {x:snake[0].x + snakeDirection.x, y:snake[0].y + snakeDirection.y};
                
                // –ì—Ä–∞–Ω–∏—Ü—ã
                if (head.x < 0 || head.x >= tileCount || head.y < 0 || head.y >= tileCount || 
                    snake.some(s => s.x === head.x && s.y === head.y)) {
                    gameRunning = false;
                    if (currentUser && snakeScore > 0) {
                        addScore('snake', difficulty, snakeScore);
                        alert(`üíÄ GAME OVER! ${snakeScore} –æ—á–∫–æ–≤`);
                    }
                    return;
                }
                
                snake.unshift(head);
                
                // ‚úÖ –§–ò–ö–° 5: –ü–†–û–í–ï–†–ö–ê –ï–î–´
                if (head.x === food.x && head.y === food.y) {
                    snakeScore += 10;
                    food = {x: Math.floor(Math.random() * tileCount), y: Math.floor(Math.random() * tileCount)};
                } else {
                    snake.pop();
                }
                
                // ‚úÖ –û—Ç—Ä–∏—Å–æ–≤–∫–∞: –ó–ú–ï–Ø + –ö–†–ê–°–ù–ê–Ø –ï–î–ê
                ctx.fillStyle = 'black';
                ctx.fillRect(0,0,canvas.width,canvas.height);
                
                // –ï–î–ê ‚úÖ –ö–†–ê–°–ù–ê–Ø
                ctx.fillStyle = 'red';
                ctx.fillRect(food.x*gridSize, food.y*gridSize, gridSize-2, gridSize-2);
                
                // –ó–ú–ï–Ø
                ctx.fillStyle = '#00ff00';
                snake.forEach((segment, i) => {
                    ctx.fillStyle = i === 0 ? '#ff00ff' : '#00ff00';
                    ctx.fillRect(segment.x*gridSize, segment.y*gridSize, gridSize-2, gridSize-2);
                });
                
                document.getElementById('snakeScore').textContent = `–°—á—ë—Ç: ${snakeScore}`;
            }
            
            snakeInterval = setInterval(gameLoop, speeds[difficulty]);
        }
    </script>
</body>
</html>
